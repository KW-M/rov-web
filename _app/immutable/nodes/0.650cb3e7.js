var Pe=Object.defineProperty;var Ie=(t,e,n)=>e in t?Pe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var de=(t,e,n)=>(Ie(t,typeof e!="symbol"?e+"":e,n),n);import{r as dist,u as noop$4,v as identity,w as run_all,x as setContext,y as getContext,z as get_store_value,A as split_css_unit,s as safe_not_equal,B as create_slot,f as element,a as space,g as claim_element,h as children,c as claim_space,d as detach,j as attr,i as insert_hydration,C as append_hydration,D as update_slot_base,E as get_all_dirty_from_scope,F as get_slot_changes,G as compute_slots,H as assign$1,I as exclude_internal_props,k as set_style,J as listen,K as bubble,l as text,m as claim_text,L as is_function,M as svg_element,N as claim_svg_element,O as toggle_class,b as afterUpdate,e as empty,P as component_subscribe,Q as createEventDispatcher,R as action_destroyer,S as add_render_callback,T as HtmlTagHydration,U as claim_html_tag,V as src_url_equal,q as construct_svelte_component,W as set_attributes,X as set_input_value,n as set_data,p as binding_callbacks,Y as buffer,Z as destroy_each,o as onMount,_ as get_svelte_dataset,$ as onDestroy,a0 as set_svg_attributes,a1 as compute_rest_props,a2 as null_to_empty,a3 as select_option}from"../chunks/scheduler.60bdeabe.js";import{n as now,l as loop,f as create_rule,h as delete_rule,t as transition_out,a as transition_in,S as SvelteComponent,i as init,g as group_outros,c as check_outros,j as create_in_transition,k as create_bidirectional_transition,o as create_out_transition,b as create_component,d as claim_component,m as mount_component,e as destroy_component}from"../chunks/index.3deb9aef.js";import{w as writable,r as readable}from"../chunks/index.8df900ee.js";var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}const globals=typeof window<"u"?window:typeof globalThis<"u"?globalThis:dist.global;function create_animation(t,e,n,a){if(!e)return noop$4;const s=t.getBoundingClientRect();if(e.left===s.left&&e.right===s.right&&e.top===s.top&&e.bottom===s.bottom)return noop$4;const{delay:c=0,duration:u=300,easing:d=identity,start:m=now()+c,end:_=m+u,tick:b=noop$4,css:S}=n(t,{from:e,to:s},a);let k=!0,w=!1,O;function P(){S&&(O=create_rule(t,0,1,u,c,d,S)),c||(w=!0)}function N(){S&&delete_rule(t,O),k=!1}return loop(I=>{if(!w&&I>=m&&(w=!0),w&&I>=_&&(b(1,0),N()),!k)return!1;if(w){const U=I-m,$=0+1*d(U/u);b($,1-$)}return!0}),P(),b(0,1),N}function fix_position(t){const e=getComputedStyle(t);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:n,height:a}=e,s=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=a,add_transform(t,s)}}function add_transform(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const a=getComputedStyle(t),s=a.transform==="none"?"":a.transform;t.style.transform=`${s} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}function ensure_array_like(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function outro_and_destroy_block(t,e){transition_out(t,1,1,()=>{e.delete(t.key)})}function fix_and_outro_and_destroy_block(t,e){t.f(),outro_and_destroy_block(t,e)}function update_keyed_each(t,e,n,a,s,c,u,d,m,_,b,S){let k=t.length,w=c.length,O=k;const P={};for(;O--;)P[t[O].key]=O;const N=[],I=new Map,U=new Map,$=[];for(O=w;O--;){const q=S(s,c,O),K=n(q);let W=u.get(K);W?a&&$.push(()=>W.p(q,e)):(W=_(K,q),W.c()),I.set(K,N[O]=W),K in P&&U.set(K,Math.abs(O-P[K]))}const x=new Set,C=new Set;function H(q){transition_in(q,1),q.m(d,b),u.set(q.key,q),b=q.first,w--}for(;k&&w;){const q=N[w-1],K=t[k-1],W=q.key,Z=K.key;q===K?(b=q.first,k--,w--):I.has(Z)?!u.has(W)||x.has(W)?H(q):C.has(Z)?k--:U.get(W)>U.get(Z)?(C.add(W),H(q)):(x.add(Z),k--):(m(K,u),k--)}for(;k--;){const q=t[k];I.has(q.key)||m(q,u)}for(;w;)H(N[w-1]);return run_all($),N}function get_spread_update(t,e){const n={},a={},s={$$scope:1};let c=t.length;for(;c--;){const u=t[c],d=e[c];if(d){for(const m in u)m in d||(a[m]=1);for(const m in d)s[m]||(n[m]=d[m],s[m]=1);t[c]=d}else for(const m in u)s[m]=1}for(const u in a)u in n||(n[u]=void 0);return n}function get_spread_object(t){return typeof t=="object"&&t!==null?t:{}}const prerender=!1,ssr=!1,_layout=Object.freeze(Object.defineProperty({__proto__:null,prerender,ssr},Symbol.toStringTag,{value:"Module"})),app="",storePopup=writable(void 0),DRAWER_STORE_KEY="drawerStore";function getDrawerStore(){const t=getContext(DRAWER_STORE_KEY);if(!t)throw new Error("drawerStore is not initialized. Please ensure that `initializeStores()` is invoked in the root layout file of this app!");return t}function initializeDrawerStore(){const t=drawerService();return setContext(DRAWER_STORE_KEY,t)}function drawerService(){const{subscribe:t,set:e,update:n}=writable({});return{subscribe:t,set:e,update:n,open:a=>n(()=>({open:!0,...a})),close:()=>n(a=>(a.open=!1,a))}}const MODAL_STORE_KEY="modalStore";function getModalStore(){const t=getContext(MODAL_STORE_KEY);if(!t)throw new Error("modalStore is not initialized. Please ensure that `initializeStores()` is invoked in the root layout file of this app!");return t}function initializeModalStore(){const t=modalService();return setContext(MODAL_STORE_KEY,t)}function modalService(){const{subscribe:t,set:e,update:n}=writable([]);return{subscribe:t,set:e,update:n,trigger:a=>n(s=>(s.push(a),s)),close:()=>n(a=>(a.length>0&&a.shift(),a)),clear:()=>e([])}}const toastDefaults={message:"Missing Toast Message",autohide:!0,timeout:5e3},TOAST_STORE_KEY="toastStore";function getToastStore(){const t=getContext(TOAST_STORE_KEY);if(!t)throw new Error("toastStore is not initialized. Please ensure that `initializeStores()` is invoked in the root layout file of this app!");return t}function initializeToastStore(){const t=toastService();return setContext(TOAST_STORE_KEY,t)}function randomUUID$1(){const t=Math.random();return Number(t).toString(32)}function toastService(){const{subscribe:t,set:e,update:n}=writable([]),a=c=>n(u=>{if(u.length>0){const d=u.findIndex(_=>_.id===c),m=u[d];m&&(m.callback&&m.callback({id:c,status:"closed"}),m.timeoutId&&clearTimeout(m.timeoutId),u.splice(d,1))}return u});function s(c){if(c.autohide===!0)return setTimeout(()=>{a(c.id)},c.timeout)}return{subscribe:t,close:a,trigger:c=>{const u=randomUUID$1();return n(d=>{c&&c.callback&&c.callback({id:u,status:"queued"}),c.hideDismiss&&(c.autohide=!0);const m={...toastDefaults,...c,id:u};return m.timeoutId=s(m),d.push(m),d}),u},freeze:c=>n(u=>(u.length>0&&clearTimeout(u[c].timeoutId),u)),unfreeze:c=>n(u=>(u.length>0&&(u[c].timeoutId=s(u[c])),u)),clear:()=>e([])}}function initializeStores(){initializeModalStore(),initializeToastStore(),initializeDrawerStore()}const stores={};function getStorage(t){return t==="local"?localStorage:sessionStorage}function localStorageStore(t,e,n){const a=(n==null?void 0:n.serializer)??JSON,s=(n==null?void 0:n.storage)??"local";function c(u,d){getStorage(s).setItem(u,a.stringify(d))}if(!stores[t]){const u=writable(e,_=>{const b=getStorage(s).getItem(t);b&&_(a.parse(b));{const S=k=>{k.key===t&&_(k.newValue?a.parse(k.newValue):null)};return window.addEventListener("storage",S),()=>window.removeEventListener("storage",S)}}),{subscribe:d,set:m}=u;stores[t]={set(_){c(t,_),m(_)},update(_){const b=_(get_store_value(u));c(t,b),m(b)},subscribe:d}}return stores[t]}localStorageStore("modeOsPrefers",!1);localStorageStore("modeUserPrefers",void 0);localStorageStore("modeCurrent",!1);const reducedMotionQuery="(prefers-reduced-motion: reduce)";function prefersReducedMotion(){return window.matchMedia(reducedMotionQuery).matches}const prefersReducedMotionStore=readable(prefersReducedMotion(),t=>{{const e=a=>{t(a.matches)},n=window.matchMedia(reducedMotionQuery);return n.addEventListener("change",e),()=>{n.removeEventListener("change",e)}}});function focusTrap(t,e){const n='a[href]:not([tabindex="-1"]), button:not([tabindex="-1"]), input:not([tabindex="-1"]), textarea:not([tabindex="-1"]), select:not([tabindex="-1"]), details:not([tabindex="-1"]), [tabindex]:not([tabindex="-1"])';let a,s;function c(S){S.shiftKey&&S.code==="Tab"&&(S.preventDefault(),s.focus())}function u(S){!S.shiftKey&&S.code==="Tab"&&(S.preventDefault(),a.focus())}const d=S=>{if(e===!1)return;const k=Array.from(t.querySelectorAll(n));k.length&&(a=k[0],s=k[k.length-1],S||a.focus(),a.addEventListener("keydown",c),s.addEventListener("keydown",u))};d(!1);function m(){a&&a.removeEventListener("keydown",c),s&&s.removeEventListener("keydown",u)}const _=(S,k)=>(S.length&&(m(),d(!0)),k),b=new MutationObserver(_);return b.observe(t,{childList:!0,subtree:!0}),{update(S){e=S,S?d(!1):m()},destroy(){m(),b.disconnect()}}}function cubicIn(t){return t*t*t}function cubicOut(t){const e=t-1;return e*e*e+1}function fade(t,{delay:e=0,duration:n=400,easing:a=identity}={}){const s=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:a,css:c=>`opacity: ${c*s}`}}function fly(t,{delay:e=0,duration:n=400,easing:a=cubicOut,x:s=0,y:c=0,opacity:u=0}={}){const d=getComputedStyle(t),m=+d.opacity,_=d.transform==="none"?"":d.transform,b=m*(1-u),[S,k]=split_css_unit(s),[w,O]=split_css_unit(c);return{delay:e,duration:n,easing:a,css:(P,N)=>`
			transform: ${_} translate(${(1-P)*S}${k}, ${(1-P)*w}${O});
			opacity: ${m-b*N}`}}function scale(t,{delay:e=0,duration:n=400,easing:a=cubicOut,start:s=0,opacity:c=0}={}){const u=getComputedStyle(t),d=+u.opacity,m=u.transform==="none"?"":u.transform,_=1-s,b=d*(1-c);return{delay:e,duration:n,easing:a,css:(S,k)=>`
			transform: ${m} scale(${1-_*k});
			opacity: ${d-b*k}
		`}}function dynamicTransition(t,e){const{transition:n,params:a,enabled:s}=e;return s?n(t,a):"duration"in a?n(t,{duration:0}):{duration:0}}const get_headline_slot_changes=t=>({}),get_headline_slot_context=t=>({}),get_trail_slot_changes=t=>({}),get_trail_slot_context=t=>({}),get_lead_slot_changes=t=>({}),get_lead_slot_context=t=>({});function create_if_block_2$5(t){let e,n,a;const s=t[22].lead,c=create_slot(s,t,t[21],get_lead_slot_context);return{c(){e=element("div"),c&&c.c(),this.h()},l(u){e=claim_element(u,"DIV",{class:!0});var d=children(e);c&&c.l(d),d.forEach(detach),this.h()},h(){attr(e,"class",n="app-bar-slot-lead "+t[4])},m(u,d){insert_hydration(u,e,d),c&&c.m(e,null),a=!0},p(u,d){c&&c.p&&(!a||d&2097152)&&update_slot_base(c,s,u,u[21],a?get_slot_changes(s,u[21],d,get_lead_slot_changes):get_all_dirty_from_scope(u[21]),get_lead_slot_context),(!a||d&16&&n!==(n="app-bar-slot-lead "+u[4]))&&attr(e,"class",n)},i(u){a||(transition_in(c,u),a=!0)},o(u){transition_out(c,u),a=!1},d(u){u&&detach(e),c&&c.d(u)}}}function create_if_block_1$6(t){let e,n,a;const s=t[22].trail,c=create_slot(s,t,t[21],get_trail_slot_context);return{c(){e=element("div"),c&&c.c(),this.h()},l(u){e=claim_element(u,"DIV",{class:!0});var d=children(e);c&&c.l(d),d.forEach(detach),this.h()},h(){attr(e,"class",n="app-bar-slot-trail "+t[2])},m(u,d){insert_hydration(u,e,d),c&&c.m(e,null),a=!0},p(u,d){c&&c.p&&(!a||d&2097152)&&update_slot_base(c,s,u,u[21],a?get_slot_changes(s,u[21],d,get_trail_slot_changes):get_all_dirty_from_scope(u[21]),get_trail_slot_context),(!a||d&4&&n!==(n="app-bar-slot-trail "+u[2]))&&attr(e,"class",n)},i(u){a||(transition_in(c,u),a=!0)},o(u){transition_out(c,u),a=!1},d(u){u&&detach(e),c&&c.d(u)}}}function create_if_block$a(t){let e,n,a;const s=t[22].headline,c=create_slot(s,t,t[21],get_headline_slot_context);return{c(){e=element("div"),c&&c.c(),this.h()},l(u){e=claim_element(u,"DIV",{class:!0});var d=children(e);c&&c.l(d),d.forEach(detach),this.h()},h(){attr(e,"class",n="app-bar-row-headline "+t[5])},m(u,d){insert_hydration(u,e,d),c&&c.m(e,null),a=!0},p(u,d){c&&c.p&&(!a||d&2097152)&&update_slot_base(c,s,u,u[21],a?get_slot_changes(s,u[21],d,get_headline_slot_changes):get_all_dirty_from_scope(u[21]),get_headline_slot_context),(!a||d&32&&n!==(n="app-bar-row-headline "+u[5]))&&attr(e,"class",n)},i(u){a||(transition_in(c,u),a=!0)},o(u){transition_out(c,u),a=!1},d(u){u&&detach(e),c&&c.d(u)}}}function create_fragment$y(t){let e,n,a,s,c,u,d,m,_,b,S=t[8].lead&&create_if_block_2$5(t);const k=t[22].default,w=create_slot(k,t,t[21],null);let O=t[8].trail&&create_if_block_1$6(t),P=t[8].headline&&create_if_block$a(t);return{c(){e=element("div"),n=element("div"),S&&S.c(),a=space(),s=element("div"),w&&w.c(),u=space(),O&&O.c(),m=space(),P&&P.c(),this.h()},l(N){e=claim_element(N,"DIV",{class:!0,"data-testid":!0,role:!0,"aria-label":!0,"aria-labelledby":!0});var I=children(e);n=claim_element(I,"DIV",{class:!0});var U=children(n);S&&S.l(U),a=claim_space(U),s=claim_element(U,"DIV",{class:!0});var $=children(s);w&&w.l($),$.forEach(detach),u=claim_space(U),O&&O.l(U),U.forEach(detach),m=claim_space(I),P&&P.l(I),I.forEach(detach),this.h()},h(){attr(s,"class",c="app-bar-slot-default "+t[3]),attr(n,"class",d="app-bar-row-main "+t[6]),attr(e,"class",_="app-bar "+t[7]),attr(e,"data-testid","app-bar"),attr(e,"role","toolbar"),attr(e,"aria-label",t[0]),attr(e,"aria-labelledby",t[1])},m(N,I){insert_hydration(N,e,I),append_hydration(e,n),S&&S.m(n,null),append_hydration(n,a),append_hydration(n,s),w&&w.m(s,null),append_hydration(n,u),O&&O.m(n,null),append_hydration(e,m),P&&P.m(e,null),b=!0},p(N,[I]){N[8].lead?S?(S.p(N,I),I&256&&transition_in(S,1)):(S=create_if_block_2$5(N),S.c(),transition_in(S,1),S.m(n,a)):S&&(group_outros(),transition_out(S,1,1,()=>{S=null}),check_outros()),w&&w.p&&(!b||I&2097152)&&update_slot_base(w,k,N,N[21],b?get_slot_changes(k,N[21],I,null):get_all_dirty_from_scope(N[21]),null),(!b||I&8&&c!==(c="app-bar-slot-default "+N[3]))&&attr(s,"class",c),N[8].trail?O?(O.p(N,I),I&256&&transition_in(O,1)):(O=create_if_block_1$6(N),O.c(),transition_in(O,1),O.m(n,null)):O&&(group_outros(),transition_out(O,1,1,()=>{O=null}),check_outros()),(!b||I&64&&d!==(d="app-bar-row-main "+N[6]))&&attr(n,"class",d),N[8].headline?P?(P.p(N,I),I&256&&transition_in(P,1)):(P=create_if_block$a(N),P.c(),transition_in(P,1),P.m(e,null)):P&&(group_outros(),transition_out(P,1,1,()=>{P=null}),check_outros()),(!b||I&128&&_!==(_="app-bar "+N[7]))&&attr(e,"class",_),(!b||I&1)&&attr(e,"aria-label",N[0]),(!b||I&2)&&attr(e,"aria-labelledby",N[1])},i(N){b||(transition_in(S),transition_in(w,N),transition_in(O),transition_in(P),b=!0)},o(N){transition_out(S),transition_out(w,N),transition_out(O),transition_out(P),b=!1},d(N){N&&detach(e),S&&S.d(),w&&w.d(N),O&&O.d(),P&&P.d()}}}const cBase$1="flex flex-col",cRowMain="grid items-center",cRowHeadline="",cSlotLead="flex-none flex justify-between items-center",cSlotDefault="flex-auto",cSlotTrail="flex-none flex items-center space-x-4";function instance$y(t,e,n){let a,s,c,u,d,m,{$$slots:_={},$$scope:b}=e;const S=compute_slots(_);let{background:k="bg-surface-100-800-token"}=e,{border:w=""}=e,{padding:O="p-4"}=e,{shadow:P=""}=e,{spacing:N="space-y-4"}=e,{gridColumns:I="grid-cols-[auto_1fr_auto]"}=e,{gap:U="gap-4"}=e,{regionRowMain:$=""}=e,{regionRowHeadline:x=""}=e,{slotLead:C=""}=e,{slotDefault:H=""}=e,{slotTrail:q=""}=e,{label:K=""}=e,{labelledby:W=""}=e;return t.$$set=Z=>{n(23,e=assign$1(assign$1({},e),exclude_internal_props(Z))),"background"in Z&&n(9,k=Z.background),"border"in Z&&n(10,w=Z.border),"padding"in Z&&n(11,O=Z.padding),"shadow"in Z&&n(12,P=Z.shadow),"spacing"in Z&&n(13,N=Z.spacing),"gridColumns"in Z&&n(14,I=Z.gridColumns),"gap"in Z&&n(15,U=Z.gap),"regionRowMain"in Z&&n(16,$=Z.regionRowMain),"regionRowHeadline"in Z&&n(17,x=Z.regionRowHeadline),"slotLead"in Z&&n(18,C=Z.slotLead),"slotDefault"in Z&&n(19,H=Z.slotDefault),"slotTrail"in Z&&n(20,q=Z.slotTrail),"label"in Z&&n(0,K=Z.label),"labelledby"in Z&&n(1,W=Z.labelledby),"$$scope"in Z&&n(21,b=Z.$$scope)},t.$$.update=()=>{n(7,a=`${cBase$1} ${k} ${w} ${N} ${O} ${P} ${e.class??""}`),t.$$.dirty&114688&&n(6,s=`${cRowMain} ${I} ${U} ${$}`),t.$$.dirty&131072&&n(5,c=`${cRowHeadline} ${x}`),t.$$.dirty&262144&&n(4,u=`${cSlotLead} ${C}`),t.$$.dirty&524288&&n(3,d=`${cSlotDefault} ${H}`),t.$$.dirty&1048576&&n(2,m=`${cSlotTrail} ${q}`)},e=exclude_internal_props(e),[K,W,m,d,u,c,s,a,S,k,w,O,P,N,I,U,$,x,C,H,q,b,_]}class AppBar extends SvelteComponent{constructor(e){super(),init(this,e,instance$y,create_fragment$y,safe_not_equal,{background:9,border:10,padding:11,shadow:12,spacing:13,gridColumns:14,gap:15,regionRowMain:16,regionRowHeadline:17,slotLead:18,slotDefault:19,slotTrail:20,label:0,labelledby:1})}}const get_footer_slot_changes=t=>({}),get_footer_slot_context=t=>({}),get_sidebarRight_slot_changes=t=>({}),get_sidebarRight_slot_context=t=>({}),get_pageFooter_slot_changes=t=>({}),get_pageFooter_slot_context=t=>({}),get_pageHeader_slot_changes=t=>({}),get_pageHeader_slot_context=t=>({}),get_sidebarLeft_slot_changes=t=>({}),get_sidebarLeft_slot_context=t=>({}),get_header_slot_changes=t=>({}),get_header_slot_context=t=>({});function create_if_block_5$1(t){let e,n,a;const s=t[19].header,c=create_slot(s,t,t[18],get_header_slot_context);return{c(){e=element("header"),c&&c.c(),this.h()},l(u){e=claim_element(u,"HEADER",{id:!0,class:!0});var d=children(e);c&&c.l(d),d.forEach(detach),this.h()},h(){attr(e,"id","shell-header"),attr(e,"class",n="flex-none "+t[8])},m(u,d){insert_hydration(u,e,d),c&&c.m(e,null),a=!0},p(u,d){c&&c.p&&(!a||d&262144)&&update_slot_base(c,s,u,u[18],a?get_slot_changes(s,u[18],d,get_header_slot_changes):get_all_dirty_from_scope(u[18]),get_header_slot_context),(!a||d&256&&n!==(n="flex-none "+u[8]))&&attr(e,"class",n)},i(u){a||(transition_in(c,u),a=!0)},o(u){transition_out(c,u),a=!1},d(u){u&&detach(e),c&&c.d(u)}}}function create_if_block_4$2(t){let e,n;const a=t[19].sidebarLeft,s=create_slot(a,t,t[18],get_sidebarLeft_slot_context);return{c(){e=element("aside"),s&&s.c(),this.h()},l(c){e=claim_element(c,"ASIDE",{id:!0,class:!0});var u=children(e);s&&s.l(u),u.forEach(detach),this.h()},h(){attr(e,"id","sidebar-left"),attr(e,"class",t[7])},m(c,u){insert_hydration(c,e,u),s&&s.m(e,null),n=!0},p(c,u){s&&s.p&&(!n||u&262144)&&update_slot_base(s,a,c,c[18],n?get_slot_changes(a,c[18],u,get_sidebarLeft_slot_changes):get_all_dirty_from_scope(c[18]),get_sidebarLeft_slot_context),(!n||u&128)&&attr(e,"class",c[7])},i(c){n||(transition_in(s,c),n=!0)},o(c){transition_out(s,c),n=!1},d(c){c&&detach(e),s&&s.d(c)}}}function create_if_block_3$4(t){let e,n,a;const s=t[19].pageHeader,c=create_slot(s,t,t[18],get_pageHeader_slot_context),u=c||fallback_block_1();return{c(){e=element("header"),u&&u.c(),this.h()},l(d){e=claim_element(d,"HEADER",{id:!0,class:!0});var m=children(e);u&&u.l(m),m.forEach(detach),this.h()},h(){attr(e,"id","page-header"),attr(e,"class",n="flex-none "+t[5])},m(d,m){insert_hydration(d,e,m),u&&u.m(e,null),a=!0},p(d,m){c&&c.p&&(!a||m&262144)&&update_slot_base(c,s,d,d[18],a?get_slot_changes(s,d[18],m,get_pageHeader_slot_changes):get_all_dirty_from_scope(d[18]),get_pageHeader_slot_context),(!a||m&32&&n!==(n="flex-none "+d[5]))&&attr(e,"class",n)},i(d){a||(transition_in(u,d),a=!0)},o(d){transition_out(u,d),a=!1},d(d){d&&detach(e),u&&u.d(d)}}}function fallback_block_1(t){let e;return{c(){e=text("(slot:header)")},l(n){e=claim_text(n,"(slot:header)")},m(n,a){insert_hydration(n,e,a)},d(n){n&&detach(e)}}}function create_if_block_2$4(t){let e,n,a;const s=t[19].pageFooter,c=create_slot(s,t,t[18],get_pageFooter_slot_context),u=c||fallback_block();return{c(){e=element("footer"),u&&u.c(),this.h()},l(d){e=claim_element(d,"FOOTER",{id:!0,class:!0});var m=children(e);u&&u.l(m),m.forEach(detach),this.h()},h(){attr(e,"id","page-footer"),attr(e,"class",n="flex-none "+t[3])},m(d,m){insert_hydration(d,e,m),u&&u.m(e,null),a=!0},p(d,m){c&&c.p&&(!a||m&262144)&&update_slot_base(c,s,d,d[18],a?get_slot_changes(s,d[18],m,get_pageFooter_slot_changes):get_all_dirty_from_scope(d[18]),get_pageFooter_slot_context),(!a||m&8&&n!==(n="flex-none "+d[3]))&&attr(e,"class",n)},i(d){a||(transition_in(u,d),a=!0)},o(d){transition_out(u,d),a=!1},d(d){d&&detach(e),u&&u.d(d)}}}function fallback_block(t){let e;return{c(){e=text("(slot:footer)")},l(n){e=claim_text(n,"(slot:footer)")},m(n,a){insert_hydration(n,e,a)},d(n){n&&detach(e)}}}function create_if_block_1$5(t){let e,n;const a=t[19].sidebarRight,s=create_slot(a,t,t[18],get_sidebarRight_slot_context);return{c(){e=element("aside"),s&&s.c(),this.h()},l(c){e=claim_element(c,"ASIDE",{id:!0,class:!0});var u=children(e);s&&s.l(u),u.forEach(detach),this.h()},h(){attr(e,"id","sidebar-right"),attr(e,"class",t[6])},m(c,u){insert_hydration(c,e,u),s&&s.m(e,null),n=!0},p(c,u){s&&s.p&&(!n||u&262144)&&update_slot_base(s,a,c,c[18],n?get_slot_changes(a,c[18],u,get_sidebarRight_slot_changes):get_all_dirty_from_scope(c[18]),get_sidebarRight_slot_context),(!n||u&64)&&attr(e,"class",c[6])},i(c){n||(transition_in(s,c),n=!0)},o(c){transition_out(s,c),n=!1},d(c){c&&detach(e),s&&s.d(c)}}}function create_if_block$9(t){let e,n,a;const s=t[19].footer,c=create_slot(s,t,t[18],get_footer_slot_context);return{c(){e=element("footer"),c&&c.c(),this.h()},l(u){e=claim_element(u,"FOOTER",{id:!0,class:!0});var d=children(e);c&&c.l(d),d.forEach(detach),this.h()},h(){attr(e,"id","shell-footer"),attr(e,"class",n="flex-none "+t[2])},m(u,d){insert_hydration(u,e,d),c&&c.m(e,null),a=!0},p(u,d){c&&c.p&&(!a||d&262144)&&update_slot_base(c,s,u,u[18],a?get_slot_changes(s,u[18],d,get_footer_slot_changes):get_all_dirty_from_scope(u[18]),get_footer_slot_context),(!a||d&4&&n!==(n="flex-none "+u[2]))&&attr(e,"class",n)},i(u){a||(transition_in(c,u),a=!0)},o(u){transition_out(c,u),a=!1},d(u){u&&detach(e),c&&c.d(u)}}}function create_fragment$x(t){let e,n,a,s,c,u,d,m,_,b,S,k,w,O,P,N=t[10].header&&create_if_block_5$1(t),I=t[10].sidebarLeft&&create_if_block_4$2(t),U=t[10].pageHeader&&create_if_block_3$4(t);const $=t[19].default,x=create_slot($,t,t[18],null);let C=t[10].pageFooter&&create_if_block_2$4(t),H=t[10].sidebarRight&&create_if_block_1$5(t),q=t[10].footer&&create_if_block$9(t);return{c(){e=element("div"),N&&N.c(),n=space(),a=element("div"),I&&I.c(),s=space(),c=element("div"),U&&U.c(),u=space(),d=element("main"),x&&x.c(),_=space(),C&&C.c(),S=space(),H&&H.c(),k=space(),q&&q.c(),this.h()},l(K){e=claim_element(K,"DIV",{id:!0,class:!0,"data-testid":!0});var W=children(e);N&&N.l(W),n=claim_space(W),a=claim_element(W,"DIV",{class:!0});var Z=children(a);I&&I.l(Z),s=claim_space(Z),c=claim_element(Z,"DIV",{id:!0,class:!0});var ee=children(c);U&&U.l(ee),u=claim_space(ee),d=claim_element(ee,"MAIN",{id:!0,class:!0});var ie=children(d);x&&x.l(ie),ie.forEach(detach),_=claim_space(ee),C&&C.l(ee),ee.forEach(detach),S=claim_space(Z),H&&H.l(Z),Z.forEach(detach),k=claim_space(W),q&&q.l(W),W.forEach(detach),this.h()},h(){attr(d,"id","page-content"),attr(d,"class",m="flex-auto "+t[4]),attr(c,"id","page"),attr(c,"class",b=t[1]+" "+cPage),set_style(c,"scrollbar-gutter",t[0]),attr(a,"class","flex-auto "+cContentArea),attr(e,"id","appShell"),attr(e,"class",t[9]),attr(e,"data-testid","app-shell")},m(K,W){insert_hydration(K,e,W),N&&N.m(e,null),append_hydration(e,n),append_hydration(e,a),I&&I.m(a,null),append_hydration(a,s),append_hydration(a,c),U&&U.m(c,null),append_hydration(c,u),append_hydration(c,d),x&&x.m(d,null),append_hydration(c,_),C&&C.m(c,null),append_hydration(a,S),H&&H.m(a,null),append_hydration(e,k),q&&q.m(e,null),w=!0,O||(P=listen(c,"scroll",t[20]),O=!0)},p(K,[W]){K[10].header?N?(N.p(K,W),W&1024&&transition_in(N,1)):(N=create_if_block_5$1(K),N.c(),transition_in(N,1),N.m(e,n)):N&&(group_outros(),transition_out(N,1,1,()=>{N=null}),check_outros()),K[10].sidebarLeft?I?(I.p(K,W),W&1024&&transition_in(I,1)):(I=create_if_block_4$2(K),I.c(),transition_in(I,1),I.m(a,s)):I&&(group_outros(),transition_out(I,1,1,()=>{I=null}),check_outros()),K[10].pageHeader?U?(U.p(K,W),W&1024&&transition_in(U,1)):(U=create_if_block_3$4(K),U.c(),transition_in(U,1),U.m(c,u)):U&&(group_outros(),transition_out(U,1,1,()=>{U=null}),check_outros()),x&&x.p&&(!w||W&262144)&&update_slot_base(x,$,K,K[18],w?get_slot_changes($,K[18],W,null):get_all_dirty_from_scope(K[18]),null),(!w||W&16&&m!==(m="flex-auto "+K[4]))&&attr(d,"class",m),K[10].pageFooter?C?(C.p(K,W),W&1024&&transition_in(C,1)):(C=create_if_block_2$4(K),C.c(),transition_in(C,1),C.m(c,null)):C&&(group_outros(),transition_out(C,1,1,()=>{C=null}),check_outros()),(!w||W&2&&b!==(b=K[1]+" "+cPage))&&attr(c,"class",b),W&1&&set_style(c,"scrollbar-gutter",K[0]),K[10].sidebarRight?H?(H.p(K,W),W&1024&&transition_in(H,1)):(H=create_if_block_1$5(K),H.c(),transition_in(H,1),H.m(a,null)):H&&(group_outros(),transition_out(H,1,1,()=>{H=null}),check_outros()),K[10].footer?q?(q.p(K,W),W&1024&&transition_in(q,1)):(q=create_if_block$9(K),q.c(),transition_in(q,1),q.m(e,null)):q&&(group_outros(),transition_out(q,1,1,()=>{q=null}),check_outros()),(!w||W&512)&&attr(e,"class",K[9])},i(K){w||(transition_in(N),transition_in(I),transition_in(U),transition_in(x,K),transition_in(C),transition_in(H),transition_in(q),w=!0)},o(K){transition_out(N),transition_out(I),transition_out(U),transition_out(x,K),transition_out(C),transition_out(H),transition_out(q),w=!1},d(K){K&&detach(e),N&&N.d(),I&&I.d(),U&&U.d(),x&&x.d(K),C&&C.d(),H&&H.d(),q&&q.d(),O=!1,P()}}}const cBaseAppShell="w-full h-full flex flex-col overflow-hidden",cContentArea="w-full h-full flex overflow-hidden",cPage="flex-1 overflow-x-hidden flex flex-col",cSidebarLeft="flex-none overflow-x-hidden overflow-y-auto",cSidebarRight="flex-none overflow-x-hidden overflow-y-auto";function instance$x(t,e,n){let a,s,c,u,d,m,_,b,{$$slots:S={},$$scope:k}=e;const w=compute_slots(S);let{scrollbarGutter:O="auto"}=e,{regionPage:P=""}=e,{slotHeader:N="z-10"}=e,{slotSidebarLeft:I="w-auto"}=e,{slotSidebarRight:U="w-auto"}=e,{slotPageHeader:$=""}=e,{slotPageContent:x=""}=e,{slotPageFooter:C=""}=e,{slotFooter:H=""}=e;function q(K){bubble.call(this,t,K)}return t.$$set=K=>{n(21,e=assign$1(assign$1({},e),exclude_internal_props(K))),"scrollbarGutter"in K&&n(0,O=K.scrollbarGutter),"regionPage"in K&&n(1,P=K.regionPage),"slotHeader"in K&&n(11,N=K.slotHeader),"slotSidebarLeft"in K&&n(12,I=K.slotSidebarLeft),"slotSidebarRight"in K&&n(13,U=K.slotSidebarRight),"slotPageHeader"in K&&n(14,$=K.slotPageHeader),"slotPageContent"in K&&n(15,x=K.slotPageContent),"slotPageFooter"in K&&n(16,C=K.slotPageFooter),"slotFooter"in K&&n(17,H=K.slotFooter),"$$scope"in K&&n(18,k=K.$$scope)},t.$$.update=()=>{n(9,a=`${cBaseAppShell} ${e.class??""}`),t.$$.dirty&2048&&n(8,s=`${N}`),t.$$.dirty&4096&&n(7,c=`${cSidebarLeft} ${I}`),t.$$.dirty&8192&&n(6,u=`${cSidebarRight} ${U}`),t.$$.dirty&16384&&n(5,d=`${$}`),t.$$.dirty&32768&&n(4,m=`${x}`),t.$$.dirty&65536&&n(3,_=`${C}`),t.$$.dirty&131072&&n(2,b=`${H}`)},e=exclude_internal_props(e),[O,P,b,_,m,d,u,c,s,a,w,N,I,U,$,x,C,H,k,S,q]}class AppShell extends SvelteComponent{constructor(e){super(),init(this,e,instance$x,create_fragment$x,safe_not_equal,{scrollbarGutter:0,regionPage:1,slotHeader:11,slotSidebarLeft:12,slotSidebarRight:13,slotPageHeader:14,slotPageContent:15,slotPageFooter:16,slotFooter:17})}}function flip$1(t,{from:e,to:n},a={}){const s=getComputedStyle(t),c=s.transform==="none"?"":s.transform,[u,d]=s.transformOrigin.split(" ").map(parseFloat),m=e.left+e.width*u/n.width-(n.left+u),_=e.top+e.height*d/n.height-(n.top+d),{delay:b=0,duration:S=w=>Math.sqrt(w)*120,easing:k=cubicOut}=a;return{delay:b,duration:is_function(S)?S(Math.sqrt(m*m+_*_)):S,easing:k,css:(w,O)=>{const P=O*m,N=O*_,I=w+O*e.width/n.width,U=w+O*e.height/n.height;return`transform: ${c} translate(${P}px, ${N}px) scale(${I}, ${U});`}}}const ProgressBar_svelte_svelte_type_style_lang="";function create_if_block$8(t){let e,n,a;const s=t[16].default,c=create_slot(s,t,t[15],null);return{c(){e=svg_element("text"),c&&c.c(),this.h()},l(u){e=claim_svg_element(u,"text",{x:!0,y:!0,"text-anchor":!0,"dominant-baseline":!0,"font-weight":!0,"font-size":!0,class:!0});var d=children(e);c&&c.l(d),d.forEach(detach),this.h()},h(){attr(e,"x","50%"),attr(e,"y","50%"),attr(e,"text-anchor","middle"),attr(e,"dominant-baseline","middle"),attr(e,"font-weight","bold"),attr(e,"font-size",t[2]),attr(e,"class",n="progress-radial-text "+t[7])},m(u,d){insert_hydration(u,e,d),c&&c.m(e,null),a=!0},p(u,d){c&&c.p&&(!a||d&32768)&&update_slot_base(c,s,u,u[15],a?get_slot_changes(s,u[15],d,null):get_all_dirty_from_scope(u[15]),null),(!a||d&4)&&attr(e,"font-size",u[2]),(!a||d&128&&n!==(n="progress-radial-text "+u[7]))&&attr(e,"class",n)},i(u){a||(transition_in(c,u),a=!0)},o(u){transition_out(c,u),a=!1},d(u){u&&detach(e),c&&c.d(u)}}}function create_fragment$w(t){let e,n,a,s,c,u,d=`${t[9]}
			${t[9]}`,m,_,b,S,k=t[0]!=null&&t[0]>=0&&t[13].default&&create_if_block$8(t);return{c(){e=element("figure"),n=svg_element("svg"),a=svg_element("circle"),c=svg_element("circle"),k&&k.c(),this.h()},l(w){e=claim_element(w,"FIGURE",{class:!0,"data-testid":!0,role:!0,"aria-labelledby":!0,"aria-valuenow":!0,"aria-valuetext":!0,"aria-valuemin":!0,"aria-valuemax":!0});var O=children(e);n=claim_svg_element(O,"svg",{viewBox:!0,class:!0});var P=children(n);a=claim_svg_element(P,"circle",{class:!0,"stroke-width":!0,r:!0,cx:!0,cy:!0}),children(a).forEach(detach),c=claim_svg_element(P,"circle",{class:!0,"stroke-width":!0,r:!0,cx:!0,cy:!0,"stroke-linecap":!0}),children(c).forEach(detach),k&&k.l(P),P.forEach(detach),O.forEach(detach),this.h()},h(){attr(a,"class",s="progress-radial-track "+cBaseTrack+" "+t[6]),attr(a,"stroke-width",t[1]),attr(a,"r",t[12]),attr(a,"cx","50%"),attr(a,"cy","50%"),attr(c,"class",u="progress-radial-meter "+cBaseMeter+" "+t[5]+" "+t[4]),attr(c,"stroke-width",t[1]),attr(c,"r",t[12]),attr(c,"cx","50%"),attr(c,"cy","50%"),attr(c,"stroke-linecap",t[3]),set_style(c,"stroke-dasharray",d),set_style(c,"stroke-dashoffset",t[10]),attr(n,"viewBox","0 0 "+baseSize+" "+baseSize),attr(n,"class","rounded-full"),toggle_class(n,"animate-spin",t[0]===void 0),attr(e,"class",m="progress-radial "+t[11]),attr(e,"data-testid","progress-radial"),attr(e,"role","meter"),attr(e,"aria-labelledby",t[8]),attr(e,"aria-valuenow",_=t[0]||0),attr(e,"aria-valuetext",b=t[0]?`${t[0]}%`:"Indeterminate Spinner"),attr(e,"aria-valuemin",0),attr(e,"aria-valuemax",100)},m(w,O){insert_hydration(w,e,O),append_hydration(e,n),append_hydration(n,a),append_hydration(n,c),k&&k.m(n,null),S=!0},p(w,[O]){(!S||O&64&&s!==(s="progress-radial-track "+cBaseTrack+" "+w[6]))&&attr(a,"class",s),(!S||O&2)&&attr(a,"stroke-width",w[1]),(!S||O&48&&u!==(u="progress-radial-meter "+cBaseMeter+" "+w[5]+" "+w[4]))&&attr(c,"class",u),(!S||O&2)&&attr(c,"stroke-width",w[1]),(!S||O&8)&&attr(c,"stroke-linecap",w[3]),O&512&&d!==(d=`${w[9]}
			${w[9]}`)&&set_style(c,"stroke-dasharray",d),O&1024&&set_style(c,"stroke-dashoffset",w[10]),w[0]!=null&&w[0]>=0&&w[13].default?k?(k.p(w,O),O&8193&&transition_in(k,1)):(k=create_if_block$8(w),k.c(),transition_in(k,1),k.m(n,null)):k&&(group_outros(),transition_out(k,1,1,()=>{k=null}),check_outros()),(!S||O&1)&&toggle_class(n,"animate-spin",w[0]===void 0),(!S||O&2048&&m!==(m="progress-radial "+w[11]))&&attr(e,"class",m),(!S||O&256)&&attr(e,"aria-labelledby",w[8]),(!S||O&1&&_!==(_=w[0]||0))&&attr(e,"aria-valuenow",_),(!S||O&1&&b!==(b=w[0]?`${w[0]}%`:"Indeterminate Spinner"))&&attr(e,"aria-valuetext",b)},i(w){S||(transition_in(k),S=!0)},o(w){transition_out(k),S=!1},d(w){w&&detach(e),k&&k.d()}}}const cBase="progress-radial relative overflow-hidden",cBaseTrack="fill-transparent",cBaseMeter="fill-transparent -rotate-90 origin-[50%_50%]",baseSize=512;function instance$w(t,e,n){let a,{$$slots:s={},$$scope:c}=e;const u=compute_slots(s);let{value:d=void 0}=e,{stroke:m=40}=e,{font:_=56}=e,{strokeLinecap:b="butt"}=e,{transition:S="transition-[stroke-dashoffset]"}=e,{width:k="w-36"}=e,{meter:w="stroke-surface-900 dark:stroke-surface-50"}=e,{track:O="stroke-surface-500/30"}=e,{fill:P="fill-token"}=e,{labelledby:N=""}=e;const I=baseSize/2-m/2;let U=I,$;function x(C){n(9,U=I*2*Math.PI),n(10,$=U-C/100*U)}return x(0),afterUpdate(()=>{x(d===void 0?25:d)}),t.$$set=C=>{n(18,e=assign$1(assign$1({},e),exclude_internal_props(C))),"value"in C&&n(0,d=C.value),"stroke"in C&&n(1,m=C.stroke),"font"in C&&n(2,_=C.font),"strokeLinecap"in C&&n(3,b=C.strokeLinecap),"transition"in C&&n(4,S=C.transition),"width"in C&&n(14,k=C.width),"meter"in C&&n(5,w=C.meter),"track"in C&&n(6,O=C.track),"fill"in C&&n(7,P=C.fill),"labelledby"in C&&n(8,N=C.labelledby),"$$scope"in C&&n(15,c=C.$$scope)},t.$$.update=()=>{n(11,a=`${cBase} ${k} ${e.class??""}`)},e=exclude_internal_props(e),[d,m,_,b,S,w,O,P,N,U,$,a,I,u,k,c,s]}class ProgressRadial extends SvelteComponent{constructor(e){super(),init(this,e,instance$w,create_fragment$w,safe_not_equal,{value:0,stroke:1,font:2,strokeLinecap:3,transition:4,width:14,meter:5,track:6,fill:7,labelledby:8})}}function create_if_block$7(t){let e=t[13],n,a,s=create_key_block(t);return{c(){s.c(),n=empty()},l(c){s.l(c),n=empty()},m(c,u){s.m(c,u),insert_hydration(c,n,u),a=!0},p(c,u){u[0]&8192&&safe_not_equal(e,e=c[13])?(group_outros(),transition_out(s,1,1,noop$4),check_outros(),s=create_key_block(c),s.c(),transition_in(s,1),s.m(n.parentNode,n)):s.p(c,u)},i(c){a||(transition_in(s),a=!0)},o(c){transition_out(s),a=!1},d(c){c&&detach(n),s.d(c)}}}function create_else_block$4(t){let e,n,a,s,c,u;const d=[create_if_block_8,create_else_block_1$1],m=[];function _(b,S){var k;return(k=b[15])!=null&&k.slot?0:1}return n=_(t),a=m[n]=d[n](t),{c(){e=element("div"),a.c(),this.h()},l(b){e=claim_element(b,"DIV",{class:!0,"data-testid":!0,role:!0,"aria-modal":!0,"aria-label":!0});var S=children(e);a.l(S),S.forEach(detach),this.h()},h(){var b;attr(e,"class",s="modal contents "+(((b=t[13][0])==null?void 0:b.modalClasses)??"")),attr(e,"data-testid","modal-component"),attr(e,"role","dialog"),attr(e,"aria-modal","true"),attr(e,"aria-label",c=t[13][0].title??"")},m(b,S){insert_hydration(b,e,S),m[n].m(e,null),u=!0},p(b,S){var w;let k=n;n=_(b),n===k?m[n].p(b,S):(group_outros(),transition_out(m[k],1,1,()=>{m[k]=null}),check_outros(),a=m[n],a?a.p(b,S):(a=m[n]=d[n](b),a.c()),transition_in(a,1),a.m(e,null)),(!u||S[0]&8192&&s!==(s="modal contents "+(((w=b[13][0])==null?void 0:w.modalClasses)??"")))&&attr(e,"class",s),(!u||S[0]&8192&&c!==(c=b[13][0].title??""))&&attr(e,"aria-label",c)},i(b){u||(transition_in(a),u=!0)},o(b){transition_out(a),u=!1},d(b){b&&detach(e),m[n].d()}}}function create_if_block_1$4(t){var w,O,P,N;let e,n,a,s,c,u,d=((w=t[13][0])==null?void 0:w.title)&&create_if_block_7(t),m=((O=t[13][0])==null?void 0:O.body)&&create_if_block_6(t),_=((P=t[13][0])==null?void 0:P.image)&&typeof((N=t[13][0])==null?void 0:N.image)=="string"&&create_if_block_5(t);function b(I,U){if(I[13][0].type==="alert")return create_if_block_2$3;if(I[13][0].type==="confirm")return create_if_block_3$3;if(I[13][0].type==="prompt")return create_if_block_4$1}let S=b(t),k=S&&S(t);return{c(){e=element("div"),d&&d.c(),n=space(),m&&m.c(),a=space(),_&&_.c(),s=space(),k&&k.c(),this.h()},l(I){e=claim_element(I,"DIV",{class:!0,"data-testid":!0,role:!0,"aria-modal":!0,"aria-label":!0});var U=children(e);d&&d.l(U),n=claim_space(U),m&&m.l(U),a=claim_space(U),_&&_.l(U),s=claim_space(U),k&&k.l(U),U.forEach(detach),this.h()},h(){attr(e,"class",c="modal "+t[17]),attr(e,"data-testid","modal"),attr(e,"role","dialog"),attr(e,"aria-modal","true"),attr(e,"aria-label",u=t[13][0].title??"")},m(I,U){insert_hydration(I,e,U),d&&d.m(e,null),append_hydration(e,n),m&&m.m(e,null),append_hydration(e,a),_&&_.m(e,null),append_hydration(e,s),k&&k.m(e,null)},p(I,U){var $,x,C,H;($=I[13][0])!=null&&$.title?d?d.p(I,U):(d=create_if_block_7(I),d.c(),d.m(e,n)):d&&(d.d(1),d=null),(x=I[13][0])!=null&&x.body?m?m.p(I,U):(m=create_if_block_6(I),m.c(),m.m(e,a)):m&&(m.d(1),m=null),(C=I[13][0])!=null&&C.image&&typeof((H=I[13][0])==null?void 0:H.image)=="string"?_?_.p(I,U):(_=create_if_block_5(I),_.c(),_.m(e,s)):_&&(_.d(1),_=null),S===(S=b(I))&&k?k.p(I,U):(k&&k.d(1),k=S&&S(I),k&&(k.c(),k.m(e,null))),U[0]&131072&&c!==(c="modal "+I[17])&&attr(e,"class",c),U[0]&8192&&u!==(u=I[13][0].title??"")&&attr(e,"aria-label",u)},i:noop$4,o:noop$4,d(I){I&&detach(e),d&&d.d(),m&&m.d(),_&&_.d(),k&&k.d()}}}function create_else_block_1$1(t){var d,m;let e,n,a;const s=[(d=t[15])==null?void 0:d.props,{parent:t[16]}];var c=(m=t[15])==null?void 0:m.ref;function u(_,b){var k;let S={};if(b!==void 0&&b[0]&98304)S=get_spread_update(s,[b[0]&32768&&get_spread_object((k=_[15])==null?void 0:k.props),b[0]&65536&&{parent:_[16]}]);else for(let w=0;w<s.length;w+=1)S=assign$1(S,s[w]);return{props:S}}return c&&(e=construct_svelte_component(c,u(t))),{c(){e&&create_component(e.$$.fragment),n=empty()},l(_){e&&claim_component(e.$$.fragment,_),n=empty()},m(_,b){e&&mount_component(e,_,b),insert_hydration(_,n,b),a=!0},p(_,b){var S,k;if(b[0]&32768&&c!==(c=(S=_[15])==null?void 0:S.ref)){if(e){group_outros();const w=e;transition_out(w.$$.fragment,1,0,()=>{destroy_component(w,1)}),check_outros()}c?(e=construct_svelte_component(c,u(_,b)),create_component(e.$$.fragment),transition_in(e.$$.fragment,1),mount_component(e,n.parentNode,n)):e=null}else if(c){const w=b[0]&98304?get_spread_update(s,[b[0]&32768&&get_spread_object((k=_[15])==null?void 0:k.props),b[0]&65536&&{parent:_[16]}]):{};e.$set(w)}},i(_){a||(e&&transition_in(e.$$.fragment,_),a=!0)},o(_){e&&transition_out(e.$$.fragment,_),a=!1},d(_){_&&detach(n),e&&destroy_component(e,_)}}}function create_if_block_8(t){var d,m;let e,n,a;const s=[(d=t[15])==null?void 0:d.props,{parent:t[16]}];var c=(m=t[15])==null?void 0:m.ref;function u(_,b){var k;let S={$$slots:{default:[create_default_slot$3]},$$scope:{ctx:_}};if(b!==void 0&&b[0]&98304)S=get_spread_update(s,[b[0]&32768&&get_spread_object((k=_[15])==null?void 0:k.props),b[0]&65536&&{parent:_[16]}]);else for(let w=0;w<s.length;w+=1)S=assign$1(S,s[w]);return{props:S}}return c&&(e=construct_svelte_component(c,u(t))),{c(){e&&create_component(e.$$.fragment),n=empty()},l(_){e&&claim_component(e.$$.fragment,_),n=empty()},m(_,b){e&&mount_component(e,_,b),insert_hydration(_,n,b),a=!0},p(_,b){var S,k;if(b[0]&32768&&c!==(c=(S=_[15])==null?void 0:S.ref)){if(e){group_outros();const w=e;transition_out(w.$$.fragment,1,0,()=>{destroy_component(w,1)}),check_outros()}c?(e=construct_svelte_component(c,u(_,b)),create_component(e.$$.fragment),transition_in(e.$$.fragment,1),mount_component(e,n.parentNode,n)):e=null}else if(c){const w=b[0]&98304?get_spread_update(s,[b[0]&32768&&get_spread_object((k=_[15])==null?void 0:k.props),b[0]&65536&&{parent:_[16]}]):{};b[0]&32768|b[1]&65536&&(w.$$scope={dirty:b,ctx:_}),e.$set(w)}},i(_){a||(e&&transition_in(e.$$.fragment,_),a=!0)},o(_){e&&transition_out(e.$$.fragment,_),a=!1},d(_){_&&detach(n),e&&destroy_component(e,_)}}}function create_default_slot$3(t){var s;let e,n=((s=t[15])==null?void 0:s.slot)+"",a;return{c(){e=new HtmlTagHydration(!1),a=empty(),this.h()},l(c){e=claim_html_tag(c,!1),a=empty(),this.h()},h(){e.a=a},m(c,u){e.m(n,c,u),insert_hydration(c,a,u)},p(c,u){var d;u[0]&32768&&n!==(n=((d=c[15])==null?void 0:d.slot)+"")&&e.p(n)},d(c){c&&(detach(a),e.d())}}}function create_if_block_7(t){let e,n,a=t[13][0].title+"",s;return{c(){e=element("header"),n=new HtmlTagHydration(!1),this.h()},l(c){e=claim_element(c,"HEADER",{class:!0});var u=children(e);n=claim_html_tag(u,!1),u.forEach(detach),this.h()},h(){n.a=null,attr(e,"class",s="modal-header "+t[5])},m(c,u){insert_hydration(c,e,u),n.m(a,e)},p(c,u){u[0]&8192&&a!==(a=c[13][0].title+"")&&n.p(a),u[0]&32&&s!==(s="modal-header "+c[5])&&attr(e,"class",s)},d(c){c&&detach(e)}}}function create_if_block_6(t){let e,n,a=t[13][0].body+"",s;return{c(){e=element("article"),n=new HtmlTagHydration(!1),this.h()},l(c){e=claim_element(c,"ARTICLE",{class:!0});var u=children(e);n=claim_html_tag(u,!1),u.forEach(detach),this.h()},h(){n.a=null,attr(e,"class",s="modal-body "+t[6])},m(c,u){insert_hydration(c,e,u),n.m(a,e)},p(c,u){u[0]&8192&&a!==(a=c[13][0].body+"")&&n.p(a),u[0]&64&&s!==(s="modal-body "+c[6])&&attr(e,"class",s)},d(c){c&&detach(e)}}}function create_if_block_5(t){let e,n;return{c(){e=element("img"),this.h()},l(a){e=claim_element(a,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){var a;attr(e,"class","modal-image "+cModalImage),src_url_equal(e.src,n=(a=t[13][0])==null?void 0:a.image)||attr(e,"src",n),attr(e,"alt","Modal")},m(a,s){insert_hydration(a,e,s)},p(a,s){var c;s[0]&8192&&!src_url_equal(e.src,n=(c=a[13][0])==null?void 0:c.image)&&attr(e,"src",n)},d(a){a&&detach(e)}}}function create_if_block_4$1(t){let e,n,a,s,c,u,d,m,_,b,S,k,w,O,P=[{class:"modal-prompt-input input"},{name:"prompt"},{type:"text"},t[13][0].valueAttr],N={};for(let I=0;I<P.length;I+=1)N=assign$1(N,P[I]);return{c(){e=element("form"),n=element("input"),a=space(),s=element("footer"),c=element("button"),u=text(t[0]),m=space(),_=element("button"),b=text(t[2]),this.h()},l(I){e=claim_element(I,"FORM",{class:!0});var U=children(e);n=claim_element(U,"INPUT",{class:!0,name:!0,type:!0}),a=claim_space(U),s=claim_element(U,"FOOTER",{class:!0});var $=children(s);c=claim_element($,"BUTTON",{type:!0,class:!0});var x=children(c);u=claim_text(x,t[0]),x.forEach(detach),m=claim_space($),_=claim_element($,"BUTTON",{type:!0,class:!0});var C=children(_);b=claim_text(C,t[2]),C.forEach(detach),$.forEach(detach),U.forEach(detach),this.h()},h(){set_attributes(n,N),attr(c,"type","button"),attr(c,"class",d="btn "+t[3]),attr(_,"type","submit"),attr(_,"class",S="btn "+t[4]),attr(s,"class",k="modal-footer "+t[7]),attr(e,"class","space-y-4")},m(I,U){insert_hydration(I,e,U),append_hydration(e,n),n.autofocus&&n.focus(),set_input_value(n,t[14]),append_hydration(e,a),append_hydration(e,s),append_hydration(s,c),append_hydration(c,u),append_hydration(s,m),append_hydration(s,_),append_hydration(_,b),w||(O=[listen(n,"input",t[41]),listen(c,"click",t[23]),listen(e,"submit",t[25])],w=!0)},p(I,U){set_attributes(n,N=get_spread_update(P,[{class:"modal-prompt-input input"},{name:"prompt"},{type:"text"},U[0]&8192&&I[13][0].valueAttr])),U[0]&16384&&n.value!==I[14]&&set_input_value(n,I[14]),U[0]&1&&set_data(u,I[0]),U[0]&8&&d!==(d="btn "+I[3])&&attr(c,"class",d),U[0]&4&&set_data(b,I[2]),U[0]&16&&S!==(S="btn "+I[4])&&attr(_,"class",S),U[0]&128&&k!==(k="modal-footer "+I[7])&&attr(s,"class",k)},d(I){I&&detach(e),w=!1,run_all(O)}}}function create_if_block_3$3(t){let e,n,a,s,c,u,d,m,_,b,S;return{c(){e=element("footer"),n=element("button"),a=text(t[0]),c=space(),u=element("button"),d=text(t[1]),this.h()},l(k){e=claim_element(k,"FOOTER",{class:!0});var w=children(e);n=claim_element(w,"BUTTON",{type:!0,class:!0});var O=children(n);a=claim_text(O,t[0]),O.forEach(detach),c=claim_space(w),u=claim_element(w,"BUTTON",{type:!0,class:!0});var P=children(u);d=claim_text(P,t[1]),P.forEach(detach),w.forEach(detach),this.h()},h(){attr(n,"type","button"),attr(n,"class",s="btn "+t[3]),attr(u,"type","button"),attr(u,"class",m="btn "+t[4]),attr(e,"class",_="modal-footer "+t[7])},m(k,w){insert_hydration(k,e,w),append_hydration(e,n),append_hydration(n,a),append_hydration(e,c),append_hydration(e,u),append_hydration(u,d),b||(S=[listen(n,"click",t[23]),listen(u,"click",t[24])],b=!0)},p(k,w){w[0]&1&&set_data(a,k[0]),w[0]&8&&s!==(s="btn "+k[3])&&attr(n,"class",s),w[0]&2&&set_data(d,k[1]),w[0]&16&&m!==(m="btn "+k[4])&&attr(u,"class",m),w[0]&128&&_!==(_="modal-footer "+k[7])&&attr(e,"class",_)},d(k){k&&detach(e),b=!1,run_all(S)}}}function create_if_block_2$3(t){let e,n,a,s,c,u,d;return{c(){e=element("footer"),n=element("button"),a=text(t[0]),this.h()},l(m){e=claim_element(m,"FOOTER",{class:!0});var _=children(e);n=claim_element(_,"BUTTON",{type:!0,class:!0});var b=children(n);a=claim_text(b,t[0]),b.forEach(detach),_.forEach(detach),this.h()},h(){attr(n,"type","button"),attr(n,"class",s="btn "+t[3]),attr(e,"class",c="modal-footer "+t[7])},m(m,_){insert_hydration(m,e,_),append_hydration(e,n),append_hydration(n,a),u||(d=listen(n,"click",t[23]),u=!0)},p(m,_){_[0]&1&&set_data(a,m[0]),_[0]&8&&s!==(s="btn "+m[3])&&attr(n,"class",s),_[0]&128&&c!==(c="modal-footer "+m[7])&&attr(e,"class",c)},d(m){m&&detach(e),u=!1,d()}}}function create_key_block(t){let e,n,a,s,c,u,d,m,_,b,S,k;const w=[create_if_block_1$4,create_else_block$4],O=[];function P(N,I){return N[13][0].type!=="component"?0:1}return a=P(t),s=O[a]=w[a](t),{c(){e=element("div"),n=element("div"),s.c(),this.h()},l(N){e=claim_element(N,"DIV",{class:!0,"data-testid":!0});var I=children(e);n=claim_element(I,"DIV",{class:!0});var U=children(n);s.l(U),U.forEach(detach),I.forEach(detach),this.h()},h(){attr(n,"class",c="modal-transition "+t[18]),attr(e,"class",m="modal-backdrop "+t[19]),attr(e,"data-testid","modal-backdrop")},m(N,I){insert_hydration(N,e,I),append_hydration(e,n),O[a].m(n,null),b=!0,S||(k=[listen(e,"mousedown",t[21]),listen(e,"mouseup",t[22]),listen(e,"touchstart",t[39],{passive:!0}),listen(e,"touchend",t[40],{passive:!0}),action_destroyer(focusTrap.call(null,e,!0))],S=!0)},p(N,I){t=N;let U=a;a=P(t),a===U?O[a].p(t,I):(group_outros(),transition_out(O[U],1,1,()=>{O[U]=null}),check_outros(),s=O[a],s?s.p(t,I):(s=O[a]=w[a](t),s.c()),transition_in(s,1),s.m(n,null)),(!b||I[0]&262144&&c!==(c="modal-transition "+t[18]))&&attr(n,"class",c),(!b||I[0]&524288&&m!==(m="modal-backdrop "+t[19]))&&attr(e,"class",m)},i(N){b||(transition_in(s),add_render_callback(()=>{b&&(d&&d.end(1),u=create_in_transition(n,dynamicTransition,{transition:t[9],params:t[10],enabled:t[8]}),u.start())}),add_render_callback(()=>{b&&(_||(_=create_bidirectional_transition(e,dynamicTransition,{transition:fade,params:{duration:150},enabled:t[8]},!0)),_.run(1))}),b=!0)},o(N){transition_out(s),u&&u.invalidate(),d=create_out_transition(n,dynamicTransition,{transition:t[11],params:t[12],enabled:t[8]}),_||(_=create_bidirectional_transition(e,dynamicTransition,{transition:fade,params:{duration:150},enabled:t[8]},!1)),_.run(0),b=!1},d(N){N&&detach(e),O[a].d(),N&&d&&d.end(),N&&_&&_.end(),S=!1,run_all(k)}}}function create_fragment$v(t){let e,n,a,s,c=t[13].length>0&&create_if_block$7(t);return{c(){c&&c.c(),e=empty()},l(u){c&&c.l(u),e=empty()},m(u,d){c&&c.m(u,d),insert_hydration(u,e,d),n=!0,a||(s=listen(window,"keydown",t[26]),a=!0)},p(u,d){u[13].length>0?c?(c.p(u,d),d[0]&8192&&transition_in(c,1)):(c=create_if_block$7(u),c.c(),transition_in(c,1),c.m(e.parentNode,e)):c&&(group_outros(),transition_out(c,1,1,()=>{c=null}),check_outros())},i(u){n||(transition_in(c),n=!0)},o(u){transition_out(c),n=!1},d(u){u&&detach(e),c&&c.d(u),a=!1,s()}}}const cBackdrop$1="fixed top-0 left-0 right-0 bottom-0 overflow-y-auto",cTransitionLayer="w-full h-fit min-h-full p-4 overflow-y-auto flex justify-center",cModal="block overflow-y-auto",cModalImage="w-full h-auto";function instance$v(t,e,n){let a,s,c,u,d,m,_;component_subscribe(t,prefersReducedMotionStore,Y=>n(43,_=Y));const b=createEventDispatcher();let{position:S="items-center"}=e,{components:k={}}=e,{background:w="bg-surface-100-800-token"}=e,{width:O="w-modal"}=e,{height:P="h-auto"}=e,{padding:N="p-4"}=e,{spacing:I="space-y-4"}=e,{rounded:U="rounded-container-token"}=e,{shadow:$="shadow-xl"}=e,{zIndex:x="z-[999]"}=e,{buttonNeutral:C="variant-ghost-surface"}=e,{buttonPositive:H="variant-filled"}=e,{buttonTextCancel:q="Cancel"}=e,{buttonTextConfirm:K="Confirm"}=e,{buttonTextSubmit:W="Submit"}=e,{regionBackdrop:Z="bg-surface-backdrop-token"}=e,{regionHeader:ee="text-2xl font-bold"}=e,{regionBody:ie="max-h-[200px] overflow-hidden"}=e,{regionFooter:se="flex justify-end space-x-2"}=e,{transitions:ce=!_}=e,{transitionIn:fe=fly}=e,{transitionInParams:pe={duration:150,opacity:0,x:0,y:100}}=e,{transitionOut:ue=fly}=e,{transitionOutParams:ge={duration:150,opacity:0,x:0,y:100}}=e,he;const _e={buttonTextCancel:q,buttonTextConfirm:K,buttonTextSubmit:W};let re,V=!1;const Q=getModalStore();component_subscribe(t,Q,Y=>n(13,m=Y)),Q.subscribe(Y=>{Y.length&&(Y[0].type==="prompt"&&n(14,he=Y[0].value),n(0,q=Y[0].buttonTextCancel||_e.buttonTextCancel),n(1,K=Y[0].buttonTextConfirm||_e.buttonTextConfirm),n(2,W=Y[0].buttonTextSubmit||_e.buttonTextSubmit),n(15,re=typeof Y[0].component=="string"?k[Y[0].component]:Y[0].component))});function j(Y){if(!(Y.target instanceof Element))return;const ae=Y.target.classList;(ae.contains("modal-backdrop")||ae.contains("modal-transition"))&&(V=!0)}function le(Y){if(!(Y.target instanceof Element))return;const ae=Y.target.classList;(ae.contains("modal-backdrop")||ae.contains("modal-transition"))&&V&&(m[0].response&&m[0].response(void 0),Q.close(),b("backdrop",Y)),V=!1}function J(){m[0].response&&m[0].response(!1),Q.close()}function z(){m[0].response&&m[0].response(!0),Q.close()}function X(Y){Y.preventDefault(),m[0].response&&m[0].response(he),Q.close()}function te(Y){m.length&&Y.code==="Escape"&&J()}function oe(Y){bubble.call(this,t,Y)}function B(Y){bubble.call(this,t,Y)}function F(){he=this.value,n(14,he)}return t.$$set=Y=>{n(46,e=assign$1(assign$1({},e),exclude_internal_props(Y))),"position"in Y&&n(27,S=Y.position),"components"in Y&&n(28,k=Y.components),"background"in Y&&n(29,w=Y.background),"width"in Y&&n(30,O=Y.width),"height"in Y&&n(31,P=Y.height),"padding"in Y&&n(32,N=Y.padding),"spacing"in Y&&n(33,I=Y.spacing),"rounded"in Y&&n(34,U=Y.rounded),"shadow"in Y&&n(35,$=Y.shadow),"zIndex"in Y&&n(36,x=Y.zIndex),"buttonNeutral"in Y&&n(3,C=Y.buttonNeutral),"buttonPositive"in Y&&n(4,H=Y.buttonPositive),"buttonTextCancel"in Y&&n(0,q=Y.buttonTextCancel),"buttonTextConfirm"in Y&&n(1,K=Y.buttonTextConfirm),"buttonTextSubmit"in Y&&n(2,W=Y.buttonTextSubmit),"regionBackdrop"in Y&&n(37,Z=Y.regionBackdrop),"regionHeader"in Y&&n(5,ee=Y.regionHeader),"regionBody"in Y&&n(6,ie=Y.regionBody),"regionFooter"in Y&&n(7,se=Y.regionFooter),"transitions"in Y&&n(8,ce=Y.transitions),"transitionIn"in Y&&n(9,fe=Y.transitionIn),"transitionInParams"in Y&&n(10,pe=Y.transitionInParams),"transitionOut"in Y&&n(11,ue=Y.transitionOut),"transitionOutParams"in Y&&n(12,ge=Y.transitionOutParams)},t.$$.update=()=>{var Y,ae,ve;t.$$.dirty[0]&134225920&&n(38,a=((Y=m[0])==null?void 0:Y.position)??S),n(19,s=`${cBackdrop$1} ${Z} ${x} ${e.class??""} ${((ae=m[0])==null?void 0:ae.backdropClasses)??""}`),t.$$.dirty[1]&128&&n(18,c=`${cTransitionLayer} ${a??""}`),t.$$.dirty[0]&1610620928|t.$$.dirty[1]&31&&n(17,u=`${cModal} ${w} ${O} ${P} ${N} ${I} ${U} ${$} ${((ve=m[0])==null?void 0:ve.modalClasses)??""}`),t.$$.dirty[0]&1744830719|t.$$.dirty[1]&95&&n(16,d={position:S,background:w,width:O,height:P,padding:N,spacing:I,rounded:U,shadow:$,buttonNeutral:C,buttonPositive:H,buttonTextCancel:q,buttonTextConfirm:K,buttonTextSubmit:W,regionBackdrop:Z,regionHeader:ee,regionBody:ie,regionFooter:se,onClose:J})},e=exclude_internal_props(e),[q,K,W,C,H,ee,ie,se,ce,fe,pe,ue,ge,m,he,re,d,u,c,s,Q,j,le,J,z,X,te,S,k,w,O,P,N,I,U,$,x,Z,a,oe,B,F]}class Modal extends SvelteComponent{constructor(e){super(),init(this,e,instance$v,create_fragment$v,safe_not_equal,{position:27,components:28,background:29,width:30,height:31,padding:32,spacing:33,rounded:34,shadow:35,zIndex:36,buttonNeutral:3,buttonPositive:4,buttonTextCancel:0,buttonTextConfirm:1,buttonTextSubmit:2,regionBackdrop:37,regionHeader:5,regionBody:6,regionFooter:7,transitions:8,transitionIn:9,transitionInParams:10,transitionOut:11,transitionOutParams:12},null,[-1,-1])}}const{window:window_1}=globals;function create_if_block$6(t){let e,n,a,s,c,u,d,m,_,b,S;const k=t[32].default,w=create_slot(k,t,t[31],null);return{c(){e=element("div"),n=element("div"),w&&w.c(),this.h()},l(O){e=claim_element(O,"DIV",{class:!0,"data-testid":!0});var P=children(e);n=claim_element(P,"DIV",{class:!0,"data-testid":!0,role:!0,"aria-modal":!0,"aria-labelledby":!0,"aria-describedby":!0});var N=children(n);w&&w.l(N),N.forEach(detach),P.forEach(detach),this.h()},h(){attr(n,"class",a="drawer "+t[8]),attr(n,"data-testid","drawer"),attr(n,"role","dialog"),attr(n,"aria-modal","true"),attr(n,"aria-labelledby",t[0]),attr(n,"aria-describedby",t[1]),attr(e,"class",u="drawer-backdrop "+t[9]),attr(e,"data-testid","drawer-backdrop")},m(O,P){insert_hydration(O,e,P),append_hydration(e,n),w&&w.m(n,null),t[36](n),t[37](e),_=!0,b||(S=[listen(e,"mousedown",t[12]),listen(e,"touchstart",t[33],{passive:!0}),listen(e,"touchend",t[34],{passive:!0}),listen(e,"keypress",t[35]),action_destroyer(focusTrap.call(null,e,!0))],b=!0)},p(O,P){t=O,w&&w.p&&(!_||P[1]&1)&&update_slot_base(w,k,t,t[31],_?get_slot_changes(k,t[31],P,null):get_all_dirty_from_scope(t[31]),null),(!_||P[0]&256&&a!==(a="drawer "+t[8]))&&attr(n,"class",a),(!_||P[0]&1)&&attr(n,"aria-labelledby",t[0]),(!_||P[0]&2)&&attr(n,"aria-describedby",t[1]),(!_||P[0]&512&&u!==(u="drawer-backdrop "+t[9]))&&attr(e,"class",u)},i(O){_||(transition_in(w,O),O&&add_render_callback(()=>{_&&(c&&c.end(1),s=create_in_transition(n,dynamicTransition,{transition:fly,params:{x:t[7].x,y:t[7].y,duration:t[2],opacity:t[3]?void 0:1},enabled:t[4]}),s.start())}),O&&add_render_callback(()=>{_&&(m&&m.end(1),d=create_in_transition(e,dynamicTransition,{transition:fade,params:{duration:t[2]},enabled:t[4]&&t[3]}),d.start())}),_=!0)},o(O){transition_out(w,O),s&&s.invalidate(),O&&(c=create_out_transition(n,dynamicTransition,{transition:fly,params:{x:t[7].x,y:t[7].y,duration:t[2],opacity:t[3]?void 0:1,easing:cubicIn},enabled:t[4]})),d&&d.invalidate(),O&&(m=create_out_transition(e,dynamicTransition,{transition:fade,params:{duration:t[2]},enabled:t[4]&&t[3]})),_=!1},d(O){O&&detach(e),w&&w.d(O),t[36](null),O&&c&&c.end(),t[37](null),O&&m&&m.end(),b=!1,run_all(S)}}}function create_fragment$u(t){let e,n,a,s,c=t[10].open===!0&&create_if_block$6(t);return{c(){c&&c.c(),e=empty()},l(u){c&&c.l(u),e=empty()},m(u,d){c&&c.m(u,d),insert_hydration(u,e,d),n=!0,a||(s=listen(window_1,"keydown",t[13]),a=!0)},p(u,d){u[10].open===!0?c?(c.p(u,d),d[0]&1024&&transition_in(c,1)):(c=create_if_block$6(u),c.c(),transition_in(c,1),c.m(e.parentNode,e)):c&&(group_outros(),transition_out(c,1,1,()=>{c=null}),check_outros())},i(u){n||(transition_in(c),n=!0)},o(u){transition_out(c),n=!1},d(u){u&&detach(e),c&&c.d(u),a=!1,s()}}}const cBackdrop="fixed top-0 left-0 right-0 bottom-0 flex",cDrawer="overflow-y-auto transition-transform";function instance$u(t,e,n){let a,s,c,u,d,m,_,b;component_subscribe(t,prefersReducedMotionStore,B=>n(38,b=B));let{$$slots:S={},$$scope:k}=e;const w=createEventDispatcher();let{position:O="left"}=e,{bgDrawer:P="bg-surface-100-800-token"}=e,{border:N=""}=e,{rounded:I=""}=e,{shadow:U="shadow-xl"}=e,{width:$=""}=e,{height:x=""}=e,{bgBackdrop:C="bg-surface-backdrop-token"}=e,{blur:H=""}=e,{padding:q=""}=e,{zIndex:K="z-40"}=e,{regionBackdrop:W=""}=e,{regionDrawer:Z=""}=e,{labelledby:ee=""}=e,{describedby:ie=""}=e,{duration:se=200}=e,{transitions:ce=!b}=e,{opacityTransition:fe=!0}=e;const pe={top:{alignment:"items-start",width:"w-full",height:"h-[50%]",rounded:"rounded-bl-container-token rounded-br-container-token"},bottom:{alignment:"items-end",width:"w-full",height:" h-[50%]",rounded:"rounded-tl-container-token rounded-tr-container-token"},left:{alignment:"justify-start",width:"w-[90%]",height:"h-full",rounded:"rounded-tr-container-token rounded-br-container-token"},right:{alignment:"justify-end",width:"w-[90%]",height:"h-full",rounded:"rounded-tl-container-token rounded-bl-container-token"}};let ue,ge,he={x:0,y:0};const _e=getDrawerStore();component_subscribe(t,_e,B=>n(10,_=B));const re={position:O,bgBackdrop:C,blur:H,padding:q,bgDrawer:P,border:N,rounded:I,shadow:U,width:$,height:x,opacityTransition:fe,regionBackdrop:W,regionDrawer:Z,labelledby:ee,describedby:ie,duration:se};function V(B){n(14,O=B.position||re.position),n(21,C=B.bgBackdrop||re.bgBackdrop),n(22,H=B.blur||re.blur),n(23,q=B.padding||re.padding),n(15,P=B.bgDrawer||re.bgDrawer),n(16,N=B.border||re.border),n(17,I=B.rounded||re.rounded),n(18,U=B.shadow||re.shadow),n(19,$=B.width||re.width),n(20,x=B.height||re.height),n(24,W=B.regionBackdrop||re.regionBackdrop),n(25,Z=B.regionDrawer||re.regionDrawer),n(0,ee=B.labelledby||re.labelledby),n(1,ie=B.describedby||re.describedby),n(3,fe=B.opacityTransition||re.opacityTransition),n(2,se=B.duration||re.duration)}function Q(){switch(O){case"top":n(7,he={x:0,y:-window.innerWidth});break;case"bottom":n(7,he={x:0,y:window.innerWidth});break;case"left":n(7,he={x:-window.innerHeight,y:0});break;case"right":n(7,he={x:window.innerHeight,y:0});break;default:console.error("Error: unknown position property value.");break}}function j(B){B.target===ue?(_e.close(),w("backdrop",B)):w("drawer",B)}function le(B){_&&B.code==="Escape"&&_e.close()}_e.subscribe(B=>{B.open===!0&&(V(B),Q())});function J(B){bubble.call(this,t,B)}function z(B){bubble.call(this,t,B)}function X(B){bubble.call(this,t,B)}function te(B){binding_callbacks[B?"unshift":"push"](()=>{ge=B,n(6,ge)})}function oe(B){binding_callbacks[B?"unshift":"push"](()=>{ue=B,n(5,ue)})}return t.$$set=B=>{n(44,e=assign$1(assign$1({},e),exclude_internal_props(B))),"position"in B&&n(14,O=B.position),"bgDrawer"in B&&n(15,P=B.bgDrawer),"border"in B&&n(16,N=B.border),"rounded"in B&&n(17,I=B.rounded),"shadow"in B&&n(18,U=B.shadow),"width"in B&&n(19,$=B.width),"height"in B&&n(20,x=B.height),"bgBackdrop"in B&&n(21,C=B.bgBackdrop),"blur"in B&&n(22,H=B.blur),"padding"in B&&n(23,q=B.padding),"zIndex"in B&&n(26,K=B.zIndex),"regionBackdrop"in B&&n(24,W=B.regionBackdrop),"regionDrawer"in B&&n(25,Z=B.regionDrawer),"labelledby"in B&&n(0,ee=B.labelledby),"describedby"in B&&n(1,ie=B.describedby),"duration"in B&&n(2,se=B.duration),"transitions"in B&&n(4,ce=B.transitions),"opacityTransition"in B&&n(3,fe=B.opacityTransition),"$$scope"in B&&n(31,k=B.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&16384&&n(30,a=pe[O].alignment),t.$$.dirty[0]&540672&&n(29,s=$||pe[O].width),t.$$.dirty[0]&1064960&&n(28,c=x||pe[O].height),t.$$.dirty[0]&147456&&n(27,u=I||pe[O].rounded),n(9,d=`${cBackdrop} ${C} ${q} ${H} ${a} ${W} ${K} ${e.class??""}`),t.$$.dirty[0]&973570048&&n(8,m=`${cDrawer} ${P} ${N} ${I} ${U} ${s} ${c} ${u} ${Z}`)},e=exclude_internal_props(e),[ee,ie,se,fe,ce,ue,ge,he,m,d,_,_e,j,le,O,P,N,I,U,$,x,C,H,q,W,Z,K,u,c,s,a,k,S,J,z,X,te,oe]}class Drawer extends SvelteComponent{constructor(e){super(),init(this,e,instance$u,create_fragment$u,safe_not_equal,{position:14,bgDrawer:15,border:16,rounded:17,shadow:18,width:19,height:20,bgBackdrop:21,blur:22,padding:23,zIndex:26,regionBackdrop:24,regionDrawer:25,labelledby:0,describedby:1,duration:2,transitions:4,opacityTransition:3},null,[-1,-1])}}function get_each_context$5(t,e,n){const a=t.slice();return a[36]=e[n],a[38]=n,a}function create_if_block$5(t){let e,n,a=[],s=new Map,c,u,d,m=ensure_array_like(t[11]);const _=b=>b[36];for(let b=0;b<m.length;b+=1){let S=get_each_context$5(t,m,b),k=_(S);s.set(k,a[b]=create_each_block$5(k,S))}return{c(){e=element("div"),n=element("div");for(let b=0;b<a.length;b+=1)a[b].c();this.h()},l(b){e=claim_element(b,"DIV",{class:!0,"data-testid":!0});var S=children(e);n=claim_element(S,"DIV",{class:!0});var k=children(n);for(let w=0;w<a.length;w+=1)a[w].l(k);k.forEach(detach),S.forEach(detach),this.h()},h(){attr(n,"class",c="snackbar "+t[13]),attr(e,"class",u="snackbar-wrapper "+t[14]),attr(e,"data-testid","snackbar-wrapper")},m(b,S){insert_hydration(b,e,S),append_hydration(e,n);for(let k=0;k<a.length;k+=1)a[k]&&a[k].m(n,null);d=!0},p(b,S){if(S[0]&499103){m=ensure_array_like(b[11]),group_outros();for(let k=0;k<a.length;k+=1)a[k].r();a=update_keyed_each(a,S,_,1,b,m,s,n,fix_and_outro_and_destroy_block,create_each_block$5,null,get_each_context$5);for(let k=0;k<a.length;k+=1)a[k].a();check_outros()}(!d||S[0]&8192&&c!==(c="snackbar "+b[13]))&&attr(n,"class",c),(!d||S[0]&16384&&u!==(u="snackbar-wrapper "+b[14]))&&attr(e,"class",u)},i(b){if(!d){for(let S=0;S<m.length;S+=1)transition_in(a[S]);d=!0}},o(b){for(let S=0;S<a.length;S+=1)transition_out(a[S]);d=!1},d(b){b&&detach(e);for(let S=0;S<a.length;S+=1)a[S].d()}}}function create_if_block_1$3(t){let e,n,a=t[36].action&&create_if_block_3$2(t),s=!t[36].hideDismiss&&create_if_block_2$2(t);return{c(){e=element("div"),a&&a.c(),n=space(),s&&s.c(),this.h()},l(c){e=claim_element(c,"DIV",{class:!0});var u=children(e);a&&a.l(u),n=claim_space(u),s&&s.l(u),u.forEach(detach),this.h()},h(){attr(e,"class","toast-actions "+cToastActions)},m(c,u){insert_hydration(c,e,u),a&&a.m(e,null),append_hydration(e,n),s&&s.m(e,null)},p(c,u){c[36].action?a?a.p(c,u):(a=create_if_block_3$2(c),a.c(),a.m(e,n)):a&&(a.d(1),a=null),c[36].hideDismiss?s&&(s.d(1),s=null):s?s.p(c,u):(s=create_if_block_2$2(c),s.c(),s.m(e,null))},d(c){c&&detach(e),a&&a.d(),s&&s.d()}}}function create_if_block_3$2(t){let e,n,a=t[36].action.label+"",s,c;function u(){return t[30](t[38])}return{c(){e=element("button"),n=new HtmlTagHydration(!1),this.h()},l(d){e=claim_element(d,"BUTTON",{class:!0});var m=children(e);n=claim_html_tag(m,!1),m.forEach(detach),this.h()},h(){n.a=null,attr(e,"class",t[1])},m(d,m){insert_hydration(d,e,m),n.m(a,e),s||(c=listen(e,"click",u),s=!0)},p(d,m){t=d,m[0]&2048&&a!==(a=t[36].action.label+"")&&n.p(a),m[0]&2&&attr(e,"class",t[1])},d(d){d&&detach(e),s=!1,c()}}}function create_if_block_2$2(t){let e,n,a,s;function c(){return t[31](t[36])}return{c(){e=element("button"),n=text(t[3]),this.h()},l(u){e=claim_element(u,"BUTTON",{class:!0,"aria-label":!0});var d=children(e);n=claim_text(d,t[3]),d.forEach(detach),this.h()},h(){attr(e,"class",t[2]),attr(e,"aria-label","Dismiss toast")},m(u,d){insert_hydration(u,e,d),append_hydration(e,n),a||(s=listen(e,"click",c),a=!0)},p(u,d){t=u,d[0]&8&&set_data(n,t[3]),d[0]&4&&attr(e,"class",t[2])},d(u){u&&detach(e),a=!1,s()}}}function create_each_block$5(t,e){let n,a,s,c,u=e[36].message+"",d,m,_,b,S,k,w,O=noop$4,P,N,I,U=(e[36].action||!e[36].hideDismiss)&&create_if_block_1$3(e);function $(){return e[32](e[38])}function x(){return e[33](e[38])}return{key:t,first:null,c(){n=element("div"),a=element("div"),s=element("div"),c=new HtmlTagHydration(!1),d=space(),U&&U.c(),_=space(),this.h()},l(C){n=claim_element(C,"DIV",{role:!0,"aria-live":!0});var H=children(n);a=claim_element(H,"DIV",{class:!0,"data-testid":!0});var q=children(a);s=claim_element(q,"DIV",{class:!0});var K=children(s);c=claim_html_tag(K,!1),K.forEach(detach),d=claim_space(q),U&&U.l(q),q.forEach(detach),_=claim_space(H),H.forEach(detach),this.h()},h(){c.a=null,attr(s,"class","text-base"),attr(a,"class",m="toast "+e[12]+" "+(e[36].background??e[0])+" "+(e[36].classes??"")),attr(a,"data-testid","toast"),attr(n,"role",b=e[36].hideDismiss?"alert":"alertdialog"),attr(n,"aria-live","polite"),this.first=n},m(C,H){insert_hydration(C,n,H),append_hydration(n,a),append_hydration(a,s),c.m(u,s),append_hydration(a,d),U&&U.m(a,null),append_hydration(n,_),P=!0,N||(I=[listen(n,"mouseenter",$),listen(n,"mouseleave",x)],N=!0)},p(C,H){e=C,(!P||H[0]&2048)&&u!==(u=e[36].message+"")&&c.p(u),e[36].action||!e[36].hideDismiss?U?U.p(e,H):(U=create_if_block_1$3(e),U.c(),U.m(a,null)):U&&(U.d(1),U=null),(!P||H[0]&6145&&m!==(m="toast "+e[12]+" "+(e[36].background??e[0])+" "+(e[36].classes??"")))&&attr(a,"class",m),(!P||H[0]&2048&&b!==(b=e[36].hideDismiss?"alert":"alertdialog"))&&attr(n,"role",b)},r(){w=n.getBoundingClientRect()},f(){fix_position(n),O(),add_transform(n,w)},a(){O(),O=create_animation(n,w,flip$1,{duration:e[4]?250:0})},i(C){P||(add_render_callback(()=>{P&&(k&&k.end(1),S=create_in_transition(n,dynamicTransition,{transition:e[5],params:{x:e[10].x,y:e[10].y,...e[6]},enabled:e[4]}),S.start())}),P=!0)},o(C){S&&S.invalidate(),k=create_out_transition(n,dynamicTransition,{transition:e[7],params:{x:e[10].x,y:e[10].y,...e[8]},enabled:e[4]}),P=!1},d(C){C&&detach(n),U&&U.d(),C&&k&&k.end(),N=!1,run_all(I)}}}function create_fragment$t(t){let e,n,a=t[9].length&&create_if_block$5(t);return{c(){a&&a.c(),e=empty()},l(s){a&&a.l(s),e=empty()},m(s,c){a&&a.m(s,c),insert_hydration(s,e,c),n=!0},p(s,c){s[9].length?a?(a.p(s,c),c[0]&512&&transition_in(a,1)):(a=create_if_block$5(s),a.c(),transition_in(a,1),a.m(e.parentNode,e)):a&&(group_outros(),transition_out(a,1,1,()=>{a=null}),check_outros())},i(s){n||(transition_in(a),n=!0)},o(s){transition_out(a),n=!1},d(s){s&&detach(e),a&&a.d(s)}}}const cWrapper="flex fixed top-0 left-0 right-0 bottom-0 pointer-events-none",cSnackbar="flex flex-col gap-y-2",cToast="flex justify-between items-center pointer-events-auto",cToastActions="flex items-center space-x-2";function instance$t(t,e,n){let a,s,c,u,d,m;component_subscribe(t,prefersReducedMotionStore,V=>n(34,m=V));const _=getToastStore();component_subscribe(t,_,V=>n(9,d=V));let{position:b="b"}=e,{max:S=3}=e,{background:k="variant-filled-secondary"}=e,{width:w="max-w-[640px]"}=e,{color:O=""}=e,{padding:P="p-4"}=e,{spacing:N="space-x-4"}=e,{rounded:I="rounded-container-token"}=e,{shadow:U="shadow-lg"}=e,{zIndex:$="z-[888]"}=e,{buttonAction:x="btn variant-filled"}=e,{buttonDismiss:C="btn-icon btn-icon-sm variant-filled"}=e,{buttonDismissLabel:H="✕"}=e,{transitions:q=!m}=e,{transitionIn:K=fly}=e,{transitionInParams:W={duration:250}}=e,{transitionOut:Z=fly}=e,{transitionOutParams:ee={duration:250}}=e,ie,se,ce={x:0,y:0};switch(b){case"t":ie="justify-center items-start",se="items-center",ce={x:0,y:-100};break;case"b":ie="justify-center items-end",se="items-center",ce={x:0,y:100};break;case"l":ie="justify-start items-center",se="items-start",ce={x:-100,y:0};break;case"r":ie="justify-end items-center",se="items-end",ce={x:100,y:0};break;case"tl":ie="justify-start items-start",se="items-start",ce={x:-100,y:0};break;case"tr":ie="justify-end items-start",se="items-end",ce={x:100,y:0};break;case"bl":ie="justify-start items-end",se="items-start",ce={x:-100,y:0};break;case"br":ie="justify-end items-end",se="items-end",ce={x:100,y:0};break}function fe(V){var Q,j;(j=(Q=d[V])==null?void 0:Q.action)==null||j.response(),_.close(d[V].id)}function pe(V){var Q;(Q=d[V])!=null&&Q.hoverable&&(_.freeze(V),n(13,s+=" scale-[105%]"))}function ue(V){var Q;(Q=d[V])!=null&&Q.hoverable&&(_.unfreeze(V),n(13,s=s.replace(" scale-[105%]","")))}const ge=V=>fe(V),he=V=>_.close(V.id),_e=V=>pe(V),re=V=>ue(V);return t.$$set=V=>{n(35,e=assign$1(assign$1({},e),exclude_internal_props(V))),"position"in V&&n(19,b=V.position),"max"in V&&n(20,S=V.max),"background"in V&&n(0,k=V.background),"width"in V&&n(21,w=V.width),"color"in V&&n(22,O=V.color),"padding"in V&&n(23,P=V.padding),"spacing"in V&&n(24,N=V.spacing),"rounded"in V&&n(25,I=V.rounded),"shadow"in V&&n(26,U=V.shadow),"zIndex"in V&&n(27,$=V.zIndex),"buttonAction"in V&&n(1,x=V.buttonAction),"buttonDismiss"in V&&n(2,C=V.buttonDismiss),"buttonDismissLabel"in V&&n(3,H=V.buttonDismissLabel),"transitions"in V&&n(4,q=V.transitions),"transitionIn"in V&&n(5,K=V.transitionIn),"transitionInParams"in V&&n(6,W=V.transitionInParams),"transitionOut"in V&&n(7,Z=V.transitionOut),"transitionOutParams"in V&&n(8,ee=V.transitionOutParams)},t.$$.update=()=>{n(14,a=`${cWrapper} ${ie} ${$} ${e.class||""}`),t.$$.dirty[0]&545259520&&n(13,s=`${cSnackbar} ${se} ${P}`),t.$$.dirty[0]&132120576&&n(12,c=`${cToast} ${w} ${O} ${P} ${N} ${I} ${U}`),t.$$.dirty[0]&1049088&&n(11,u=Array.from(d).slice(0,S))},e=exclude_internal_props(e),[k,x,C,H,q,K,W,Z,ee,d,ce,u,c,s,a,_,fe,pe,ue,b,S,w,O,P,N,I,U,$,ie,se,ge,he,_e,re]}class Toast extends SvelteComponent{constructor(e){super(),init(this,e,instance$t,create_fragment$t,safe_not_equal,{position:19,max:20,background:0,width:21,color:22,padding:23,spacing:24,rounded:25,shadow:26,zIndex:27,buttonAction:1,buttonDismiss:2,buttonDismissLabel:3,transitions:4,transitionIn:5,transitionInParams:6,transitionOut:7,transitionOutParams:8},null,[-1,-1])}}function _mergeNamespaces(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(a){if(a!=="default"&&!(a in t)){var s=Object.getOwnPropertyDescriptor(n,a);Object.defineProperty(t,a,s.get?s:{enumerable:!0,get:function(){return n[a]}})}})}),Object.freeze(t)}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof dist.global<"u"?dist.global:typeof self<"u"?self:{};function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var loglevel={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(commonjsGlobal,function(){var e=function(){},n="undefined",a=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),s=["trace","debug","info","warn","error"];function c(P,N){var I=P[N];if(typeof I.bind=="function")return I.bind(P);try{return Function.prototype.bind.call(I,P)}catch{return function(){return Function.prototype.apply.apply(I,[P,arguments])}}}function u(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function d(P){return P==="debug"&&(P="log"),typeof console===n?!1:P==="trace"&&a?u:console[P]!==void 0?c(console,P):console.log!==void 0?c(console,"log"):e}function m(P,N){for(var I=0;I<s.length;I++){var U=s[I];this[U]=I<P?e:this.methodFactory(U,P,N)}this.log=this.debug}function _(P,N,I){return function(){typeof console!==n&&(m.call(this,N,I),this[P].apply(this,arguments))}}function b(P,N,I){return d(P)||_.apply(this,arguments)}function S(P,N,I){var U=this,$;N=N??"WARN";var x="loglevel";typeof P=="string"?x+=":"+P:typeof P=="symbol"&&(x=void 0);function C(W){var Z=(s[W]||"silent").toUpperCase();if(!(typeof window===n||!x)){try{window.localStorage[x]=Z;return}catch{}try{window.document.cookie=encodeURIComponent(x)+"="+Z+";"}catch{}}}function H(){var W;if(!(typeof window===n||!x)){try{W=window.localStorage[x]}catch{}if(typeof W===n)try{var Z=window.document.cookie,ee=Z.indexOf(encodeURIComponent(x)+"=");ee!==-1&&(W=/^([^;]+)/.exec(Z.slice(ee))[1])}catch{}return U.levels[W]===void 0&&(W=void 0),W}}function q(){if(!(typeof window===n||!x)){try{window.localStorage.removeItem(x);return}catch{}try{window.document.cookie=encodeURIComponent(x)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}U.name=P,U.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},U.methodFactory=I||b,U.getLevel=function(){return $},U.setLevel=function(W,Z){if(typeof W=="string"&&U.levels[W.toUpperCase()]!==void 0&&(W=U.levels[W.toUpperCase()]),typeof W=="number"&&W>=0&&W<=U.levels.SILENT){if($=W,Z!==!1&&C(W),m.call(U,W,P),typeof console===n&&W<U.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+W},U.setDefaultLevel=function(W){N=W,H()||U.setLevel(W,!1)},U.resetLevel=function(){U.setLevel(N,!1),q()},U.enableAll=function(W){U.setLevel(U.levels.TRACE,W)},U.disableAll=function(W){U.setLevel(U.levels.SILENT,W)};var K=H();K==null&&(K=N),U.setLevel(K,!1)}var k=new S,w={};k.getLogger=function(N){if(typeof N!="symbol"&&typeof N!="string"||N==="")throw new TypeError("You must supply a name when creating a logger.");var I=w[N];return I||(I=w[N]=new S(N,k.getLevel(),k.methodFactory)),I};var O=typeof window!==n?window.log:void 0;return k.noConflict=function(){return typeof window!==n&&window.log===k&&(window.log=O),k},k.getLoggers=function(){return w},k.default=k,k})})(loglevel);var loglevelExports=loglevel.exports,LogLevel;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(LogLevel||(LogLevel={}));const livekitLogger=loglevelExports.getLogger("livekit");livekitLogger.setLevel(LogLevel.info);var long=Long$1,wasm$1=null;try{wasm$1=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Long$1(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Long$1.prototype.__isLong__;Object.defineProperty(Long$1.prototype,"__isLong__",{value:!0});function isLong$1(t){return(t&&t.__isLong__)===!0}Long$1.isLong=isLong$1;var INT_CACHE$1={},UINT_CACHE$1={};function fromInt$1(t,e){var n,a,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(a=UINT_CACHE$1[t],a)?a:(n=fromBits$1(t,(t|0)<0?-1:0,!0),s&&(UINT_CACHE$1[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(a=INT_CACHE$1[t],a)?a:(n=fromBits$1(t,t<0?-1:0,!1),s&&(INT_CACHE$1[t]=n),n))}Long$1.fromInt=fromInt$1;function fromNumber$1(t,e){if(isNaN(t))return e?UZERO$1:ZERO$1;if(e){if(t<0)return UZERO$1;if(t>=TWO_PWR_64_DBL$1)return MAX_UNSIGNED_VALUE$1}else{if(t<=-TWO_PWR_63_DBL$1)return MIN_VALUE$1;if(t+1>=TWO_PWR_63_DBL$1)return MAX_VALUE$1}return t<0?fromNumber$1(-t,e).neg():fromBits$1(t%TWO_PWR_32_DBL$1|0,t/TWO_PWR_32_DBL$1|0,e)}Long$1.fromNumber=fromNumber$1;function fromBits$1(t,e,n){return new Long$1(t,e,n)}Long$1.fromBits=fromBits$1;var pow_dbl$1=Math.pow;function fromString$1(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return ZERO$1;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var a;if((a=t.indexOf("-"))>0)throw Error("interior hyphen");if(a===0)return fromString$1(t.substring(1),e,n).neg();for(var s=fromNumber$1(pow_dbl$1(n,8)),c=ZERO$1,u=0;u<t.length;u+=8){var d=Math.min(8,t.length-u),m=parseInt(t.substring(u,u+d),n);if(d<8){var _=fromNumber$1(pow_dbl$1(n,d));c=c.mul(_).add(fromNumber$1(m))}else c=c.mul(s),c=c.add(fromNumber$1(m))}return c.unsigned=e,c}Long$1.fromString=fromString$1;function fromValue$1(t,e){return typeof t=="number"?fromNumber$1(t,e):typeof t=="string"?fromString$1(t,e):fromBits$1(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Long$1.fromValue=fromValue$1;var TWO_PWR_16_DBL$1=65536,TWO_PWR_24_DBL$1=1<<24,TWO_PWR_32_DBL$1=TWO_PWR_16_DBL$1*TWO_PWR_16_DBL$1,TWO_PWR_64_DBL$1=TWO_PWR_32_DBL$1*TWO_PWR_32_DBL$1,TWO_PWR_63_DBL$1=TWO_PWR_64_DBL$1/2,TWO_PWR_24$1=fromInt$1(TWO_PWR_24_DBL$1),ZERO$1=fromInt$1(0);Long$1.ZERO=ZERO$1;var UZERO$1=fromInt$1(0,!0);Long$1.UZERO=UZERO$1;var ONE$1=fromInt$1(1);Long$1.ONE=ONE$1;var UONE$1=fromInt$1(1,!0);Long$1.UONE=UONE$1;var NEG_ONE$1=fromInt$1(-1);Long$1.NEG_ONE=NEG_ONE$1;var MAX_VALUE$1=fromBits$1(-1,2147483647,!1);Long$1.MAX_VALUE=MAX_VALUE$1;var MAX_UNSIGNED_VALUE$1=fromBits$1(-1,-1,!0);Long$1.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE$1;var MIN_VALUE$1=fromBits$1(0,-2147483648,!1);Long$1.MIN_VALUE=MIN_VALUE$1;var LongPrototype$1=Long$1.prototype;LongPrototype$1.toInt=function(){return this.unsigned?this.low>>>0:this.low};LongPrototype$1.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL$1+(this.low>>>0):this.high*TWO_PWR_32_DBL$1+(this.low>>>0)};LongPrototype$1.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(MIN_VALUE$1)){var n=fromNumber$1(e),a=this.div(n),s=a.mul(n).sub(this);return a.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var c=fromNumber$1(pow_dbl$1(e,6),this.unsigned),u=this,d="";;){var m=u.div(c),_=u.sub(m.mul(c)).toInt()>>>0,b=_.toString(e);if(u=m,u.isZero())return b+d;for(;b.length<6;)b="0"+b;d=""+b+d}};LongPrototype$1.getHighBits=function(){return this.high};LongPrototype$1.getHighBitsUnsigned=function(){return this.high>>>0};LongPrototype$1.getLowBits=function(){return this.low};LongPrototype$1.getLowBitsUnsigned=function(){return this.low>>>0};LongPrototype$1.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE$1)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};LongPrototype$1.isZero=function(){return this.high===0&&this.low===0};LongPrototype$1.eqz=LongPrototype$1.isZero;LongPrototype$1.isNegative=function(){return!this.unsigned&&this.high<0};LongPrototype$1.isPositive=function(){return this.unsigned||this.high>=0};LongPrototype$1.isOdd=function(){return(this.low&1)===1};LongPrototype$1.isEven=function(){return(this.low&1)===0};LongPrototype$1.equals=function(e){return isLong$1(e)||(e=fromValue$1(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};LongPrototype$1.eq=LongPrototype$1.equals;LongPrototype$1.notEquals=function(e){return!this.eq(e)};LongPrototype$1.neq=LongPrototype$1.notEquals;LongPrototype$1.ne=LongPrototype$1.notEquals;LongPrototype$1.lessThan=function(e){return this.comp(e)<0};LongPrototype$1.lt=LongPrototype$1.lessThan;LongPrototype$1.lessThanOrEqual=function(e){return this.comp(e)<=0};LongPrototype$1.lte=LongPrototype$1.lessThanOrEqual;LongPrototype$1.le=LongPrototype$1.lessThanOrEqual;LongPrototype$1.greaterThan=function(e){return this.comp(e)>0};LongPrototype$1.gt=LongPrototype$1.greaterThan;LongPrototype$1.greaterThanOrEqual=function(e){return this.comp(e)>=0};LongPrototype$1.gte=LongPrototype$1.greaterThanOrEqual;LongPrototype$1.ge=LongPrototype$1.greaterThanOrEqual;LongPrototype$1.compare=function(e){if(isLong$1(e)||(e=fromValue$1(e)),this.eq(e))return 0;var n=this.isNegative(),a=e.isNegative();return n&&!a?-1:!n&&a?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};LongPrototype$1.comp=LongPrototype$1.compare;LongPrototype$1.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE$1)?MIN_VALUE$1:this.not().add(ONE$1)};LongPrototype$1.neg=LongPrototype$1.negate;LongPrototype$1.add=function(e){isLong$1(e)||(e=fromValue$1(e));var n=this.high>>>16,a=this.high&65535,s=this.low>>>16,c=this.low&65535,u=e.high>>>16,d=e.high&65535,m=e.low>>>16,_=e.low&65535,b=0,S=0,k=0,w=0;return w+=c+_,k+=w>>>16,w&=65535,k+=s+m,S+=k>>>16,k&=65535,S+=a+d,b+=S>>>16,S&=65535,b+=n+u,b&=65535,fromBits$1(k<<16|w,b<<16|S,this.unsigned)};LongPrototype$1.subtract=function(e){return isLong$1(e)||(e=fromValue$1(e)),this.add(e.neg())};LongPrototype$1.sub=LongPrototype$1.subtract;LongPrototype$1.multiply=function(e){if(this.isZero())return ZERO$1;if(isLong$1(e)||(e=fromValue$1(e)),wasm$1){var n=wasm$1.mul(this.low,this.high,e.low,e.high);return fromBits$1(n,wasm$1.get_high(),this.unsigned)}if(e.isZero())return ZERO$1;if(this.eq(MIN_VALUE$1))return e.isOdd()?MIN_VALUE$1:ZERO$1;if(e.eq(MIN_VALUE$1))return this.isOdd()?MIN_VALUE$1:ZERO$1;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(TWO_PWR_24$1)&&e.lt(TWO_PWR_24$1))return fromNumber$1(this.toNumber()*e.toNumber(),this.unsigned);var a=this.high>>>16,s=this.high&65535,c=this.low>>>16,u=this.low&65535,d=e.high>>>16,m=e.high&65535,_=e.low>>>16,b=e.low&65535,S=0,k=0,w=0,O=0;return O+=u*b,w+=O>>>16,O&=65535,w+=c*b,k+=w>>>16,w&=65535,w+=u*_,k+=w>>>16,w&=65535,k+=s*b,S+=k>>>16,k&=65535,k+=c*_,S+=k>>>16,k&=65535,k+=u*m,S+=k>>>16,k&=65535,S+=a*b+s*_+c*m+u*d,S&=65535,fromBits$1(w<<16|O,S<<16|k,this.unsigned)};LongPrototype$1.mul=LongPrototype$1.multiply;LongPrototype$1.divide=function(e){if(isLong$1(e)||(e=fromValue$1(e)),e.isZero())throw Error("division by zero");if(wasm$1){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?wasm$1.div_u:wasm$1.div_s)(this.low,this.high,e.low,e.high);return fromBits$1(n,wasm$1.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?UZERO$1:ZERO$1;var a,s,c;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return UZERO$1;if(e.gt(this.shru(1)))return UONE$1;c=UZERO$1}else{if(this.eq(MIN_VALUE$1)){if(e.eq(ONE$1)||e.eq(NEG_ONE$1))return MIN_VALUE$1;if(e.eq(MIN_VALUE$1))return ONE$1;var u=this.shr(1);return a=u.div(e).shl(1),a.eq(ZERO$1)?e.isNegative()?ONE$1:NEG_ONE$1:(s=this.sub(e.mul(a)),c=a.add(s.div(e)),c)}else if(e.eq(MIN_VALUE$1))return this.unsigned?UZERO$1:ZERO$1;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();c=ZERO$1}for(s=this;s.gte(e);){a=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var d=Math.ceil(Math.log(a)/Math.LN2),m=d<=48?1:pow_dbl$1(2,d-48),_=fromNumber$1(a),b=_.mul(e);b.isNegative()||b.gt(s);)a-=m,_=fromNumber$1(a,this.unsigned),b=_.mul(e);_.isZero()&&(_=ONE$1),c=c.add(_),s=s.sub(b)}return c};LongPrototype$1.div=LongPrototype$1.divide;LongPrototype$1.modulo=function(e){if(isLong$1(e)||(e=fromValue$1(e)),wasm$1){var n=(this.unsigned?wasm$1.rem_u:wasm$1.rem_s)(this.low,this.high,e.low,e.high);return fromBits$1(n,wasm$1.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};LongPrototype$1.mod=LongPrototype$1.modulo;LongPrototype$1.rem=LongPrototype$1.modulo;LongPrototype$1.not=function(){return fromBits$1(~this.low,~this.high,this.unsigned)};LongPrototype$1.and=function(e){return isLong$1(e)||(e=fromValue$1(e)),fromBits$1(this.low&e.low,this.high&e.high,this.unsigned)};LongPrototype$1.or=function(e){return isLong$1(e)||(e=fromValue$1(e)),fromBits$1(this.low|e.low,this.high|e.high,this.unsigned)};LongPrototype$1.xor=function(e){return isLong$1(e)||(e=fromValue$1(e)),fromBits$1(this.low^e.low,this.high^e.high,this.unsigned)};LongPrototype$1.shiftLeft=function(e){return isLong$1(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?fromBits$1(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits$1(0,this.low<<e-32,this.unsigned)};LongPrototype$1.shl=LongPrototype$1.shiftLeft;LongPrototype$1.shiftRight=function(e){return isLong$1(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?fromBits$1(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits$1(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};LongPrototype$1.shr=LongPrototype$1.shiftRight;LongPrototype$1.shiftRightUnsigned=function(e){if(isLong$1(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var a=this.low;return fromBits$1(a>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?fromBits$1(n,0,this.unsigned):fromBits$1(n>>>e-32,0,this.unsigned)};LongPrototype$1.shru=LongPrototype$1.shiftRightUnsigned;LongPrototype$1.shr_u=LongPrototype$1.shiftRightUnsigned;LongPrototype$1.toSigned=function(){return this.unsigned?fromBits$1(this.low,this.high,!1):this};LongPrototype$1.toUnsigned=function(){return this.unsigned?this:fromBits$1(this.low,this.high,!0)};LongPrototype$1.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};LongPrototype$1.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};LongPrototype$1.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Long$1.fromBytes=function(e,n,a){return a?Long$1.fromBytesLE(e,n):Long$1.fromBytesBE(e,n)};Long$1.fromBytesLE=function(e,n){return new Long$1(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Long$1.fromBytesBE=function(e,n){return new Long$1(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};var Long$1$1=getDefaultExportFromCjs(long),indexMinimal$1={},minimal$1$1={},aspromise$1,hasRequiredAspromise$1;function requireAspromise$1(){if(hasRequiredAspromise$1)return aspromise$1;hasRequiredAspromise$1=1,aspromise$1=t;function t(e,n){for(var a=new Array(arguments.length-1),s=0,c=2,u=!0;c<arguments.length;)a[s++]=arguments[c++];return new Promise(function(m,_){a[s]=function(S){if(u)if(u=!1,S)_(S);else{for(var k=new Array(arguments.length-1),w=0;w<k.length;)k[w++]=arguments[w];m.apply(null,k)}};try{e.apply(n||null,a)}catch(b){u&&(u=!1,_(b))}})}return aspromise$1}var base64$1$1={},hasRequiredBase64$1;function requireBase64$1(){return hasRequiredBase64$1||(hasRequiredBase64$1=1,function(t){var e=t;e.length=function(d){var m=d.length;if(!m)return 0;for(var _=0;--m%4>1&&d.charAt(m)==="=";)++_;return Math.ceil(d.length*3)/4-_};for(var n=new Array(64),a=new Array(123),s=0;s<64;)a[n[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;e.encode=function(d,m,_){for(var b=null,S=[],k=0,w=0,O;m<_;){var P=d[m++];switch(w){case 0:S[k++]=n[P>>2],O=(P&3)<<4,w=1;break;case 1:S[k++]=n[O|P>>4],O=(P&15)<<2,w=2;break;case 2:S[k++]=n[O|P>>6],S[k++]=n[P&63],w=0;break}k>8191&&((b||(b=[])).push(String.fromCharCode.apply(String,S)),k=0)}return w&&(S[k++]=n[O],S[k++]=61,w===1&&(S[k++]=61)),b?(k&&b.push(String.fromCharCode.apply(String,S.slice(0,k))),b.join("")):String.fromCharCode.apply(String,S.slice(0,k))};var c="invalid encoding";e.decode=function(d,m,_){for(var b=_,S=0,k,w=0;w<d.length;){var O=d.charCodeAt(w++);if(O===61&&S>1)break;if((O=a[O])===void 0)throw Error(c);switch(S){case 0:k=O,S=1;break;case 1:m[_++]=k<<2|(O&48)>>4,k=O,S=2;break;case 2:m[_++]=(k&15)<<4|(O&60)>>2,k=O,S=3;break;case 3:m[_++]=(k&3)<<6|O,S=0;break}}if(S===1)throw Error(c);return _-b},e.test=function(d){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(d)}}(base64$1$1)),base64$1$1}var eventemitter$1,hasRequiredEventemitter$1;function requireEventemitter$1(){if(hasRequiredEventemitter$1)return eventemitter$1;hasRequiredEventemitter$1=1,eventemitter$1=t;function t(){this._listeners={}}return t.prototype.on=function(n,a,s){return(this._listeners[n]||(this._listeners[n]=[])).push({fn:a,ctx:s||this}),this},t.prototype.off=function(n,a){if(n===void 0)this._listeners={};else if(a===void 0)this._listeners[n]=[];else for(var s=this._listeners[n],c=0;c<s.length;)s[c].fn===a?s.splice(c,1):++c;return this},t.prototype.emit=function(n){var a=this._listeners[n];if(a){for(var s=[],c=1;c<arguments.length;)s.push(arguments[c++]);for(c=0;c<a.length;)a[c].fn.apply(a[c++].ctx,s)}return this},eventemitter$1}var float$1,hasRequiredFloat$1;function requireFloat$1(){if(hasRequiredFloat$1)return float$1;hasRequiredFloat$1=1,float$1=t(t);function t(c){return typeof Float32Array<"u"?function(){var u=new Float32Array([-0]),d=new Uint8Array(u.buffer),m=d[3]===128;function _(w,O,P){u[0]=w,O[P]=d[0],O[P+1]=d[1],O[P+2]=d[2],O[P+3]=d[3]}function b(w,O,P){u[0]=w,O[P]=d[3],O[P+1]=d[2],O[P+2]=d[1],O[P+3]=d[0]}c.writeFloatLE=m?_:b,c.writeFloatBE=m?b:_;function S(w,O){return d[0]=w[O],d[1]=w[O+1],d[2]=w[O+2],d[3]=w[O+3],u[0]}function k(w,O){return d[3]=w[O],d[2]=w[O+1],d[1]=w[O+2],d[0]=w[O+3],u[0]}c.readFloatLE=m?S:k,c.readFloatBE=m?k:S}():function(){function u(m,_,b,S){var k=_<0?1:0;if(k&&(_=-_),_===0)m(1/_>0?0:2147483648,b,S);else if(isNaN(_))m(2143289344,b,S);else if(_>34028234663852886e22)m((k<<31|2139095040)>>>0,b,S);else if(_<11754943508222875e-54)m((k<<31|Math.round(_/1401298464324817e-60))>>>0,b,S);else{var w=Math.floor(Math.log(_)/Math.LN2),O=Math.round(_*Math.pow(2,-w)*8388608)&8388607;m((k<<31|w+127<<23|O)>>>0,b,S)}}c.writeFloatLE=u.bind(null,e),c.writeFloatBE=u.bind(null,n);function d(m,_,b){var S=m(_,b),k=(S>>31)*2+1,w=S>>>23&255,O=S&8388607;return w===255?O?NaN:k*(1/0):w===0?k*1401298464324817e-60*O:k*Math.pow(2,w-150)*(O+8388608)}c.readFloatLE=d.bind(null,a),c.readFloatBE=d.bind(null,s)}(),typeof Float64Array<"u"?function(){var u=new Float64Array([-0]),d=new Uint8Array(u.buffer),m=d[7]===128;function _(w,O,P){u[0]=w,O[P]=d[0],O[P+1]=d[1],O[P+2]=d[2],O[P+3]=d[3],O[P+4]=d[4],O[P+5]=d[5],O[P+6]=d[6],O[P+7]=d[7]}function b(w,O,P){u[0]=w,O[P]=d[7],O[P+1]=d[6],O[P+2]=d[5],O[P+3]=d[4],O[P+4]=d[3],O[P+5]=d[2],O[P+6]=d[1],O[P+7]=d[0]}c.writeDoubleLE=m?_:b,c.writeDoubleBE=m?b:_;function S(w,O){return d[0]=w[O],d[1]=w[O+1],d[2]=w[O+2],d[3]=w[O+3],d[4]=w[O+4],d[5]=w[O+5],d[6]=w[O+6],d[7]=w[O+7],u[0]}function k(w,O){return d[7]=w[O],d[6]=w[O+1],d[5]=w[O+2],d[4]=w[O+3],d[3]=w[O+4],d[2]=w[O+5],d[1]=w[O+6],d[0]=w[O+7],u[0]}c.readDoubleLE=m?S:k,c.readDoubleBE=m?k:S}():function(){function u(m,_,b,S,k,w){var O=S<0?1:0;if(O&&(S=-S),S===0)m(0,k,w+_),m(1/S>0?0:2147483648,k,w+b);else if(isNaN(S))m(0,k,w+_),m(2146959360,k,w+b);else if(S>17976931348623157e292)m(0,k,w+_),m((O<<31|2146435072)>>>0,k,w+b);else{var P;if(S<22250738585072014e-324)P=S/5e-324,m(P>>>0,k,w+_),m((O<<31|P/4294967296)>>>0,k,w+b);else{var N=Math.floor(Math.log(S)/Math.LN2);N===1024&&(N=1023),P=S*Math.pow(2,-N),m(P*4503599627370496>>>0,k,w+_),m((O<<31|N+1023<<20|P*1048576&1048575)>>>0,k,w+b)}}}c.writeDoubleLE=u.bind(null,e,0,4),c.writeDoubleBE=u.bind(null,n,4,0);function d(m,_,b,S,k){var w=m(S,k+_),O=m(S,k+b),P=(O>>31)*2+1,N=O>>>20&2047,I=4294967296*(O&1048575)+w;return N===2047?I?NaN:P*(1/0):N===0?P*5e-324*I:P*Math.pow(2,N-1075)*(I+4503599627370496)}c.readDoubleLE=d.bind(null,a,0,4),c.readDoubleBE=d.bind(null,s,4,0)}(),c}function e(c,u,d){u[d]=c&255,u[d+1]=c>>>8&255,u[d+2]=c>>>16&255,u[d+3]=c>>>24}function n(c,u,d){u[d]=c>>>24,u[d+1]=c>>>16&255,u[d+2]=c>>>8&255,u[d+3]=c&255}function a(c,u){return(c[u]|c[u+1]<<8|c[u+2]<<16|c[u+3]<<24)>>>0}function s(c,u){return(c[u]<<24|c[u+1]<<16|c[u+2]<<8|c[u+3])>>>0}return float$1}var inquire_1$1,hasRequiredInquire$1;function requireInquire$1(){if(hasRequiredInquire$1)return inquire_1$1;hasRequiredInquire$1=1,inquire_1$1=t;function t(e){try{var n=void 0;if(n&&(n.length||Object.keys(n).length))return n}catch{}return null}return inquire_1$1}var utf8$2$1={},hasRequiredUtf8$1;function requireUtf8$1(){return hasRequiredUtf8$1||(hasRequiredUtf8$1=1,function(t){var e=t;e.length=function(a){for(var s=0,c=0,u=0;u<a.length;++u)c=a.charCodeAt(u),c<128?s+=1:c<2048?s+=2:(c&64512)===55296&&(a.charCodeAt(u+1)&64512)===56320?(++u,s+=4):s+=3;return s},e.read=function(a,s,c){var u=c-s;if(u<1)return"";for(var d=null,m=[],_=0,b;s<c;)b=a[s++],b<128?m[_++]=b:b>191&&b<224?m[_++]=(b&31)<<6|a[s++]&63:b>239&&b<365?(b=((b&7)<<18|(a[s++]&63)<<12|(a[s++]&63)<<6|a[s++]&63)-65536,m[_++]=55296+(b>>10),m[_++]=56320+(b&1023)):m[_++]=(b&15)<<12|(a[s++]&63)<<6|a[s++]&63,_>8191&&((d||(d=[])).push(String.fromCharCode.apply(String,m)),_=0);return d?(_&&d.push(String.fromCharCode.apply(String,m.slice(0,_))),d.join("")):String.fromCharCode.apply(String,m.slice(0,_))},e.write=function(a,s,c){for(var u=c,d,m,_=0;_<a.length;++_)d=a.charCodeAt(_),d<128?s[c++]=d:d<2048?(s[c++]=d>>6|192,s[c++]=d&63|128):(d&64512)===55296&&((m=a.charCodeAt(_+1))&64512)===56320?(d=65536+((d&1023)<<10)+(m&1023),++_,s[c++]=d>>18|240,s[c++]=d>>12&63|128,s[c++]=d>>6&63|128,s[c++]=d&63|128):(s[c++]=d>>12|224,s[c++]=d>>6&63|128,s[c++]=d&63|128);return c-u}}(utf8$2$1)),utf8$2$1}var pool_1$1,hasRequiredPool$1;function requirePool$1(){if(hasRequiredPool$1)return pool_1$1;hasRequiredPool$1=1,pool_1$1=t;function t(e,n,a){var s=a||8192,c=s>>>1,u=null,d=s;return function(_){if(_<1||_>c)return e(_);d+_>s&&(u=e(s),d=0);var b=n.call(u,d,d+=_);return d&7&&(d=(d|7)+1),b}}return pool_1$1}var longbits$1,hasRequiredLongbits$1;function requireLongbits$1(){if(hasRequiredLongbits$1)return longbits$1;hasRequiredLongbits$1=1,longbits$1=e;var t=requireMinimal$1();function e(c,u){this.lo=c>>>0,this.hi=u>>>0}var n=e.zero=new e(0,0);n.toNumber=function(){return 0},n.zzEncode=n.zzDecode=function(){return this},n.length=function(){return 1};var a=e.zeroHash="\0\0\0\0\0\0\0\0";e.fromNumber=function(u){if(u===0)return n;var d=u<0;d&&(u=-u);var m=u>>>0,_=(u-m)/4294967296>>>0;return d&&(_=~_>>>0,m=~m>>>0,++m>4294967295&&(m=0,++_>4294967295&&(_=0))),new e(m,_)},e.from=function(u){if(typeof u=="number")return e.fromNumber(u);if(t.isString(u))if(t.Long)u=t.Long.fromString(u);else return e.fromNumber(parseInt(u,10));return u.low||u.high?new e(u.low>>>0,u.high>>>0):n},e.prototype.toNumber=function(u){if(!u&&this.hi>>>31){var d=~this.lo+1>>>0,m=~this.hi>>>0;return d||(m=m+1>>>0),-(d+m*4294967296)}return this.lo+this.hi*4294967296},e.prototype.toLong=function(u){return t.Long?new t.Long(this.lo|0,this.hi|0,!!u):{low:this.lo|0,high:this.hi|0,unsigned:!!u}};var s=String.prototype.charCodeAt;return e.fromHash=function(u){return u===a?n:new e((s.call(u,0)|s.call(u,1)<<8|s.call(u,2)<<16|s.call(u,3)<<24)>>>0,(s.call(u,4)|s.call(u,5)<<8|s.call(u,6)<<16|s.call(u,7)<<24)>>>0)},e.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},e.prototype.zzEncode=function(){var u=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^u)>>>0,this.lo=(this.lo<<1^u)>>>0,this},e.prototype.zzDecode=function(){var u=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^u)>>>0,this.hi=(this.hi>>>1^u)>>>0,this},e.prototype.length=function(){var u=this.lo,d=(this.lo>>>28|this.hi<<4)>>>0,m=this.hi>>>24;return m===0?d===0?u<16384?u<128?1:2:u<2097152?3:4:d<16384?d<128?5:6:d<2097152?7:8:m<128?9:10},longbits$1}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(t){var e=t;e.asPromise=requireAspromise$1(),e.base64=requireBase64$1(),e.EventEmitter=requireEventemitter$1(),e.float=requireFloat$1(),e.inquire=requireInquire$1(),e.utf8=requireUtf8$1(),e.pool=requirePool$1(),e.LongBits=requireLongbits$1(),e.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),e.global=e.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,e.emptyArray=Object.freeze?Object.freeze([]):[],e.emptyObject=Object.freeze?Object.freeze({}):{},e.isInteger=Number.isInteger||function(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c},e.isString=function(c){return typeof c=="string"||c instanceof String},e.isObject=function(c){return c&&typeof c=="object"},e.isset=e.isSet=function(c,u){var d=c[u];return d!=null&&c.hasOwnProperty(u)?typeof d!="object"||(Array.isArray(d)?d.length:Object.keys(d).length)>0:!1},e.Buffer=function(){try{var s=e.inquire("buffer").Buffer;return s.prototype.utf8Write?s:null}catch{return null}}(),e._Buffer_from=null,e._Buffer_allocUnsafe=null,e.newBuffer=function(c){return typeof c=="number"?e.Buffer?e._Buffer_allocUnsafe(c):new e.Array(c):e.Buffer?e._Buffer_from(c):typeof Uint8Array>"u"?c:new Uint8Array(c)},e.Array=typeof Uint8Array<"u"?Uint8Array:Array,e.Long=e.global.dcodeIO&&e.global.dcodeIO.Long||e.global.Long||e.inquire("long"),e.key2Re=/^true|false|0|1$/,e.key32Re=/^-?(?:0|[1-9][0-9]*)$/,e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,e.longToHash=function(c){return c?e.LongBits.from(c).toHash():e.LongBits.zeroHash},e.longFromHash=function(c,u){var d=e.LongBits.fromHash(c);return e.Long?e.Long.fromBits(d.lo,d.hi,u):d.toNumber(!!u)};function n(s,c,u){for(var d=Object.keys(c),m=0;m<d.length;++m)(s[d[m]]===void 0||!u)&&(s[d[m]]=c[d[m]]);return s}e.merge=n,e.lcFirst=function(c){return c.charAt(0).toLowerCase()+c.substring(1)};function a(s){function c(u,d){if(!(this instanceof c))return new c(u,d);Object.defineProperty(this,"message",{get:function(){return u}}),Error.captureStackTrace?Error.captureStackTrace(this,c):Object.defineProperty(this,"stack",{value:new Error().stack||""}),d&&n(this,d)}return c.prototype=Object.create(Error.prototype,{constructor:{value:c,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return s},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),c}e.newError=a,e.ProtocolError=a("ProtocolError"),e.oneOfGetter=function(c){for(var u={},d=0;d<c.length;++d)u[c[d]]=1;return function(){for(var m=Object.keys(this),_=m.length-1;_>-1;--_)if(u[m[_]]===1&&this[m[_]]!==void 0&&this[m[_]]!==null)return m[_]}},e.oneOfSetter=function(c){return function(u){for(var d=0;d<c.length;++d)c[d]!==u&&delete this[c[d]]}},e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},e._configure=function(){var s=e.Buffer;if(!s){e._Buffer_from=e._Buffer_allocUnsafe=null;return}e._Buffer_from=s.from!==Uint8Array.from&&s.from||function(u,d){return new s(u,d)},e._Buffer_allocUnsafe=s.allocUnsafe||function(u){return new s(u)}}}(minimal$1$1)),minimal$1$1}var writer$2=Writer$1$1,util$4$1=requireMinimal$1(),BufferWriter$1$1,LongBits$1$1=util$4$1.LongBits,base64$2=util$4$1.base64,utf8$1$1=util$4$1.utf8;function Op$1(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}function noop$3(){}function State$1(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Writer$1$1(){this.len=0,this.head=new Op$1(noop$3,0,0),this.tail=this.head,this.states=null}var create$1$1=function(){return util$4$1.Buffer?function(){return(Writer$1$1.create=function(){return new BufferWriter$1$1})()}:function(){return new Writer$1$1}};Writer$1$1.create=create$1$1();Writer$1$1.alloc=function(e){return new util$4$1.Array(e)};util$4$1.Array!==Array&&(Writer$1$1.alloc=util$4$1.pool(Writer$1$1.alloc,util$4$1.Array.prototype.subarray));Writer$1$1.prototype._push=function(e,n,a){return this.tail=this.tail.next=new Op$1(e,n,a),this.len+=n,this};function writeByte$1(t,e,n){e[n]=t&255}function writeVarint32$1(t,e,n){for(;t>127;)e[n++]=t&127|128,t>>>=7;e[n]=t}function VarintOp$1(t,e){this.len=t,this.next=void 0,this.val=e}VarintOp$1.prototype=Object.create(Op$1.prototype);VarintOp$1.prototype.fn=writeVarint32$1;Writer$1$1.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp$1((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Writer$1$1.prototype.int32=function(e){return e<0?this._push(writeVarint64$1,10,LongBits$1$1.fromNumber(e)):this.uint32(e)};Writer$1$1.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function writeVarint64$1(t,e,n){for(;t.hi;)e[n++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[n++]=t.lo&127|128,t.lo=t.lo>>>7;e[n++]=t.lo}Writer$1$1.prototype.uint64=function(e){var n=LongBits$1$1.from(e);return this._push(writeVarint64$1,n.length(),n)};Writer$1$1.prototype.int64=Writer$1$1.prototype.uint64;Writer$1$1.prototype.sint64=function(e){var n=LongBits$1$1.from(e).zzEncode();return this._push(writeVarint64$1,n.length(),n)};Writer$1$1.prototype.bool=function(e){return this._push(writeByte$1,1,e?1:0)};function writeFixed32$1(t,e,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}Writer$1$1.prototype.fixed32=function(e){return this._push(writeFixed32$1,4,e>>>0)};Writer$1$1.prototype.sfixed32=Writer$1$1.prototype.fixed32;Writer$1$1.prototype.fixed64=function(e){var n=LongBits$1$1.from(e);return this._push(writeFixed32$1,4,n.lo)._push(writeFixed32$1,4,n.hi)};Writer$1$1.prototype.sfixed64=Writer$1$1.prototype.fixed64;Writer$1$1.prototype.float=function(e){return this._push(util$4$1.float.writeFloatLE,4,e)};Writer$1$1.prototype.double=function(e){return this._push(util$4$1.float.writeDoubleLE,8,e)};var writeBytes$1=util$4$1.Array.prototype.set?function(e,n,a){n.set(e,a)}:function(e,n,a){for(var s=0;s<e.length;++s)n[a+s]=e[s]};Writer$1$1.prototype.bytes=function(e){var n=e.length>>>0;if(!n)return this._push(writeByte$1,1,0);if(util$4$1.isString(e)){var a=Writer$1$1.alloc(n=base64$2.length(e));base64$2.decode(e,a,0),e=a}return this.uint32(n)._push(writeBytes$1,n,e)};Writer$1$1.prototype.string=function(e){var n=utf8$1$1.length(e);return n?this.uint32(n)._push(utf8$1$1.write,n,e):this._push(writeByte$1,1,0)};Writer$1$1.prototype.fork=function(){return this.states=new State$1(this),this.head=this.tail=new Op$1(noop$3,0,0),this.len=0,this};Writer$1$1.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op$1(noop$3,0,0),this.len=0),this};Writer$1$1.prototype.ldelim=function(){var e=this.head,n=this.tail,a=this.len;return this.reset().uint32(a),a&&(this.tail.next=e.next,this.tail=n,this.len+=a),this};Writer$1$1.prototype.finish=function(){for(var e=this.head.next,n=this.constructor.alloc(this.len),a=0;e;)e.fn(e.val,n,a),a+=e.len,e=e.next;return n};Writer$1$1._configure=function(t){BufferWriter$1$1=t,Writer$1$1.create=create$1$1(),BufferWriter$1$1._configure()};var writer_buffer$1=BufferWriter$2,Writer$2=writer$2;(BufferWriter$2.prototype=Object.create(Writer$2.prototype)).constructor=BufferWriter$2;var util$3$1=requireMinimal$1();function BufferWriter$2(){Writer$2.call(this)}BufferWriter$2._configure=function(){BufferWriter$2.alloc=util$3$1._Buffer_allocUnsafe,BufferWriter$2.writeBytesBuffer=util$3$1.Buffer&&util$3$1.Buffer.prototype instanceof Uint8Array&&util$3$1.Buffer.prototype.set.name==="set"?function(e,n,a){n.set(e,a)}:function(e,n,a){if(e.copy)e.copy(n,a,0,e.length);else for(var s=0;s<e.length;)n[a++]=e[s++]}};BufferWriter$2.prototype.bytes=function(e){util$3$1.isString(e)&&(e=util$3$1._Buffer_from(e,"base64"));var n=e.length>>>0;return this.uint32(n),n&&this._push(BufferWriter$2.writeBytesBuffer,n,e),this};function writeStringBuffer$1(t,e,n){t.length<40?util$3$1.utf8.write(t,e,n):e.utf8Write?e.utf8Write(t,n):e.write(t,n)}BufferWriter$2.prototype.string=function(e){var n=util$3$1.Buffer.byteLength(e);return this.uint32(n),n&&this._push(writeStringBuffer$1,n,e),this};BufferWriter$2._configure();var reader$1=Reader$1$1,util$2$1=requireMinimal$1(),BufferReader$1$1,LongBits$2=util$2$1.LongBits,utf8$3=util$2$1.utf8;function indexOutOfRange$1(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Reader$1$1(t){this.buf=t,this.pos=0,this.len=t.length}var create_array$1=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader$1$1(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader$1$1(e);throw Error("illegal buffer")},create$2=function(){return util$2$1.Buffer?function(n){return(Reader$1$1.create=function(s){return util$2$1.Buffer.isBuffer(s)?new BufferReader$1$1(s):create_array$1(s)})(n)}:create_array$1};Reader$1$1.create=create$2();Reader$1$1.prototype._slice=util$2$1.Array.prototype.subarray||util$2$1.Array.prototype.slice;Reader$1$1.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange$1(this,10);return e}}();Reader$1$1.prototype.int32=function(){return this.uint32()|0};Reader$1$1.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function readLongVarint$1(){var t=new LongBits$2(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw indexOutOfRange$1(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw indexOutOfRange$1(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Reader$1$1.prototype.bool=function(){return this.uint32()!==0};function readFixed32_end$1(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Reader$1$1.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange$1(this,4);return readFixed32_end$1(this.buf,this.pos+=4)};Reader$1$1.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange$1(this,4);return readFixed32_end$1(this.buf,this.pos+=4)|0};function readFixed64$1(){if(this.pos+8>this.len)throw indexOutOfRange$1(this,8);return new LongBits$2(readFixed32_end$1(this.buf,this.pos+=4),readFixed32_end$1(this.buf,this.pos+=4))}Reader$1$1.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange$1(this,4);var e=util$2$1.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Reader$1$1.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange$1(this,4);var e=util$2$1.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Reader$1$1.prototype.bytes=function(){var e=this.uint32(),n=this.pos,a=this.pos+e;if(a>this.len)throw indexOutOfRange$1(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(n,a):n===a?new this.buf.constructor(0):this._slice.call(this.buf,n,a)};Reader$1$1.prototype.string=function(){var e=this.bytes();return utf8$3.read(e,0,e.length)};Reader$1$1.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw indexOutOfRange$1(this,e);this.pos+=e}else do if(this.pos>=this.len)throw indexOutOfRange$1(this);while(this.buf[this.pos++]&128);return this};Reader$1$1.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Reader$1$1._configure=function(t){BufferReader$1$1=t,Reader$1$1.create=create$2(),BufferReader$1$1._configure();var e=util$2$1.Long?"toLong":"toNumber";util$2$1.merge(Reader$1$1.prototype,{int64:function(){return readLongVarint$1.call(this)[e](!1)},uint64:function(){return readLongVarint$1.call(this)[e](!0)},sint64:function(){return readLongVarint$1.call(this).zzDecode()[e](!1)},fixed64:function(){return readFixed64$1.call(this)[e](!0)},sfixed64:function(){return readFixed64$1.call(this)[e](!1)}})};var reader_buffer$1=BufferReader$2,Reader$2=reader$1;(BufferReader$2.prototype=Object.create(Reader$2.prototype)).constructor=BufferReader$2;var util$1$1=requireMinimal$1();function BufferReader$2(t){Reader$2.call(this,t)}BufferReader$2._configure=function(){util$1$1.Buffer&&(BufferReader$2.prototype._slice=util$1$1.Buffer.prototype.slice)};BufferReader$2.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};BufferReader$2._configure();var rpc$1={},service$1=Service$1,util$6=requireMinimal$1();(Service$1.prototype=Object.create(util$6.EventEmitter.prototype)).constructor=Service$1;function Service$1(t,e,n){if(typeof t!="function")throw TypeError("rpcImpl must be a function");util$6.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=!!e,this.responseDelimited=!!n}Service$1.prototype.rpcCall=function t(e,n,a,s,c){if(!s)throw TypeError("request must be specified");var u=this;if(!c)return util$6.asPromise(t,u,e,n,a,s);if(!u.rpcImpl){setTimeout(function(){c(Error("already ended"))},0);return}try{return u.rpcImpl(e,n[u.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(m,_){if(m)return u.emit("error",m,e),c(m);if(_===null){u.end(!0);return}if(!(_ instanceof a))try{_=a[u.responseDelimited?"decodeDelimited":"decode"](_)}catch(b){return u.emit("error",b,e),c(b)}return u.emit("data",_,e),c(null,_)})}catch(d){u.emit("error",d,e),setTimeout(function(){c(d)},0);return}};Service$1.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};(function(t){var e=t;e.Service=service$1})(rpc$1);var roots$1={};(function(t){var e=t;e.build="minimal",e.Writer=writer$2,e.BufferWriter=writer_buffer$1,e.Reader=reader$1,e.BufferReader=reader_buffer$1,e.util=requireMinimal$1(),e.rpc=rpc$1,e.roots=roots$1,e.configure=n;function n(){e.util._configure(),e.Writer._configure(e.BufferWriter),e.Reader._configure(e.BufferReader)}n()})(indexMinimal$1);var minimal$2=indexMinimal$1,_m0$1=getDefaultExportFromCjs(minimal$2);(()=>{if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof dist.global<"u")return dist.global;throw"Unable to locate global object"})();_m0$1.util.Long!==Long$1$1&&(_m0$1.util.Long=Long$1$1,_m0$1.configure());var AudioCodec$1;(function(t){t[t.DEFAULT_AC=0]="DEFAULT_AC",t[t.OPUS=1]="OPUS",t[t.AAC=2]="AAC",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(AudioCodec$1||(AudioCodec$1={}));var VideoCodec$1;(function(t){t[t.DEFAULT_VC=0]="DEFAULT_VC",t[t.H264_BASELINE=1]="H264_BASELINE",t[t.H264_MAIN=2]="H264_MAIN",t[t.H264_HIGH=3]="H264_HIGH",t[t.VP8=4]="VP8",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(VideoCodec$1||(VideoCodec$1={}));var TrackType$1;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO",t[t.DATA=2]="DATA",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(TrackType$1||(TrackType$1={}));function trackTypeFromJSON(t){switch(t){case 0:case"AUDIO":return TrackType$1.AUDIO;case 1:case"VIDEO":return TrackType$1.VIDEO;case 2:case"DATA":return TrackType$1.DATA;case-1:case"UNRECOGNIZED":default:return TrackType$1.UNRECOGNIZED}}function trackTypeToJSON(t){switch(t){case TrackType$1.AUDIO:return"AUDIO";case TrackType$1.VIDEO:return"VIDEO";case TrackType$1.DATA:return"DATA";case TrackType$1.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var TrackSource$2;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CAMERA=1]="CAMERA",t[t.MICROPHONE=2]="MICROPHONE",t[t.SCREEN_SHARE=3]="SCREEN_SHARE",t[t.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(TrackSource$2||(TrackSource$2={}));function trackSourceFromJSON(t){switch(t){case 0:case"UNKNOWN":return TrackSource$2.UNKNOWN;case 1:case"CAMERA":return TrackSource$2.CAMERA;case 2:case"MICROPHONE":return TrackSource$2.MICROPHONE;case 3:case"SCREEN_SHARE":return TrackSource$2.SCREEN_SHARE;case 4:case"SCREEN_SHARE_AUDIO":return TrackSource$2.SCREEN_SHARE_AUDIO;case-1:case"UNRECOGNIZED":default:return TrackSource$2.UNRECOGNIZED}}function trackSourceToJSON(t){switch(t){case TrackSource$2.UNKNOWN:return"UNKNOWN";case TrackSource$2.CAMERA:return"CAMERA";case TrackSource$2.MICROPHONE:return"MICROPHONE";case TrackSource$2.SCREEN_SHARE:return"SCREEN_SHARE";case TrackSource$2.SCREEN_SHARE_AUDIO:return"SCREEN_SHARE_AUDIO";case TrackSource$2.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var VideoQuality$1;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.OFF=3]="OFF",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(VideoQuality$1||(VideoQuality$1={}));function videoQualityFromJSON(t){switch(t){case 0:case"LOW":return VideoQuality$1.LOW;case 1:case"MEDIUM":return VideoQuality$1.MEDIUM;case 2:case"HIGH":return VideoQuality$1.HIGH;case 3:case"OFF":return VideoQuality$1.OFF;case-1:case"UNRECOGNIZED":default:return VideoQuality$1.UNRECOGNIZED}}function videoQualityToJSON(t){switch(t){case VideoQuality$1.LOW:return"LOW";case VideoQuality$1.MEDIUM:return"MEDIUM";case VideoQuality$1.HIGH:return"HIGH";case VideoQuality$1.OFF:return"OFF";case VideoQuality$1.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var ConnectionQuality$1;(function(t){t[t.POOR=0]="POOR",t[t.GOOD=1]="GOOD",t[t.EXCELLENT=2]="EXCELLENT",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ConnectionQuality$1||(ConnectionQuality$1={}));function connectionQualityFromJSON(t){switch(t){case 0:case"POOR":return ConnectionQuality$1.POOR;case 1:case"GOOD":return ConnectionQuality$1.GOOD;case 2:case"EXCELLENT":return ConnectionQuality$1.EXCELLENT;case-1:case"UNRECOGNIZED":default:return ConnectionQuality$1.UNRECOGNIZED}}function connectionQualityToJSON(t){switch(t){case ConnectionQuality$1.POOR:return"POOR";case ConnectionQuality$1.GOOD:return"GOOD";case ConnectionQuality$1.EXCELLENT:return"EXCELLENT";case ConnectionQuality$1.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var ClientConfigSetting$1;(function(t){t[t.UNSET=0]="UNSET",t[t.DISABLED=1]="DISABLED",t[t.ENABLED=2]="ENABLED",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ClientConfigSetting$1||(ClientConfigSetting$1={}));function clientConfigSettingFromJSON(t){switch(t){case 0:case"UNSET":return ClientConfigSetting$1.UNSET;case 1:case"DISABLED":return ClientConfigSetting$1.DISABLED;case 2:case"ENABLED":return ClientConfigSetting$1.ENABLED;case-1:case"UNRECOGNIZED":default:return ClientConfigSetting$1.UNRECOGNIZED}}function clientConfigSettingToJSON(t){switch(t){case ClientConfigSetting$1.UNSET:return"UNSET";case ClientConfigSetting$1.DISABLED:return"DISABLED";case ClientConfigSetting$1.ENABLED:return"ENABLED";case ClientConfigSetting$1.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var DisconnectReason$1;(function(t){t[t.UNKNOWN_REASON=0]="UNKNOWN_REASON",t[t.CLIENT_INITIATED=1]="CLIENT_INITIATED",t[t.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",t[t.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",t[t.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",t[t.ROOM_DELETED=5]="ROOM_DELETED",t[t.STATE_MISMATCH=6]="STATE_MISMATCH",t[t.JOIN_FAILURE=7]="JOIN_FAILURE",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(DisconnectReason$1||(DisconnectReason$1={}));function disconnectReasonFromJSON(t){switch(t){case 0:case"UNKNOWN_REASON":return DisconnectReason$1.UNKNOWN_REASON;case 1:case"CLIENT_INITIATED":return DisconnectReason$1.CLIENT_INITIATED;case 2:case"DUPLICATE_IDENTITY":return DisconnectReason$1.DUPLICATE_IDENTITY;case 3:case"SERVER_SHUTDOWN":return DisconnectReason$1.SERVER_SHUTDOWN;case 4:case"PARTICIPANT_REMOVED":return DisconnectReason$1.PARTICIPANT_REMOVED;case 5:case"ROOM_DELETED":return DisconnectReason$1.ROOM_DELETED;case 6:case"STATE_MISMATCH":return DisconnectReason$1.STATE_MISMATCH;case 7:case"JOIN_FAILURE":return DisconnectReason$1.JOIN_FAILURE;case-1:case"UNRECOGNIZED":default:return DisconnectReason$1.UNRECOGNIZED}}function disconnectReasonToJSON(t){switch(t){case DisconnectReason$1.UNKNOWN_REASON:return"UNKNOWN_REASON";case DisconnectReason$1.CLIENT_INITIATED:return"CLIENT_INITIATED";case DisconnectReason$1.DUPLICATE_IDENTITY:return"DUPLICATE_IDENTITY";case DisconnectReason$1.SERVER_SHUTDOWN:return"SERVER_SHUTDOWN";case DisconnectReason$1.PARTICIPANT_REMOVED:return"PARTICIPANT_REMOVED";case DisconnectReason$1.ROOM_DELETED:return"ROOM_DELETED";case DisconnectReason$1.STATE_MISMATCH:return"STATE_MISMATCH";case DisconnectReason$1.JOIN_FAILURE:return"JOIN_FAILURE";case DisconnectReason$1.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var ReconnectReason$1;(function(t){t[t.RR_UNKOWN=0]="RR_UNKOWN",t[t.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",t[t.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",t[t.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",t[t.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ReconnectReason$1||(ReconnectReason$1={}));var ParticipantInfo_State$1;(function(t){t[t.JOINING=0]="JOINING",t[t.JOINED=1]="JOINED",t[t.ACTIVE=2]="ACTIVE",t[t.DISCONNECTED=3]="DISCONNECTED",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ParticipantInfo_State$1||(ParticipantInfo_State$1={}));function participantInfo_StateFromJSON(t){switch(t){case 0:case"JOINING":return ParticipantInfo_State$1.JOINING;case 1:case"JOINED":return ParticipantInfo_State$1.JOINED;case 2:case"ACTIVE":return ParticipantInfo_State$1.ACTIVE;case 3:case"DISCONNECTED":return ParticipantInfo_State$1.DISCONNECTED;case-1:case"UNRECOGNIZED":default:return ParticipantInfo_State$1.UNRECOGNIZED}}function participantInfo_StateToJSON(t){switch(t){case ParticipantInfo_State$1.JOINING:return"JOINING";case ParticipantInfo_State$1.JOINED:return"JOINED";case ParticipantInfo_State$1.ACTIVE:return"ACTIVE";case ParticipantInfo_State$1.DISCONNECTED:return"DISCONNECTED";case ParticipantInfo_State$1.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var Encryption_Type$1;(function(t){t[t.NONE=0]="NONE",t[t.GCM=1]="GCM",t[t.CUSTOM=2]="CUSTOM",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(Encryption_Type$1||(Encryption_Type$1={}));function encryption_TypeFromJSON(t){switch(t){case 0:case"NONE":return Encryption_Type$1.NONE;case 1:case"GCM":return Encryption_Type$1.GCM;case 2:case"CUSTOM":return Encryption_Type$1.CUSTOM;case-1:case"UNRECOGNIZED":default:return Encryption_Type$1.UNRECOGNIZED}}function encryption_TypeToJSON(t){switch(t){case Encryption_Type$1.NONE:return"NONE";case Encryption_Type$1.GCM:return"GCM";case Encryption_Type$1.CUSTOM:return"CUSTOM";case Encryption_Type$1.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var DataPacket_Kind$1;(function(t){t[t.RELIABLE=0]="RELIABLE",t[t.LOSSY=1]="LOSSY",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(DataPacket_Kind$1||(DataPacket_Kind$1={}));function dataPacket_KindFromJSON(t){switch(t){case 0:case"RELIABLE":return DataPacket_Kind$1.RELIABLE;case 1:case"LOSSY":return DataPacket_Kind$1.LOSSY;case-1:case"UNRECOGNIZED":default:return DataPacket_Kind$1.UNRECOGNIZED}}function dataPacket_KindToJSON(t){switch(t){case DataPacket_Kind$1.RELIABLE:return"RELIABLE";case DataPacket_Kind$1.LOSSY:return"LOSSY";case DataPacket_Kind$1.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var ServerInfo_Edition$1;(function(t){t[t.Standard=0]="Standard",t[t.Cloud=1]="Cloud",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ServerInfo_Edition$1||(ServerInfo_Edition$1={}));function serverInfo_EditionFromJSON(t){switch(t){case 0:case"Standard":return ServerInfo_Edition$1.Standard;case 1:case"Cloud":return ServerInfo_Edition$1.Cloud;case-1:case"UNRECOGNIZED":default:return ServerInfo_Edition$1.UNRECOGNIZED}}function serverInfo_EditionToJSON(t){switch(t){case ServerInfo_Edition$1.Standard:return"Standard";case ServerInfo_Edition$1.Cloud:return"Cloud";case ServerInfo_Edition$1.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var ClientInfo_SDK$1;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JS=1]="JS",t[t.SWIFT=2]="SWIFT",t[t.ANDROID=3]="ANDROID",t[t.FLUTTER=4]="FLUTTER",t[t.GO=5]="GO",t[t.UNITY=6]="UNITY",t[t.REACT_NATIVE=7]="REACT_NATIVE",t[t.RUST=8]="RUST",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ClientInfo_SDK$1||(ClientInfo_SDK$1={}));function clientInfo_SDKFromJSON(t){switch(t){case 0:case"UNKNOWN":return ClientInfo_SDK$1.UNKNOWN;case 1:case"JS":return ClientInfo_SDK$1.JS;case 2:case"SWIFT":return ClientInfo_SDK$1.SWIFT;case 3:case"ANDROID":return ClientInfo_SDK$1.ANDROID;case 4:case"FLUTTER":return ClientInfo_SDK$1.FLUTTER;case 5:case"GO":return ClientInfo_SDK$1.GO;case 6:case"UNITY":return ClientInfo_SDK$1.UNITY;case 7:case"REACT_NATIVE":return ClientInfo_SDK$1.REACT_NATIVE;case 8:case"RUST":return ClientInfo_SDK$1.RUST;case-1:case"UNRECOGNIZED":default:return ClientInfo_SDK$1.UNRECOGNIZED}}function clientInfo_SDKToJSON(t){switch(t){case ClientInfo_SDK$1.UNKNOWN:return"UNKNOWN";case ClientInfo_SDK$1.JS:return"JS";case ClientInfo_SDK$1.SWIFT:return"SWIFT";case ClientInfo_SDK$1.ANDROID:return"ANDROID";case ClientInfo_SDK$1.FLUTTER:return"FLUTTER";case ClientInfo_SDK$1.GO:return"GO";case ClientInfo_SDK$1.UNITY:return"UNITY";case ClientInfo_SDK$1.REACT_NATIVE:return"REACT_NATIVE";case ClientInfo_SDK$1.RUST:return"RUST";case ClientInfo_SDK$1.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function createBaseRoom(){return{sid:"",name:"",emptyTimeout:0,maxParticipants:0,creationTime:0,turnPassword:"",enabledCodecs:[],metadata:"",numParticipants:0,numPublishers:0,activeRecording:!1}}const Room$1={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.sid!==""&&e.uint32(10).string(t.sid),t.name!==""&&e.uint32(18).string(t.name),t.emptyTimeout!==0&&e.uint32(24).uint32(t.emptyTimeout),t.maxParticipants!==0&&e.uint32(32).uint32(t.maxParticipants),t.creationTime!==0&&e.uint32(40).int64(t.creationTime),t.turnPassword!==""&&e.uint32(50).string(t.turnPassword);for(const n of t.enabledCodecs)Codec.encode(n,e.uint32(58).fork()).ldelim();return t.metadata!==""&&e.uint32(66).string(t.metadata),t.numParticipants!==0&&e.uint32(72).uint32(t.numParticipants),t.numPublishers!==0&&e.uint32(88).uint32(t.numPublishers),t.activeRecording===!0&&e.uint32(80).bool(t.activeRecording),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseRoom();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.sid=n.string();continue;case 2:if(c!=18)break;s.name=n.string();continue;case 3:if(c!=24)break;s.emptyTimeout=n.uint32();continue;case 4:if(c!=32)break;s.maxParticipants=n.uint32();continue;case 5:if(c!=40)break;s.creationTime=longToNumber$1(n.int64());continue;case 6:if(c!=50)break;s.turnPassword=n.string();continue;case 7:if(c!=58)break;s.enabledCodecs.push(Codec.decode(n,n.uint32()));continue;case 8:if(c!=66)break;s.metadata=n.string();continue;case 9:if(c!=72)break;s.numParticipants=n.uint32();continue;case 11:if(c!=88)break;s.numPublishers=n.uint32();continue;case 10:if(c!=80)break;s.activeRecording=n.bool();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{sid:isSet$1(t.sid)?String(t.sid):"",name:isSet$1(t.name)?String(t.name):"",emptyTimeout:isSet$1(t.emptyTimeout)?Number(t.emptyTimeout):0,maxParticipants:isSet$1(t.maxParticipants)?Number(t.maxParticipants):0,creationTime:isSet$1(t.creationTime)?Number(t.creationTime):0,turnPassword:isSet$1(t.turnPassword)?String(t.turnPassword):"",enabledCodecs:Array.isArray(t==null?void 0:t.enabledCodecs)?t.enabledCodecs.map(e=>Codec.fromJSON(e)):[],metadata:isSet$1(t.metadata)?String(t.metadata):"",numParticipants:isSet$1(t.numParticipants)?Number(t.numParticipants):0,numPublishers:isSet$1(t.numPublishers)?Number(t.numPublishers):0,activeRecording:isSet$1(t.activeRecording)?!!t.activeRecording:!1}},toJSON(t){const e={};return t.sid!==void 0&&(e.sid=t.sid),t.name!==void 0&&(e.name=t.name),t.emptyTimeout!==void 0&&(e.emptyTimeout=Math.round(t.emptyTimeout)),t.maxParticipants!==void 0&&(e.maxParticipants=Math.round(t.maxParticipants)),t.creationTime!==void 0&&(e.creationTime=Math.round(t.creationTime)),t.turnPassword!==void 0&&(e.turnPassword=t.turnPassword),t.enabledCodecs?e.enabledCodecs=t.enabledCodecs.map(n=>n?Codec.toJSON(n):void 0):e.enabledCodecs=[],t.metadata!==void 0&&(e.metadata=t.metadata),t.numParticipants!==void 0&&(e.numParticipants=Math.round(t.numParticipants)),t.numPublishers!==void 0&&(e.numPublishers=Math.round(t.numPublishers)),t.activeRecording!==void 0&&(e.activeRecording=t.activeRecording),e},create(t){return Room$1.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u,d,m,_,b,S;const k=createBaseRoom();return k.sid=(e=t.sid)!==null&&e!==void 0?e:"",k.name=(n=t.name)!==null&&n!==void 0?n:"",k.emptyTimeout=(a=t.emptyTimeout)!==null&&a!==void 0?a:0,k.maxParticipants=(s=t.maxParticipants)!==null&&s!==void 0?s:0,k.creationTime=(c=t.creationTime)!==null&&c!==void 0?c:0,k.turnPassword=(u=t.turnPassword)!==null&&u!==void 0?u:"",k.enabledCodecs=((d=t.enabledCodecs)===null||d===void 0?void 0:d.map(w=>Codec.fromPartial(w)))||[],k.metadata=(m=t.metadata)!==null&&m!==void 0?m:"",k.numParticipants=(_=t.numParticipants)!==null&&_!==void 0?_:0,k.numPublishers=(b=t.numPublishers)!==null&&b!==void 0?b:0,k.activeRecording=(S=t.activeRecording)!==null&&S!==void 0?S:!1,k}};function createBaseCodec(){return{mime:"",fmtpLine:""}}const Codec={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.mime!==""&&e.uint32(10).string(t.mime),t.fmtpLine!==""&&e.uint32(18).string(t.fmtpLine),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseCodec();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.mime=n.string();continue;case 2:if(c!=18)break;s.fmtpLine=n.string();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{mime:isSet$1(t.mime)?String(t.mime):"",fmtpLine:isSet$1(t.fmtpLine)?String(t.fmtpLine):""}},toJSON(t){const e={};return t.mime!==void 0&&(e.mime=t.mime),t.fmtpLine!==void 0&&(e.fmtpLine=t.fmtpLine),e},create(t){return Codec.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseCodec();return a.mime=(e=t.mime)!==null&&e!==void 0?e:"",a.fmtpLine=(n=t.fmtpLine)!==null&&n!==void 0?n:"",a}};function createBaseParticipantPermission(){return{canSubscribe:!1,canPublish:!1,canPublishData:!1,canPublishSources:[],hidden:!1,recorder:!1,canUpdateMetadata:!1}}const ParticipantPermission={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.canSubscribe===!0&&e.uint32(8).bool(t.canSubscribe),t.canPublish===!0&&e.uint32(16).bool(t.canPublish),t.canPublishData===!0&&e.uint32(24).bool(t.canPublishData),e.uint32(74).fork();for(const n of t.canPublishSources)e.int32(n);return e.ldelim(),t.hidden===!0&&e.uint32(56).bool(t.hidden),t.recorder===!0&&e.uint32(64).bool(t.recorder),t.canUpdateMetadata===!0&&e.uint32(80).bool(t.canUpdateMetadata),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseParticipantPermission();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=8)break;s.canSubscribe=n.bool();continue;case 2:if(c!=16)break;s.canPublish=n.bool();continue;case 3:if(c!=24)break;s.canPublishData=n.bool();continue;case 9:if(c==72){s.canPublishSources.push(n.int32());continue}if(c==74){const u=n.uint32()+n.pos;for(;n.pos<u;)s.canPublishSources.push(n.int32());continue}break;case 7:if(c!=56)break;s.hidden=n.bool();continue;case 8:if(c!=64)break;s.recorder=n.bool();continue;case 10:if(c!=80)break;s.canUpdateMetadata=n.bool();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{canSubscribe:isSet$1(t.canSubscribe)?!!t.canSubscribe:!1,canPublish:isSet$1(t.canPublish)?!!t.canPublish:!1,canPublishData:isSet$1(t.canPublishData)?!!t.canPublishData:!1,canPublishSources:Array.isArray(t==null?void 0:t.canPublishSources)?t.canPublishSources.map(e=>trackSourceFromJSON(e)):[],hidden:isSet$1(t.hidden)?!!t.hidden:!1,recorder:isSet$1(t.recorder)?!!t.recorder:!1,canUpdateMetadata:isSet$1(t.canUpdateMetadata)?!!t.canUpdateMetadata:!1}},toJSON(t){const e={};return t.canSubscribe!==void 0&&(e.canSubscribe=t.canSubscribe),t.canPublish!==void 0&&(e.canPublish=t.canPublish),t.canPublishData!==void 0&&(e.canPublishData=t.canPublishData),t.canPublishSources?e.canPublishSources=t.canPublishSources.map(n=>trackSourceToJSON(n)):e.canPublishSources=[],t.hidden!==void 0&&(e.hidden=t.hidden),t.recorder!==void 0&&(e.recorder=t.recorder),t.canUpdateMetadata!==void 0&&(e.canUpdateMetadata=t.canUpdateMetadata),e},create(t){return ParticipantPermission.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u,d;const m=createBaseParticipantPermission();return m.canSubscribe=(e=t.canSubscribe)!==null&&e!==void 0?e:!1,m.canPublish=(n=t.canPublish)!==null&&n!==void 0?n:!1,m.canPublishData=(a=t.canPublishData)!==null&&a!==void 0?a:!1,m.canPublishSources=((s=t.canPublishSources)===null||s===void 0?void 0:s.map(_=>_))||[],m.hidden=(c=t.hidden)!==null&&c!==void 0?c:!1,m.recorder=(u=t.recorder)!==null&&u!==void 0?u:!1,m.canUpdateMetadata=(d=t.canUpdateMetadata)!==null&&d!==void 0?d:!1,m}};function createBaseParticipantInfo(){return{sid:"",identity:"",state:0,tracks:[],metadata:"",joinedAt:0,name:"",version:0,permission:void 0,region:"",isPublisher:!1}}const ParticipantInfo={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.sid!==""&&e.uint32(10).string(t.sid),t.identity!==""&&e.uint32(18).string(t.identity),t.state!==0&&e.uint32(24).int32(t.state);for(const n of t.tracks)TrackInfo.encode(n,e.uint32(34).fork()).ldelim();return t.metadata!==""&&e.uint32(42).string(t.metadata),t.joinedAt!==0&&e.uint32(48).int64(t.joinedAt),t.name!==""&&e.uint32(74).string(t.name),t.version!==0&&e.uint32(80).uint32(t.version),t.permission!==void 0&&ParticipantPermission.encode(t.permission,e.uint32(90).fork()).ldelim(),t.region!==""&&e.uint32(98).string(t.region),t.isPublisher===!0&&e.uint32(104).bool(t.isPublisher),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseParticipantInfo();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.sid=n.string();continue;case 2:if(c!=18)break;s.identity=n.string();continue;case 3:if(c!=24)break;s.state=n.int32();continue;case 4:if(c!=34)break;s.tracks.push(TrackInfo.decode(n,n.uint32()));continue;case 5:if(c!=42)break;s.metadata=n.string();continue;case 6:if(c!=48)break;s.joinedAt=longToNumber$1(n.int64());continue;case 9:if(c!=74)break;s.name=n.string();continue;case 10:if(c!=80)break;s.version=n.uint32();continue;case 11:if(c!=90)break;s.permission=ParticipantPermission.decode(n,n.uint32());continue;case 12:if(c!=98)break;s.region=n.string();continue;case 13:if(c!=104)break;s.isPublisher=n.bool();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{sid:isSet$1(t.sid)?String(t.sid):"",identity:isSet$1(t.identity)?String(t.identity):"",state:isSet$1(t.state)?participantInfo_StateFromJSON(t.state):0,tracks:Array.isArray(t==null?void 0:t.tracks)?t.tracks.map(e=>TrackInfo.fromJSON(e)):[],metadata:isSet$1(t.metadata)?String(t.metadata):"",joinedAt:isSet$1(t.joinedAt)?Number(t.joinedAt):0,name:isSet$1(t.name)?String(t.name):"",version:isSet$1(t.version)?Number(t.version):0,permission:isSet$1(t.permission)?ParticipantPermission.fromJSON(t.permission):void 0,region:isSet$1(t.region)?String(t.region):"",isPublisher:isSet$1(t.isPublisher)?!!t.isPublisher:!1}},toJSON(t){const e={};return t.sid!==void 0&&(e.sid=t.sid),t.identity!==void 0&&(e.identity=t.identity),t.state!==void 0&&(e.state=participantInfo_StateToJSON(t.state)),t.tracks?e.tracks=t.tracks.map(n=>n?TrackInfo.toJSON(n):void 0):e.tracks=[],t.metadata!==void 0&&(e.metadata=t.metadata),t.joinedAt!==void 0&&(e.joinedAt=Math.round(t.joinedAt)),t.name!==void 0&&(e.name=t.name),t.version!==void 0&&(e.version=Math.round(t.version)),t.permission!==void 0&&(e.permission=t.permission?ParticipantPermission.toJSON(t.permission):void 0),t.region!==void 0&&(e.region=t.region),t.isPublisher!==void 0&&(e.isPublisher=t.isPublisher),e},create(t){return ParticipantInfo.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u,d,m,_,b;const S=createBaseParticipantInfo();return S.sid=(e=t.sid)!==null&&e!==void 0?e:"",S.identity=(n=t.identity)!==null&&n!==void 0?n:"",S.state=(a=t.state)!==null&&a!==void 0?a:0,S.tracks=((s=t.tracks)===null||s===void 0?void 0:s.map(k=>TrackInfo.fromPartial(k)))||[],S.metadata=(c=t.metadata)!==null&&c!==void 0?c:"",S.joinedAt=(u=t.joinedAt)!==null&&u!==void 0?u:0,S.name=(d=t.name)!==null&&d!==void 0?d:"",S.version=(m=t.version)!==null&&m!==void 0?m:0,S.permission=t.permission!==void 0&&t.permission!==null?ParticipantPermission.fromPartial(t.permission):void 0,S.region=(_=t.region)!==null&&_!==void 0?_:"",S.isPublisher=(b=t.isPublisher)!==null&&b!==void 0?b:!1,S}};function createBaseSimulcastCodecInfo(){return{mimeType:"",mid:"",cid:"",layers:[]}}const SimulcastCodecInfo={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.mimeType!==""&&e.uint32(10).string(t.mimeType),t.mid!==""&&e.uint32(18).string(t.mid),t.cid!==""&&e.uint32(26).string(t.cid);for(const n of t.layers)VideoLayer.encode(n,e.uint32(34).fork()).ldelim();return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSimulcastCodecInfo();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.mimeType=n.string();continue;case 2:if(c!=18)break;s.mid=n.string();continue;case 3:if(c!=26)break;s.cid=n.string();continue;case 4:if(c!=34)break;s.layers.push(VideoLayer.decode(n,n.uint32()));continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{mimeType:isSet$1(t.mimeType)?String(t.mimeType):"",mid:isSet$1(t.mid)?String(t.mid):"",cid:isSet$1(t.cid)?String(t.cid):"",layers:Array.isArray(t==null?void 0:t.layers)?t.layers.map(e=>VideoLayer.fromJSON(e)):[]}},toJSON(t){const e={};return t.mimeType!==void 0&&(e.mimeType=t.mimeType),t.mid!==void 0&&(e.mid=t.mid),t.cid!==void 0&&(e.cid=t.cid),t.layers?e.layers=t.layers.map(n=>n?VideoLayer.toJSON(n):void 0):e.layers=[],e},create(t){return SimulcastCodecInfo.fromPartial(t??{})},fromPartial(t){var e,n,a,s;const c=createBaseSimulcastCodecInfo();return c.mimeType=(e=t.mimeType)!==null&&e!==void 0?e:"",c.mid=(n=t.mid)!==null&&n!==void 0?n:"",c.cid=(a=t.cid)!==null&&a!==void 0?a:"",c.layers=((s=t.layers)===null||s===void 0?void 0:s.map(u=>VideoLayer.fromPartial(u)))||[],c}};function createBaseTrackInfo(){return{sid:"",type:0,name:"",muted:!1,width:0,height:0,simulcast:!1,disableDtx:!1,source:0,layers:[],mimeType:"",mid:"",codecs:[],stereo:!1,disableRed:!1,encryption:0}}const TrackInfo={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.sid!==""&&e.uint32(10).string(t.sid),t.type!==0&&e.uint32(16).int32(t.type),t.name!==""&&e.uint32(26).string(t.name),t.muted===!0&&e.uint32(32).bool(t.muted),t.width!==0&&e.uint32(40).uint32(t.width),t.height!==0&&e.uint32(48).uint32(t.height),t.simulcast===!0&&e.uint32(56).bool(t.simulcast),t.disableDtx===!0&&e.uint32(64).bool(t.disableDtx),t.source!==0&&e.uint32(72).int32(t.source);for(const n of t.layers)VideoLayer.encode(n,e.uint32(82).fork()).ldelim();t.mimeType!==""&&e.uint32(90).string(t.mimeType),t.mid!==""&&e.uint32(98).string(t.mid);for(const n of t.codecs)SimulcastCodecInfo.encode(n,e.uint32(106).fork()).ldelim();return t.stereo===!0&&e.uint32(112).bool(t.stereo),t.disableRed===!0&&e.uint32(120).bool(t.disableRed),t.encryption!==0&&e.uint32(128).int32(t.encryption),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseTrackInfo();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.sid=n.string();continue;case 2:if(c!=16)break;s.type=n.int32();continue;case 3:if(c!=26)break;s.name=n.string();continue;case 4:if(c!=32)break;s.muted=n.bool();continue;case 5:if(c!=40)break;s.width=n.uint32();continue;case 6:if(c!=48)break;s.height=n.uint32();continue;case 7:if(c!=56)break;s.simulcast=n.bool();continue;case 8:if(c!=64)break;s.disableDtx=n.bool();continue;case 9:if(c!=72)break;s.source=n.int32();continue;case 10:if(c!=82)break;s.layers.push(VideoLayer.decode(n,n.uint32()));continue;case 11:if(c!=90)break;s.mimeType=n.string();continue;case 12:if(c!=98)break;s.mid=n.string();continue;case 13:if(c!=106)break;s.codecs.push(SimulcastCodecInfo.decode(n,n.uint32()));continue;case 14:if(c!=112)break;s.stereo=n.bool();continue;case 15:if(c!=120)break;s.disableRed=n.bool();continue;case 16:if(c!=128)break;s.encryption=n.int32();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{sid:isSet$1(t.sid)?String(t.sid):"",type:isSet$1(t.type)?trackTypeFromJSON(t.type):0,name:isSet$1(t.name)?String(t.name):"",muted:isSet$1(t.muted)?!!t.muted:!1,width:isSet$1(t.width)?Number(t.width):0,height:isSet$1(t.height)?Number(t.height):0,simulcast:isSet$1(t.simulcast)?!!t.simulcast:!1,disableDtx:isSet$1(t.disableDtx)?!!t.disableDtx:!1,source:isSet$1(t.source)?trackSourceFromJSON(t.source):0,layers:Array.isArray(t==null?void 0:t.layers)?t.layers.map(e=>VideoLayer.fromJSON(e)):[],mimeType:isSet$1(t.mimeType)?String(t.mimeType):"",mid:isSet$1(t.mid)?String(t.mid):"",codecs:Array.isArray(t==null?void 0:t.codecs)?t.codecs.map(e=>SimulcastCodecInfo.fromJSON(e)):[],stereo:isSet$1(t.stereo)?!!t.stereo:!1,disableRed:isSet$1(t.disableRed)?!!t.disableRed:!1,encryption:isSet$1(t.encryption)?encryption_TypeFromJSON(t.encryption):0}},toJSON(t){const e={};return t.sid!==void 0&&(e.sid=t.sid),t.type!==void 0&&(e.type=trackTypeToJSON(t.type)),t.name!==void 0&&(e.name=t.name),t.muted!==void 0&&(e.muted=t.muted),t.width!==void 0&&(e.width=Math.round(t.width)),t.height!==void 0&&(e.height=Math.round(t.height)),t.simulcast!==void 0&&(e.simulcast=t.simulcast),t.disableDtx!==void 0&&(e.disableDtx=t.disableDtx),t.source!==void 0&&(e.source=trackSourceToJSON(t.source)),t.layers?e.layers=t.layers.map(n=>n?VideoLayer.toJSON(n):void 0):e.layers=[],t.mimeType!==void 0&&(e.mimeType=t.mimeType),t.mid!==void 0&&(e.mid=t.mid),t.codecs?e.codecs=t.codecs.map(n=>n?SimulcastCodecInfo.toJSON(n):void 0):e.codecs=[],t.stereo!==void 0&&(e.stereo=t.stereo),t.disableRed!==void 0&&(e.disableRed=t.disableRed),t.encryption!==void 0&&(e.encryption=encryption_TypeToJSON(t.encryption)),e},create(t){return TrackInfo.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u,d,m,_,b,S,k,w,O,P,N;const I=createBaseTrackInfo();return I.sid=(e=t.sid)!==null&&e!==void 0?e:"",I.type=(n=t.type)!==null&&n!==void 0?n:0,I.name=(a=t.name)!==null&&a!==void 0?a:"",I.muted=(s=t.muted)!==null&&s!==void 0?s:!1,I.width=(c=t.width)!==null&&c!==void 0?c:0,I.height=(u=t.height)!==null&&u!==void 0?u:0,I.simulcast=(d=t.simulcast)!==null&&d!==void 0?d:!1,I.disableDtx=(m=t.disableDtx)!==null&&m!==void 0?m:!1,I.source=(_=t.source)!==null&&_!==void 0?_:0,I.layers=((b=t.layers)===null||b===void 0?void 0:b.map(U=>VideoLayer.fromPartial(U)))||[],I.mimeType=(S=t.mimeType)!==null&&S!==void 0?S:"",I.mid=(k=t.mid)!==null&&k!==void 0?k:"",I.codecs=((w=t.codecs)===null||w===void 0?void 0:w.map(U=>SimulcastCodecInfo.fromPartial(U)))||[],I.stereo=(O=t.stereo)!==null&&O!==void 0?O:!1,I.disableRed=(P=t.disableRed)!==null&&P!==void 0?P:!1,I.encryption=(N=t.encryption)!==null&&N!==void 0?N:0,I}};function createBaseVideoLayer(){return{quality:0,width:0,height:0,bitrate:0,ssrc:0}}const VideoLayer={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.quality!==0&&e.uint32(8).int32(t.quality),t.width!==0&&e.uint32(16).uint32(t.width),t.height!==0&&e.uint32(24).uint32(t.height),t.bitrate!==0&&e.uint32(32).uint32(t.bitrate),t.ssrc!==0&&e.uint32(40).uint32(t.ssrc),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseVideoLayer();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=8)break;s.quality=n.int32();continue;case 2:if(c!=16)break;s.width=n.uint32();continue;case 3:if(c!=24)break;s.height=n.uint32();continue;case 4:if(c!=32)break;s.bitrate=n.uint32();continue;case 5:if(c!=40)break;s.ssrc=n.uint32();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{quality:isSet$1(t.quality)?videoQualityFromJSON(t.quality):0,width:isSet$1(t.width)?Number(t.width):0,height:isSet$1(t.height)?Number(t.height):0,bitrate:isSet$1(t.bitrate)?Number(t.bitrate):0,ssrc:isSet$1(t.ssrc)?Number(t.ssrc):0}},toJSON(t){const e={};return t.quality!==void 0&&(e.quality=videoQualityToJSON(t.quality)),t.width!==void 0&&(e.width=Math.round(t.width)),t.height!==void 0&&(e.height=Math.round(t.height)),t.bitrate!==void 0&&(e.bitrate=Math.round(t.bitrate)),t.ssrc!==void 0&&(e.ssrc=Math.round(t.ssrc)),e},create(t){return VideoLayer.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c;const u=createBaseVideoLayer();return u.quality=(e=t.quality)!==null&&e!==void 0?e:0,u.width=(n=t.width)!==null&&n!==void 0?n:0,u.height=(a=t.height)!==null&&a!==void 0?a:0,u.bitrate=(s=t.bitrate)!==null&&s!==void 0?s:0,u.ssrc=(c=t.ssrc)!==null&&c!==void 0?c:0,u}};function createBaseDataPacket(){return{kind:0,value:void 0}}const DataPacket={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();var n;switch(t.kind!==0&&e.uint32(8).int32(t.kind),(n=t.value)===null||n===void 0?void 0:n.$case){case"user":UserPacket.encode(t.value.user,e.uint32(18).fork()).ldelim();break;case"speaker":ActiveSpeakerUpdate.encode(t.value.speaker,e.uint32(26).fork()).ldelim();break}return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseDataPacket();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=8)break;s.kind=n.int32();continue;case 2:if(c!=18)break;s.value={$case:"user",user:UserPacket.decode(n,n.uint32())};continue;case 3:if(c!=26)break;s.value={$case:"speaker",speaker:ActiveSpeakerUpdate.decode(n,n.uint32())};continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{kind:isSet$1(t.kind)?dataPacket_KindFromJSON(t.kind):0,value:isSet$1(t.user)?{$case:"user",user:UserPacket.fromJSON(t.user)}:isSet$1(t.speaker)?{$case:"speaker",speaker:ActiveSpeakerUpdate.fromJSON(t.speaker)}:void 0}},toJSON(t){var e,n,a,s,c,u;const d={};return t.kind!==void 0&&(d.kind=dataPacket_KindToJSON(t.kind)),((e=t.value)===null||e===void 0?void 0:e.$case)==="user"&&(d.user=!((n=t.value)===null||n===void 0)&&n.user?UserPacket.toJSON((a=t.value)===null||a===void 0?void 0:a.user):void 0),((s=t.value)===null||s===void 0?void 0:s.$case)==="speaker"&&(d.speaker=!((c=t.value)===null||c===void 0)&&c.speaker?ActiveSpeakerUpdate.toJSON((u=t.value)===null||u===void 0?void 0:u.speaker):void 0),d},create(t){return DataPacket.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u,d;const m=createBaseDataPacket();return m.kind=(e=t.kind)!==null&&e!==void 0?e:0,((n=t.value)===null||n===void 0?void 0:n.$case)==="user"&&((a=t.value)===null||a===void 0?void 0:a.user)!==void 0&&((s=t.value)===null||s===void 0?void 0:s.user)!==null&&(m.value={$case:"user",user:UserPacket.fromPartial(t.value.user)}),((c=t.value)===null||c===void 0?void 0:c.$case)==="speaker"&&((u=t.value)===null||u===void 0?void 0:u.speaker)!==void 0&&((d=t.value)===null||d===void 0?void 0:d.speaker)!==null&&(m.value={$case:"speaker",speaker:ActiveSpeakerUpdate.fromPartial(t.value.speaker)}),m}};function createBaseActiveSpeakerUpdate(){return{speakers:[]}}const ActiveSpeakerUpdate={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();for(const n of t.speakers)SpeakerInfo.encode(n,e.uint32(10).fork()).ldelim();return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseActiveSpeakerUpdate();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.speakers.push(SpeakerInfo.decode(n,n.uint32()));continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{speakers:Array.isArray(t==null?void 0:t.speakers)?t.speakers.map(e=>SpeakerInfo.fromJSON(e)):[]}},toJSON(t){const e={};return t.speakers?e.speakers=t.speakers.map(n=>n?SpeakerInfo.toJSON(n):void 0):e.speakers=[],e},create(t){return ActiveSpeakerUpdate.fromPartial(t??{})},fromPartial(t){var e;const n=createBaseActiveSpeakerUpdate();return n.speakers=((e=t.speakers)===null||e===void 0?void 0:e.map(a=>SpeakerInfo.fromPartial(a)))||[],n}};function createBaseSpeakerInfo(){return{sid:"",level:0,active:!1}}const SpeakerInfo={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.sid!==""&&e.uint32(10).string(t.sid),t.level!==0&&e.uint32(21).float(t.level),t.active===!0&&e.uint32(24).bool(t.active),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSpeakerInfo();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.sid=n.string();continue;case 2:if(c!=21)break;s.level=n.float();continue;case 3:if(c!=24)break;s.active=n.bool();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{sid:isSet$1(t.sid)?String(t.sid):"",level:isSet$1(t.level)?Number(t.level):0,active:isSet$1(t.active)?!!t.active:!1}},toJSON(t){const e={};return t.sid!==void 0&&(e.sid=t.sid),t.level!==void 0&&(e.level=t.level),t.active!==void 0&&(e.active=t.active),e},create(t){return SpeakerInfo.fromPartial(t??{})},fromPartial(t){var e,n,a;const s=createBaseSpeakerInfo();return s.sid=(e=t.sid)!==null&&e!==void 0?e:"",s.level=(n=t.level)!==null&&n!==void 0?n:0,s.active=(a=t.active)!==null&&a!==void 0?a:!1,s}};function createBaseUserPacket(){return{participantSid:"",payload:new Uint8Array,destinationSids:[],topic:void 0}}const UserPacket={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.participantSid!==""&&e.uint32(10).string(t.participantSid),t.payload.length!==0&&e.uint32(18).bytes(t.payload);for(const n of t.destinationSids)e.uint32(26).string(n);return t.topic!==void 0&&e.uint32(34).string(t.topic),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseUserPacket();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.participantSid=n.string();continue;case 2:if(c!=18)break;s.payload=n.bytes();continue;case 3:if(c!=26)break;s.destinationSids.push(n.string());continue;case 4:if(c!=34)break;s.topic=n.string();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{participantSid:isSet$1(t.participantSid)?String(t.participantSid):"",payload:isSet$1(t.payload)?bytesFromBase64(t.payload):new Uint8Array,destinationSids:Array.isArray(t==null?void 0:t.destinationSids)?t.destinationSids.map(e=>String(e)):[],topic:isSet$1(t.topic)?String(t.topic):void 0}},toJSON(t){const e={};return t.participantSid!==void 0&&(e.participantSid=t.participantSid),t.payload!==void 0&&(e.payload=base64FromBytes(t.payload!==void 0?t.payload:new Uint8Array)),t.destinationSids?e.destinationSids=t.destinationSids.map(n=>n):e.destinationSids=[],t.topic!==void 0&&(e.topic=t.topic),e},create(t){return UserPacket.fromPartial(t??{})},fromPartial(t){var e,n,a,s;const c=createBaseUserPacket();return c.participantSid=(e=t.participantSid)!==null&&e!==void 0?e:"",c.payload=(n=t.payload)!==null&&n!==void 0?n:new Uint8Array,c.destinationSids=((a=t.destinationSids)===null||a===void 0?void 0:a.map(u=>u))||[],c.topic=(s=t.topic)!==null&&s!==void 0?s:void 0,c}};function createBaseParticipantTracks(){return{participantSid:"",trackSids:[]}}const ParticipantTracks={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.participantSid!==""&&e.uint32(10).string(t.participantSid);for(const n of t.trackSids)e.uint32(18).string(n);return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseParticipantTracks();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.participantSid=n.string();continue;case 2:if(c!=18)break;s.trackSids.push(n.string());continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{participantSid:isSet$1(t.participantSid)?String(t.participantSid):"",trackSids:Array.isArray(t==null?void 0:t.trackSids)?t.trackSids.map(e=>String(e)):[]}},toJSON(t){const e={};return t.participantSid!==void 0&&(e.participantSid=t.participantSid),t.trackSids?e.trackSids=t.trackSids.map(n=>n):e.trackSids=[],e},create(t){return ParticipantTracks.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseParticipantTracks();return a.participantSid=(e=t.participantSid)!==null&&e!==void 0?e:"",a.trackSids=((n=t.trackSids)===null||n===void 0?void 0:n.map(s=>s))||[],a}};function createBaseServerInfo(){return{edition:0,version:"",protocol:0,region:"",nodeId:"",debugInfo:""}}const ServerInfo={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.edition!==0&&e.uint32(8).int32(t.edition),t.version!==""&&e.uint32(18).string(t.version),t.protocol!==0&&e.uint32(24).int32(t.protocol),t.region!==""&&e.uint32(34).string(t.region),t.nodeId!==""&&e.uint32(42).string(t.nodeId),t.debugInfo!==""&&e.uint32(50).string(t.debugInfo),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseServerInfo();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=8)break;s.edition=n.int32();continue;case 2:if(c!=18)break;s.version=n.string();continue;case 3:if(c!=24)break;s.protocol=n.int32();continue;case 4:if(c!=34)break;s.region=n.string();continue;case 5:if(c!=42)break;s.nodeId=n.string();continue;case 6:if(c!=50)break;s.debugInfo=n.string();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{edition:isSet$1(t.edition)?serverInfo_EditionFromJSON(t.edition):0,version:isSet$1(t.version)?String(t.version):"",protocol:isSet$1(t.protocol)?Number(t.protocol):0,region:isSet$1(t.region)?String(t.region):"",nodeId:isSet$1(t.nodeId)?String(t.nodeId):"",debugInfo:isSet$1(t.debugInfo)?String(t.debugInfo):""}},toJSON(t){const e={};return t.edition!==void 0&&(e.edition=serverInfo_EditionToJSON(t.edition)),t.version!==void 0&&(e.version=t.version),t.protocol!==void 0&&(e.protocol=Math.round(t.protocol)),t.region!==void 0&&(e.region=t.region),t.nodeId!==void 0&&(e.nodeId=t.nodeId),t.debugInfo!==void 0&&(e.debugInfo=t.debugInfo),e},create(t){return ServerInfo.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u;const d=createBaseServerInfo();return d.edition=(e=t.edition)!==null&&e!==void 0?e:0,d.version=(n=t.version)!==null&&n!==void 0?n:"",d.protocol=(a=t.protocol)!==null&&a!==void 0?a:0,d.region=(s=t.region)!==null&&s!==void 0?s:"",d.nodeId=(c=t.nodeId)!==null&&c!==void 0?c:"",d.debugInfo=(u=t.debugInfo)!==null&&u!==void 0?u:"",d}};function createBaseClientInfo(){return{sdk:0,version:"",protocol:0,os:"",osVersion:"",deviceModel:"",browser:"",browserVersion:"",address:"",network:""}}const ClientInfo={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.sdk!==0&&e.uint32(8).int32(t.sdk),t.version!==""&&e.uint32(18).string(t.version),t.protocol!==0&&e.uint32(24).int32(t.protocol),t.os!==""&&e.uint32(34).string(t.os),t.osVersion!==""&&e.uint32(42).string(t.osVersion),t.deviceModel!==""&&e.uint32(50).string(t.deviceModel),t.browser!==""&&e.uint32(58).string(t.browser),t.browserVersion!==""&&e.uint32(66).string(t.browserVersion),t.address!==""&&e.uint32(74).string(t.address),t.network!==""&&e.uint32(82).string(t.network),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseClientInfo();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=8)break;s.sdk=n.int32();continue;case 2:if(c!=18)break;s.version=n.string();continue;case 3:if(c!=24)break;s.protocol=n.int32();continue;case 4:if(c!=34)break;s.os=n.string();continue;case 5:if(c!=42)break;s.osVersion=n.string();continue;case 6:if(c!=50)break;s.deviceModel=n.string();continue;case 7:if(c!=58)break;s.browser=n.string();continue;case 8:if(c!=66)break;s.browserVersion=n.string();continue;case 9:if(c!=74)break;s.address=n.string();continue;case 10:if(c!=82)break;s.network=n.string();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{sdk:isSet$1(t.sdk)?clientInfo_SDKFromJSON(t.sdk):0,version:isSet$1(t.version)?String(t.version):"",protocol:isSet$1(t.protocol)?Number(t.protocol):0,os:isSet$1(t.os)?String(t.os):"",osVersion:isSet$1(t.osVersion)?String(t.osVersion):"",deviceModel:isSet$1(t.deviceModel)?String(t.deviceModel):"",browser:isSet$1(t.browser)?String(t.browser):"",browserVersion:isSet$1(t.browserVersion)?String(t.browserVersion):"",address:isSet$1(t.address)?String(t.address):"",network:isSet$1(t.network)?String(t.network):""}},toJSON(t){const e={};return t.sdk!==void 0&&(e.sdk=clientInfo_SDKToJSON(t.sdk)),t.version!==void 0&&(e.version=t.version),t.protocol!==void 0&&(e.protocol=Math.round(t.protocol)),t.os!==void 0&&(e.os=t.os),t.osVersion!==void 0&&(e.osVersion=t.osVersion),t.deviceModel!==void 0&&(e.deviceModel=t.deviceModel),t.browser!==void 0&&(e.browser=t.browser),t.browserVersion!==void 0&&(e.browserVersion=t.browserVersion),t.address!==void 0&&(e.address=t.address),t.network!==void 0&&(e.network=t.network),e},create(t){return ClientInfo.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u,d,m,_,b;const S=createBaseClientInfo();return S.sdk=(e=t.sdk)!==null&&e!==void 0?e:0,S.version=(n=t.version)!==null&&n!==void 0?n:"",S.protocol=(a=t.protocol)!==null&&a!==void 0?a:0,S.os=(s=t.os)!==null&&s!==void 0?s:"",S.osVersion=(c=t.osVersion)!==null&&c!==void 0?c:"",S.deviceModel=(u=t.deviceModel)!==null&&u!==void 0?u:"",S.browser=(d=t.browser)!==null&&d!==void 0?d:"",S.browserVersion=(m=t.browserVersion)!==null&&m!==void 0?m:"",S.address=(_=t.address)!==null&&_!==void 0?_:"",S.network=(b=t.network)!==null&&b!==void 0?b:"",S}};function createBaseClientConfiguration(){return{video:void 0,screen:void 0,resumeConnection:0,disabledCodecs:void 0,forceRelay:0}}const ClientConfiguration={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.video!==void 0&&VideoConfiguration.encode(t.video,e.uint32(10).fork()).ldelim(),t.screen!==void 0&&VideoConfiguration.encode(t.screen,e.uint32(18).fork()).ldelim(),t.resumeConnection!==0&&e.uint32(24).int32(t.resumeConnection),t.disabledCodecs!==void 0&&DisabledCodecs.encode(t.disabledCodecs,e.uint32(34).fork()).ldelim(),t.forceRelay!==0&&e.uint32(40).int32(t.forceRelay),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseClientConfiguration();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.video=VideoConfiguration.decode(n,n.uint32());continue;case 2:if(c!=18)break;s.screen=VideoConfiguration.decode(n,n.uint32());continue;case 3:if(c!=24)break;s.resumeConnection=n.int32();continue;case 4:if(c!=34)break;s.disabledCodecs=DisabledCodecs.decode(n,n.uint32());continue;case 5:if(c!=40)break;s.forceRelay=n.int32();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{video:isSet$1(t.video)?VideoConfiguration.fromJSON(t.video):void 0,screen:isSet$1(t.screen)?VideoConfiguration.fromJSON(t.screen):void 0,resumeConnection:isSet$1(t.resumeConnection)?clientConfigSettingFromJSON(t.resumeConnection):0,disabledCodecs:isSet$1(t.disabledCodecs)?DisabledCodecs.fromJSON(t.disabledCodecs):void 0,forceRelay:isSet$1(t.forceRelay)?clientConfigSettingFromJSON(t.forceRelay):0}},toJSON(t){const e={};return t.video!==void 0&&(e.video=t.video?VideoConfiguration.toJSON(t.video):void 0),t.screen!==void 0&&(e.screen=t.screen?VideoConfiguration.toJSON(t.screen):void 0),t.resumeConnection!==void 0&&(e.resumeConnection=clientConfigSettingToJSON(t.resumeConnection)),t.disabledCodecs!==void 0&&(e.disabledCodecs=t.disabledCodecs?DisabledCodecs.toJSON(t.disabledCodecs):void 0),t.forceRelay!==void 0&&(e.forceRelay=clientConfigSettingToJSON(t.forceRelay)),e},create(t){return ClientConfiguration.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseClientConfiguration();return a.video=t.video!==void 0&&t.video!==null?VideoConfiguration.fromPartial(t.video):void 0,a.screen=t.screen!==void 0&&t.screen!==null?VideoConfiguration.fromPartial(t.screen):void 0,a.resumeConnection=(e=t.resumeConnection)!==null&&e!==void 0?e:0,a.disabledCodecs=t.disabledCodecs!==void 0&&t.disabledCodecs!==null?DisabledCodecs.fromPartial(t.disabledCodecs):void 0,a.forceRelay=(n=t.forceRelay)!==null&&n!==void 0?n:0,a}};function createBaseVideoConfiguration(){return{hardwareEncoder:0}}const VideoConfiguration={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.hardwareEncoder!==0&&e.uint32(8).int32(t.hardwareEncoder),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseVideoConfiguration();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=8)break;s.hardwareEncoder=n.int32();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{hardwareEncoder:isSet$1(t.hardwareEncoder)?clientConfigSettingFromJSON(t.hardwareEncoder):0}},toJSON(t){const e={};return t.hardwareEncoder!==void 0&&(e.hardwareEncoder=clientConfigSettingToJSON(t.hardwareEncoder)),e},create(t){return VideoConfiguration.fromPartial(t??{})},fromPartial(t){var e;const n=createBaseVideoConfiguration();return n.hardwareEncoder=(e=t.hardwareEncoder)!==null&&e!==void 0?e:0,n}};function createBaseDisabledCodecs(){return{codecs:[]}}const DisabledCodecs={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();for(const n of t.codecs)Codec.encode(n,e.uint32(10).fork()).ldelim();return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseDisabledCodecs();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.codecs.push(Codec.decode(n,n.uint32()));continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{codecs:Array.isArray(t==null?void 0:t.codecs)?t.codecs.map(e=>Codec.fromJSON(e)):[]}},toJSON(t){const e={};return t.codecs?e.codecs=t.codecs.map(n=>n?Codec.toJSON(n):void 0):e.codecs=[],e},create(t){return DisabledCodecs.fromPartial(t??{})},fromPartial(t){var e;const n=createBaseDisabledCodecs();return n.codecs=((e=t.codecs)===null||e===void 0?void 0:e.map(a=>Codec.fromPartial(a)))||[],n}};var tsProtoGlobalThis$1=(()=>{if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof dist.global<"u")return dist.global;throw"Unable to locate global object"})();function bytesFromBase64(t){if(tsProtoGlobalThis$1.Buffer)return Uint8Array.from(tsProtoGlobalThis$1.Buffer.from(t,"base64"));{const e=tsProtoGlobalThis$1.atob(t),n=new Uint8Array(e.length);for(let a=0;a<e.length;++a)n[a]=e.charCodeAt(a);return n}}function base64FromBytes(t){if(tsProtoGlobalThis$1.Buffer)return tsProtoGlobalThis$1.Buffer.from(t).toString("base64");{const e=[];return t.forEach(n=>{e.push(String.fromCharCode(n))}),tsProtoGlobalThis$1.btoa(e.join(""))}}function longToNumber$1(t){if(t.gt(Number.MAX_SAFE_INTEGER))throw new tsProtoGlobalThis$1.Error("Value is larger than Number.MAX_SAFE_INTEGER");return t.toNumber()}_m0$1.util.Long!==Long$1$1&&(_m0$1.util.Long=Long$1$1,_m0$1.configure());function isSet$1(t){return t!=null}const maxRetryDelay=7e3,DEFAULT_RETRY_DELAYS_IN_MS=[0,300,2*2*300,3*3*300,4*4*300,maxRetryDelay,maxRetryDelay,maxRetryDelay,maxRetryDelay,maxRetryDelay];class DefaultReconnectPolicy{constructor(e){this._retryDelays=e!==void 0?[...e]:DEFAULT_RETRY_DELAYS_IN_MS}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function __awaiter(t,e,n,a){function s(c){return c instanceof n?c:new n(function(u){u(c)})}return new(n||(n=Promise))(function(c,u){function d(b){try{_(a.next(b))}catch(S){u(S)}}function m(b){try{_(a.throw(b))}catch(S){u(S)}}function _(b){b.done?c(b.value):s(b.value).then(d,m)}_((a=a.apply(t,e||[])).next())})}function __values(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],a=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function __asyncValues(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n);function a(c){n[c]=t[c]&&function(u){return new Promise(function(d,m){u=t[c](u),s(d,m,u.done,u.value)})}}function s(c,u,d,m){Promise.resolve(m).then(function(_){c({value:_,done:d})},u)}}var events$1={exports:{}},R$1=typeof Reflect=="object"?Reflect:null,ReflectApply$1=R$1&&typeof R$1.apply=="function"?R$1.apply:function(e,n,a){return Function.prototype.apply.call(e,n,a)},ReflectOwnKeys$1;R$1&&typeof R$1.ownKeys=="function"?ReflectOwnKeys$1=R$1.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys$1=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ReflectOwnKeys$1=function(e){return Object.getOwnPropertyNames(e)};function ProcessEmitWarning$1(t){console&&console.warn&&console.warn(t)}var NumberIsNaN$1=Number.isNaN||function(e){return e!==e};function EventEmitter$1(){EventEmitter$1.init.call(this)}events$1.exports=EventEmitter$1;events$1.exports.once=once$3;EventEmitter$1.EventEmitter=EventEmitter$1;EventEmitter$1.prototype._events=void 0;EventEmitter$1.prototype._eventsCount=0;EventEmitter$1.prototype._maxListeners=void 0;var defaultMaxListeners$1=10;function checkListener$1(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(EventEmitter$1,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners$1},set:function(t){if(typeof t!="number"||t<0||NumberIsNaN$1(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");defaultMaxListeners$1=t}});EventEmitter$1.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};EventEmitter$1.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||NumberIsNaN$1(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function _getMaxListeners$1(t){return t._maxListeners===void 0?EventEmitter$1.defaultMaxListeners:t._maxListeners}EventEmitter$1.prototype.getMaxListeners=function(){return _getMaxListeners$1(this)};EventEmitter$1.prototype.emit=function(e){for(var n=[],a=1;a<arguments.length;a++)n.push(arguments[a]);var s=e==="error",c=this._events;if(c!==void 0)s=s&&c.error===void 0;else if(!s)return!1;if(s){var u;if(n.length>0&&(u=n[0]),u instanceof Error)throw u;var d=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw d.context=u,d}var m=c[e];if(m===void 0)return!1;if(typeof m=="function")ReflectApply$1(m,this,n);else for(var _=m.length,b=arrayClone$1(m,_),a=0;a<_;++a)ReflectApply$1(b[a],this,n);return!0};function _addListener$1(t,e,n,a){var s,c,u;if(checkListener$1(n),c=t._events,c===void 0?(c=t._events=Object.create(null),t._eventsCount=0):(c.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),c=t._events),u=c[e]),u===void 0)u=c[e]=n,++t._eventsCount;else if(typeof u=="function"?u=c[e]=a?[n,u]:[u,n]:a?u.unshift(n):u.push(n),s=_getMaxListeners$1(t),s>0&&u.length>s&&!u.warned){u.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=t,d.type=e,d.count=u.length,ProcessEmitWarning$1(d)}return t}EventEmitter$1.prototype.addListener=function(e,n){return _addListener$1(this,e,n,!1)};EventEmitter$1.prototype.on=EventEmitter$1.prototype.addListener;EventEmitter$1.prototype.prependListener=function(e,n){return _addListener$1(this,e,n,!0)};function onceWrapper$1(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap$1(t,e,n){var a={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},s=onceWrapper$1.bind(a);return s.listener=n,a.wrapFn=s,s}EventEmitter$1.prototype.once=function(e,n){return checkListener$1(n),this.on(e,_onceWrap$1(this,e,n)),this};EventEmitter$1.prototype.prependOnceListener=function(e,n){return checkListener$1(n),this.prependListener(e,_onceWrap$1(this,e,n)),this};EventEmitter$1.prototype.removeListener=function(e,n){var a,s,c,u,d;if(checkListener$1(n),s=this._events,s===void 0)return this;if(a=s[e],a===void 0)return this;if(a===n||a.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,a.listener||n));else if(typeof a!="function"){for(c=-1,u=a.length-1;u>=0;u--)if(a[u]===n||a[u].listener===n){d=a[u].listener,c=u;break}if(c<0)return this;c===0?a.shift():spliceOne$1(a,c),a.length===1&&(s[e]=a[0]),s.removeListener!==void 0&&this.emit("removeListener",e,d||n)}return this};EventEmitter$1.prototype.off=EventEmitter$1.prototype.removeListener;EventEmitter$1.prototype.removeAllListeners=function(e){var n,a,s;if(a=this._events,a===void 0)return this;if(a.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):a[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete a[e]),this;if(arguments.length===0){var c=Object.keys(a),u;for(s=0;s<c.length;++s)u=c[s],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=a[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(s=n.length-1;s>=0;s--)this.removeListener(e,n[s]);return this};function _listeners$1(t,e,n){var a=t._events;if(a===void 0)return[];var s=a[e];return s===void 0?[]:typeof s=="function"?n?[s.listener||s]:[s]:n?unwrapListeners$1(s):arrayClone$1(s,s.length)}EventEmitter$1.prototype.listeners=function(e){return _listeners$1(this,e,!0)};EventEmitter$1.prototype.rawListeners=function(e){return _listeners$1(this,e,!1)};EventEmitter$1.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):listenerCount$1.call(t,e)};EventEmitter$1.prototype.listenerCount=listenerCount$1;function listenerCount$1(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}EventEmitter$1.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys$1(this._events):[]};function arrayClone$1(t,e){for(var n=new Array(e),a=0;a<e;++a)n[a]=t[a];return n}function spliceOne$1(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function unwrapListeners$1(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function once$3(t,e){return new Promise(function(n,a){function s(u){t.removeListener(e,c),a(u)}function c(){typeof t.removeListener=="function"&&t.removeListener("error",s),n([].slice.call(arguments))}eventTargetAgnosticAddListener$1(t,e,c,{once:!0}),e!=="error"&&addErrorHandlerIfEventEmitter$1(t,s,{once:!0})})}function addErrorHandlerIfEventEmitter$1(t,e,n){typeof t.on=="function"&&eventTargetAgnosticAddListener$1(t,"error",e,n)}function eventTargetAgnosticAddListener$1(t,e,n,a){if(typeof t.on=="function")a.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function s(c){a.once&&t.removeEventListener(e,s),n(c)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var eventsExports$1=events$1.exports;let logDisabled_=!0,deprecationWarnings_=!0;function extractVersion(t,e,n){const a=t.match(e);return a&&a.length>=n&&parseInt(a[n],10)}function wrapPeerConnectionEvent(t,e,n){if(!t.RTCPeerConnection)return;const a=t.RTCPeerConnection.prototype,s=a.addEventListener;a.addEventListener=function(u,d){if(u!==e)return s.apply(this,arguments);const m=_=>{const b=n(_);b&&(d.handleEvent?d.handleEvent(b):d(b))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(d,m),s.apply(this,[u,m])};const c=a.removeEventListener;a.removeEventListener=function(u,d){if(u!==e||!this._eventMap||!this._eventMap[e])return c.apply(this,arguments);if(!this._eventMap[e].has(d))return c.apply(this,arguments);const m=this._eventMap[e].get(d);return this._eventMap[e].delete(d),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,c.apply(this,[u,m])},Object.defineProperty(a,"on"+e,{get(){return this["_on"+e]},set(u){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),u&&this.addEventListener(e,this["_on"+e]=u)},enumerable:!0,configurable:!0})}function disableLog(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(logDisabled_=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function disableWarnings(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(deprecationWarnings_=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function log(){if(typeof window=="object"){if(logDisabled_)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function deprecated(t,e){deprecationWarnings_&&console.warn(t+" is deprecated, please use "+e+" instead.")}function detectBrowser(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=extractVersion(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=extractVersion(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=extractVersion(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function isObject$1(t){return Object.prototype.toString.call(t)==="[object Object]"}function compactObject(t){return isObject$1(t)?Object.keys(t).reduce(function(e,n){const a=isObject$1(t[n]),s=a?compactObject(t[n]):t[n],c=a&&!Object.keys(s).length;return s===void 0||c?e:Object.assign(e,{[n]:s})},{}):t}function walkStats(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(a=>{a.endsWith("Id")?walkStats(t,t.get(e[a]),n):a.endsWith("Ids")&&e[a].forEach(s=>{walkStats(t,t.get(s),n)})}))}function filterStats(t,e,n){const a=n?"outbound-rtp":"inbound-rtp",s=new Map;if(e===null)return s;const c=[];return t.forEach(u=>{u.type==="track"&&u.trackIdentifier===e.id&&c.push(u)}),c.forEach(u=>{t.forEach(d=>{d.type===a&&d.trackId===u.id&&walkStats(t,d,s)})}),s}const logging=log;function shimGetUserMedia$2(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const a=function(d){if(typeof d!="object"||d.mandatory||d.optional)return d;const m={};return Object.keys(d).forEach(_=>{if(_==="require"||_==="advanced"||_==="mediaSource")return;const b=typeof d[_]=="object"?d[_]:{ideal:d[_]};b.exact!==void 0&&typeof b.exact=="number"&&(b.min=b.max=b.exact);const S=function(k,w){return k?k+w.charAt(0).toUpperCase()+w.slice(1):w==="deviceId"?"sourceId":w};if(b.ideal!==void 0){m.optional=m.optional||[];let k={};typeof b.ideal=="number"?(k[S("min",_)]=b.ideal,m.optional.push(k),k={},k[S("max",_)]=b.ideal,m.optional.push(k)):(k[S("",_)]=b.ideal,m.optional.push(k))}b.exact!==void 0&&typeof b.exact!="number"?(m.mandatory=m.mandatory||{},m.mandatory[S("",_)]=b.exact):["min","max"].forEach(k=>{b[k]!==void 0&&(m.mandatory=m.mandatory||{},m.mandatory[S(k,_)]=b[k])})}),d.advanced&&(m.optional=(m.optional||[]).concat(d.advanced)),m},s=function(d,m){if(e.version>=61)return m(d);if(d=JSON.parse(JSON.stringify(d)),d&&typeof d.audio=="object"){const _=function(b,S,k){S in b&&!(k in b)&&(b[k]=b[S],delete b[S])};d=JSON.parse(JSON.stringify(d)),_(d.audio,"autoGainControl","googAutoGainControl"),_(d.audio,"noiseSuppression","googNoiseSuppression"),d.audio=a(d.audio)}if(d&&typeof d.video=="object"){let _=d.video.facingMode;_=_&&(typeof _=="object"?_:{ideal:_});const b=e.version<66;if(_&&(_.exact==="user"||_.exact==="environment"||_.ideal==="user"||_.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!b)){delete d.video.facingMode;let S;if(_.exact==="environment"||_.ideal==="environment"?S=["back","rear"]:(_.exact==="user"||_.ideal==="user")&&(S=["front"]),S)return n.mediaDevices.enumerateDevices().then(k=>{k=k.filter(O=>O.kind==="videoinput");let w=k.find(O=>S.some(P=>O.label.toLowerCase().includes(P)));return!w&&k.length&&S.includes("back")&&(w=k[k.length-1]),w&&(d.video.deviceId=_.exact?{exact:w.deviceId}:{ideal:w.deviceId}),d.video=a(d.video),logging("chrome: "+JSON.stringify(d)),m(d)})}d.video=a(d.video)}return logging("chrome: "+JSON.stringify(d)),m(d)},c=function(d){return e.version>=64?d:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[d.name]||d.name,message:d.message,constraint:d.constraint||d.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},u=function(d,m,_){s(d,b=>{n.webkitGetUserMedia(b,m,S=>{_&&_(c(S))})})};if(n.getUserMedia=u.bind(n),n.mediaDevices.getUserMedia){const d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(m){return s(m,_=>d(_).then(b=>{if(_.audio&&!b.getAudioTracks().length||_.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(S=>{S.stop()}),new DOMException("","NotFoundError");return b},b=>Promise.reject(c(b))))}}}function shimGetDisplayMedia$1(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(a){return e(a).then(s=>{const c=a.video&&a.video.width,u=a.video&&a.video.height,d=a.video&&a.video.frameRate;return a.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:s,maxFrameRate:d||3}},c&&(a.video.mandatory.maxWidth=c),u&&(a.video.mandatory.maxHeight=u),t.navigator.mediaDevices.getUserMedia(a)})}}}function shimMediaStream(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function shimOnTrack$1(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=a=>{a.stream.addEventListener("addtrack",s=>{let c;t.RTCPeerConnection.prototype.getReceivers?c=this.getReceivers().find(d=>d.track&&d.track.id===s.track.id):c={track:s.track};const u=new Event("track");u.track=s.track,u.receiver=c,u.transceiver={receiver:c},u.streams=[a.stream],this.dispatchEvent(u)}),a.stream.getTracks().forEach(s=>{let c;t.RTCPeerConnection.prototype.getReceivers?c=this.getReceivers().find(d=>d.track&&d.track.id===s.id):c={track:s};const u=new Event("track");u.track=s,u.receiver=c,u.transceiver={receiver:c},u.streams=[a.stream],this.dispatchEvent(u)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else wrapPeerConnectionEvent(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function shimGetSendersWithDtmf(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(s,c){return{track:c,get dtmf(){return this._dtmf===void 0&&(c.kind==="audio"?this._dtmf=s.createDTMFSender(c):this._dtmf=null),this._dtmf},_pc:s}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const s=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(d,m){let _=s.apply(this,arguments);return _||(_=e(this,d),this._senders.push(_)),_};const c=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(d){c.apply(this,arguments);const m=this._senders.indexOf(d);m!==-1&&this._senders.splice(m,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(c){this._senders=this._senders||[],n.apply(this,[c]),c.getTracks().forEach(u=>{this._senders.push(e(this,u))})};const a=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(c){this._senders=this._senders||[],a.apply(this,[c]),c.getTracks().forEach(u=>{const d=this._senders.find(m=>m.track===u);d&&this._senders.splice(this._senders.indexOf(d),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const a=e.apply(this,[]);return a.forEach(s=>s._pc=this),a},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function shimGetStats(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[a,s,c]=arguments;if(arguments.length>0&&typeof a=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof a!="function"))return e.apply(this,[]);const u=function(m){const _={};return m.result().forEach(S=>{const k={id:S.id,timestamp:S.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[S.type]||S.type};S.names().forEach(w=>{k[w]=S.stat(w)}),_[k.id]=k}),_},d=function(m){return new Map(Object.keys(m).map(_=>[_,m[_]]))};if(arguments.length>=2){const m=function(_){s(d(u(_)))};return e.apply(this,[m,a])}return new Promise((m,_)=>{e.apply(this,[function(b){m(d(u(b)))},_])}).then(s,c)}}function shimSenderReceiverGetStats(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const c=n.apply(this,[]);return c.forEach(u=>u._pc=this),c});const a=t.RTCPeerConnection.prototype.addTrack;a&&(t.RTCPeerConnection.prototype.addTrack=function(){const c=a.apply(this,arguments);return c._pc=this,c}),t.RTCRtpSender.prototype.getStats=function(){const c=this;return this._pc.getStats().then(u=>filterStats(u,c.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const s=n.apply(this,[]);return s.forEach(c=>c._pc=this),s}),wrapPeerConnectionEvent(t,"track",a=>(a.receiver._pc=a.srcElement,a)),t.RTCRtpReceiver.prototype.getStats=function(){const s=this;return this._pc.getStats().then(c=>filterStats(c,s.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const a=arguments[0];let s,c,u;return this.getSenders().forEach(d=>{d.track===a&&(s?u=!0:s=d)}),this.getReceivers().forEach(d=>(d.track===a&&(c?u=!0:c=d),d.track===a)),u||s&&c?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):s?s.getStats():c?c.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function shimAddTrackRemoveTrackWithNative(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(u=>this._shimmedLocalStreams[u][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(u,d){if(!d)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const m=e.apply(this,arguments);return this._shimmedLocalStreams[d.id]?this._shimmedLocalStreams[d.id].indexOf(m)===-1&&this._shimmedLocalStreams[d.id].push(m):this._shimmedLocalStreams[d.id]=[d,m],m};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){this._shimmedLocalStreams=this._shimmedLocalStreams||{},u.getTracks().forEach(_=>{if(this.getSenders().find(S=>S.track===_))throw new DOMException("Track already exists.","InvalidAccessError")});const d=this.getSenders();n.apply(this,arguments);const m=this.getSenders().filter(_=>d.indexOf(_)===-1);this._shimmedLocalStreams[u.id]=[u].concat(m)};const a=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[u.id],a.apply(this,arguments)};const s=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(u){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},u&&Object.keys(this._shimmedLocalStreams).forEach(d=>{const m=this._shimmedLocalStreams[d].indexOf(u);m!==-1&&this._shimmedLocalStreams[d].splice(m,1),this._shimmedLocalStreams[d].length===1&&delete this._shimmedLocalStreams[d]}),s.apply(this,arguments)}}function shimAddTrackRemoveTrack(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return shimAddTrackRemoveTrackWithNative(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const b=n.apply(this);return this._reverseStreams=this._reverseStreams||{},b.map(S=>this._reverseStreams[S.id])};const a=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(b){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},b.getTracks().forEach(S=>{if(this.getSenders().find(w=>w.track===S))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[b.id]){const S=new t.MediaStream(b.getTracks());this._streams[b.id]=S,this._reverseStreams[S.id]=b,b=S}a.apply(this,[b])};const s=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(b){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[b.id]||b]),delete this._reverseStreams[this._streams[b.id]?this._streams[b.id].id:b.id],delete this._streams[b.id]},t.RTCPeerConnection.prototype.addTrack=function(b,S){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const k=[].slice.call(arguments,1);if(k.length!==1||!k[0].getTracks().find(P=>P===b))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(P=>P.track===b))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const O=this._streams[S.id];if(O)O.addTrack(b),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const P=new t.MediaStream([b]);this._streams[S.id]=P,this._reverseStreams[P.id]=S,this.addStream(P)}return this.getSenders().find(P=>P.track===b)};function c(_,b){let S=b.sdp;return Object.keys(_._reverseStreams||[]).forEach(k=>{const w=_._reverseStreams[k],O=_._streams[w.id];S=S.replace(new RegExp(O.id,"g"),w.id)}),new RTCSessionDescription({type:b.type,sdp:S})}function u(_,b){let S=b.sdp;return Object.keys(_._reverseStreams||[]).forEach(k=>{const w=_._reverseStreams[k],O=_._streams[w.id];S=S.replace(new RegExp(w.id,"g"),O.id)}),new RTCSessionDescription({type:b.type,sdp:S})}["createOffer","createAnswer"].forEach(function(_){const b=t.RTCPeerConnection.prototype[_],S={[_](){const k=arguments;return arguments.length&&typeof arguments[0]=="function"?b.apply(this,[O=>{const P=c(this,O);k[0].apply(null,[P])},O=>{k[1]&&k[1].apply(null,O)},arguments[2]]):b.apply(this,arguments).then(O=>c(this,O))}};t.RTCPeerConnection.prototype[_]=S[_]});const d=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?d.apply(this,arguments):(arguments[0]=u(this,arguments[0]),d.apply(this,arguments))};const m=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const _=m.get.apply(this);return _.type===""?_:c(this,_)}}),t.RTCPeerConnection.prototype.removeTrack=function(b){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!b._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(b._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let k;Object.keys(this._streams).forEach(w=>{this._streams[w].getTracks().find(P=>b.track===P)&&(k=this._streams[w])}),k&&(k.getTracks().length===1?this.removeStream(this._reverseStreams[k.id]):k.removeTrack(b.track),this.dispatchEvent(new Event("negotiationneeded")))}}function shimPeerConnection$1(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const a=t.RTCPeerConnection.prototype[n],s={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=s[n]})}function fixNegotiationNeeded(t,e){wrapPeerConnectionEvent(t,"negotiationneeded",n=>{const a=n.target;if(!((e.version<72||a.getConfiguration&&a.getConfiguration().sdpSemantics==="plan-b")&&a.signalingState!=="stable"))return n})}var chromeShim=Object.freeze({__proto__:null,fixNegotiationNeeded,shimAddTrackRemoveTrack,shimAddTrackRemoveTrackWithNative,shimGetDisplayMedia:shimGetDisplayMedia$1,shimGetSendersWithDtmf,shimGetStats,shimGetUserMedia:shimGetUserMedia$2,shimMediaStream,shimOnTrack:shimOnTrack$1,shimPeerConnection:shimPeerConnection$1,shimSenderReceiverGetStats});function shimGetUserMedia$1(t,e){const n=t&&t.navigator,a=t&&t.MediaStreamTrack;if(n.getUserMedia=function(s,c,u){deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(s).then(c,u)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const s=function(u,d,m){d in u&&!(m in u)&&(u[m]=u[d],delete u[d])},c=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(u){return typeof u=="object"&&typeof u.audio=="object"&&(u=JSON.parse(JSON.stringify(u)),s(u.audio,"autoGainControl","mozAutoGainControl"),s(u.audio,"noiseSuppression","mozNoiseSuppression")),c(u)},a&&a.prototype.getSettings){const u=a.prototype.getSettings;a.prototype.getSettings=function(){const d=u.apply(this,arguments);return s(d,"mozAutoGainControl","autoGainControl"),s(d,"mozNoiseSuppression","noiseSuppression"),d}}if(a&&a.prototype.applyConstraints){const u=a.prototype.applyConstraints;a.prototype.applyConstraints=function(d){return this.kind==="audio"&&typeof d=="object"&&(d=JSON.parse(JSON.stringify(d)),s(d,"autoGainControl","mozAutoGainControl"),s(d,"noiseSuppression","mozNoiseSuppression")),u.apply(this,[d])}}}}function shimGetDisplayMedia(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(a){if(!(a&&a.video)){const s=new DOMException("getDisplayMedia without video constraints is undefined");return s.name="NotFoundError",s.code=8,Promise.reject(s)}return a.video===!0?a.video={mediaSource:e}:a.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(a)})}function shimOnTrack(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimPeerConnection(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(s){const c=t.RTCPeerConnection.prototype[s],u={[s](){return arguments[0]=new(s==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}};t.RTCPeerConnection.prototype[s]=u[s]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[c,u,d]=arguments;return a.apply(this,[c||null]).then(m=>{if(e.version<53&&!u)try{m.forEach(_=>{_.type=n[_.type]||_.type})}catch(_){if(_.name!=="TypeError")throw _;m.forEach((b,S)=>{m.set(S,Object.assign({},b,{type:n[b.type]||b.type}))})}return m}).then(u,d)}}function shimSenderGetStats(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=e.apply(this,[]);return s.forEach(c=>c._pc=this),s});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=n.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function shimReceiverGetStats(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const a=e.apply(this,[]);return a.forEach(s=>s._pc=this),a}),wrapPeerConnectionEvent(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function shimRemoveStream(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){deprecated("removeStream","removeTrack"),this.getSenders().forEach(a=>{a.track&&n.getTracks().includes(a.track)&&this.removeTrack(a)})})}function shimRTCDataChannel(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function shimAddTransceiver(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let a=arguments[1]&&arguments[1].sendEncodings;a===void 0&&(a=[]),a=[...a];const s=a.length>0;s&&a.forEach(u=>{if("rid"in u&&!/^[a-z0-9]{0,16}$/i.test(u.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in u&&!(parseFloat(u.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in u&&!(parseFloat(u.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const c=e.apply(this,arguments);if(s){const{sender:u}=c,d=u.getParameters();(!("encodings"in d)||d.encodings.length===1&&Object.keys(d.encodings[0]).length===0)&&(d.encodings=a,u.sendEncodings=a,this.setParametersPromises.push(u.setParameters(d).then(()=>{delete u.sendEncodings}).catch(()=>{delete u.sendEncodings})))}return c})}function shimGetParameters(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const a=e.apply(this,arguments);return"encodings"in a||(a.encodings=[].concat(this.sendEncodings||[{}])),a})}function shimCreateOffer(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function shimCreateAnswer(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var firefoxShim=Object.freeze({__proto__:null,shimAddTransceiver,shimCreateAnswer,shimCreateOffer,shimGetDisplayMedia,shimGetParameters,shimGetUserMedia:shimGetUserMedia$1,shimOnTrack,shimPeerConnection,shimRTCDataChannel,shimReceiverGetStats,shimRemoveStream,shimSenderGetStats});function shimLocalStreamsAPI(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(a){this._localStreams||(this._localStreams=[]),this._localStreams.includes(a)||this._localStreams.push(a),a.getAudioTracks().forEach(s=>e.call(this,s,a)),a.getVideoTracks().forEach(s=>e.call(this,s,a))},t.RTCPeerConnection.prototype.addTrack=function(a){for(var s=arguments.length,c=new Array(s>1?s-1:0),u=1;u<s;u++)c[u-1]=arguments[u];return c&&c.forEach(d=>{this._localStreams?this._localStreams.includes(d)||this._localStreams.push(d):this._localStreams=[d]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const a=this._localStreams.indexOf(n);if(a===-1)return;this._localStreams.splice(a,1);const s=n.getTracks();this.getSenders().forEach(c=>{s.includes(c.track)&&this.removeTrack(c)})})}}function shimRemoteStreamsAPI(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=a=>{a.streams.forEach(s=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(s))return;this._remoteStreams.push(s);const c=new Event("addstream");c.stream=s,this.dispatchEvent(c)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const a=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(s){s.streams.forEach(c=>{if(a._remoteStreams||(a._remoteStreams=[]),a._remoteStreams.indexOf(c)>=0)return;a._remoteStreams.push(c);const u=new Event("addstream");u.stream=c,a.dispatchEvent(u)})}),e.apply(a,arguments)}}}function shimCallbacksAPI(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,a=e.createAnswer,s=e.setLocalDescription,c=e.setRemoteDescription,u=e.addIceCandidate;e.createOffer=function(_,b){const S=arguments.length>=2?arguments[2]:arguments[0],k=n.apply(this,[S]);return b?(k.then(_,b),Promise.resolve()):k},e.createAnswer=function(_,b){const S=arguments.length>=2?arguments[2]:arguments[0],k=a.apply(this,[S]);return b?(k.then(_,b),Promise.resolve()):k};let d=function(m,_,b){const S=s.apply(this,[m]);return b?(S.then(_,b),Promise.resolve()):S};e.setLocalDescription=d,d=function(m,_,b){const S=c.apply(this,[m]);return b?(S.then(_,b),Promise.resolve()):S},e.setRemoteDescription=d,d=function(m,_,b){const S=u.apply(this,[m]);return b?(S.then(_,b),Promise.resolve()):S},e.addIceCandidate=d}function shimGetUserMedia(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,a=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=s=>a(shimConstraints(s))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(a,s,c){e.mediaDevices.getUserMedia(a).then(s,c)}).bind(e))}function shimConstraints(t){return t&&t.video!==void 0?Object.assign({},t,{video:compactObject(t.video)}):t}function shimRTCIceServerUrls(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(a,s){if(a&&a.iceServers){const c=[];for(let u=0;u<a.iceServers.length;u++){let d=a.iceServers[u];d.urls===void 0&&d.url?(deprecated("RTCIceServer.url","RTCIceServer.urls"),d=JSON.parse(JSON.stringify(d)),d.urls=d.url,delete d.url,c.push(d)):c.push(a.iceServers[u])}a.iceServers=c}return new e(a,s)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function shimTrackEventTransceiver(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function shimCreateOfferLegacy(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(a){if(a){typeof a.offerToReceiveAudio<"u"&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);const s=this.getTransceivers().find(u=>u.receiver.track.kind==="audio");a.offerToReceiveAudio===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):a.offerToReceiveAudio===!0&&!s&&this.addTransceiver("audio",{direction:"recvonly"}),typeof a.offerToReceiveVideo<"u"&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);const c=this.getTransceivers().find(u=>u.receiver.track.kind==="video");a.offerToReceiveVideo===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):a.offerToReceiveVideo===!0&&!c&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function shimAudioContext(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var safariShim=Object.freeze({__proto__:null,shimAudioContext,shimCallbacksAPI,shimConstraints,shimCreateOfferLegacy,shimGetUserMedia,shimLocalStreamsAPI,shimRTCIceServerUrls,shimRemoteStreamsAPI,shimTrackEventTransceiver}),sdp$1={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(a=>a.trim())},e.splitSections=function(n){return n.split(`
m=`).map((s,c)=>(c>0?"m="+s:s).trim()+`\r
`)},e.getDescription=function(n){const a=e.splitSections(n);return a&&a[0]},e.getMediaSections=function(n){const a=e.splitSections(n);return a.shift(),a},e.matchPrefix=function(n,a){return e.splitLines(n).filter(s=>s.indexOf(a)===0)},e.parseCandidate=function(n){let a;n.indexOf("a=candidate:")===0?a=n.substring(12).split(" "):a=n.substring(10).split(" ");const s={foundation:a[0],component:{1:"rtp",2:"rtcp"}[a[1]]||a[1],protocol:a[2].toLowerCase(),priority:parseInt(a[3],10),ip:a[4],address:a[4],port:parseInt(a[5],10),type:a[7]};for(let c=8;c<a.length;c+=2)switch(a[c]){case"raddr":s.relatedAddress=a[c+1];break;case"rport":s.relatedPort=parseInt(a[c+1],10);break;case"tcptype":s.tcpType=a[c+1];break;case"ufrag":s.ufrag=a[c+1],s.usernameFragment=a[c+1];break;default:s[a[c]]===void 0&&(s[a[c]]=a[c+1]);break}return s},e.writeCandidate=function(n){const a=[];a.push(n.foundation);const s=n.component;s==="rtp"?a.push(1):s==="rtcp"?a.push(2):a.push(s),a.push(n.protocol.toUpperCase()),a.push(n.priority),a.push(n.address||n.ip),a.push(n.port);const c=n.type;return a.push("typ"),a.push(c),c!=="host"&&n.relatedAddress&&n.relatedPort&&(a.push("raddr"),a.push(n.relatedAddress),a.push("rport"),a.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(a.push("tcptype"),a.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(a.push("ufrag"),a.push(n.usernameFragment||n.ufrag)),"candidate:"+a.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let a=n.substring(9).split(" ");const s={payloadType:parseInt(a.shift(),10)};return a=a[0].split("/"),s.name=a[0],s.clockRate=parseInt(a[1],10),s.channels=a.length===3?parseInt(a[2],10):1,s.numChannels=s.channels,s},e.writeRtpMap=function(n){let a=n.payloadType;n.preferredPayloadType!==void 0&&(a=n.preferredPayloadType);const s=n.channels||n.numChannels||1;return"a=rtpmap:"+a+" "+n.name+"/"+n.clockRate+(s!==1?"/"+s:"")+`\r
`},e.parseExtmap=function(n){const a=n.substring(9).split(" ");return{id:parseInt(a[0],10),direction:a[0].indexOf("/")>0?a[0].split("/")[1]:"sendrecv",uri:a[1],attributes:a.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const a={};let s;const c=n.substring(n.indexOf(" ")+1).split(";");for(let u=0;u<c.length;u++)s=c[u].trim().split("="),a[s[0].trim()]=s[1];return a},e.writeFmtp=function(n){let a="",s=n.payloadType;if(n.preferredPayloadType!==void 0&&(s=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const c=[];Object.keys(n.parameters).forEach(u=>{n.parameters[u]!==void 0?c.push(u+"="+n.parameters[u]):c.push(u)}),a+="a=fmtp:"+s+" "+c.join(";")+`\r
`}return a},e.parseRtcpFb=function(n){const a=n.substring(n.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}},e.writeRtcpFb=function(n){let a="",s=n.payloadType;return n.preferredPayloadType!==void 0&&(s=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(c=>{a+="a=rtcp-fb:"+s+" "+c.type+(c.parameter&&c.parameter.length?" "+c.parameter:"")+`\r
`}),a},e.parseSsrcMedia=function(n){const a=n.indexOf(" "),s={ssrc:parseInt(n.substring(7,a),10)},c=n.indexOf(":",a);return c>-1?(s.attribute=n.substring(a+1,c),s.value=n.substring(c+1)):s.attribute=n.substring(a+1),s},e.parseSsrcGroup=function(n){const a=n.substring(13).split(" ");return{semantics:a.shift(),ssrcs:a.map(s=>parseInt(s,10))}},e.getMid=function(n){const a=e.matchPrefix(n,"a=mid:")[0];if(a)return a.substring(6)},e.parseFingerprint=function(n){const a=n.substring(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1].toUpperCase()}},e.getDtlsParameters=function(n,a){return{role:"auto",fingerprints:e.matchPrefix(n+a,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,a){let s="a=setup:"+a+`\r
`;return n.fingerprints.forEach(c=>{s+="a=fingerprint:"+c.algorithm+" "+c.value+`\r
`}),s},e.parseCryptoLine=function(n){const a=n.substring(9).split(" ");return{tag:parseInt(a[0],10),cryptoSuite:a[1],keyParams:a[2],sessionParams:a.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const a=n.substring(7).split("|");return{keyMethod:"inline",keySalt:a[0],lifeTime:a[1],mkiValue:a[2]?a[2].split(":")[0]:void 0,mkiLength:a[2]?a[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,a){return e.matchPrefix(n+a,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,a){const s=e.matchPrefix(n+a,"a=ice-ufrag:")[0],c=e.matchPrefix(n+a,"a=ice-pwd:")[0];return s&&c?{usernameFragment:s.substring(12),password:c.substring(10)}:null},e.writeIceParameters=function(n){let a="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(a+=`a=ice-lite\r
`),a},e.parseRtpParameters=function(n){const a={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=e.splitLines(n)[0].split(" ");a.profile=c[2];for(let d=3;d<c.length;d++){const m=c[d],_=e.matchPrefix(n,"a=rtpmap:"+m+" ")[0];if(_){const b=e.parseRtpMap(_),S=e.matchPrefix(n,"a=fmtp:"+m+" ");switch(b.parameters=S.length?e.parseFmtp(S[0]):{},b.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+m+" ").map(e.parseRtcpFb),a.codecs.push(b),b.name.toUpperCase()){case"RED":case"ULPFEC":a.fecMechanisms.push(b.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(d=>{a.headerExtensions.push(e.parseExtmap(d))});const u=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return a.codecs.forEach(d=>{u.forEach(m=>{d.rtcpFeedback.find(b=>b.type===m.type&&b.parameter===m.parameter)||d.rtcpFeedback.push(m)})}),a},e.writeRtpDescription=function(n,a){let s="";s+="m="+n+" ",s+=a.codecs.length>0?"9":"0",s+=" "+(a.profile||"UDP/TLS/RTP/SAVPF")+" ",s+=a.codecs.map(u=>u.preferredPayloadType!==void 0?u.preferredPayloadType:u.payloadType).join(" ")+`\r
`,s+=`c=IN IP4 0.0.0.0\r
`,s+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,a.codecs.forEach(u=>{s+=e.writeRtpMap(u),s+=e.writeFmtp(u),s+=e.writeRtcpFb(u)});let c=0;return a.codecs.forEach(u=>{u.maxptime>c&&(c=u.maxptime)}),c>0&&(s+="a=maxptime:"+c+`\r
`),a.headerExtensions&&a.headerExtensions.forEach(u=>{s+=e.writeExtmap(u)}),s},e.parseRtpEncodingParameters=function(n){const a=[],s=e.parseRtpParameters(n),c=s.fecMechanisms.indexOf("RED")!==-1,u=s.fecMechanisms.indexOf("ULPFEC")!==-1,d=e.matchPrefix(n,"a=ssrc:").map(k=>e.parseSsrcMedia(k)).filter(k=>k.attribute==="cname"),m=d.length>0&&d[0].ssrc;let _;const b=e.matchPrefix(n,"a=ssrc-group:FID").map(k=>k.substring(17).split(" ").map(O=>parseInt(O,10)));b.length>0&&b[0].length>1&&b[0][0]===m&&(_=b[0][1]),s.codecs.forEach(k=>{if(k.name.toUpperCase()==="RTX"&&k.parameters.apt){let w={ssrc:m,codecPayloadType:parseInt(k.parameters.apt,10)};m&&_&&(w.rtx={ssrc:_}),a.push(w),c&&(w=JSON.parse(JSON.stringify(w)),w.fec={ssrc:m,mechanism:u?"red+ulpfec":"red"},a.push(w))}}),a.length===0&&m&&a.push({ssrc:m});let S=e.matchPrefix(n,"b=");return S.length&&(S[0].indexOf("b=TIAS:")===0?S=parseInt(S[0].substring(7),10):S[0].indexOf("b=AS:")===0?S=parseInt(S[0].substring(5),10)*1e3*.95-50*40*8:S=void 0,a.forEach(k=>{k.maxBitrate=S})),a},e.parseRtcpParameters=function(n){const a={},s=e.matchPrefix(n,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="cname")[0];s&&(a.cname=s.value,a.ssrc=s.ssrc);const c=e.matchPrefix(n,"a=rtcp-rsize");a.reducedSize=c.length>0,a.compound=c.length===0;const u=e.matchPrefix(n,"a=rtcp-mux");return a.mux=u.length>0,a},e.writeRtcpParameters=function(n){let a="";return n.reducedSize&&(a+=`a=rtcp-rsize\r
`),n.mux&&(a+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(a+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),a},e.parseMsid=function(n){let a;const s=e.matchPrefix(n,"a=msid:");if(s.length===1)return a=s[0].substring(7).split(" "),{stream:a[0],track:a[1]};const c=e.matchPrefix(n,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="msid");if(c.length>0)return a=c[0].value.split(" "),{stream:a[0],track:a[1]}},e.parseSctpDescription=function(n){const a=e.parseMLine(n),s=e.matchPrefix(n,"a=max-message-size:");let c;s.length>0&&(c=parseInt(s[0].substring(19),10)),isNaN(c)&&(c=65536);const u=e.matchPrefix(n,"a=sctp-port:");if(u.length>0)return{port:parseInt(u[0].substring(12),10),protocol:a.fmt,maxMessageSize:c};const d=e.matchPrefix(n,"a=sctpmap:");if(d.length>0){const m=d[0].substring(10).split(" ");return{port:parseInt(m[0],10),protocol:m[1],maxMessageSize:c}}},e.writeSctpDescription=function(n,a){let s=[];return n.protocol!=="DTLS/SCTP"?s=["m="+n.kind+" 9 "+n.protocol+" "+a.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+a.port+`\r
`]:s=["m="+n.kind+" 9 "+n.protocol+" "+a.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+a.port+" "+a.protocol+` 65535\r
`],a.maxMessageSize!==void 0&&s.push("a=max-message-size:"+a.maxMessageSize+`\r
`),s.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,a,s){let c;const u=a!==void 0?a:2;return n?c=n:c=e.generateSessionId(),`v=0\r
o=`+(s||"thisisadapterortc")+" "+c+" "+u+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,a){const s=e.splitLines(n);for(let c=0;c<s.length;c++)switch(s[c]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return s[c].substring(2)}return a?e.getDirection(a):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const s=e.splitLines(n)[0].substring(2).split(" ");return{kind:s[0],port:parseInt(s[1],10),protocol:s[2],fmt:s.slice(3).join(" ")}},e.parseOLine=function(n){const s=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:s[0],sessionId:s[1],sessionVersion:parseInt(s[2],10),netType:s[3],addressType:s[4],address:s[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const a=e.splitLines(n);for(let s=0;s<a.length;s++)if(a[s].length<2||a[s].charAt(1)!=="=")return!1;return!0},t.exports=e})(sdp$1);var sdpExports=sdp$1.exports,SDPUtils=getDefaultExportFromCjs(sdpExports),sdp=_mergeNamespaces({__proto__:null,default:SDPUtils},[sdpExports]);function shimRTCIceCandidate(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(a){if(typeof a=="object"&&a.candidate&&a.candidate.indexOf("a=")===0&&(a=JSON.parse(JSON.stringify(a)),a.candidate=a.candidate.substring(2)),a.candidate&&a.candidate.length){const s=new e(a),c=SDPUtils.parseCandidate(a.candidate);for(const u in c)u in s||Object.defineProperty(s,u,{value:c[u]});return s.toJSON=function(){return{candidate:s.candidate,sdpMid:s.sdpMid,sdpMLineIndex:s.sdpMLineIndex,usernameFragment:s.usernameFragment}},s}return new e(a)},t.RTCIceCandidate.prototype=e.prototype,wrapPeerConnectionEvent(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function shimRTCIceCandidateRelayProtocol(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||wrapPeerConnectionEvent(t,"icecandidate",e=>{if(e.candidate){const n=SDPUtils.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function shimMaxMessageSize(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(d){if(!d||!d.sdp)return!1;const m=SDPUtils.splitSections(d.sdp);return m.shift(),m.some(_=>{const b=SDPUtils.parseMLine(_);return b&&b.kind==="application"&&b.protocol.indexOf("SCTP")!==-1})},a=function(d){const m=d.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(m===null||m.length<2)return-1;const _=parseInt(m[1],10);return _!==_?-1:_},s=function(d){let m=65536;return e.browser==="firefox"&&(e.version<57?d===-1?m=16384:m=2147483637:e.version<60?m=e.version===57?65535:65536:m=2147483637),m},c=function(d,m){let _=65536;e.browser==="firefox"&&e.version===57&&(_=65535);const b=SDPUtils.matchPrefix(d.sdp,"a=max-message-size:");return b.length>0?_=parseInt(b[0].substring(19),10):e.browser==="firefox"&&m!==-1&&(_=2147483637),_},u=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:m}=this.getConfiguration();m==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const m=a(arguments[0]),_=s(m),b=c(arguments[0],m);let S;_===0&&b===0?S=Number.POSITIVE_INFINITY:_===0||b===0?S=Math.max(_,b):S=Math.min(_,b);const k={};Object.defineProperty(k,"maxMessageSize",{get(){return S}}),this._sctp=k}return u.apply(this,arguments)}}function shimSendThrowTypeError(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(a,s){const c=a.send;a.send=function(){const d=arguments[0],m=d.length||d.size||d.byteLength;if(a.readyState==="open"&&s.sctp&&m>s.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+s.sctp.maxMessageSize+" bytes)");return c.apply(a,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const s=n.apply(this,arguments);return e(s,this),s},wrapPeerConnectionEvent(t,"datachannel",a=>(e(a.channel,a.target),a))}function shimConnectionState(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const a=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=s=>{const c=s.target;if(c._lastConnectionState!==c.connectionState){c._lastConnectionState=c.connectionState;const u=new Event("connectionstatechange",s);c.dispatchEvent(u)}return s},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),a.apply(this,arguments)}})}function removeExtmapAllowMixed(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(s){if(s&&s.sdp&&s.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const c=s.sdp.split(`
`).filter(u=>u.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&s instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:s.type,sdp:c}):s.sdp=c}return n.apply(this,arguments)}}function shimAddIceCandidateNullOrEmpty(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function shimParameterlessSetLocalDescription(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let s=arguments[0]||{};if(typeof s!="object"||s.type&&s.sdp)return n.apply(this,arguments);if(s={type:s.type,sdp:s.sdp},!s.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":s.type="offer";break;default:s.type="answer";break}return s.sdp||s.type!=="offer"&&s.type!=="answer"?n.apply(this,[s]):(s.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(u=>n.apply(this,[u]))})}var commonShim=Object.freeze({__proto__:null,removeExtmapAllowMixed,shimAddIceCandidateNullOrEmpty,shimConnectionState,shimMaxMessageSize,shimParameterlessSetLocalDescription,shimRTCIceCandidate,shimRTCIceCandidateRelayProtocol,shimSendThrowTypeError});function adapterFactory(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=log,a=detectBrowser(t),s={browserDetails:a,commonShim,extractVersion,disableLog,disableWarnings,sdp};switch(a.browser){case"chrome":if(!chromeShim||!shimPeerConnection$1||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),s;if(a.version===null)return n("Chrome shim can not determine version, not shimming."),s;n("adapter.js shimming chrome."),s.browserShim=chromeShim,shimAddIceCandidateNullOrEmpty(t,a),shimParameterlessSetLocalDescription(t),shimGetUserMedia$2(t,a),shimMediaStream(t),shimPeerConnection$1(t,a),shimOnTrack$1(t),shimAddTrackRemoveTrack(t,a),shimGetSendersWithDtmf(t),shimGetStats(t),shimSenderReceiverGetStats(t),fixNegotiationNeeded(t,a),shimRTCIceCandidate(t),shimRTCIceCandidateRelayProtocol(t),shimConnectionState(t),shimMaxMessageSize(t,a),shimSendThrowTypeError(t),removeExtmapAllowMixed(t,a);break;case"firefox":if(!firefoxShim||!shimPeerConnection||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),s;n("adapter.js shimming firefox."),s.browserShim=firefoxShim,shimAddIceCandidateNullOrEmpty(t,a),shimParameterlessSetLocalDescription(t),shimGetUserMedia$1(t,a),shimPeerConnection(t,a),shimOnTrack(t),shimRemoveStream(t),shimSenderGetStats(t),shimReceiverGetStats(t),shimRTCDataChannel(t),shimAddTransceiver(t),shimGetParameters(t),shimCreateOffer(t),shimCreateAnswer(t),shimRTCIceCandidate(t),shimConnectionState(t),shimMaxMessageSize(t,a),shimSendThrowTypeError(t);break;case"safari":if(!safariShim||!e.shimSafari)return n("Safari shim is not included in this adapter release."),s;n("adapter.js shimming safari."),s.browserShim=safariShim,shimAddIceCandidateNullOrEmpty(t,a),shimParameterlessSetLocalDescription(t),shimRTCIceServerUrls(t),shimCreateOfferLegacy(t),shimCallbacksAPI(t),shimLocalStreamsAPI(t),shimRemoteStreamsAPI(t),shimTrackEventTransceiver(t),shimGetUserMedia(t),shimAudioContext(t),shimRTCIceCandidate(t),shimRTCIceCandidateRelayProtocol(t),shimMaxMessageSize(t,a),shimSendThrowTypeError(t),removeExtmapAllowMixed(t,a);break;default:n("Unsupported browser!");break}return s}adapterFactory({window:typeof window>"u"?void 0:window});var SignalTarget;(function(t){t[t.PUBLISHER=0]="PUBLISHER",t[t.SUBSCRIBER=1]="SUBSCRIBER",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(SignalTarget||(SignalTarget={}));function signalTargetFromJSON(t){switch(t){case 0:case"PUBLISHER":return SignalTarget.PUBLISHER;case 1:case"SUBSCRIBER":return SignalTarget.SUBSCRIBER;case-1:case"UNRECOGNIZED":default:return SignalTarget.UNRECOGNIZED}}function signalTargetToJSON(t){switch(t){case SignalTarget.PUBLISHER:return"PUBLISHER";case SignalTarget.SUBSCRIBER:return"SUBSCRIBER";case SignalTarget.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var StreamState;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.PAUSED=1]="PAUSED",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(StreamState||(StreamState={}));function streamStateFromJSON(t){switch(t){case 0:case"ACTIVE":return StreamState.ACTIVE;case 1:case"PAUSED":return StreamState.PAUSED;case-1:case"UNRECOGNIZED":default:return StreamState.UNRECOGNIZED}}function streamStateToJSON(t){switch(t){case StreamState.ACTIVE:return"ACTIVE";case StreamState.PAUSED:return"PAUSED";case StreamState.UNRECOGNIZED:default:return"UNRECOGNIZED"}}var CandidateProtocol;(function(t){t[t.UDP=0]="UDP",t[t.TCP=1]="TCP",t[t.TLS=2]="TLS",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(CandidateProtocol||(CandidateProtocol={}));function candidateProtocolFromJSON(t){switch(t){case 0:case"UDP":return CandidateProtocol.UDP;case 1:case"TCP":return CandidateProtocol.TCP;case 2:case"TLS":return CandidateProtocol.TLS;case-1:case"UNRECOGNIZED":default:return CandidateProtocol.UNRECOGNIZED}}function candidateProtocolToJSON(t){switch(t){case CandidateProtocol.UDP:return"UDP";case CandidateProtocol.TCP:return"TCP";case CandidateProtocol.TLS:return"TLS";case CandidateProtocol.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function createBaseSignalRequest(){return{message:void 0}}const SignalRequest={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();var n;switch((n=t.message)===null||n===void 0?void 0:n.$case){case"offer":SessionDescription.encode(t.message.offer,e.uint32(10).fork()).ldelim();break;case"answer":SessionDescription.encode(t.message.answer,e.uint32(18).fork()).ldelim();break;case"trickle":TrickleRequest.encode(t.message.trickle,e.uint32(26).fork()).ldelim();break;case"addTrack":AddTrackRequest.encode(t.message.addTrack,e.uint32(34).fork()).ldelim();break;case"mute":MuteTrackRequest.encode(t.message.mute,e.uint32(42).fork()).ldelim();break;case"subscription":UpdateSubscription.encode(t.message.subscription,e.uint32(50).fork()).ldelim();break;case"trackSetting":UpdateTrackSettings.encode(t.message.trackSetting,e.uint32(58).fork()).ldelim();break;case"leave":LeaveRequest.encode(t.message.leave,e.uint32(66).fork()).ldelim();break;case"updateLayers":UpdateVideoLayers.encode(t.message.updateLayers,e.uint32(82).fork()).ldelim();break;case"subscriptionPermission":SubscriptionPermission.encode(t.message.subscriptionPermission,e.uint32(90).fork()).ldelim();break;case"syncState":SyncState.encode(t.message.syncState,e.uint32(98).fork()).ldelim();break;case"simulate":SimulateScenario.encode(t.message.simulate,e.uint32(106).fork()).ldelim();break;case"ping":e.uint32(112).int64(t.message.ping);break;case"updateMetadata":UpdateParticipantMetadata.encode(t.message.updateMetadata,e.uint32(122).fork()).ldelim();break;case"pingReq":Ping.encode(t.message.pingReq,e.uint32(130).fork()).ldelim();break}return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSignalRequest();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.message={$case:"offer",offer:SessionDescription.decode(n,n.uint32())};continue;case 2:if(c!=18)break;s.message={$case:"answer",answer:SessionDescription.decode(n,n.uint32())};continue;case 3:if(c!=26)break;s.message={$case:"trickle",trickle:TrickleRequest.decode(n,n.uint32())};continue;case 4:if(c!=34)break;s.message={$case:"addTrack",addTrack:AddTrackRequest.decode(n,n.uint32())};continue;case 5:if(c!=42)break;s.message={$case:"mute",mute:MuteTrackRequest.decode(n,n.uint32())};continue;case 6:if(c!=50)break;s.message={$case:"subscription",subscription:UpdateSubscription.decode(n,n.uint32())};continue;case 7:if(c!=58)break;s.message={$case:"trackSetting",trackSetting:UpdateTrackSettings.decode(n,n.uint32())};continue;case 8:if(c!=66)break;s.message={$case:"leave",leave:LeaveRequest.decode(n,n.uint32())};continue;case 10:if(c!=82)break;s.message={$case:"updateLayers",updateLayers:UpdateVideoLayers.decode(n,n.uint32())};continue;case 11:if(c!=90)break;s.message={$case:"subscriptionPermission",subscriptionPermission:SubscriptionPermission.decode(n,n.uint32())};continue;case 12:if(c!=98)break;s.message={$case:"syncState",syncState:SyncState.decode(n,n.uint32())};continue;case 13:if(c!=106)break;s.message={$case:"simulate",simulate:SimulateScenario.decode(n,n.uint32())};continue;case 14:if(c!=112)break;s.message={$case:"ping",ping:longToNumber(n.int64())};continue;case 15:if(c!=122)break;s.message={$case:"updateMetadata",updateMetadata:UpdateParticipantMetadata.decode(n,n.uint32())};continue;case 16:if(c!=130)break;s.message={$case:"pingReq",pingReq:Ping.decode(n,n.uint32())};continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{message:isSet(t.offer)?{$case:"offer",offer:SessionDescription.fromJSON(t.offer)}:isSet(t.answer)?{$case:"answer",answer:SessionDescription.fromJSON(t.answer)}:isSet(t.trickle)?{$case:"trickle",trickle:TrickleRequest.fromJSON(t.trickle)}:isSet(t.addTrack)?{$case:"addTrack",addTrack:AddTrackRequest.fromJSON(t.addTrack)}:isSet(t.mute)?{$case:"mute",mute:MuteTrackRequest.fromJSON(t.mute)}:isSet(t.subscription)?{$case:"subscription",subscription:UpdateSubscription.fromJSON(t.subscription)}:isSet(t.trackSetting)?{$case:"trackSetting",trackSetting:UpdateTrackSettings.fromJSON(t.trackSetting)}:isSet(t.leave)?{$case:"leave",leave:LeaveRequest.fromJSON(t.leave)}:isSet(t.updateLayers)?{$case:"updateLayers",updateLayers:UpdateVideoLayers.fromJSON(t.updateLayers)}:isSet(t.subscriptionPermission)?{$case:"subscriptionPermission",subscriptionPermission:SubscriptionPermission.fromJSON(t.subscriptionPermission)}:isSet(t.syncState)?{$case:"syncState",syncState:SyncState.fromJSON(t.syncState)}:isSet(t.simulate)?{$case:"simulate",simulate:SimulateScenario.fromJSON(t.simulate)}:isSet(t.ping)?{$case:"ping",ping:Number(t.ping)}:isSet(t.updateMetadata)?{$case:"updateMetadata",updateMetadata:UpdateParticipantMetadata.fromJSON(t.updateMetadata)}:isSet(t.pingReq)?{$case:"pingReq",pingReq:Ping.fromJSON(t.pingReq)}:void 0}},toJSON(t){var e,n,a,s,c,u,d,m,_,b,S,k,w,O,P,N,I,U,$,x,C,H,q,K,W,Z,ee,ie,se,ce,fe,pe,ue,ge,he,_e,re,V,Q,j,le,J,z,X;const te={};return((e=t.message)===null||e===void 0?void 0:e.$case)==="offer"&&(te.offer=!((n=t.message)===null||n===void 0)&&n.offer?SessionDescription.toJSON((a=t.message)===null||a===void 0?void 0:a.offer):void 0),((s=t.message)===null||s===void 0?void 0:s.$case)==="answer"&&(te.answer=!((c=t.message)===null||c===void 0)&&c.answer?SessionDescription.toJSON((u=t.message)===null||u===void 0?void 0:u.answer):void 0),((d=t.message)===null||d===void 0?void 0:d.$case)==="trickle"&&(te.trickle=!((m=t.message)===null||m===void 0)&&m.trickle?TrickleRequest.toJSON((_=t.message)===null||_===void 0?void 0:_.trickle):void 0),((b=t.message)===null||b===void 0?void 0:b.$case)==="addTrack"&&(te.addTrack=!((S=t.message)===null||S===void 0)&&S.addTrack?AddTrackRequest.toJSON((k=t.message)===null||k===void 0?void 0:k.addTrack):void 0),((w=t.message)===null||w===void 0?void 0:w.$case)==="mute"&&(te.mute=!((O=t.message)===null||O===void 0)&&O.mute?MuteTrackRequest.toJSON((P=t.message)===null||P===void 0?void 0:P.mute):void 0),((N=t.message)===null||N===void 0?void 0:N.$case)==="subscription"&&(te.subscription=!((I=t.message)===null||I===void 0)&&I.subscription?UpdateSubscription.toJSON((U=t.message)===null||U===void 0?void 0:U.subscription):void 0),(($=t.message)===null||$===void 0?void 0:$.$case)==="trackSetting"&&(te.trackSetting=!((x=t.message)===null||x===void 0)&&x.trackSetting?UpdateTrackSettings.toJSON((C=t.message)===null||C===void 0?void 0:C.trackSetting):void 0),((H=t.message)===null||H===void 0?void 0:H.$case)==="leave"&&(te.leave=!((q=t.message)===null||q===void 0)&&q.leave?LeaveRequest.toJSON((K=t.message)===null||K===void 0?void 0:K.leave):void 0),((W=t.message)===null||W===void 0?void 0:W.$case)==="updateLayers"&&(te.updateLayers=!((Z=t.message)===null||Z===void 0)&&Z.updateLayers?UpdateVideoLayers.toJSON((ee=t.message)===null||ee===void 0?void 0:ee.updateLayers):void 0),((ie=t.message)===null||ie===void 0?void 0:ie.$case)==="subscriptionPermission"&&(te.subscriptionPermission=!((se=t.message)===null||se===void 0)&&se.subscriptionPermission?SubscriptionPermission.toJSON((ce=t.message)===null||ce===void 0?void 0:ce.subscriptionPermission):void 0),((fe=t.message)===null||fe===void 0?void 0:fe.$case)==="syncState"&&(te.syncState=!((pe=t.message)===null||pe===void 0)&&pe.syncState?SyncState.toJSON((ue=t.message)===null||ue===void 0?void 0:ue.syncState):void 0),((ge=t.message)===null||ge===void 0?void 0:ge.$case)==="simulate"&&(te.simulate=!((he=t.message)===null||he===void 0)&&he.simulate?SimulateScenario.toJSON((_e=t.message)===null||_e===void 0?void 0:_e.simulate):void 0),((re=t.message)===null||re===void 0?void 0:re.$case)==="ping"&&(te.ping=Math.round((V=t.message)===null||V===void 0?void 0:V.ping)),((Q=t.message)===null||Q===void 0?void 0:Q.$case)==="updateMetadata"&&(te.updateMetadata=!((j=t.message)===null||j===void 0)&&j.updateMetadata?UpdateParticipantMetadata.toJSON((le=t.message)===null||le===void 0?void 0:le.updateMetadata):void 0),((J=t.message)===null||J===void 0?void 0:J.$case)==="pingReq"&&(te.pingReq=!((z=t.message)===null||z===void 0)&&z.pingReq?Ping.toJSON((X=t.message)===null||X===void 0?void 0:X.pingReq):void 0),te},create(t){return SignalRequest.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u,d,m,_,b,S,k,w,O,P,N,I,U,$,x,C,H,q,K,W,Z,ee,ie,se,ce,fe,pe,ue,ge,he,_e,re,V,Q,j,le,J,z,X,te;const oe=createBaseSignalRequest();return((e=t.message)===null||e===void 0?void 0:e.$case)==="offer"&&((n=t.message)===null||n===void 0?void 0:n.offer)!==void 0&&((a=t.message)===null||a===void 0?void 0:a.offer)!==null&&(oe.message={$case:"offer",offer:SessionDescription.fromPartial(t.message.offer)}),((s=t.message)===null||s===void 0?void 0:s.$case)==="answer"&&((c=t.message)===null||c===void 0?void 0:c.answer)!==void 0&&((u=t.message)===null||u===void 0?void 0:u.answer)!==null&&(oe.message={$case:"answer",answer:SessionDescription.fromPartial(t.message.answer)}),((d=t.message)===null||d===void 0?void 0:d.$case)==="trickle"&&((m=t.message)===null||m===void 0?void 0:m.trickle)!==void 0&&((_=t.message)===null||_===void 0?void 0:_.trickle)!==null&&(oe.message={$case:"trickle",trickle:TrickleRequest.fromPartial(t.message.trickle)}),((b=t.message)===null||b===void 0?void 0:b.$case)==="addTrack"&&((S=t.message)===null||S===void 0?void 0:S.addTrack)!==void 0&&((k=t.message)===null||k===void 0?void 0:k.addTrack)!==null&&(oe.message={$case:"addTrack",addTrack:AddTrackRequest.fromPartial(t.message.addTrack)}),((w=t.message)===null||w===void 0?void 0:w.$case)==="mute"&&((O=t.message)===null||O===void 0?void 0:O.mute)!==void 0&&((P=t.message)===null||P===void 0?void 0:P.mute)!==null&&(oe.message={$case:"mute",mute:MuteTrackRequest.fromPartial(t.message.mute)}),((N=t.message)===null||N===void 0?void 0:N.$case)==="subscription"&&((I=t.message)===null||I===void 0?void 0:I.subscription)!==void 0&&((U=t.message)===null||U===void 0?void 0:U.subscription)!==null&&(oe.message={$case:"subscription",subscription:UpdateSubscription.fromPartial(t.message.subscription)}),(($=t.message)===null||$===void 0?void 0:$.$case)==="trackSetting"&&((x=t.message)===null||x===void 0?void 0:x.trackSetting)!==void 0&&((C=t.message)===null||C===void 0?void 0:C.trackSetting)!==null&&(oe.message={$case:"trackSetting",trackSetting:UpdateTrackSettings.fromPartial(t.message.trackSetting)}),((H=t.message)===null||H===void 0?void 0:H.$case)==="leave"&&((q=t.message)===null||q===void 0?void 0:q.leave)!==void 0&&((K=t.message)===null||K===void 0?void 0:K.leave)!==null&&(oe.message={$case:"leave",leave:LeaveRequest.fromPartial(t.message.leave)}),((W=t.message)===null||W===void 0?void 0:W.$case)==="updateLayers"&&((Z=t.message)===null||Z===void 0?void 0:Z.updateLayers)!==void 0&&((ee=t.message)===null||ee===void 0?void 0:ee.updateLayers)!==null&&(oe.message={$case:"updateLayers",updateLayers:UpdateVideoLayers.fromPartial(t.message.updateLayers)}),((ie=t.message)===null||ie===void 0?void 0:ie.$case)==="subscriptionPermission"&&((se=t.message)===null||se===void 0?void 0:se.subscriptionPermission)!==void 0&&((ce=t.message)===null||ce===void 0?void 0:ce.subscriptionPermission)!==null&&(oe.message={$case:"subscriptionPermission",subscriptionPermission:SubscriptionPermission.fromPartial(t.message.subscriptionPermission)}),((fe=t.message)===null||fe===void 0?void 0:fe.$case)==="syncState"&&((pe=t.message)===null||pe===void 0?void 0:pe.syncState)!==void 0&&((ue=t.message)===null||ue===void 0?void 0:ue.syncState)!==null&&(oe.message={$case:"syncState",syncState:SyncState.fromPartial(t.message.syncState)}),((ge=t.message)===null||ge===void 0?void 0:ge.$case)==="simulate"&&((he=t.message)===null||he===void 0?void 0:he.simulate)!==void 0&&((_e=t.message)===null||_e===void 0?void 0:_e.simulate)!==null&&(oe.message={$case:"simulate",simulate:SimulateScenario.fromPartial(t.message.simulate)}),((re=t.message)===null||re===void 0?void 0:re.$case)==="ping"&&((V=t.message)===null||V===void 0?void 0:V.ping)!==void 0&&((Q=t.message)===null||Q===void 0?void 0:Q.ping)!==null&&(oe.message={$case:"ping",ping:t.message.ping}),((j=t.message)===null||j===void 0?void 0:j.$case)==="updateMetadata"&&((le=t.message)===null||le===void 0?void 0:le.updateMetadata)!==void 0&&((J=t.message)===null||J===void 0?void 0:J.updateMetadata)!==null&&(oe.message={$case:"updateMetadata",updateMetadata:UpdateParticipantMetadata.fromPartial(t.message.updateMetadata)}),((z=t.message)===null||z===void 0?void 0:z.$case)==="pingReq"&&((X=t.message)===null||X===void 0?void 0:X.pingReq)!==void 0&&((te=t.message)===null||te===void 0?void 0:te.pingReq)!==null&&(oe.message={$case:"pingReq",pingReq:Ping.fromPartial(t.message.pingReq)}),oe}};function createBaseSignalResponse(){return{message:void 0}}const SignalResponse={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();var n;switch((n=t.message)===null||n===void 0?void 0:n.$case){case"join":JoinResponse.encode(t.message.join,e.uint32(10).fork()).ldelim();break;case"answer":SessionDescription.encode(t.message.answer,e.uint32(18).fork()).ldelim();break;case"offer":SessionDescription.encode(t.message.offer,e.uint32(26).fork()).ldelim();break;case"trickle":TrickleRequest.encode(t.message.trickle,e.uint32(34).fork()).ldelim();break;case"update":ParticipantUpdate.encode(t.message.update,e.uint32(42).fork()).ldelim();break;case"trackPublished":TrackPublishedResponse.encode(t.message.trackPublished,e.uint32(50).fork()).ldelim();break;case"leave":LeaveRequest.encode(t.message.leave,e.uint32(66).fork()).ldelim();break;case"mute":MuteTrackRequest.encode(t.message.mute,e.uint32(74).fork()).ldelim();break;case"speakersChanged":SpeakersChanged.encode(t.message.speakersChanged,e.uint32(82).fork()).ldelim();break;case"roomUpdate":RoomUpdate.encode(t.message.roomUpdate,e.uint32(90).fork()).ldelim();break;case"connectionQuality":ConnectionQualityUpdate.encode(t.message.connectionQuality,e.uint32(98).fork()).ldelim();break;case"streamStateUpdate":StreamStateUpdate.encode(t.message.streamStateUpdate,e.uint32(106).fork()).ldelim();break;case"subscribedQualityUpdate":SubscribedQualityUpdate.encode(t.message.subscribedQualityUpdate,e.uint32(114).fork()).ldelim();break;case"subscriptionPermissionUpdate":SubscriptionPermissionUpdate.encode(t.message.subscriptionPermissionUpdate,e.uint32(122).fork()).ldelim();break;case"refreshToken":e.uint32(130).string(t.message.refreshToken);break;case"trackUnpublished":TrackUnpublishedResponse.encode(t.message.trackUnpublished,e.uint32(138).fork()).ldelim();break;case"pong":e.uint32(144).int64(t.message.pong);break;case"reconnect":ReconnectResponse.encode(t.message.reconnect,e.uint32(154).fork()).ldelim();break;case"pongResp":Pong.encode(t.message.pongResp,e.uint32(162).fork()).ldelim();break}return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSignalResponse();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.message={$case:"join",join:JoinResponse.decode(n,n.uint32())};continue;case 2:if(c!=18)break;s.message={$case:"answer",answer:SessionDescription.decode(n,n.uint32())};continue;case 3:if(c!=26)break;s.message={$case:"offer",offer:SessionDescription.decode(n,n.uint32())};continue;case 4:if(c!=34)break;s.message={$case:"trickle",trickle:TrickleRequest.decode(n,n.uint32())};continue;case 5:if(c!=42)break;s.message={$case:"update",update:ParticipantUpdate.decode(n,n.uint32())};continue;case 6:if(c!=50)break;s.message={$case:"trackPublished",trackPublished:TrackPublishedResponse.decode(n,n.uint32())};continue;case 8:if(c!=66)break;s.message={$case:"leave",leave:LeaveRequest.decode(n,n.uint32())};continue;case 9:if(c!=74)break;s.message={$case:"mute",mute:MuteTrackRequest.decode(n,n.uint32())};continue;case 10:if(c!=82)break;s.message={$case:"speakersChanged",speakersChanged:SpeakersChanged.decode(n,n.uint32())};continue;case 11:if(c!=90)break;s.message={$case:"roomUpdate",roomUpdate:RoomUpdate.decode(n,n.uint32())};continue;case 12:if(c!=98)break;s.message={$case:"connectionQuality",connectionQuality:ConnectionQualityUpdate.decode(n,n.uint32())};continue;case 13:if(c!=106)break;s.message={$case:"streamStateUpdate",streamStateUpdate:StreamStateUpdate.decode(n,n.uint32())};continue;case 14:if(c!=114)break;s.message={$case:"subscribedQualityUpdate",subscribedQualityUpdate:SubscribedQualityUpdate.decode(n,n.uint32())};continue;case 15:if(c!=122)break;s.message={$case:"subscriptionPermissionUpdate",subscriptionPermissionUpdate:SubscriptionPermissionUpdate.decode(n,n.uint32())};continue;case 16:if(c!=130)break;s.message={$case:"refreshToken",refreshToken:n.string()};continue;case 17:if(c!=138)break;s.message={$case:"trackUnpublished",trackUnpublished:TrackUnpublishedResponse.decode(n,n.uint32())};continue;case 18:if(c!=144)break;s.message={$case:"pong",pong:longToNumber(n.int64())};continue;case 19:if(c!=154)break;s.message={$case:"reconnect",reconnect:ReconnectResponse.decode(n,n.uint32())};continue;case 20:if(c!=162)break;s.message={$case:"pongResp",pongResp:Pong.decode(n,n.uint32())};continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{message:isSet(t.join)?{$case:"join",join:JoinResponse.fromJSON(t.join)}:isSet(t.answer)?{$case:"answer",answer:SessionDescription.fromJSON(t.answer)}:isSet(t.offer)?{$case:"offer",offer:SessionDescription.fromJSON(t.offer)}:isSet(t.trickle)?{$case:"trickle",trickle:TrickleRequest.fromJSON(t.trickle)}:isSet(t.update)?{$case:"update",update:ParticipantUpdate.fromJSON(t.update)}:isSet(t.trackPublished)?{$case:"trackPublished",trackPublished:TrackPublishedResponse.fromJSON(t.trackPublished)}:isSet(t.leave)?{$case:"leave",leave:LeaveRequest.fromJSON(t.leave)}:isSet(t.mute)?{$case:"mute",mute:MuteTrackRequest.fromJSON(t.mute)}:isSet(t.speakersChanged)?{$case:"speakersChanged",speakersChanged:SpeakersChanged.fromJSON(t.speakersChanged)}:isSet(t.roomUpdate)?{$case:"roomUpdate",roomUpdate:RoomUpdate.fromJSON(t.roomUpdate)}:isSet(t.connectionQuality)?{$case:"connectionQuality",connectionQuality:ConnectionQualityUpdate.fromJSON(t.connectionQuality)}:isSet(t.streamStateUpdate)?{$case:"streamStateUpdate",streamStateUpdate:StreamStateUpdate.fromJSON(t.streamStateUpdate)}:isSet(t.subscribedQualityUpdate)?{$case:"subscribedQualityUpdate",subscribedQualityUpdate:SubscribedQualityUpdate.fromJSON(t.subscribedQualityUpdate)}:isSet(t.subscriptionPermissionUpdate)?{$case:"subscriptionPermissionUpdate",subscriptionPermissionUpdate:SubscriptionPermissionUpdate.fromJSON(t.subscriptionPermissionUpdate)}:isSet(t.refreshToken)?{$case:"refreshToken",refreshToken:String(t.refreshToken)}:isSet(t.trackUnpublished)?{$case:"trackUnpublished",trackUnpublished:TrackUnpublishedResponse.fromJSON(t.trackUnpublished)}:isSet(t.pong)?{$case:"pong",pong:Number(t.pong)}:isSet(t.reconnect)?{$case:"reconnect",reconnect:ReconnectResponse.fromJSON(t.reconnect)}:isSet(t.pongResp)?{$case:"pongResp",pongResp:Pong.fromJSON(t.pongResp)}:void 0}},toJSON(t){var e,n,a,s,c,u,d,m,_,b,S,k,w,O,P,N,I,U,$,x,C,H,q,K,W,Z,ee,ie,se,ce,fe,pe,ue,ge,he,_e,re,V,Q,j,le,J,z,X,te,oe,B,F,Y,ae,ve,me,ye,Ee,ne;const be={};return((e=t.message)===null||e===void 0?void 0:e.$case)==="join"&&(be.join=!((n=t.message)===null||n===void 0)&&n.join?JoinResponse.toJSON((a=t.message)===null||a===void 0?void 0:a.join):void 0),((s=t.message)===null||s===void 0?void 0:s.$case)==="answer"&&(be.answer=!((c=t.message)===null||c===void 0)&&c.answer?SessionDescription.toJSON((u=t.message)===null||u===void 0?void 0:u.answer):void 0),((d=t.message)===null||d===void 0?void 0:d.$case)==="offer"&&(be.offer=!((m=t.message)===null||m===void 0)&&m.offer?SessionDescription.toJSON((_=t.message)===null||_===void 0?void 0:_.offer):void 0),((b=t.message)===null||b===void 0?void 0:b.$case)==="trickle"&&(be.trickle=!((S=t.message)===null||S===void 0)&&S.trickle?TrickleRequest.toJSON((k=t.message)===null||k===void 0?void 0:k.trickle):void 0),((w=t.message)===null||w===void 0?void 0:w.$case)==="update"&&(be.update=!((O=t.message)===null||O===void 0)&&O.update?ParticipantUpdate.toJSON((P=t.message)===null||P===void 0?void 0:P.update):void 0),((N=t.message)===null||N===void 0?void 0:N.$case)==="trackPublished"&&(be.trackPublished=!((I=t.message)===null||I===void 0)&&I.trackPublished?TrackPublishedResponse.toJSON((U=t.message)===null||U===void 0?void 0:U.trackPublished):void 0),(($=t.message)===null||$===void 0?void 0:$.$case)==="leave"&&(be.leave=!((x=t.message)===null||x===void 0)&&x.leave?LeaveRequest.toJSON((C=t.message)===null||C===void 0?void 0:C.leave):void 0),((H=t.message)===null||H===void 0?void 0:H.$case)==="mute"&&(be.mute=!((q=t.message)===null||q===void 0)&&q.mute?MuteTrackRequest.toJSON((K=t.message)===null||K===void 0?void 0:K.mute):void 0),((W=t.message)===null||W===void 0?void 0:W.$case)==="speakersChanged"&&(be.speakersChanged=!((Z=t.message)===null||Z===void 0)&&Z.speakersChanged?SpeakersChanged.toJSON((ee=t.message)===null||ee===void 0?void 0:ee.speakersChanged):void 0),((ie=t.message)===null||ie===void 0?void 0:ie.$case)==="roomUpdate"&&(be.roomUpdate=!((se=t.message)===null||se===void 0)&&se.roomUpdate?RoomUpdate.toJSON((ce=t.message)===null||ce===void 0?void 0:ce.roomUpdate):void 0),((fe=t.message)===null||fe===void 0?void 0:fe.$case)==="connectionQuality"&&(be.connectionQuality=!((pe=t.message)===null||pe===void 0)&&pe.connectionQuality?ConnectionQualityUpdate.toJSON((ue=t.message)===null||ue===void 0?void 0:ue.connectionQuality):void 0),((ge=t.message)===null||ge===void 0?void 0:ge.$case)==="streamStateUpdate"&&(be.streamStateUpdate=!((he=t.message)===null||he===void 0)&&he.streamStateUpdate?StreamStateUpdate.toJSON((_e=t.message)===null||_e===void 0?void 0:_e.streamStateUpdate):void 0),((re=t.message)===null||re===void 0?void 0:re.$case)==="subscribedQualityUpdate"&&(be.subscribedQualityUpdate=!((V=t.message)===null||V===void 0)&&V.subscribedQualityUpdate?SubscribedQualityUpdate.toJSON((Q=t.message)===null||Q===void 0?void 0:Q.subscribedQualityUpdate):void 0),((j=t.message)===null||j===void 0?void 0:j.$case)==="subscriptionPermissionUpdate"&&(be.subscriptionPermissionUpdate=!((le=t.message)===null||le===void 0)&&le.subscriptionPermissionUpdate?SubscriptionPermissionUpdate.toJSON((J=t.message)===null||J===void 0?void 0:J.subscriptionPermissionUpdate):void 0),((z=t.message)===null||z===void 0?void 0:z.$case)==="refreshToken"&&(be.refreshToken=(X=t.message)===null||X===void 0?void 0:X.refreshToken),((te=t.message)===null||te===void 0?void 0:te.$case)==="trackUnpublished"&&(be.trackUnpublished=!((oe=t.message)===null||oe===void 0)&&oe.trackUnpublished?TrackUnpublishedResponse.toJSON((B=t.message)===null||B===void 0?void 0:B.trackUnpublished):void 0),((F=t.message)===null||F===void 0?void 0:F.$case)==="pong"&&(be.pong=Math.round((Y=t.message)===null||Y===void 0?void 0:Y.pong)),((ae=t.message)===null||ae===void 0?void 0:ae.$case)==="reconnect"&&(be.reconnect=!((ve=t.message)===null||ve===void 0)&&ve.reconnect?ReconnectResponse.toJSON((me=t.message)===null||me===void 0?void 0:me.reconnect):void 0),((ye=t.message)===null||ye===void 0?void 0:ye.$case)==="pongResp"&&(be.pongResp=!((Ee=t.message)===null||Ee===void 0)&&Ee.pongResp?Pong.toJSON((ne=t.message)===null||ne===void 0?void 0:ne.pongResp):void 0),be},create(t){return SignalResponse.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u,d,m,_,b,S,k,w,O,P,N,I,U,$,x,C,H,q,K,W,Z,ee,ie,se,ce,fe,pe,ue,ge,he,_e,re,V,Q,j,le,J,z,X,te,oe,B,F,Y,ae,ve,me,ye,Ee,ne,be,Te;const Se=createBaseSignalResponse();return((e=t.message)===null||e===void 0?void 0:e.$case)==="join"&&((n=t.message)===null||n===void 0?void 0:n.join)!==void 0&&((a=t.message)===null||a===void 0?void 0:a.join)!==null&&(Se.message={$case:"join",join:JoinResponse.fromPartial(t.message.join)}),((s=t.message)===null||s===void 0?void 0:s.$case)==="answer"&&((c=t.message)===null||c===void 0?void 0:c.answer)!==void 0&&((u=t.message)===null||u===void 0?void 0:u.answer)!==null&&(Se.message={$case:"answer",answer:SessionDescription.fromPartial(t.message.answer)}),((d=t.message)===null||d===void 0?void 0:d.$case)==="offer"&&((m=t.message)===null||m===void 0?void 0:m.offer)!==void 0&&((_=t.message)===null||_===void 0?void 0:_.offer)!==null&&(Se.message={$case:"offer",offer:SessionDescription.fromPartial(t.message.offer)}),((b=t.message)===null||b===void 0?void 0:b.$case)==="trickle"&&((S=t.message)===null||S===void 0?void 0:S.trickle)!==void 0&&((k=t.message)===null||k===void 0?void 0:k.trickle)!==null&&(Se.message={$case:"trickle",trickle:TrickleRequest.fromPartial(t.message.trickle)}),((w=t.message)===null||w===void 0?void 0:w.$case)==="update"&&((O=t.message)===null||O===void 0?void 0:O.update)!==void 0&&((P=t.message)===null||P===void 0?void 0:P.update)!==null&&(Se.message={$case:"update",update:ParticipantUpdate.fromPartial(t.message.update)}),((N=t.message)===null||N===void 0?void 0:N.$case)==="trackPublished"&&((I=t.message)===null||I===void 0?void 0:I.trackPublished)!==void 0&&((U=t.message)===null||U===void 0?void 0:U.trackPublished)!==null&&(Se.message={$case:"trackPublished",trackPublished:TrackPublishedResponse.fromPartial(t.message.trackPublished)}),(($=t.message)===null||$===void 0?void 0:$.$case)==="leave"&&((x=t.message)===null||x===void 0?void 0:x.leave)!==void 0&&((C=t.message)===null||C===void 0?void 0:C.leave)!==null&&(Se.message={$case:"leave",leave:LeaveRequest.fromPartial(t.message.leave)}),((H=t.message)===null||H===void 0?void 0:H.$case)==="mute"&&((q=t.message)===null||q===void 0?void 0:q.mute)!==void 0&&((K=t.message)===null||K===void 0?void 0:K.mute)!==null&&(Se.message={$case:"mute",mute:MuteTrackRequest.fromPartial(t.message.mute)}),((W=t.message)===null||W===void 0?void 0:W.$case)==="speakersChanged"&&((Z=t.message)===null||Z===void 0?void 0:Z.speakersChanged)!==void 0&&((ee=t.message)===null||ee===void 0?void 0:ee.speakersChanged)!==null&&(Se.message={$case:"speakersChanged",speakersChanged:SpeakersChanged.fromPartial(t.message.speakersChanged)}),((ie=t.message)===null||ie===void 0?void 0:ie.$case)==="roomUpdate"&&((se=t.message)===null||se===void 0?void 0:se.roomUpdate)!==void 0&&((ce=t.message)===null||ce===void 0?void 0:ce.roomUpdate)!==null&&(Se.message={$case:"roomUpdate",roomUpdate:RoomUpdate.fromPartial(t.message.roomUpdate)}),((fe=t.message)===null||fe===void 0?void 0:fe.$case)==="connectionQuality"&&((pe=t.message)===null||pe===void 0?void 0:pe.connectionQuality)!==void 0&&((ue=t.message)===null||ue===void 0?void 0:ue.connectionQuality)!==null&&(Se.message={$case:"connectionQuality",connectionQuality:ConnectionQualityUpdate.fromPartial(t.message.connectionQuality)}),((ge=t.message)===null||ge===void 0?void 0:ge.$case)==="streamStateUpdate"&&((he=t.message)===null||he===void 0?void 0:he.streamStateUpdate)!==void 0&&((_e=t.message)===null||_e===void 0?void 0:_e.streamStateUpdate)!==null&&(Se.message={$case:"streamStateUpdate",streamStateUpdate:StreamStateUpdate.fromPartial(t.message.streamStateUpdate)}),((re=t.message)===null||re===void 0?void 0:re.$case)==="subscribedQualityUpdate"&&((V=t.message)===null||V===void 0?void 0:V.subscribedQualityUpdate)!==void 0&&((Q=t.message)===null||Q===void 0?void 0:Q.subscribedQualityUpdate)!==null&&(Se.message={$case:"subscribedQualityUpdate",subscribedQualityUpdate:SubscribedQualityUpdate.fromPartial(t.message.subscribedQualityUpdate)}),((j=t.message)===null||j===void 0?void 0:j.$case)==="subscriptionPermissionUpdate"&&((le=t.message)===null||le===void 0?void 0:le.subscriptionPermissionUpdate)!==void 0&&((J=t.message)===null||J===void 0?void 0:J.subscriptionPermissionUpdate)!==null&&(Se.message={$case:"subscriptionPermissionUpdate",subscriptionPermissionUpdate:SubscriptionPermissionUpdate.fromPartial(t.message.subscriptionPermissionUpdate)}),((z=t.message)===null||z===void 0?void 0:z.$case)==="refreshToken"&&((X=t.message)===null||X===void 0?void 0:X.refreshToken)!==void 0&&((te=t.message)===null||te===void 0?void 0:te.refreshToken)!==null&&(Se.message={$case:"refreshToken",refreshToken:t.message.refreshToken}),((oe=t.message)===null||oe===void 0?void 0:oe.$case)==="trackUnpublished"&&((B=t.message)===null||B===void 0?void 0:B.trackUnpublished)!==void 0&&((F=t.message)===null||F===void 0?void 0:F.trackUnpublished)!==null&&(Se.message={$case:"trackUnpublished",trackUnpublished:TrackUnpublishedResponse.fromPartial(t.message.trackUnpublished)}),((Y=t.message)===null||Y===void 0?void 0:Y.$case)==="pong"&&((ae=t.message)===null||ae===void 0?void 0:ae.pong)!==void 0&&((ve=t.message)===null||ve===void 0?void 0:ve.pong)!==null&&(Se.message={$case:"pong",pong:t.message.pong}),((me=t.message)===null||me===void 0?void 0:me.$case)==="reconnect"&&((ye=t.message)===null||ye===void 0?void 0:ye.reconnect)!==void 0&&((Ee=t.message)===null||Ee===void 0?void 0:Ee.reconnect)!==null&&(Se.message={$case:"reconnect",reconnect:ReconnectResponse.fromPartial(t.message.reconnect)}),((ne=t.message)===null||ne===void 0?void 0:ne.$case)==="pongResp"&&((be=t.message)===null||be===void 0?void 0:be.pongResp)!==void 0&&((Te=t.message)===null||Te===void 0?void 0:Te.pongResp)!==null&&(Se.message={$case:"pongResp",pongResp:Pong.fromPartial(t.message.pongResp)}),Se}};function createBaseSimulcastCodec(){return{codec:"",cid:"",enableSimulcastLayers:!1}}const SimulcastCodec={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.codec!==""&&e.uint32(10).string(t.codec),t.cid!==""&&e.uint32(18).string(t.cid),t.enableSimulcastLayers===!0&&e.uint32(24).bool(t.enableSimulcastLayers),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSimulcastCodec();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.codec=n.string();continue;case 2:if(c!=18)break;s.cid=n.string();continue;case 3:if(c!=24)break;s.enableSimulcastLayers=n.bool();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{codec:isSet(t.codec)?String(t.codec):"",cid:isSet(t.cid)?String(t.cid):"",enableSimulcastLayers:isSet(t.enableSimulcastLayers)?!!t.enableSimulcastLayers:!1}},toJSON(t){const e={};return t.codec!==void 0&&(e.codec=t.codec),t.cid!==void 0&&(e.cid=t.cid),t.enableSimulcastLayers!==void 0&&(e.enableSimulcastLayers=t.enableSimulcastLayers),e},create(t){return SimulcastCodec.fromPartial(t??{})},fromPartial(t){var e,n,a;const s=createBaseSimulcastCodec();return s.codec=(e=t.codec)!==null&&e!==void 0?e:"",s.cid=(n=t.cid)!==null&&n!==void 0?n:"",s.enableSimulcastLayers=(a=t.enableSimulcastLayers)!==null&&a!==void 0?a:!1,s}};function createBaseAddTrackRequest(){return{cid:"",name:"",type:0,width:0,height:0,muted:!1,disableDtx:!1,source:0,layers:[],simulcastCodecs:[],sid:"",stereo:!1,disableRed:!1,encryption:0}}const AddTrackRequest={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.cid!==""&&e.uint32(10).string(t.cid),t.name!==""&&e.uint32(18).string(t.name),t.type!==0&&e.uint32(24).int32(t.type),t.width!==0&&e.uint32(32).uint32(t.width),t.height!==0&&e.uint32(40).uint32(t.height),t.muted===!0&&e.uint32(48).bool(t.muted),t.disableDtx===!0&&e.uint32(56).bool(t.disableDtx),t.source!==0&&e.uint32(64).int32(t.source);for(const n of t.layers)VideoLayer.encode(n,e.uint32(74).fork()).ldelim();for(const n of t.simulcastCodecs)SimulcastCodec.encode(n,e.uint32(82).fork()).ldelim();return t.sid!==""&&e.uint32(90).string(t.sid),t.stereo===!0&&e.uint32(96).bool(t.stereo),t.disableRed===!0&&e.uint32(104).bool(t.disableRed),t.encryption!==0&&e.uint32(112).int32(t.encryption),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseAddTrackRequest();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.cid=n.string();continue;case 2:if(c!=18)break;s.name=n.string();continue;case 3:if(c!=24)break;s.type=n.int32();continue;case 4:if(c!=32)break;s.width=n.uint32();continue;case 5:if(c!=40)break;s.height=n.uint32();continue;case 6:if(c!=48)break;s.muted=n.bool();continue;case 7:if(c!=56)break;s.disableDtx=n.bool();continue;case 8:if(c!=64)break;s.source=n.int32();continue;case 9:if(c!=74)break;s.layers.push(VideoLayer.decode(n,n.uint32()));continue;case 10:if(c!=82)break;s.simulcastCodecs.push(SimulcastCodec.decode(n,n.uint32()));continue;case 11:if(c!=90)break;s.sid=n.string();continue;case 12:if(c!=96)break;s.stereo=n.bool();continue;case 13:if(c!=104)break;s.disableRed=n.bool();continue;case 14:if(c!=112)break;s.encryption=n.int32();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{cid:isSet(t.cid)?String(t.cid):"",name:isSet(t.name)?String(t.name):"",type:isSet(t.type)?trackTypeFromJSON(t.type):0,width:isSet(t.width)?Number(t.width):0,height:isSet(t.height)?Number(t.height):0,muted:isSet(t.muted)?!!t.muted:!1,disableDtx:isSet(t.disableDtx)?!!t.disableDtx:!1,source:isSet(t.source)?trackSourceFromJSON(t.source):0,layers:Array.isArray(t==null?void 0:t.layers)?t.layers.map(e=>VideoLayer.fromJSON(e)):[],simulcastCodecs:Array.isArray(t==null?void 0:t.simulcastCodecs)?t.simulcastCodecs.map(e=>SimulcastCodec.fromJSON(e)):[],sid:isSet(t.sid)?String(t.sid):"",stereo:isSet(t.stereo)?!!t.stereo:!1,disableRed:isSet(t.disableRed)?!!t.disableRed:!1,encryption:isSet(t.encryption)?encryption_TypeFromJSON(t.encryption):0}},toJSON(t){const e={};return t.cid!==void 0&&(e.cid=t.cid),t.name!==void 0&&(e.name=t.name),t.type!==void 0&&(e.type=trackTypeToJSON(t.type)),t.width!==void 0&&(e.width=Math.round(t.width)),t.height!==void 0&&(e.height=Math.round(t.height)),t.muted!==void 0&&(e.muted=t.muted),t.disableDtx!==void 0&&(e.disableDtx=t.disableDtx),t.source!==void 0&&(e.source=trackSourceToJSON(t.source)),t.layers?e.layers=t.layers.map(n=>n?VideoLayer.toJSON(n):void 0):e.layers=[],t.simulcastCodecs?e.simulcastCodecs=t.simulcastCodecs.map(n=>n?SimulcastCodec.toJSON(n):void 0):e.simulcastCodecs=[],t.sid!==void 0&&(e.sid=t.sid),t.stereo!==void 0&&(e.stereo=t.stereo),t.disableRed!==void 0&&(e.disableRed=t.disableRed),t.encryption!==void 0&&(e.encryption=encryption_TypeToJSON(t.encryption)),e},create(t){return AddTrackRequest.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u,d,m,_,b,S,k,w,O;const P=createBaseAddTrackRequest();return P.cid=(e=t.cid)!==null&&e!==void 0?e:"",P.name=(n=t.name)!==null&&n!==void 0?n:"",P.type=(a=t.type)!==null&&a!==void 0?a:0,P.width=(s=t.width)!==null&&s!==void 0?s:0,P.height=(c=t.height)!==null&&c!==void 0?c:0,P.muted=(u=t.muted)!==null&&u!==void 0?u:!1,P.disableDtx=(d=t.disableDtx)!==null&&d!==void 0?d:!1,P.source=(m=t.source)!==null&&m!==void 0?m:0,P.layers=((_=t.layers)===null||_===void 0?void 0:_.map(N=>VideoLayer.fromPartial(N)))||[],P.simulcastCodecs=((b=t.simulcastCodecs)===null||b===void 0?void 0:b.map(N=>SimulcastCodec.fromPartial(N)))||[],P.sid=(S=t.sid)!==null&&S!==void 0?S:"",P.stereo=(k=t.stereo)!==null&&k!==void 0?k:!1,P.disableRed=(w=t.disableRed)!==null&&w!==void 0?w:!1,P.encryption=(O=t.encryption)!==null&&O!==void 0?O:0,P}};function createBaseTrickleRequest(){return{candidateInit:"",target:0}}const TrickleRequest={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.candidateInit!==""&&e.uint32(10).string(t.candidateInit),t.target!==0&&e.uint32(16).int32(t.target),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseTrickleRequest();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.candidateInit=n.string();continue;case 2:if(c!=16)break;s.target=n.int32();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{candidateInit:isSet(t.candidateInit)?String(t.candidateInit):"",target:isSet(t.target)?signalTargetFromJSON(t.target):0}},toJSON(t){const e={};return t.candidateInit!==void 0&&(e.candidateInit=t.candidateInit),t.target!==void 0&&(e.target=signalTargetToJSON(t.target)),e},create(t){return TrickleRequest.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseTrickleRequest();return a.candidateInit=(e=t.candidateInit)!==null&&e!==void 0?e:"",a.target=(n=t.target)!==null&&n!==void 0?n:0,a}};function createBaseMuteTrackRequest(){return{sid:"",muted:!1}}const MuteTrackRequest={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.sid!==""&&e.uint32(10).string(t.sid),t.muted===!0&&e.uint32(16).bool(t.muted),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseMuteTrackRequest();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.sid=n.string();continue;case 2:if(c!=16)break;s.muted=n.bool();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{sid:isSet(t.sid)?String(t.sid):"",muted:isSet(t.muted)?!!t.muted:!1}},toJSON(t){const e={};return t.sid!==void 0&&(e.sid=t.sid),t.muted!==void 0&&(e.muted=t.muted),e},create(t){return MuteTrackRequest.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseMuteTrackRequest();return a.sid=(e=t.sid)!==null&&e!==void 0?e:"",a.muted=(n=t.muted)!==null&&n!==void 0?n:!1,a}};function createBaseJoinResponse(){return{room:void 0,participant:void 0,otherParticipants:[],serverVersion:"",iceServers:[],subscriberPrimary:!1,alternativeUrl:"",clientConfiguration:void 0,serverRegion:"",pingTimeout:0,pingInterval:0,serverInfo:void 0}}const JoinResponse={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.room!==void 0&&Room$1.encode(t.room,e.uint32(10).fork()).ldelim(),t.participant!==void 0&&ParticipantInfo.encode(t.participant,e.uint32(18).fork()).ldelim();for(const n of t.otherParticipants)ParticipantInfo.encode(n,e.uint32(26).fork()).ldelim();t.serverVersion!==""&&e.uint32(34).string(t.serverVersion);for(const n of t.iceServers)ICEServer.encode(n,e.uint32(42).fork()).ldelim();return t.subscriberPrimary===!0&&e.uint32(48).bool(t.subscriberPrimary),t.alternativeUrl!==""&&e.uint32(58).string(t.alternativeUrl),t.clientConfiguration!==void 0&&ClientConfiguration.encode(t.clientConfiguration,e.uint32(66).fork()).ldelim(),t.serverRegion!==""&&e.uint32(74).string(t.serverRegion),t.pingTimeout!==0&&e.uint32(80).int32(t.pingTimeout),t.pingInterval!==0&&e.uint32(88).int32(t.pingInterval),t.serverInfo!==void 0&&ServerInfo.encode(t.serverInfo,e.uint32(98).fork()).ldelim(),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseJoinResponse();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.room=Room$1.decode(n,n.uint32());continue;case 2:if(c!=18)break;s.participant=ParticipantInfo.decode(n,n.uint32());continue;case 3:if(c!=26)break;s.otherParticipants.push(ParticipantInfo.decode(n,n.uint32()));continue;case 4:if(c!=34)break;s.serverVersion=n.string();continue;case 5:if(c!=42)break;s.iceServers.push(ICEServer.decode(n,n.uint32()));continue;case 6:if(c!=48)break;s.subscriberPrimary=n.bool();continue;case 7:if(c!=58)break;s.alternativeUrl=n.string();continue;case 8:if(c!=66)break;s.clientConfiguration=ClientConfiguration.decode(n,n.uint32());continue;case 9:if(c!=74)break;s.serverRegion=n.string();continue;case 10:if(c!=80)break;s.pingTimeout=n.int32();continue;case 11:if(c!=88)break;s.pingInterval=n.int32();continue;case 12:if(c!=98)break;s.serverInfo=ServerInfo.decode(n,n.uint32());continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{room:isSet(t.room)?Room$1.fromJSON(t.room):void 0,participant:isSet(t.participant)?ParticipantInfo.fromJSON(t.participant):void 0,otherParticipants:Array.isArray(t==null?void 0:t.otherParticipants)?t.otherParticipants.map(e=>ParticipantInfo.fromJSON(e)):[],serverVersion:isSet(t.serverVersion)?String(t.serverVersion):"",iceServers:Array.isArray(t==null?void 0:t.iceServers)?t.iceServers.map(e=>ICEServer.fromJSON(e)):[],subscriberPrimary:isSet(t.subscriberPrimary)?!!t.subscriberPrimary:!1,alternativeUrl:isSet(t.alternativeUrl)?String(t.alternativeUrl):"",clientConfiguration:isSet(t.clientConfiguration)?ClientConfiguration.fromJSON(t.clientConfiguration):void 0,serverRegion:isSet(t.serverRegion)?String(t.serverRegion):"",pingTimeout:isSet(t.pingTimeout)?Number(t.pingTimeout):0,pingInterval:isSet(t.pingInterval)?Number(t.pingInterval):0,serverInfo:isSet(t.serverInfo)?ServerInfo.fromJSON(t.serverInfo):void 0}},toJSON(t){const e={};return t.room!==void 0&&(e.room=t.room?Room$1.toJSON(t.room):void 0),t.participant!==void 0&&(e.participant=t.participant?ParticipantInfo.toJSON(t.participant):void 0),t.otherParticipants?e.otherParticipants=t.otherParticipants.map(n=>n?ParticipantInfo.toJSON(n):void 0):e.otherParticipants=[],t.serverVersion!==void 0&&(e.serverVersion=t.serverVersion),t.iceServers?e.iceServers=t.iceServers.map(n=>n?ICEServer.toJSON(n):void 0):e.iceServers=[],t.subscriberPrimary!==void 0&&(e.subscriberPrimary=t.subscriberPrimary),t.alternativeUrl!==void 0&&(e.alternativeUrl=t.alternativeUrl),t.clientConfiguration!==void 0&&(e.clientConfiguration=t.clientConfiguration?ClientConfiguration.toJSON(t.clientConfiguration):void 0),t.serverRegion!==void 0&&(e.serverRegion=t.serverRegion),t.pingTimeout!==void 0&&(e.pingTimeout=Math.round(t.pingTimeout)),t.pingInterval!==void 0&&(e.pingInterval=Math.round(t.pingInterval)),t.serverInfo!==void 0&&(e.serverInfo=t.serverInfo?ServerInfo.toJSON(t.serverInfo):void 0),e},create(t){return JoinResponse.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u,d,m;const _=createBaseJoinResponse();return _.room=t.room!==void 0&&t.room!==null?Room$1.fromPartial(t.room):void 0,_.participant=t.participant!==void 0&&t.participant!==null?ParticipantInfo.fromPartial(t.participant):void 0,_.otherParticipants=((e=t.otherParticipants)===null||e===void 0?void 0:e.map(b=>ParticipantInfo.fromPartial(b)))||[],_.serverVersion=(n=t.serverVersion)!==null&&n!==void 0?n:"",_.iceServers=((a=t.iceServers)===null||a===void 0?void 0:a.map(b=>ICEServer.fromPartial(b)))||[],_.subscriberPrimary=(s=t.subscriberPrimary)!==null&&s!==void 0?s:!1,_.alternativeUrl=(c=t.alternativeUrl)!==null&&c!==void 0?c:"",_.clientConfiguration=t.clientConfiguration!==void 0&&t.clientConfiguration!==null?ClientConfiguration.fromPartial(t.clientConfiguration):void 0,_.serverRegion=(u=t.serverRegion)!==null&&u!==void 0?u:"",_.pingTimeout=(d=t.pingTimeout)!==null&&d!==void 0?d:0,_.pingInterval=(m=t.pingInterval)!==null&&m!==void 0?m:0,_.serverInfo=t.serverInfo!==void 0&&t.serverInfo!==null?ServerInfo.fromPartial(t.serverInfo):void 0,_}};function createBaseReconnectResponse(){return{iceServers:[],clientConfiguration:void 0}}const ReconnectResponse={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();for(const n of t.iceServers)ICEServer.encode(n,e.uint32(10).fork()).ldelim();return t.clientConfiguration!==void 0&&ClientConfiguration.encode(t.clientConfiguration,e.uint32(18).fork()).ldelim(),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseReconnectResponse();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.iceServers.push(ICEServer.decode(n,n.uint32()));continue;case 2:if(c!=18)break;s.clientConfiguration=ClientConfiguration.decode(n,n.uint32());continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{iceServers:Array.isArray(t==null?void 0:t.iceServers)?t.iceServers.map(e=>ICEServer.fromJSON(e)):[],clientConfiguration:isSet(t.clientConfiguration)?ClientConfiguration.fromJSON(t.clientConfiguration):void 0}},toJSON(t){const e={};return t.iceServers?e.iceServers=t.iceServers.map(n=>n?ICEServer.toJSON(n):void 0):e.iceServers=[],t.clientConfiguration!==void 0&&(e.clientConfiguration=t.clientConfiguration?ClientConfiguration.toJSON(t.clientConfiguration):void 0),e},create(t){return ReconnectResponse.fromPartial(t??{})},fromPartial(t){var e;const n=createBaseReconnectResponse();return n.iceServers=((e=t.iceServers)===null||e===void 0?void 0:e.map(a=>ICEServer.fromPartial(a)))||[],n.clientConfiguration=t.clientConfiguration!==void 0&&t.clientConfiguration!==null?ClientConfiguration.fromPartial(t.clientConfiguration):void 0,n}};function createBaseTrackPublishedResponse(){return{cid:"",track:void 0}}const TrackPublishedResponse={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.cid!==""&&e.uint32(10).string(t.cid),t.track!==void 0&&TrackInfo.encode(t.track,e.uint32(18).fork()).ldelim(),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseTrackPublishedResponse();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.cid=n.string();continue;case 2:if(c!=18)break;s.track=TrackInfo.decode(n,n.uint32());continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{cid:isSet(t.cid)?String(t.cid):"",track:isSet(t.track)?TrackInfo.fromJSON(t.track):void 0}},toJSON(t){const e={};return t.cid!==void 0&&(e.cid=t.cid),t.track!==void 0&&(e.track=t.track?TrackInfo.toJSON(t.track):void 0),e},create(t){return TrackPublishedResponse.fromPartial(t??{})},fromPartial(t){var e;const n=createBaseTrackPublishedResponse();return n.cid=(e=t.cid)!==null&&e!==void 0?e:"",n.track=t.track!==void 0&&t.track!==null?TrackInfo.fromPartial(t.track):void 0,n}};function createBaseTrackUnpublishedResponse(){return{trackSid:""}}const TrackUnpublishedResponse={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.trackSid!==""&&e.uint32(10).string(t.trackSid),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseTrackUnpublishedResponse();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.trackSid=n.string();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{trackSid:isSet(t.trackSid)?String(t.trackSid):""}},toJSON(t){const e={};return t.trackSid!==void 0&&(e.trackSid=t.trackSid),e},create(t){return TrackUnpublishedResponse.fromPartial(t??{})},fromPartial(t){var e;const n=createBaseTrackUnpublishedResponse();return n.trackSid=(e=t.trackSid)!==null&&e!==void 0?e:"",n}};function createBaseSessionDescription(){return{type:"",sdp:""}}const SessionDescription={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.type!==""&&e.uint32(10).string(t.type),t.sdp!==""&&e.uint32(18).string(t.sdp),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSessionDescription();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.type=n.string();continue;case 2:if(c!=18)break;s.sdp=n.string();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{type:isSet(t.type)?String(t.type):"",sdp:isSet(t.sdp)?String(t.sdp):""}},toJSON(t){const e={};return t.type!==void 0&&(e.type=t.type),t.sdp!==void 0&&(e.sdp=t.sdp),e},create(t){return SessionDescription.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseSessionDescription();return a.type=(e=t.type)!==null&&e!==void 0?e:"",a.sdp=(n=t.sdp)!==null&&n!==void 0?n:"",a}};function createBaseParticipantUpdate(){return{participants:[]}}const ParticipantUpdate={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();for(const n of t.participants)ParticipantInfo.encode(n,e.uint32(10).fork()).ldelim();return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseParticipantUpdate();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.participants.push(ParticipantInfo.decode(n,n.uint32()));continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{participants:Array.isArray(t==null?void 0:t.participants)?t.participants.map(e=>ParticipantInfo.fromJSON(e)):[]}},toJSON(t){const e={};return t.participants?e.participants=t.participants.map(n=>n?ParticipantInfo.toJSON(n):void 0):e.participants=[],e},create(t){return ParticipantUpdate.fromPartial(t??{})},fromPartial(t){var e;const n=createBaseParticipantUpdate();return n.participants=((e=t.participants)===null||e===void 0?void 0:e.map(a=>ParticipantInfo.fromPartial(a)))||[],n}};function createBaseUpdateSubscription(){return{trackSids:[],subscribe:!1,participantTracks:[]}}const UpdateSubscription={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();for(const n of t.trackSids)e.uint32(10).string(n);t.subscribe===!0&&e.uint32(16).bool(t.subscribe);for(const n of t.participantTracks)ParticipantTracks.encode(n,e.uint32(26).fork()).ldelim();return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseUpdateSubscription();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.trackSids.push(n.string());continue;case 2:if(c!=16)break;s.subscribe=n.bool();continue;case 3:if(c!=26)break;s.participantTracks.push(ParticipantTracks.decode(n,n.uint32()));continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{trackSids:Array.isArray(t==null?void 0:t.trackSids)?t.trackSids.map(e=>String(e)):[],subscribe:isSet(t.subscribe)?!!t.subscribe:!1,participantTracks:Array.isArray(t==null?void 0:t.participantTracks)?t.participantTracks.map(e=>ParticipantTracks.fromJSON(e)):[]}},toJSON(t){const e={};return t.trackSids?e.trackSids=t.trackSids.map(n=>n):e.trackSids=[],t.subscribe!==void 0&&(e.subscribe=t.subscribe),t.participantTracks?e.participantTracks=t.participantTracks.map(n=>n?ParticipantTracks.toJSON(n):void 0):e.participantTracks=[],e},create(t){return UpdateSubscription.fromPartial(t??{})},fromPartial(t){var e,n,a;const s=createBaseUpdateSubscription();return s.trackSids=((e=t.trackSids)===null||e===void 0?void 0:e.map(c=>c))||[],s.subscribe=(n=t.subscribe)!==null&&n!==void 0?n:!1,s.participantTracks=((a=t.participantTracks)===null||a===void 0?void 0:a.map(c=>ParticipantTracks.fromPartial(c)))||[],s}};function createBaseUpdateTrackSettings(){return{trackSids:[],disabled:!1,quality:0,width:0,height:0,fps:0,priority:0}}const UpdateTrackSettings={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();for(const n of t.trackSids)e.uint32(10).string(n);return t.disabled===!0&&e.uint32(24).bool(t.disabled),t.quality!==0&&e.uint32(32).int32(t.quality),t.width!==0&&e.uint32(40).uint32(t.width),t.height!==0&&e.uint32(48).uint32(t.height),t.fps!==0&&e.uint32(56).uint32(t.fps),t.priority!==0&&e.uint32(64).uint32(t.priority),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseUpdateTrackSettings();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.trackSids.push(n.string());continue;case 3:if(c!=24)break;s.disabled=n.bool();continue;case 4:if(c!=32)break;s.quality=n.int32();continue;case 5:if(c!=40)break;s.width=n.uint32();continue;case 6:if(c!=48)break;s.height=n.uint32();continue;case 7:if(c!=56)break;s.fps=n.uint32();continue;case 8:if(c!=64)break;s.priority=n.uint32();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{trackSids:Array.isArray(t==null?void 0:t.trackSids)?t.trackSids.map(e=>String(e)):[],disabled:isSet(t.disabled)?!!t.disabled:!1,quality:isSet(t.quality)?videoQualityFromJSON(t.quality):0,width:isSet(t.width)?Number(t.width):0,height:isSet(t.height)?Number(t.height):0,fps:isSet(t.fps)?Number(t.fps):0,priority:isSet(t.priority)?Number(t.priority):0}},toJSON(t){const e={};return t.trackSids?e.trackSids=t.trackSids.map(n=>n):e.trackSids=[],t.disabled!==void 0&&(e.disabled=t.disabled),t.quality!==void 0&&(e.quality=videoQualityToJSON(t.quality)),t.width!==void 0&&(e.width=Math.round(t.width)),t.height!==void 0&&(e.height=Math.round(t.height)),t.fps!==void 0&&(e.fps=Math.round(t.fps)),t.priority!==void 0&&(e.priority=Math.round(t.priority)),e},create(t){return UpdateTrackSettings.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u,d;const m=createBaseUpdateTrackSettings();return m.trackSids=((e=t.trackSids)===null||e===void 0?void 0:e.map(_=>_))||[],m.disabled=(n=t.disabled)!==null&&n!==void 0?n:!1,m.quality=(a=t.quality)!==null&&a!==void 0?a:0,m.width=(s=t.width)!==null&&s!==void 0?s:0,m.height=(c=t.height)!==null&&c!==void 0?c:0,m.fps=(u=t.fps)!==null&&u!==void 0?u:0,m.priority=(d=t.priority)!==null&&d!==void 0?d:0,m}};function createBaseLeaveRequest(){return{canReconnect:!1,reason:0}}const LeaveRequest={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.canReconnect===!0&&e.uint32(8).bool(t.canReconnect),t.reason!==0&&e.uint32(16).int32(t.reason),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseLeaveRequest();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=8)break;s.canReconnect=n.bool();continue;case 2:if(c!=16)break;s.reason=n.int32();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{canReconnect:isSet(t.canReconnect)?!!t.canReconnect:!1,reason:isSet(t.reason)?disconnectReasonFromJSON(t.reason):0}},toJSON(t){const e={};return t.canReconnect!==void 0&&(e.canReconnect=t.canReconnect),t.reason!==void 0&&(e.reason=disconnectReasonToJSON(t.reason)),e},create(t){return LeaveRequest.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseLeaveRequest();return a.canReconnect=(e=t.canReconnect)!==null&&e!==void 0?e:!1,a.reason=(n=t.reason)!==null&&n!==void 0?n:0,a}};function createBaseUpdateVideoLayers(){return{trackSid:"",layers:[]}}const UpdateVideoLayers={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.trackSid!==""&&e.uint32(10).string(t.trackSid);for(const n of t.layers)VideoLayer.encode(n,e.uint32(18).fork()).ldelim();return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseUpdateVideoLayers();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.trackSid=n.string();continue;case 2:if(c!=18)break;s.layers.push(VideoLayer.decode(n,n.uint32()));continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{trackSid:isSet(t.trackSid)?String(t.trackSid):"",layers:Array.isArray(t==null?void 0:t.layers)?t.layers.map(e=>VideoLayer.fromJSON(e)):[]}},toJSON(t){const e={};return t.trackSid!==void 0&&(e.trackSid=t.trackSid),t.layers?e.layers=t.layers.map(n=>n?VideoLayer.toJSON(n):void 0):e.layers=[],e},create(t){return UpdateVideoLayers.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseUpdateVideoLayers();return a.trackSid=(e=t.trackSid)!==null&&e!==void 0?e:"",a.layers=((n=t.layers)===null||n===void 0?void 0:n.map(s=>VideoLayer.fromPartial(s)))||[],a}};function createBaseUpdateParticipantMetadata(){return{metadata:"",name:""}}const UpdateParticipantMetadata={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.metadata!==""&&e.uint32(10).string(t.metadata),t.name!==""&&e.uint32(18).string(t.name),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseUpdateParticipantMetadata();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.metadata=n.string();continue;case 2:if(c!=18)break;s.name=n.string();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{metadata:isSet(t.metadata)?String(t.metadata):"",name:isSet(t.name)?String(t.name):""}},toJSON(t){const e={};return t.metadata!==void 0&&(e.metadata=t.metadata),t.name!==void 0&&(e.name=t.name),e},create(t){return UpdateParticipantMetadata.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseUpdateParticipantMetadata();return a.metadata=(e=t.metadata)!==null&&e!==void 0?e:"",a.name=(n=t.name)!==null&&n!==void 0?n:"",a}};function createBaseICEServer(){return{urls:[],username:"",credential:""}}const ICEServer={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();for(const n of t.urls)e.uint32(10).string(n);return t.username!==""&&e.uint32(18).string(t.username),t.credential!==""&&e.uint32(26).string(t.credential),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseICEServer();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.urls.push(n.string());continue;case 2:if(c!=18)break;s.username=n.string();continue;case 3:if(c!=26)break;s.credential=n.string();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{urls:Array.isArray(t==null?void 0:t.urls)?t.urls.map(e=>String(e)):[],username:isSet(t.username)?String(t.username):"",credential:isSet(t.credential)?String(t.credential):""}},toJSON(t){const e={};return t.urls?e.urls=t.urls.map(n=>n):e.urls=[],t.username!==void 0&&(e.username=t.username),t.credential!==void 0&&(e.credential=t.credential),e},create(t){return ICEServer.fromPartial(t??{})},fromPartial(t){var e,n,a;const s=createBaseICEServer();return s.urls=((e=t.urls)===null||e===void 0?void 0:e.map(c=>c))||[],s.username=(n=t.username)!==null&&n!==void 0?n:"",s.credential=(a=t.credential)!==null&&a!==void 0?a:"",s}};function createBaseSpeakersChanged(){return{speakers:[]}}const SpeakersChanged={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();for(const n of t.speakers)SpeakerInfo.encode(n,e.uint32(10).fork()).ldelim();return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSpeakersChanged();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.speakers.push(SpeakerInfo.decode(n,n.uint32()));continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{speakers:Array.isArray(t==null?void 0:t.speakers)?t.speakers.map(e=>SpeakerInfo.fromJSON(e)):[]}},toJSON(t){const e={};return t.speakers?e.speakers=t.speakers.map(n=>n?SpeakerInfo.toJSON(n):void 0):e.speakers=[],e},create(t){return SpeakersChanged.fromPartial(t??{})},fromPartial(t){var e;const n=createBaseSpeakersChanged();return n.speakers=((e=t.speakers)===null||e===void 0?void 0:e.map(a=>SpeakerInfo.fromPartial(a)))||[],n}};function createBaseRoomUpdate(){return{room:void 0}}const RoomUpdate={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.room!==void 0&&Room$1.encode(t.room,e.uint32(10).fork()).ldelim(),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseRoomUpdate();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.room=Room$1.decode(n,n.uint32());continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{room:isSet(t.room)?Room$1.fromJSON(t.room):void 0}},toJSON(t){const e={};return t.room!==void 0&&(e.room=t.room?Room$1.toJSON(t.room):void 0),e},create(t){return RoomUpdate.fromPartial(t??{})},fromPartial(t){const e=createBaseRoomUpdate();return e.room=t.room!==void 0&&t.room!==null?Room$1.fromPartial(t.room):void 0,e}};function createBaseConnectionQualityInfo(){return{participantSid:"",quality:0,score:0}}const ConnectionQualityInfo={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.participantSid!==""&&e.uint32(10).string(t.participantSid),t.quality!==0&&e.uint32(16).int32(t.quality),t.score!==0&&e.uint32(29).float(t.score),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseConnectionQualityInfo();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.participantSid=n.string();continue;case 2:if(c!=16)break;s.quality=n.int32();continue;case 3:if(c!=29)break;s.score=n.float();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{participantSid:isSet(t.participantSid)?String(t.participantSid):"",quality:isSet(t.quality)?connectionQualityFromJSON(t.quality):0,score:isSet(t.score)?Number(t.score):0}},toJSON(t){const e={};return t.participantSid!==void 0&&(e.participantSid=t.participantSid),t.quality!==void 0&&(e.quality=connectionQualityToJSON(t.quality)),t.score!==void 0&&(e.score=t.score),e},create(t){return ConnectionQualityInfo.fromPartial(t??{})},fromPartial(t){var e,n,a;const s=createBaseConnectionQualityInfo();return s.participantSid=(e=t.participantSid)!==null&&e!==void 0?e:"",s.quality=(n=t.quality)!==null&&n!==void 0?n:0,s.score=(a=t.score)!==null&&a!==void 0?a:0,s}};function createBaseConnectionQualityUpdate(){return{updates:[]}}const ConnectionQualityUpdate={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();for(const n of t.updates)ConnectionQualityInfo.encode(n,e.uint32(10).fork()).ldelim();return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseConnectionQualityUpdate();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.updates.push(ConnectionQualityInfo.decode(n,n.uint32()));continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{updates:Array.isArray(t==null?void 0:t.updates)?t.updates.map(e=>ConnectionQualityInfo.fromJSON(e)):[]}},toJSON(t){const e={};return t.updates?e.updates=t.updates.map(n=>n?ConnectionQualityInfo.toJSON(n):void 0):e.updates=[],e},create(t){return ConnectionQualityUpdate.fromPartial(t??{})},fromPartial(t){var e;const n=createBaseConnectionQualityUpdate();return n.updates=((e=t.updates)===null||e===void 0?void 0:e.map(a=>ConnectionQualityInfo.fromPartial(a)))||[],n}};function createBaseStreamStateInfo(){return{participantSid:"",trackSid:"",state:0}}const StreamStateInfo={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.participantSid!==""&&e.uint32(10).string(t.participantSid),t.trackSid!==""&&e.uint32(18).string(t.trackSid),t.state!==0&&e.uint32(24).int32(t.state),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseStreamStateInfo();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.participantSid=n.string();continue;case 2:if(c!=18)break;s.trackSid=n.string();continue;case 3:if(c!=24)break;s.state=n.int32();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{participantSid:isSet(t.participantSid)?String(t.participantSid):"",trackSid:isSet(t.trackSid)?String(t.trackSid):"",state:isSet(t.state)?streamStateFromJSON(t.state):0}},toJSON(t){const e={};return t.participantSid!==void 0&&(e.participantSid=t.participantSid),t.trackSid!==void 0&&(e.trackSid=t.trackSid),t.state!==void 0&&(e.state=streamStateToJSON(t.state)),e},create(t){return StreamStateInfo.fromPartial(t??{})},fromPartial(t){var e,n,a;const s=createBaseStreamStateInfo();return s.participantSid=(e=t.participantSid)!==null&&e!==void 0?e:"",s.trackSid=(n=t.trackSid)!==null&&n!==void 0?n:"",s.state=(a=t.state)!==null&&a!==void 0?a:0,s}};function createBaseStreamStateUpdate(){return{streamStates:[]}}const StreamStateUpdate={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();for(const n of t.streamStates)StreamStateInfo.encode(n,e.uint32(10).fork()).ldelim();return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseStreamStateUpdate();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.streamStates.push(StreamStateInfo.decode(n,n.uint32()));continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{streamStates:Array.isArray(t==null?void 0:t.streamStates)?t.streamStates.map(e=>StreamStateInfo.fromJSON(e)):[]}},toJSON(t){const e={};return t.streamStates?e.streamStates=t.streamStates.map(n=>n?StreamStateInfo.toJSON(n):void 0):e.streamStates=[],e},create(t){return StreamStateUpdate.fromPartial(t??{})},fromPartial(t){var e;const n=createBaseStreamStateUpdate();return n.streamStates=((e=t.streamStates)===null||e===void 0?void 0:e.map(a=>StreamStateInfo.fromPartial(a)))||[],n}};function createBaseSubscribedQuality(){return{quality:0,enabled:!1}}const SubscribedQuality={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.quality!==0&&e.uint32(8).int32(t.quality),t.enabled===!0&&e.uint32(16).bool(t.enabled),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSubscribedQuality();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=8)break;s.quality=n.int32();continue;case 2:if(c!=16)break;s.enabled=n.bool();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{quality:isSet(t.quality)?videoQualityFromJSON(t.quality):0,enabled:isSet(t.enabled)?!!t.enabled:!1}},toJSON(t){const e={};return t.quality!==void 0&&(e.quality=videoQualityToJSON(t.quality)),t.enabled!==void 0&&(e.enabled=t.enabled),e},create(t){return SubscribedQuality.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseSubscribedQuality();return a.quality=(e=t.quality)!==null&&e!==void 0?e:0,a.enabled=(n=t.enabled)!==null&&n!==void 0?n:!1,a}};function createBaseSubscribedCodec(){return{codec:"",qualities:[]}}const SubscribedCodec={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.codec!==""&&e.uint32(10).string(t.codec);for(const n of t.qualities)SubscribedQuality.encode(n,e.uint32(18).fork()).ldelim();return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSubscribedCodec();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.codec=n.string();continue;case 2:if(c!=18)break;s.qualities.push(SubscribedQuality.decode(n,n.uint32()));continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{codec:isSet(t.codec)?String(t.codec):"",qualities:Array.isArray(t==null?void 0:t.qualities)?t.qualities.map(e=>SubscribedQuality.fromJSON(e)):[]}},toJSON(t){const e={};return t.codec!==void 0&&(e.codec=t.codec),t.qualities?e.qualities=t.qualities.map(n=>n?SubscribedQuality.toJSON(n):void 0):e.qualities=[],e},create(t){return SubscribedCodec.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseSubscribedCodec();return a.codec=(e=t.codec)!==null&&e!==void 0?e:"",a.qualities=((n=t.qualities)===null||n===void 0?void 0:n.map(s=>SubscribedQuality.fromPartial(s)))||[],a}};function createBaseSubscribedQualityUpdate(){return{trackSid:"",subscribedQualities:[],subscribedCodecs:[]}}const SubscribedQualityUpdate={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.trackSid!==""&&e.uint32(10).string(t.trackSid);for(const n of t.subscribedQualities)SubscribedQuality.encode(n,e.uint32(18).fork()).ldelim();for(const n of t.subscribedCodecs)SubscribedCodec.encode(n,e.uint32(26).fork()).ldelim();return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSubscribedQualityUpdate();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.trackSid=n.string();continue;case 2:if(c!=18)break;s.subscribedQualities.push(SubscribedQuality.decode(n,n.uint32()));continue;case 3:if(c!=26)break;s.subscribedCodecs.push(SubscribedCodec.decode(n,n.uint32()));continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{trackSid:isSet(t.trackSid)?String(t.trackSid):"",subscribedQualities:Array.isArray(t==null?void 0:t.subscribedQualities)?t.subscribedQualities.map(e=>SubscribedQuality.fromJSON(e)):[],subscribedCodecs:Array.isArray(t==null?void 0:t.subscribedCodecs)?t.subscribedCodecs.map(e=>SubscribedCodec.fromJSON(e)):[]}},toJSON(t){const e={};return t.trackSid!==void 0&&(e.trackSid=t.trackSid),t.subscribedQualities?e.subscribedQualities=t.subscribedQualities.map(n=>n?SubscribedQuality.toJSON(n):void 0):e.subscribedQualities=[],t.subscribedCodecs?e.subscribedCodecs=t.subscribedCodecs.map(n=>n?SubscribedCodec.toJSON(n):void 0):e.subscribedCodecs=[],e},create(t){return SubscribedQualityUpdate.fromPartial(t??{})},fromPartial(t){var e,n,a;const s=createBaseSubscribedQualityUpdate();return s.trackSid=(e=t.trackSid)!==null&&e!==void 0?e:"",s.subscribedQualities=((n=t.subscribedQualities)===null||n===void 0?void 0:n.map(c=>SubscribedQuality.fromPartial(c)))||[],s.subscribedCodecs=((a=t.subscribedCodecs)===null||a===void 0?void 0:a.map(c=>SubscribedCodec.fromPartial(c)))||[],s}};function createBaseTrackPermission(){return{participantSid:"",allTracks:!1,trackSids:[],participantIdentity:""}}const TrackPermission={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.participantSid!==""&&e.uint32(10).string(t.participantSid),t.allTracks===!0&&e.uint32(16).bool(t.allTracks);for(const n of t.trackSids)e.uint32(26).string(n);return t.participantIdentity!==""&&e.uint32(34).string(t.participantIdentity),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseTrackPermission();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.participantSid=n.string();continue;case 2:if(c!=16)break;s.allTracks=n.bool();continue;case 3:if(c!=26)break;s.trackSids.push(n.string());continue;case 4:if(c!=34)break;s.participantIdentity=n.string();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{participantSid:isSet(t.participantSid)?String(t.participantSid):"",allTracks:isSet(t.allTracks)?!!t.allTracks:!1,trackSids:Array.isArray(t==null?void 0:t.trackSids)?t.trackSids.map(e=>String(e)):[],participantIdentity:isSet(t.participantIdentity)?String(t.participantIdentity):""}},toJSON(t){const e={};return t.participantSid!==void 0&&(e.participantSid=t.participantSid),t.allTracks!==void 0&&(e.allTracks=t.allTracks),t.trackSids?e.trackSids=t.trackSids.map(n=>n):e.trackSids=[],t.participantIdentity!==void 0&&(e.participantIdentity=t.participantIdentity),e},create(t){return TrackPermission.fromPartial(t??{})},fromPartial(t){var e,n,a,s;const c=createBaseTrackPermission();return c.participantSid=(e=t.participantSid)!==null&&e!==void 0?e:"",c.allTracks=(n=t.allTracks)!==null&&n!==void 0?n:!1,c.trackSids=((a=t.trackSids)===null||a===void 0?void 0:a.map(u=>u))||[],c.participantIdentity=(s=t.participantIdentity)!==null&&s!==void 0?s:"",c}};function createBaseSubscriptionPermission(){return{allParticipants:!1,trackPermissions:[]}}const SubscriptionPermission={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.allParticipants===!0&&e.uint32(8).bool(t.allParticipants);for(const n of t.trackPermissions)TrackPermission.encode(n,e.uint32(18).fork()).ldelim();return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSubscriptionPermission();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=8)break;s.allParticipants=n.bool();continue;case 2:if(c!=18)break;s.trackPermissions.push(TrackPermission.decode(n,n.uint32()));continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{allParticipants:isSet(t.allParticipants)?!!t.allParticipants:!1,trackPermissions:Array.isArray(t==null?void 0:t.trackPermissions)?t.trackPermissions.map(e=>TrackPermission.fromJSON(e)):[]}},toJSON(t){const e={};return t.allParticipants!==void 0&&(e.allParticipants=t.allParticipants),t.trackPermissions?e.trackPermissions=t.trackPermissions.map(n=>n?TrackPermission.toJSON(n):void 0):e.trackPermissions=[],e},create(t){return SubscriptionPermission.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseSubscriptionPermission();return a.allParticipants=(e=t.allParticipants)!==null&&e!==void 0?e:!1,a.trackPermissions=((n=t.trackPermissions)===null||n===void 0?void 0:n.map(s=>TrackPermission.fromPartial(s)))||[],a}};function createBaseSubscriptionPermissionUpdate(){return{participantSid:"",trackSid:"",allowed:!1}}const SubscriptionPermissionUpdate={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.participantSid!==""&&e.uint32(10).string(t.participantSid),t.trackSid!==""&&e.uint32(18).string(t.trackSid),t.allowed===!0&&e.uint32(24).bool(t.allowed),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSubscriptionPermissionUpdate();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.participantSid=n.string();continue;case 2:if(c!=18)break;s.trackSid=n.string();continue;case 3:if(c!=24)break;s.allowed=n.bool();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{participantSid:isSet(t.participantSid)?String(t.participantSid):"",trackSid:isSet(t.trackSid)?String(t.trackSid):"",allowed:isSet(t.allowed)?!!t.allowed:!1}},toJSON(t){const e={};return t.participantSid!==void 0&&(e.participantSid=t.participantSid),t.trackSid!==void 0&&(e.trackSid=t.trackSid),t.allowed!==void 0&&(e.allowed=t.allowed),e},create(t){return SubscriptionPermissionUpdate.fromPartial(t??{})},fromPartial(t){var e,n,a;const s=createBaseSubscriptionPermissionUpdate();return s.participantSid=(e=t.participantSid)!==null&&e!==void 0?e:"",s.trackSid=(n=t.trackSid)!==null&&n!==void 0?n:"",s.allowed=(a=t.allowed)!==null&&a!==void 0?a:!1,s}};function createBaseSyncState(){return{answer:void 0,subscription:void 0,publishTracks:[],dataChannels:[],offer:void 0}}const SyncState={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();t.answer!==void 0&&SessionDescription.encode(t.answer,e.uint32(10).fork()).ldelim(),t.subscription!==void 0&&UpdateSubscription.encode(t.subscription,e.uint32(18).fork()).ldelim();for(const n of t.publishTracks)TrackPublishedResponse.encode(n,e.uint32(26).fork()).ldelim();for(const n of t.dataChannels)DataChannelInfo.encode(n,e.uint32(34).fork()).ldelim();return t.offer!==void 0&&SessionDescription.encode(t.offer,e.uint32(42).fork()).ldelim(),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSyncState();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.answer=SessionDescription.decode(n,n.uint32());continue;case 2:if(c!=18)break;s.subscription=UpdateSubscription.decode(n,n.uint32());continue;case 3:if(c!=26)break;s.publishTracks.push(TrackPublishedResponse.decode(n,n.uint32()));continue;case 4:if(c!=34)break;s.dataChannels.push(DataChannelInfo.decode(n,n.uint32()));continue;case 5:if(c!=42)break;s.offer=SessionDescription.decode(n,n.uint32());continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{answer:isSet(t.answer)?SessionDescription.fromJSON(t.answer):void 0,subscription:isSet(t.subscription)?UpdateSubscription.fromJSON(t.subscription):void 0,publishTracks:Array.isArray(t==null?void 0:t.publishTracks)?t.publishTracks.map(e=>TrackPublishedResponse.fromJSON(e)):[],dataChannels:Array.isArray(t==null?void 0:t.dataChannels)?t.dataChannels.map(e=>DataChannelInfo.fromJSON(e)):[],offer:isSet(t.offer)?SessionDescription.fromJSON(t.offer):void 0}},toJSON(t){const e={};return t.answer!==void 0&&(e.answer=t.answer?SessionDescription.toJSON(t.answer):void 0),t.subscription!==void 0&&(e.subscription=t.subscription?UpdateSubscription.toJSON(t.subscription):void 0),t.publishTracks?e.publishTracks=t.publishTracks.map(n=>n?TrackPublishedResponse.toJSON(n):void 0):e.publishTracks=[],t.dataChannels?e.dataChannels=t.dataChannels.map(n=>n?DataChannelInfo.toJSON(n):void 0):e.dataChannels=[],t.offer!==void 0&&(e.offer=t.offer?SessionDescription.toJSON(t.offer):void 0),e},create(t){return SyncState.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBaseSyncState();return a.answer=t.answer!==void 0&&t.answer!==null?SessionDescription.fromPartial(t.answer):void 0,a.subscription=t.subscription!==void 0&&t.subscription!==null?UpdateSubscription.fromPartial(t.subscription):void 0,a.publishTracks=((e=t.publishTracks)===null||e===void 0?void 0:e.map(s=>TrackPublishedResponse.fromPartial(s)))||[],a.dataChannels=((n=t.dataChannels)===null||n===void 0?void 0:n.map(s=>DataChannelInfo.fromPartial(s)))||[],a.offer=t.offer!==void 0&&t.offer!==null?SessionDescription.fromPartial(t.offer):void 0,a}};function createBaseDataChannelInfo(){return{label:"",id:0,target:0}}const DataChannelInfo={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.label!==""&&e.uint32(10).string(t.label),t.id!==0&&e.uint32(16).uint32(t.id),t.target!==0&&e.uint32(24).int32(t.target),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseDataChannelInfo();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=10)break;s.label=n.string();continue;case 2:if(c!=16)break;s.id=n.uint32();continue;case 3:if(c!=24)break;s.target=n.int32();continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{label:isSet(t.label)?String(t.label):"",id:isSet(t.id)?Number(t.id):0,target:isSet(t.target)?signalTargetFromJSON(t.target):0}},toJSON(t){const e={};return t.label!==void 0&&(e.label=t.label),t.id!==void 0&&(e.id=Math.round(t.id)),t.target!==void 0&&(e.target=signalTargetToJSON(t.target)),e},create(t){return DataChannelInfo.fromPartial(t??{})},fromPartial(t){var e,n,a;const s=createBaseDataChannelInfo();return s.label=(e=t.label)!==null&&e!==void 0?e:"",s.id=(n=t.id)!==null&&n!==void 0?n:0,s.target=(a=t.target)!==null&&a!==void 0?a:0,s}};function createBaseSimulateScenario(){return{scenario:void 0}}const SimulateScenario={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();var n;switch((n=t.scenario)===null||n===void 0?void 0:n.$case){case"speakerUpdate":e.uint32(8).int32(t.scenario.speakerUpdate);break;case"nodeFailure":e.uint32(16).bool(t.scenario.nodeFailure);break;case"migration":e.uint32(24).bool(t.scenario.migration);break;case"serverLeave":e.uint32(32).bool(t.scenario.serverLeave);break;case"switchCandidateProtocol":e.uint32(40).int32(t.scenario.switchCandidateProtocol);break;case"subscriberBandwidth":e.uint32(48).int64(t.scenario.subscriberBandwidth);break}return e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBaseSimulateScenario();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=8)break;s.scenario={$case:"speakerUpdate",speakerUpdate:n.int32()};continue;case 2:if(c!=16)break;s.scenario={$case:"nodeFailure",nodeFailure:n.bool()};continue;case 3:if(c!=24)break;s.scenario={$case:"migration",migration:n.bool()};continue;case 4:if(c!=32)break;s.scenario={$case:"serverLeave",serverLeave:n.bool()};continue;case 5:if(c!=40)break;s.scenario={$case:"switchCandidateProtocol",switchCandidateProtocol:n.int32()};continue;case 6:if(c!=48)break;s.scenario={$case:"subscriberBandwidth",subscriberBandwidth:longToNumber(n.int64())};continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{scenario:isSet(t.speakerUpdate)?{$case:"speakerUpdate",speakerUpdate:Number(t.speakerUpdate)}:isSet(t.nodeFailure)?{$case:"nodeFailure",nodeFailure:!!t.nodeFailure}:isSet(t.migration)?{$case:"migration",migration:!!t.migration}:isSet(t.serverLeave)?{$case:"serverLeave",serverLeave:!!t.serverLeave}:isSet(t.switchCandidateProtocol)?{$case:"switchCandidateProtocol",switchCandidateProtocol:candidateProtocolFromJSON(t.switchCandidateProtocol)}:isSet(t.subscriberBandwidth)?{$case:"subscriberBandwidth",subscriberBandwidth:Number(t.subscriberBandwidth)}:void 0}},toJSON(t){var e,n,a,s,c,u,d,m,_,b,S,k,w;const O={};return((e=t.scenario)===null||e===void 0?void 0:e.$case)==="speakerUpdate"&&(O.speakerUpdate=Math.round((n=t.scenario)===null||n===void 0?void 0:n.speakerUpdate)),((a=t.scenario)===null||a===void 0?void 0:a.$case)==="nodeFailure"&&(O.nodeFailure=(s=t.scenario)===null||s===void 0?void 0:s.nodeFailure),((c=t.scenario)===null||c===void 0?void 0:c.$case)==="migration"&&(O.migration=(u=t.scenario)===null||u===void 0?void 0:u.migration),((d=t.scenario)===null||d===void 0?void 0:d.$case)==="serverLeave"&&(O.serverLeave=(m=t.scenario)===null||m===void 0?void 0:m.serverLeave),((_=t.scenario)===null||_===void 0?void 0:_.$case)==="switchCandidateProtocol"&&(O.switchCandidateProtocol=((b=t.scenario)===null||b===void 0?void 0:b.switchCandidateProtocol)!==void 0?candidateProtocolToJSON((S=t.scenario)===null||S===void 0?void 0:S.switchCandidateProtocol):void 0),((k=t.scenario)===null||k===void 0?void 0:k.$case)==="subscriberBandwidth"&&(O.subscriberBandwidth=Math.round((w=t.scenario)===null||w===void 0?void 0:w.subscriberBandwidth)),O},create(t){return SimulateScenario.fromPartial(t??{})},fromPartial(t){var e,n,a,s,c,u,d,m,_,b,S,k,w,O,P,N,I,U;const $=createBaseSimulateScenario();return((e=t.scenario)===null||e===void 0?void 0:e.$case)==="speakerUpdate"&&((n=t.scenario)===null||n===void 0?void 0:n.speakerUpdate)!==void 0&&((a=t.scenario)===null||a===void 0?void 0:a.speakerUpdate)!==null&&($.scenario={$case:"speakerUpdate",speakerUpdate:t.scenario.speakerUpdate}),((s=t.scenario)===null||s===void 0?void 0:s.$case)==="nodeFailure"&&((c=t.scenario)===null||c===void 0?void 0:c.nodeFailure)!==void 0&&((u=t.scenario)===null||u===void 0?void 0:u.nodeFailure)!==null&&($.scenario={$case:"nodeFailure",nodeFailure:t.scenario.nodeFailure}),((d=t.scenario)===null||d===void 0?void 0:d.$case)==="migration"&&((m=t.scenario)===null||m===void 0?void 0:m.migration)!==void 0&&((_=t.scenario)===null||_===void 0?void 0:_.migration)!==null&&($.scenario={$case:"migration",migration:t.scenario.migration}),((b=t.scenario)===null||b===void 0?void 0:b.$case)==="serverLeave"&&((S=t.scenario)===null||S===void 0?void 0:S.serverLeave)!==void 0&&((k=t.scenario)===null||k===void 0?void 0:k.serverLeave)!==null&&($.scenario={$case:"serverLeave",serverLeave:t.scenario.serverLeave}),((w=t.scenario)===null||w===void 0?void 0:w.$case)==="switchCandidateProtocol"&&((O=t.scenario)===null||O===void 0?void 0:O.switchCandidateProtocol)!==void 0&&((P=t.scenario)===null||P===void 0?void 0:P.switchCandidateProtocol)!==null&&($.scenario={$case:"switchCandidateProtocol",switchCandidateProtocol:t.scenario.switchCandidateProtocol}),((N=t.scenario)===null||N===void 0?void 0:N.$case)==="subscriberBandwidth"&&((I=t.scenario)===null||I===void 0?void 0:I.subscriberBandwidth)!==void 0&&((U=t.scenario)===null||U===void 0?void 0:U.subscriberBandwidth)!==null&&($.scenario={$case:"subscriberBandwidth",subscriberBandwidth:t.scenario.subscriberBandwidth}),$}};function createBasePing(){return{timestamp:0,rtt:0}}const Ping={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.timestamp!==0&&e.uint32(8).int64(t.timestamp),t.rtt!==0&&e.uint32(16).int64(t.rtt),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBasePing();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=8)break;s.timestamp=longToNumber(n.int64());continue;case 2:if(c!=16)break;s.rtt=longToNumber(n.int64());continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{timestamp:isSet(t.timestamp)?Number(t.timestamp):0,rtt:isSet(t.rtt)?Number(t.rtt):0}},toJSON(t){const e={};return t.timestamp!==void 0&&(e.timestamp=Math.round(t.timestamp)),t.rtt!==void 0&&(e.rtt=Math.round(t.rtt)),e},create(t){return Ping.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBasePing();return a.timestamp=(e=t.timestamp)!==null&&e!==void 0?e:0,a.rtt=(n=t.rtt)!==null&&n!==void 0?n:0,a}};function createBasePong(){return{lastPingTimestamp:0,timestamp:0}}const Pong={encode(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_m0$1.Writer.create();return t.lastPingTimestamp!==0&&e.uint32(8).int64(t.lastPingTimestamp),t.timestamp!==0&&e.uint32(16).int64(t.timestamp),e},decode(t,e){const n=t instanceof _m0$1.Reader?t:_m0$1.Reader.create(t);let a=e===void 0?n.len:n.pos+e;const s=createBasePong();for(;n.pos<a;){const c=n.uint32();switch(c>>>3){case 1:if(c!=8)break;s.lastPingTimestamp=longToNumber(n.int64());continue;case 2:if(c!=16)break;s.timestamp=longToNumber(n.int64());continue}if((c&7)==4||c==0)break;n.skipType(c&7)}return s},fromJSON(t){return{lastPingTimestamp:isSet(t.lastPingTimestamp)?Number(t.lastPingTimestamp):0,timestamp:isSet(t.timestamp)?Number(t.timestamp):0}},toJSON(t){const e={};return t.lastPingTimestamp!==void 0&&(e.lastPingTimestamp=Math.round(t.lastPingTimestamp)),t.timestamp!==void 0&&(e.timestamp=Math.round(t.timestamp)),e},create(t){return Pong.fromPartial(t??{})},fromPartial(t){var e,n;const a=createBasePong();return a.lastPingTimestamp=(e=t.lastPingTimestamp)!==null&&e!==void 0?e:0,a.timestamp=(n=t.timestamp)!==null&&n!==void 0?n:0,a}};var tsProtoGlobalThis=(()=>{if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof dist.global<"u")return dist.global;throw"Unable to locate global object"})();function longToNumber(t){if(t.gt(Number.MAX_SAFE_INTEGER))throw new tsProtoGlobalThis.Error("Value is larger than Number.MAX_SAFE_INTEGER");return t.toNumber()}_m0$1.util.Long!==Long$1$1&&(_m0$1.util.Long=Long$1$1,_m0$1.configure());function isSet(t){return t!=null}class LivekitError extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}class ConnectionError extends LivekitError{constructor(e,n,a){super(1,e),this.status=a,this.reason=n}}class DeviceUnsupportedError extends LivekitError{constructor(e){super(21,e??"device is unsupported")}}class TrackInvalidError extends LivekitError{constructor(e){super(20,e??"track is invalid")}}class UnsupportedServer extends LivekitError{constructor(e){super(10,e??"unsupported server")}}class UnexpectedConnectionState extends LivekitError{constructor(e){super(12,e??"unexpected connection state")}}class NegotiationError extends LivekitError{constructor(e){super(13,e??"unable to negotiate")}}var MediaDeviceFailure;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(MediaDeviceFailure||(MediaDeviceFailure={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(MediaDeviceFailure||(MediaDeviceFailure={}));class CriticalTimers{}CriticalTimers.setTimeout=function(){return setTimeout(...arguments)};CriticalTimers.setInterval=function(){return setInterval(...arguments)};CriticalTimers.clearTimeout=function(){return clearTimeout(...arguments)};CriticalTimers.clearInterval=function(){return clearInterval(...arguments)};const commonVersionIdentifier=/version\/(\d+(\.?_?\d+)+)/i;let browserDetails;function getBrowser(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof t>"u"&&typeof navigator>"u")return;const n=(t??navigator.userAgent).toLowerCase();if(browserDetails===void 0||e){const a=browsersList.find(s=>{let{test:c}=s;return c.test(n)});browserDetails=a==null?void 0:a.describe(n)}return browserDetails}const browsersList=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:getMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t)}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:getMatch(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t)}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:getMatch(commonVersionIdentifier,t)}}}];function getMatch(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const a=e.match(t);return a&&a.length>=n&&a[n]||""}var version$1="1.9.7";const version=version$1,protocolVersion=9;function mergeDefaultOptions(t,e,n){const a=Object.assign({},t);return a.audio===!0&&(a.audio={}),a.video===!0&&(a.video={}),a.audio&&mergeObjectWithoutOverwriting(a.audio,e),a.video&&mergeObjectWithoutOverwriting(a.video,n),a}function mergeObjectWithoutOverwriting(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function constraintsForOptions(t){const e={};if(t.video)if(typeof t.video=="object"){const n={},a=n,s=t.video;Object.keys(s).forEach(c=>{switch(c){case"resolution":mergeObjectWithoutOverwriting(a,s.resolution);break;default:a[c]=s[c]}}),e.video=n}else e.video=t.video;else e.video=!1;return t.audio?typeof t.audio=="object"?e.audio=t.audio:e.audio=!0:e.audio=!1,e}function detectSilence(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return __awaiter(this,void 0,void 0,function*(){const n=getNewAudioContext();if(n){const a=n.createAnalyser();a.fftSize=2048;const s=a.frequencyBinCount,c=new Uint8Array(s);n.createMediaStreamSource(new MediaStream([t.mediaStreamTrack])).connect(a),yield sleep(e),a.getByteTimeDomainData(c);const d=c.some(m=>m!==128&&m!==0);return n.close(),!d}return!1})}function getNewAudioContext(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}const separator="|",ddExtensionURI="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function unpackStreamId(t){const e=t.split(separator);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function sleep(t){return __awaiter(this,void 0,void 0,function*(){return new Promise(e=>setTimeout(e,t))})}function supportsTransceiver(){return"addTransceiver"in RTCPeerConnection.prototype}function supportsAddTrack(){return"addTrack"in RTCPeerConnection.prototype}function supportsAV1(){if(!("getCapabilities"in RTCRtpSender))return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function supportsVP9(){if(!("getCapabilities"in RTCRtpSender))return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function isSVCCodec(t){return t==="av1"||t==="vp9"}function supportsSetSinkId(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}const setCodecPreferencesVersions={Chrome:"100",Safari:"15",Firefox:"100"};function supportsSetCodecPreferences(t){if(!isWeb()||!("setCodecPreferences"in t))return!1;const e=getBrowser();if(!(e!=null&&e.name)||!e.version)return!1;const n=setCodecPreferencesVersions[e.name];return n?compareVersions(e.version,n)>=0:!1}function isFireFox(){var t;return((t=getBrowser())===null||t===void 0?void 0:t.name)==="Firefox"}function isChromiumBased(){var t;return((t=getBrowser())===null||t===void 0?void 0:t.name)==="Chrome"}function isSafari(){var t;return((t=getBrowser())===null||t===void 0?void 0:t.name)==="Safari"}function isMobile(){return isWeb()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function isWeb(){return typeof document<"u"}function isReactNative(){return navigator.product=="ReactNative"}function isCloud(t){return t.hostname.endsWith(".livekit.cloud")}function getLKReactNativeInfo(){if(dist.global&&dist.global.LiveKitReactNativeGlobal)return dist.global.LiveKitReactNativeGlobal}function getReactNativeOs(){if(!isReactNative())return;let t=getLKReactNativeInfo();if(t)return t.platform}function getDevicePixelRatio(){if(isWeb())return window.devicePixelRatio;if(isReactNative()){let t=getLKReactNativeInfo();if(t)return t.devicePixelRatio}return 1}function compareVersions(t,e){const n=t.split("."),a=e.split("."),s=Math.min(n.length,a.length);for(let c=0;c<s;++c){const u=parseInt(n[c],10),d=parseInt(a[c],10);if(u>d)return 1;if(u<d)return-1;if(c===s-1&&u===d)return 0}return t===""&&e!==""?-1:e===""?1:n.length==a.length?0:n.length<a.length?-1:1}function roDispatchCallback(t){for(const e of t)e.target.handleResize(e)}function ioDispatchCallback(t){for(const e of t)e.target.handleVisibilityChanged(e)}let resizeObserver=null;const getResizeObserver=()=>(resizeObserver||(resizeObserver=new ResizeObserver(roDispatchCallback)),resizeObserver);let intersectionObserver=null;const getIntersectionObserver=()=>(intersectionObserver||(intersectionObserver=new IntersectionObserver(ioDispatchCallback,{root:null,rootMargin:"0px"})),intersectionObserver);function getClientInfo(){var t;const e=ClientInfo.fromPartial({sdk:ClientInfo_SDK$1.JS,protocol:protocolVersion,version});return isReactNative()&&(e.os=(t=getReactNativeOs())!==null&&t!==void 0?t:""),e}let emptyVideoStreamTrack;function getEmptyVideoStreamTrack(){return emptyVideoStreamTrack||(emptyVideoStreamTrack=createDummyVideoStreamTrack()),emptyVideoStreamTrack}function createDummyVideoStreamTrack(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=document.createElement("canvas");s.width=t,s.height=e;const c=s.getContext("2d");c==null||c.fillRect(0,0,s.width,s.height),a&&c&&(c.beginPath(),c.arc(t/2,e/2,50,0,Math.PI*2,!0),c.closePath(),c.fillStyle="grey",c.fill());const u=s.captureStream(),[d]=u.getTracks();if(!d)throw Error("Could not get empty media stream video track");return d.enabled=n,d}let emptyAudioStreamTrack;function getEmptyAudioStreamTrack(){if(!emptyAudioStreamTrack){const t=new AudioContext,e=t.createOscillator(),n=t.createMediaStreamDestination();if(e.connect(n),e.start(),[emptyAudioStreamTrack]=n.stream.getAudioTracks(),!emptyAudioStreamTrack)throw Error("Could not get empty media stream audio track");emptyAudioStreamTrack.enabled=!1}return emptyAudioStreamTrack}class Future{constructor(e,n){this.onFinally=n,this.promise=new Promise((a,s)=>__awaiter(this,void 0,void 0,function*(){this.resolve=a,this.reject=s,e&&(yield e(a,s))})).finally(()=>{var a;return(a=this.onFinally)===null||a===void 0?void 0:a.call(this)})}}class Mutex{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(s=>e=()=>{this._locks-=1,s()}),a=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),a}}var QueueTaskStatus;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(QueueTaskStatus||(QueueTaskStatus={}));class AsyncQueue{constructor(){this.pendingTasks=new Map,this.taskMutex=new Mutex,this.nextTaskIndex=0}run(e){return __awaiter(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:QueueTaskStatus.WAITING};this.pendingTasks.set(n.id,n);const a=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=QueueTaskStatus.RUNNING,yield e()}finally{n.status=QueueTaskStatus.COMPLETED,this.pendingTasks.delete(n.id),a()}})}flush(){return __awaiter(this,void 0,void 0,function*(){return this.run(()=>__awaiter(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const passThroughQueueSignals=["syncState","trickle","offer","answer","simulate","leave"];function canPassThroughQueue(t){const e=passThroughQueueSignals.indexOf(t.$case)>=0;return livekitLogger.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}class SignalClient{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.rtt=0,this.isConnected=!1,this.isReconnecting=!1,this.useJSON=e,this.requestQueue=new AsyncQueue,this.queuedRequests=[],this.closingLock=new Mutex}join(e,n,a,s){return __awaiter(this,void 0,void 0,function*(){return this.isConnected=!1,this.options=a,yield this.connect(e,n,a,s)})}reconnect(e,n,a,s){return __awaiter(this,void 0,void 0,function*(){if(!this.options){livekitLogger.warn("attempted to reconnect without signal options being set, ignoring");return}return this.isReconnecting=!0,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:a,reconnectReason:s}))})}connect(e,n,a,s){this.connectOptions=a,e.startsWith("http")&&(e=e.replace("http","ws")),e=e.replace(/\/$/,""),e+="/rtc";const c=getClientInfo(),u=createConnectionParams(n,c,a);return new Promise((d,m)=>__awaiter(this,void 0,void 0,function*(){const _=()=>__awaiter(this,void 0,void 0,function*(){yield this.close(),m(new ConnectionError("room connection has been cancelled (signal)"))});s!=null&&s.aborted&&_(),s==null||s.addEventListener("abort",_),livekitLogger.debug("connecting to ".concat(e+u)),this.ws&&(yield this.close()),this.ws=new WebSocket(e+u),this.ws.binaryType="arraybuffer",this.ws.onerror=b=>__awaiter(this,void 0,void 0,function*(){if(!this.isConnected){try{const S=yield fetch("http".concat(e.substring(2),"/validate").concat(u));if(S.status.toFixed(0).startsWith("4")){const k=yield S.text();m(new ConnectionError(k,0,S.status))}else m(new ConnectionError("Internal error",2,S.status))}catch{m(new ConnectionError("server was not reachable",1))}return}this.handleWSError(b)}),this.ws.onmessage=b=>__awaiter(this,void 0,void 0,function*(){var S,k,w,O;let P;if(typeof b.data=="string"){const N=JSON.parse(b.data);P=SignalResponse.fromJSON(N)}else if(b.data instanceof ArrayBuffer)P=SignalResponse.decode(new Uint8Array(b.data));else{livekitLogger.error("could not decode websocket message: ".concat(typeof b.data));return}if(!this.isConnected){let N=!1;if(((S=P.message)===null||S===void 0?void 0:S.$case)==="join"?(this.isConnected=!0,s==null||s.removeEventListener("abort",_),this.pingTimeoutDuration=P.message.join.pingTimeout,this.pingIntervalDuration=P.message.join.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(livekitLogger.debug("ping config",{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration}),this.startPingInterval()),d(P.message.join)):a.reconnect?(this.isConnected=!0,s==null||s.removeEventListener("abort",_),this.startPingInterval(),((k=P.message)===null||k===void 0?void 0:k.$case)==="reconnect"?d((w=P.message)===null||w===void 0?void 0:w.reconnect):(d(),N=!0)):a.reconnect||m(new ConnectionError("did not receive join response, got ".concat((O=P.message)===null||O===void 0?void 0:O.$case," instead"))),!N)return}this.signalLatency&&(yield sleep(this.signalLatency)),this.handleSignalResponse(P)}),this.ws.onclose=b=>{livekitLogger.warn("websocket closed",{ev:b}),this.handleOnClose(b.reason)}}))}close(){return __awaiter(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();try{if(this.isConnected=!1,this.ws){this.ws.onclose=null,this.ws.onmessage=null,this.ws.onopen=null;const n=new Promise(a=>{this.ws?this.ws.onclose=a:a(!0)});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([n,sleep(250)])),this.ws=void 0,this.clearPingInterval()}}finally{e()}})}sendOffer(e){livekitLogger.debug("sending offer",e),this.sendRequest({$case:"offer",offer:toProtoSessionDescription(e)})}sendAnswer(e){return livekitLogger.debug("sending answer"),this.sendRequest({$case:"answer",answer:toProtoSessionDescription(e)})}sendIceCandidate(e,n){return livekitLogger.trace("sending ice candidate",e),this.sendRequest({$case:"trickle",trickle:{candidateInit:JSON.stringify(e),target:n}})}sendMuteTrack(e,n){return this.sendRequest({$case:"mute",mute:{sid:e,muted:n}})}sendAddTrack(e){return this.sendRequest({$case:"addTrack",addTrack:AddTrackRequest.fromPartial(e)})}sendUpdateLocalMetadata(e,n){return this.sendRequest({$case:"updateMetadata",updateMetadata:{metadata:e,name:n}})}sendUpdateTrackSettings(e){this.sendRequest({$case:"trackSetting",trackSetting:e})}sendUpdateSubscription(e){return this.sendRequest({$case:"subscription",subscription:e})}sendSyncState(e){return this.sendRequest({$case:"syncState",syncState:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({$case:"updateLayers",updateLayers:{trackSid:e,layers:n}})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({$case:"subscriptionPermission",subscriptionPermission:{allParticipants:e,trackPermissions:n}})}sendSimulateScenario(e){return this.sendRequest({$case:"simulate",simulate:e})}sendPing(){return Promise.all([this.sendRequest({$case:"ping",ping:Date.now()}),this.sendRequest({$case:"pingReq",pingReq:{timestamp:Date.now(),rtt:this.rtt}})])}sendLeave(){return this.sendRequest({$case:"leave",leave:{canReconnect:!1,reason:DisconnectReason$1.CLIENT_INITIATED}})}sendRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return __awaiter(this,void 0,void 0,function*(){if(!n&&!canPassThroughQueue(e)&&this.isReconnecting){this.queuedRequests.push(()=>__awaiter(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield sleep(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){livekitLogger.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.$case));return}const s={message:e};try{this.useJSON?this.ws.send(JSON.stringify(SignalRequest.toJSON(s))):this.ws.send(SignalRequest.encode(s).finish())}catch(c){livekitLogger.error("error sending signal message",{error:c})}})}handleSignalResponse(e){var n,a;const s=e.message;if(s==null){livekitLogger.debug("received unsupported message");return}if(s.$case==="answer"){const c=fromProtoSessionDescription(s.answer);this.onAnswer&&this.onAnswer(c)}else if(s.$case==="offer"){const c=fromProtoSessionDescription(s.offer);this.onOffer&&this.onOffer(c)}else if(s.$case==="trickle"){const c=JSON.parse(s.trickle.candidateInit);this.onTrickle&&this.onTrickle(c,s.trickle.target)}else s.$case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=s.update.participants)!==null&&n!==void 0?n:[]):s.$case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(s.trackPublished):s.$case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((a=s.speakersChanged.speakers)!==null&&a!==void 0?a:[]):s.$case==="leave"?this.onLeave&&this.onLeave(s.leave):s.$case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(s.mute.sid,s.mute.muted):s.$case==="roomUpdate"?this.onRoomUpdate&&s.roomUpdate.room&&this.onRoomUpdate(s.roomUpdate.room):s.$case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(s.connectionQuality):s.$case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(s.streamStateUpdate):s.$case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(s.subscribedQualityUpdate):s.$case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(s.subscriptionPermissionUpdate):s.$case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(s.refreshToken):s.$case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(s.trackUnpublished):s.$case==="pong"?this.resetPingTimeout():s.$case==="pongResp"?(this.rtt=Date.now()-s.pongResp.lastPingTimestamp,this.resetPingTimeout()):livekitLogger.debug("unsupported message",s)}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}this.isReconnecting=!1}handleOnClose(e){return __awaiter(this,void 0,void 0,function*(){this.isConnected&&(yield this.close(),livekitLogger.debug("websocket connection closed: ".concat(e)),this.onClose&&this.onClose(e))})}handleWSError(e){livekitLogger.error("websocket error",e)}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){livekitLogger.warn("ping timeout duration not set");return}this.pingTimeout=CriticalTimers.setTimeout(()=>{livekitLogger.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString())),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&CriticalTimers.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){livekitLogger.warn("ping interval duration not set");return}livekitLogger.debug("start ping interval"),this.pingInterval=CriticalTimers.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){livekitLogger.debug("clearing ping interval"),this.clearPingTimeout(),this.pingInterval&&CriticalTimers.clearInterval(this.pingInterval)}}function fromProtoSessionDescription(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function toProtoSessionDescription(t){return{sdp:t.sdp,type:t.type}}function createConnectionParams(t,e,n){var a;const s=new URLSearchParams;return s.set("access_token",t),n.reconnect&&(s.set("reconnect","1"),n.sid&&s.set("sid",n.sid)),s.set("auto_subscribe",n.autoSubscribe?"1":"0"),s.set("sdk",isReactNative()?"reactnative":"js"),s.set("version",e.version),s.set("protocol",e.protocol.toString()),e.deviceModel&&s.set("device_model",e.deviceModel),e.os&&s.set("os",e.os),e.osVersion&&s.set("os_version",e.osVersion),e.browser&&s.set("browser",e.browser),e.browserVersion&&s.set("browser_version",e.browserVersion),n.publishOnly!==void 0&&s.set("publish",n.publishOnly),n.adaptiveStream&&s.set("adaptive_stream","1"),n.reconnectReason&&s.set("reconnect_reason",n.reconnectReason.toString()),!((a=navigator.connection)===null||a===void 0)&&a.type&&s.set("network",navigator.connection.type),"?".concat(s.toString())}const defaultId="default";class DeviceManager{static getInstance(){return this.instance===void 0&&(this.instance=new DeviceManager),this.instance}getDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var a;return __awaiter(this,void 0,void 0,function*(){if(((a=DeviceManager.userMediaPromiseMap)===null||a===void 0?void 0:a.size)>0){livekitLogger.debug("awaiting getUserMedia promise");try{e?yield DeviceManager.userMediaPromiseMap.get(e):yield Promise.all(DeviceManager.userMediaPromiseMap.values())}catch{livekitLogger.warn("error waiting for media permissons")}}let s=yield navigator.mediaDevices.enumerateDevices();if(n&&e&&(!DeviceManager.userMediaPromiseMap.get(e)||!isSafari())&&(s.length===0||s.some(u=>{const d=u.label==="",m=e?u.kind===e:!0;return d&&m}))){const u={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},d=yield navigator.mediaDevices.getUserMedia(u);s=yield navigator.mediaDevices.enumerateDevices(),d.getTracks().forEach(m=>{m.stop()})}return e&&(s=s.filter(c=>c.kind===e)),s})}normalizeDeviceId(e,n,a){return __awaiter(this,void 0,void 0,function*(){if(n!==defaultId)return n;const c=(yield this.getDevices(e)).find(u=>u.groupId===a&&u.deviceId!==defaultId);return c==null?void 0:c.deviceId})}}DeviceManager.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];DeviceManager.userMediaPromiseMap=new Map;var parser$1={},grammar$2={exports:{}},grammar$1=grammar$2.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(grammar$1).forEach(function(t){var e=grammar$1[t];e.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var grammarExports=grammar$2.exports;(function(t){var e=function(d){return String(Number(d))===d?Number(d):d},n=function(d,m,_,b){if(b&&!_)m[b]=e(d[1]);else for(var S=0;S<_.length;S+=1)d[S+1]!=null&&(m[_[S]]=e(d[S+1]))},a=function(d,m,_){var b=d.name&&d.names;d.push&&!m[d.push]?m[d.push]=[]:b&&!m[d.name]&&(m[d.name]={});var S=d.push?{}:b?m[d.name]:m;n(_.match(d.reg),S,d.names,d.name),d.push&&m[d.push].push(S)},s=grammarExports,c=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(d){var m={},_=[],b=m;return d.split(/(\r\n|\r|\n)/).filter(c).forEach(function(S){var k=S[0],w=S.slice(2);k==="m"&&(_.push({rtp:[],fmtp:[]}),b=_[_.length-1]);for(var O=0;O<(s[k]||[]).length;O+=1){var P=s[k][O];if(P.reg.test(w))return a(P,b,w)}}),m.media=_,m};var u=function(d,m){var _=m.split(/=(.+)/,2);return _.length===2?d[_[0]]=e(_[1]):_.length===1&&m.length>1&&(d[_[0]]=void 0),d};t.parseParams=function(d){return d.split(/;\s?/).reduce(u,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(d){return d.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(d){for(var m=[],_=d.split(" ").map(e),b=0;b<_.length;b+=3)m.push({component:_[b],ip:_[b+1],port:_[b+2]});return m},t.parseImageAttributes=function(d){return d.split(" ").map(function(m){return m.substring(1,m.length-1).split(",").reduce(u,{})})},t.parseSimulcastStreamList=function(d){return d.split(";").map(function(m){return m.split(",").map(function(_){var b,S=!1;return _[0]!=="~"?b=e(_):(b=e(_.substring(1,_.length)),S=!0),{scid:b,paused:S}})})}})(parser$1);var grammar=grammarExports,formatRegExp=/%[sdv%]/g,format=function(t){var e=1,n=arguments,a=n.length;return t.replace(formatRegExp,function(s){if(e>=a)return s;var c=n[e];switch(e+=1,s){case"%%":return"%";case"%s":return String(c);case"%d":return Number(c);case"%v":return""}})},makeLine=function(t,e,n){var a=e.format instanceof Function?e.format(e.push?n:n[e.name]):e.format,s=[t+"="+a];if(e.names)for(var c=0;c<e.names.length;c+=1){var u=e.names[c];e.name?s.push(n[e.name][u]):s.push(n[e.names[c]])}else s.push(n[e.name]);return format.apply(null,s)},defaultOuterOrder=["v","o","s","i","u","e","p","c","b","t","r","z","a"],defaultInnerOrder=["i","c","b","a"],writer$1=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(c){c.payloads==null&&(c.payloads="")});var n=e.outerOrder||defaultOuterOrder,a=e.innerOrder||defaultInnerOrder,s=[];return n.forEach(function(c){grammar[c].forEach(function(u){u.name in t&&t[u.name]!=null?s.push(makeLine(c,u,t)):u.push in t&&t[u.push]!=null&&t[u.push].forEach(function(d){s.push(makeLine(c,u,d))})})}),t.media.forEach(function(c){s.push(makeLine("m",grammar.m[0],c)),a.forEach(function(u){grammar[u].forEach(function(d){d.name in c&&c[d.name]!=null?s.push(makeLine(u,d,c)):d.push in c&&c[d.push]!=null&&c[d.push].forEach(function(m){s.push(makeLine(u,d,m))})})})}),s.join(`\r
`)+`\r
`},parser=parser$1,writer$3=writer$1,write=writer$3,parse=parser.parse;function r(t,e,n){var a,s,c;e===void 0&&(e=50),n===void 0&&(n={});var u=(a=n.isImmediate)!=null&&a,d=(s=n.callback)!=null&&s,m=n.maxWait,_=Date.now(),b=[];function S(){if(m!==void 0){var w=Date.now()-_;if(w+e>=m)return m-w}return e}var k=function(){var w=[].slice.call(arguments),O=this;return new Promise(function(P,N){var I=u&&c===void 0;if(c!==void 0&&clearTimeout(c),c=setTimeout(function(){if(c=void 0,_=Date.now(),!u){var $=t.apply(O,w);d&&d($),b.forEach(function(x){return(0,x.resolve)($)}),b=[]}},S()),I){var U=t.apply(O,w);return d&&d(U),P(U)}b.push({resolve:P,reject:N})})};return k.cancel=function(w){c!==void 0&&clearTimeout(c),b.forEach(function(O){return(0,O.reject)(w)}),b=[]},k}const PCEvents={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete"};class PCTransport extends eventsExports$1.EventEmitter{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=r(a=>{this.emit(PCEvents.NegotiationStarted);try{this.createAndSendOffer()}catch(s){if(a)a(s);else throw s}},100),this.pc=isChromiumBased()?new RTCPeerConnection(e,n):new RTCPeerConnection(e)}get isICEConnected(){return this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed"}addIceCandidate(e){return __awaiter(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){return __awaiter(this,void 0,void 0,function*(){if(e.type==="offer"){let{stereoMids:n,nackMids:a}=extractStereoAndNackAudioFromOffer(e);this.remoteStereoMids=n,this.remoteNackMids=a}yield this.pc.setRemoteDescription(e),this.pendingCandidates.forEach(n=>{this.pc.addIceCandidate(n)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,this.createAndSendOffer()):e.type==="answer"&&this.emit(PCEvents.NegotiationComplete)})}createAndSendOffer(e){var n;return __awaiter(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(livekitLogger.debug("restarting ICE"),this.restartingIce=!0),this.pc.signalingState==="have-local-offer"){const c=this.pc.remoteDescription;if(e!=null&&e.iceRestart&&c)yield this.pc.setRemoteDescription(c);else{this.renegotiate=!0;return}}else if(this.pc.signalingState==="closed"){livekitLogger.warn("could not createOffer with closed peer connection");return}livekitLogger.debug("starting to negotiate");const a=yield this.pc.createOffer(e),s=parse((n=a.sdp)!==null&&n!==void 0?n:"");s.media.forEach(c=>{c.type==="audio"?ensureAudioNackAndStereo(c,[],[]):c.type==="video"&&(ensureVideoDDExtensionForSVC(c),this.trackBitrates.some(u=>{if(!c.msid||!c.msid.includes(u.sid))return!1;let d=0;return c.rtp.some(m=>m.codec.toUpperCase()===u.codec.toUpperCase()?(d=m.payload,!0):!1),d>0&&(c.fmtp.some(m=>m.payload===d?(m.config.includes("x-google-start-bitrate")||(m.config+=";x-google-start-bitrate=".concat(u.maxbr*.7)),m.config.includes("x-google-max-bitrate")||(m.config+=";x-google-max-bitrate=".concat(u.maxbr)),!0):!1)||c.fmtp.push({payload:d,config:"x-google-start-bitrate=".concat(u.maxbr*.7,";x-google-max-bitrate=").concat(u.maxbr)})),!0}))}),this.trackBitrates=[],yield this.setMungedLocalDescription(a,write(s)),this.onOffer(a)})}createAndSetAnswer(){var e;return __awaiter(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),a=parse((e=n.sdp)!==null&&e!==void 0?e:"");return a.media.forEach(s=>{s.type==="audio"&&ensureAudioNackAndStereo(s,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedLocalDescription(n,write(a)),n})}setTrackCodecBitrate(e,n,a){this.trackBitrates.push({sid:e,codec:n,maxbr:a})}close(){this.pc.onconnectionstatechange=null,this.pc.oniceconnectionstatechange=null,this.pc.close()}setMungedLocalDescription(e,n){return __awaiter(this,void 0,void 0,function*(){const a=e.sdp;e.sdp=n;try{livekitLogger.debug("setting munged local description"),yield this.pc.setLocalDescription(e);return}catch(s){livekitLogger.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),{error:s}),e.sdp=a}try{yield this.pc.setLocalDescription(e)}catch(s){let c="unknown error";throw s instanceof Error?c=s.message:typeof s=="string"&&(c=s),new NegotiationError(c)}})}}function ensureAudioNackAndStereo(t,e,n){let a=0;t.rtp.some(s=>s.codec==="opus"?(a=s.payload,!0):!1),a>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(s=>s.payload===a&&s.type==="nack")&&t.rtcpFb.push({payload:a,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(s=>s.payload===a?(s.config.includes("stereo=1")||(s.config+=";stereo=1"),!0):!1))}function ensureVideoDDExtensionForSVC(t){var e,n,a,s;const c=(n=(e=t.rtp[0])===null||e===void 0?void 0:e.codec)===null||n===void 0?void 0:n.toLowerCase();if(!isSVCCodec(c))return;let u=0;((a=t.ext)===null||a===void 0?void 0:a.some(m=>m.uri===ddExtensionURI?!0:(m.value>u&&(u=m.value),!1)))||(s=t.ext)===null||s===void 0||s.push({value:u+1,uri:ddExtensionURI})}function extractStereoAndNackAudioFromOffer(t){var e;const n=[],a=[],s=parse((e=t.sdp)!==null&&e!==void 0?e:"");let c=0;return s.media.forEach(u=>{var d;u.type==="audio"&&(u.rtp.some(m=>m.codec==="opus"?(c=m.payload,!0):!1),!((d=u.rtcpFb)===null||d===void 0)&&d.some(m=>m.payload===c&&m.type==="nack")&&a.push(u.mid),u.fmtp.some(m=>m.payload===c?(m.config.includes("sprop-stereo=1")&&n.push(u.mid),!0):!1))}),{stereoMids:n,nackMids:a}}class RegionUrlProvider{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}isCloud(){return isCloud(this.serverUrl)}getNextBestRegionUrl(e){return __awaiter(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(a=>!this.attemptedRegions.find(s=>s.url===a.url));if(n.length>0){const a=n[0];return this.attemptedRegions.push(a),livekitLogger.debug("next region: ".concat(a.region)),a.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return __awaiter(this,void 0,void 0,function*(){const n=yield fetch("".concat(getCloudConfigUrl(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const a=yield n.json();return this.lastUpdateAt=Date.now(),a}else throw new ConnectionError("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function getCloudConfigUrl(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}class VideoPreset{constructor(e,n,a,s,c){this.width=e,this.height=n,this.encoding={maxBitrate:a,maxFramerate:s,priority:c}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const backupCodecs=["vp8","h264"];function isBackupCodec(t){return!!backupCodecs.find(e=>e===t)}function isCodecEqual(t,e){return(t==null?void 0:t.toLowerCase().replace(/audio\/|video\//y,""))===(e==null?void 0:e.toLowerCase().replace(/audio\/|video\//y,""))}var AudioPresets;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:2e4},t.music={maxBitrate:32e3},t.musicStereo={maxBitrate:48e3},t.musicHighQuality={maxBitrate:64e3},t.musicHighQualityStereo={maxBitrate:96e3}})(AudioPresets||(AudioPresets={}));const VideoPresets={h90:new VideoPreset(160,90,6e4,15),h180:new VideoPreset(320,180,12e4,15),h216:new VideoPreset(384,216,18e4,15),h360:new VideoPreset(640,360,3e5,20),h540:new VideoPreset(960,540,6e5,25),h720:new VideoPreset(1280,720,17e5,30),h1080:new VideoPreset(1920,1080,3e6,30),h1440:new VideoPreset(2560,1440,5e6,30),h2160:new VideoPreset(3840,2160,8e6,30)},VideoPresets43={h120:new VideoPreset(160,120,8e4,15),h180:new VideoPreset(240,180,1e5,15),h240:new VideoPreset(320,240,15e4,15),h360:new VideoPreset(480,360,225e3,20),h480:new VideoPreset(640,480,3e5,20),h540:new VideoPreset(720,540,45e4,25),h720:new VideoPreset(960,720,15e5,30),h1080:new VideoPreset(1440,1080,25e5,30),h1440:new VideoPreset(1920,1440,35e5,30)},ScreenSharePresets={h360fps3:new VideoPreset(640,360,2e5,3,"medium"),h720fps5:new VideoPreset(1280,720,4e5,5,"medium"),h720fps15:new VideoPreset(1280,720,1e6,15,"medium"),h1080fps15:new VideoPreset(1920,1080,15e5,15,"medium"),h1080fps30:new VideoPreset(1920,1080,3e6,30,"medium")},publishDefaults={audioBitrate:AudioPresets.music.maxBitrate,audioPreset:AudioPresets.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:ScreenSharePresets.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:"vp8",backupCodec:{codec:"vp8",encoding:VideoPresets.h540.encoding}},audioDefaults={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},videoDefaults={resolution:VideoPresets.h720.resolution},roomOptionDefaults={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new DefaultReconnectPolicy,disconnectOnPageLeave:!0,expWebAudioMix:!1},roomConnectOptionDefaults={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3};var RoomEvent;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.StateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.DCBufferStatusChanged="dcBufferStatusChanged"})(RoomEvent||(RoomEvent={}));var ParticipantEvent;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged"})(ParticipantEvent||(ParticipantEvent={}));var EngineEvent;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.DCBufferStatusChanged="dcBufferStatusChanged"})(EngineEvent||(EngineEvent={}));var TrackEvent;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged"})(TrackEvent||(TrackEvent={}));const BACKGROUND_REACTION_DELAY=5e3,recycledElements=[];class Track extends eventsExports$1.EventEmitter{constructor(e,n){super(),this.attachedElements=[],this.isMuted=!1,this.streamState=Track.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),BACKGROUND_REACTION_DELAY):this.handleAppVisibilityChanged()},this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=Track.Source.Unknown}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===Track.Kind.Video&&(n="video"),this.attachedElements.length===0&&Track.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(recycledElements.forEach(s=>{s.parentElement===null&&!e&&(e=s)}),e&&recycledElements.splice(recycledElements.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),attachToElement(this._mediaStreamTrack,e);const a=e.srcObject.getTracks();return a.some(s=>s.kind==="audio")&&e.play().then(()=>{this.emit(TrackEvent.AudioPlaybackStarted)}).catch(s=>{s.name==="NotAllowedError"?this.emit(TrackEvent.AudioPlaybackFailed,s):livekitLogger.warn("could not playback audio",s),e&&a.some(c=>c.kind==="video")&&s.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(TrackEvent.ElementAttached,e),e}detach(e){try{if(e){detachTrack(this._mediaStreamTrack,e);const a=this.attachedElements.indexOf(e);return a>=0&&(this.attachedElements.splice(a,1),this.recycleElement(e),this.emit(TrackEvent.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(a=>{detachTrack(this._mediaStreamTrack,a),n.push(a),this.recycleElement(a),this.emit(TrackEvent.ElementDetached,a)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),recycledElements.forEach(a=>{a.parentElement||(n=!1)}),n&&recycledElements.push(e)}}handleAppVisibilityChanged(){return __awaiter(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){isWeb()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){isWeb()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function attachToElement(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let a;t.kind==="audio"?a=n.getAudioTracks():a=n.getVideoTracks(),a.includes(t)||(a.forEach(s=>{n.removeTrack(s)}),n.addTrack(t)),e.autoplay=!0,e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(isSafari()||isFireFox())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function detachTrack(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(_){_.Audio="audio",_.Video="video",_.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(_){_.Camera="camera",_.Microphone="microphone",_.ScreenShare="screen_share",_.ScreenShareAudio="screen_share_audio",_.Unknown="unknown"})(n=t.Source||(t.Source={}));let a;(function(_){_.Active="active",_.Paused="paused",_.Unknown="unknown"})(a=t.StreamState||(t.StreamState={}));function s(_){switch(_){case e.Audio:return TrackType$1.AUDIO;case e.Video:return TrackType$1.VIDEO;default:return TrackType$1.UNRECOGNIZED}}t.kindToProto=s;function c(_){switch(_){case TrackType$1.AUDIO:return e.Audio;case TrackType$1.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=c;function u(_){switch(_){case n.Camera:return TrackSource$2.CAMERA;case n.Microphone:return TrackSource$2.MICROPHONE;case n.ScreenShare:return TrackSource$2.SCREEN_SHARE;case n.ScreenShareAudio:return TrackSource$2.SCREEN_SHARE_AUDIO;default:return TrackSource$2.UNRECOGNIZED}}t.sourceToProto=u;function d(_){switch(_){case TrackSource$2.CAMERA:return n.Camera;case TrackSource$2.MICROPHONE:return n.Microphone;case TrackSource$2.SCREEN_SHARE:return n.ScreenShare;case TrackSource$2.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=d;function m(_){switch(_){case StreamState.ACTIVE:return a.Active;case StreamState.PAUSED:return a.Paused;default:return a.Unknown}}t.streamStateFromProto=m})(Track||(Track={}));const lossyDataChannel="_lossy",reliableDataChannel="_reliable",minReconnectWait=2*1e3,leaveReconnect="leave-reconnect";var PCState;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(PCState||(PCState={}));class RTCEngine extends eventsExports$1.EventEmitter{get isClosed(){return this._isClosed}constructor(e){super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=roomConnectOptionDefaults.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=PCState.New,this._isClosed=!0,this.pendingTrackResolvers={},this.hasPublished=!1,this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.handleDataChannel=n=>{let{channel:a}=n;return __awaiter(this,void 0,void 0,function*(){if(a){if(a.label===reliableDataChannel)this.reliableDCSub=a;else if(a.label===lossyDataChannel)this.lossyDCSub=a;else return;livekitLogger.debug("on data channel ".concat(a.id,", ").concat(a.label)),a.onmessage=this.handleDataMessage}})},this.handleDataMessage=n=>__awaiter(this,void 0,void 0,function*(){var a,s;const c=yield this.dataProcessLock.lock();try{let u;if(n.data instanceof ArrayBuffer)u=n.data;else if(n.data instanceof Blob)u=yield n.data.arrayBuffer();else{livekitLogger.error("unsupported data type",n.data);return}const d=DataPacket.decode(new Uint8Array(u));((a=d.value)===null||a===void 0?void 0:a.$case)==="speaker"?this.emit(EngineEvent.ActiveSpeakersUpdate,d.value.speaker.speakers):((s=d.value)===null||s===void 0?void 0:s.$case)==="user"&&this.emit(EngineEvent.DataPacketReceived,d.value.user,d.kind)}finally{c()}}),this.handleDataError=n=>{const s=n.currentTarget.maxRetransmits===0?"lossy":"reliable";if(n instanceof ErrorEvent){const{error:c}=n.error;livekitLogger.error("DataChannel error on ".concat(s,": ").concat(n.message),c)}else livekitLogger.error("Unknown DataChannel Error on ".concat(s),n)},this.handleBufferedAmountLow=n=>{const s=n.currentTarget.maxRetransmits===0?DataPacket_Kind$1.LOSSY:DataPacket_Kind$1.RELIABLE;this.updateAndEmitDCBufferStatus(s)},this.handleDisconnect=(n,a)=>{if(this._isClosed)return;livekitLogger.warn("".concat(n," disconnected")),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const s=d=>{livekitLogger.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(d,"ms. giving up")),this.emit(EngineEvent.Disconnected),this.close()},c=Date.now()-this.reconnectStart;let u=this.getNextRetryDelay({elapsedMs:c,retryCount:this.reconnectAttempts});if(u===null){s(c);return}n===leaveReconnect&&(u=0),livekitLogger.debug("reconnecting in ".concat(u,"ms")),this.clearReconnectTimeout(),this.url&&this.token&&isCloud(new URL(this.url))&&(this.regionUrlProvider=new RegionUrlProvider(this.url,this.token)),this.reconnectTimeout=CriticalTimers.setTimeout(()=>this.attemptReconnect(a),u)},this.waitForRestarted=()=>new Promise((n,a)=>{this.pcState===PCState.Connected&&n();const s=()=>{this.off(EngineEvent.Disconnected,c),n()},c=()=>{this.off(EngineEvent.Restarted,s),a()};this.once(EngineEvent.Restarted,s),this.once(EngineEvent.Disconnected,c)}),this.updateAndEmitDCBufferStatus=n=>{const a=this.isBufferStatusLow(n);typeof a<"u"&&a!==this.dcBufferStatus.get(n)&&(this.dcBufferStatus.set(n,a),this.emit(EngineEvent.DCBufferStatusChanged,a,n))},this.isBufferStatusLow=n=>{const a=this.dataChannelForKind(n);if(a)return a.bufferedAmount<=a.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.isReconnecting&&(this.clearReconnectTimeout(),this.attemptReconnect(ReconnectReason$1.RR_SIGNAL_DISCONNECTED))},this.client=new SignalClient,this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Mutex,this.dataProcessLock=new Mutex,this.dcBufferStatus=new Map([[DataPacket_Kind$1.LOSSY,!0],[DataPacket_Kind$1.RELIABLE,!0]])}join(e,n,a,s){return __awaiter(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=a;try{this.joinAttempts+=1;const c=yield this.client.join(e,n,a,s);return this._isClosed=!1,this.latestJoinResponse=c,this.subscriberPrimary=c.subscriberPrimary,this.publisher||this.configure(c),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=c.clientConfiguration,c}catch(c){if(c instanceof ConnectionError&&c.reason===1&&(livekitLogger.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts)),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,a,s);throw c}})}close(){return __awaiter(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(EngineEvent.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),this.publisher&&this.publisher.pc.signalingState!=="closed"&&(this.publisher.pc.getSenders().forEach(n=>{var a,s;try{!((a=this.publisher)===null||a===void 0)&&a.pc.removeTrack&&((s=this.publisher)===null||s===void 0||s.pc.removeTrack(n))}catch(c){livekitLogger.warn("could not removeTrack",{error:c})}}),this.publisher.close(),this.publisher=void 0),this.subscriber&&(this.subscriber.close(),this.subscriber=void 0),yield this.client.close()}finally{e()}})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new TrackInvalidError("a track with the same ID has already been published");return new Promise((n,a)=>{const s=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],a(new ConnectionError("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:c=>{clearTimeout(s),n(c)},reject:()=>{clearTimeout(s),a(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){var n;if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:a}=this.pendingTrackResolvers[e.track.id];a&&a(),delete this.pendingTrackResolvers[e.track.id]}try{return(n=this.publisher)===null||n===void 0||n.pc.removeTrack(e),!0}catch(a){livekitLogger.warn("failed to remove track",{error:a,method:"removeTrack"})}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return __awaiter(this,void 0,void 0,function*(){if(this.primaryPC!==void 0)return getConnectedAddress(this.primaryPC)})}configure(e){var n;if(this.publisher||this.subscriber)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const a=this.makeRTCConfiguration(e),s={optional:[{googDscp:!0}]};this.publisher=new PCTransport(a,s),this.subscriber=new PCTransport(a),this.emit(EngineEvent.TransportsCreated,this.publisher,this.subscriber),this.publisher.pc.onicecandidate=m=>{m.candidate&&(livekitLogger.trace("adding ICE candidate for peer",m.candidate),this.client.sendIceCandidate(m.candidate,SignalTarget.PUBLISHER))},this.subscriber.pc.onicecandidate=m=>{m.candidate&&this.client.sendIceCandidate(m.candidate,SignalTarget.SUBSCRIBER)},this.publisher.onOffer=m=>{this.client.sendOffer(m)};let c=this.publisher.pc,u=this.subscriber.pc,d=e.subscriberPrimary;d&&(c=this.subscriber.pc,u=this.publisher.pc,this.subscriber.pc.ondatachannel=this.handleDataChannel),this.primaryPC=c,c.onconnectionstatechange=()=>__awaiter(this,void 0,void 0,function*(){if(livekitLogger.debug("primary PC state changed ".concat(c.connectionState)),c.connectionState==="connected"){const m=this.pcState===PCState.New;this.pcState=PCState.Connected,m&&this.emit(EngineEvent.Connected,e)}else c.connectionState==="failed"&&this.pcState===PCState.Connected&&(this.pcState=PCState.Disconnected,this.handleDisconnect("primary peerconnection",d?ReconnectReason$1.RR_SUBSCRIBER_FAILED:ReconnectReason$1.RR_PUBLISHER_FAILED))}),u.onconnectionstatechange=()=>__awaiter(this,void 0,void 0,function*(){livekitLogger.debug("secondary PC state changed ".concat(u.connectionState)),u.connectionState==="failed"&&this.handleDisconnect("secondary peerconnection",d?ReconnectReason$1.RR_PUBLISHER_FAILED:ReconnectReason$1.RR_SUBSCRIBER_FAILED)}),this.subscriber.pc.ontrack=m=>{this.emit(EngineEvent.MediaTrackAdded,m.track,m.streams[0],m.receiver)},this.createDataChannels(),this.client.onAnswer=m=>__awaiter(this,void 0,void 0,function*(){this.publisher&&(livekitLogger.debug("received server answer",{RTCSdpType:m.type,signalingState:this.publisher.pc.signalingState}),yield this.publisher.setRemoteDescription(m))}),this.client.onTrickle=(m,_)=>{!this.publisher||!this.subscriber||(livekitLogger.trace("got ICE candidate from peer",{candidate:m,target:_}),_===SignalTarget.PUBLISHER?this.publisher.addIceCandidate(m):this.subscriber.addIceCandidate(m))},this.client.onOffer=m=>__awaiter(this,void 0,void 0,function*(){if(!this.subscriber)return;livekitLogger.debug("received server offer",{RTCSdpType:m.type,signalingState:this.subscriber.pc.signalingState}),yield this.subscriber.setRemoteDescription(m);const _=yield this.subscriber.createAndSetAnswer();this.client.sendAnswer(_)}),this.client.onLocalTrackPublished=m=>{livekitLogger.debug("received trackPublishedResponse",m);const{resolve:_}=this.pendingTrackResolvers[m.cid];if(!_){livekitLogger.error("missing track resolver for ".concat(m.cid));return}delete this.pendingTrackResolvers[m.cid],_(m.track)},this.client.onTokenRefresh=m=>{this.token=m},this.client.onClose=()=>{this.handleDisconnect("signal",ReconnectReason$1.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=m=>{m!=null&&m.canReconnect?(this.fullReconnectOnNext=!0,this.primaryPC=void 0,this.handleDisconnect(leaveReconnect)):(this.emit(EngineEvent.Disconnected,m==null?void 0:m.reason),this.close()),livekitLogger.trace("leave request",{leave:m})}}makeRTCConfiguration(e){const n=Object.assign({},this.rtcConfig);if(e.iceServers&&!n.iceServers){const a=[];e.iceServers.forEach(s=>{const c={urls:s.urls};s.username&&(c.username=s.username),s.credential&&(c.credential=s.credential),a.push(c)}),n.iceServers=a}return e.clientConfiguration&&e.clientConfiguration.forceRelay===ClientConfigSetting$1.ENABLED&&(n.iceTransportPolicy="relay"),n.sdpSemantics="unified-plan",n.continualGatheringPolicy="gather_continually",n}createDataChannels(){this.publisher&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.publisher.pc.createDataChannel(lossyDataChannel,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.publisher.pc.createDataChannel(reliableDataChannel,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,n,a){if(!("getCapabilities"in RTCRtpSender))return;const s=RTCRtpSender.getCapabilities(n);if(!s)return;livekitLogger.debug("get capabilities",s);const c=[],u=[],d=[];s.codecs.forEach(m=>{const _=m.mimeType.toLowerCase();if(_==="audio/opus"){c.push(m);return}if(!(_==="video/".concat(a))){d.push(m);return}if(a==="h264"){m.sdpFmtpLine&&m.sdpFmtpLine.includes("profile-level-id=42e01f")?c.push(m):u.push(m);return}c.push(m)}),supportsSetCodecPreferences(e)&&e.setCodecPreferences(c.concat(u,d))}createSender(e,n,a){return __awaiter(this,void 0,void 0,function*(){if(supportsTransceiver())return this.createTransceiverRTCRtpSender(e,n,a);if(supportsAddTrack())return livekitLogger.debug("using add-track fallback"),this.createRTCRtpSender(e.mediaStreamTrack);throw new UnexpectedConnectionState("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,a,s){return __awaiter(this,void 0,void 0,function*(){if(supportsTransceiver())return this.createSimulcastTransceiverSender(e,n,a,s);if(supportsAddTrack())return livekitLogger.debug("using add-track fallback"),this.createRTCRtpSender(e.mediaStreamTrack);throw new UnexpectedConnectionState("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,a){return __awaiter(this,void 0,void 0,function*(){if(!this.publisher)throw new UnexpectedConnectionState("publisher is closed");const s={direction:"sendonly"};a&&(s.sendEncodings=a);const c=yield this.publisher.pc.addTransceiver(e.mediaStreamTrack,s);return e.kind===Track.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(c,e.kind,n.videoCodec),e.codec=n.videoCodec),c.sender})}createSimulcastTransceiverSender(e,n,a,s){return __awaiter(this,void 0,void 0,function*(){if(!this.publisher)throw new UnexpectedConnectionState("publisher is closed");const c={direction:"sendonly"};s&&(c.sendEncodings=s);const u=yield this.publisher.pc.addTransceiver(n.mediaStreamTrack,c);if(a.videoCodec)return this.setPreferredCodec(u,e.kind,a.videoCodec),e.setSimulcastTrackSender(a.videoCodec,u.sender),u.sender})}createRTCRtpSender(e){return __awaiter(this,void 0,void 0,function*(){if(!this.publisher)throw new UnexpectedConnectionState("publisher is closed");return this.publisher.pc.addTrack(e)})}attemptReconnect(e){var n,a,s;return __awaiter(this,void 0,void 0,function*(){if(!this._isClosed&&!this.attemptingReconnect){(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===ClientConfigSetting$1.DISABLED||((s=(a=this.primaryPC)===null||a===void 0?void 0:a.signalingState)!==null&&s!==void 0?s:"closed")==="closed")&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(c){this.reconnectAttempts+=1;let u=!0;c instanceof UnexpectedConnectionState?(livekitLogger.debug("received unrecoverable error",{error:c}),u=!1):c instanceof SignalReconnectError||(this.fullReconnectOnNext=!0),u?this.handleDisconnect("reconnect",ReconnectReason$1.RR_UNKOWN):(livekitLogger.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up")),this.emit(EngineEvent.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){livekitLogger.warn("encountered error in reconnect policy",{error:n})}return null}restartConnection(e){var n,a,s,c,u;return __awaiter(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new UnexpectedConnectionState("could not reconnect, url or token not saved");livekitLogger.info("reconnecting, attempt: ".concat(this.reconnectAttempts)),this.emit(EngineEvent.Restarting),this.client.isConnected&&(yield this.client.sendLeave()),yield this.client.close(),this.primaryPC=void 0,(n=this.publisher)===null||n===void 0||n.close(),this.publisher=void 0,(a=this.subscriber)===null||a===void 0||a.close(),this.subscriber=void 0;let d;try{if(!this.signalOpts)throw livekitLogger.warn("attempted connection restart, without signal options present"),new SignalReconnectError;d=yield this.join(e??this.url,this.token,this.signalOpts)}catch(m){throw m instanceof ConnectionError&&m.reason===0?new UnexpectedConnectionState("could not reconnect, token might be expired"):new SignalReconnectError}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");this.client.setReconnected(),this.emit(EngineEvent.SignalRestarted,d),yield this.waitForPCReconnected(),(s=this.regionUrlProvider)===null||s===void 0||s.resetAttempts(),this.emit(EngineEvent.Restarted)}catch(d){const m=yield(c=this.regionUrlProvider)===null||c===void 0?void 0:c.getNextBestRegionUrl();if(m){yield this.restartConnection(m);return}else throw(u=this.regionUrlProvider)===null||u===void 0||u.resetAttempts(),d}})}resumeConnection(e){var n;return __awaiter(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new UnexpectedConnectionState("could not reconnect, url or token not saved");if(!this.publisher||!this.subscriber)throw new UnexpectedConnectionState("publisher and subscriber connections unset");livekitLogger.info("resuming signal connection, attempt ".concat(this.reconnectAttempts)),this.emit(EngineEvent.Resuming);try{const a=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(a){const s=this.makeRTCConfiguration(a);this.publisher.pc.setConfiguration(s),this.subscriber.pc.setConfiguration(s)}}catch(a){let s="";throw a instanceof Error&&(s=a.message),a instanceof ConnectionError&&a.reason===0?new UnexpectedConnectionState("could not reconnect, token might be expired"):new SignalReconnectError(s)}if(this.emit(EngineEvent.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");this.subscriber.restartingIce=!0,this.hasPublished&&(yield this.publisher.createAndSendOffer({iceRestart:!0})),yield this.waitForPCReconnected(),this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(EngineEvent.Resumed)})}waitForPCInitialConnection(e,n){return __awaiter(this,void 0,void 0,function*(){if(this.pcState!==PCState.Connected){if(this.pcState!==PCState.New)throw new UnexpectedConnectionState("Expected peer connection to be new on initial connection");return new Promise((a,s)=>{const c=()=>{livekitLogger.warn("closing engine"),CriticalTimers.clearTimeout(d),s(new ConnectionError("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&c(),n==null||n.signal.addEventListener("abort",c);const u=()=>{CriticalTimers.clearTimeout(d),n==null||n.signal.removeEventListener("abort",c),a()},d=CriticalTimers.setTimeout(()=>{this.off(EngineEvent.Connected,u),s(new ConnectionError("could not establish pc connection"))},e??this.peerConnectionTimeout);this.once(EngineEvent.Connected,u)})}})}waitForPCReconnected(){var e;return __awaiter(this,void 0,void 0,function*(){const n=Date.now();let a=n;for(this.pcState=PCState.Reconnecting,livekitLogger.debug("waiting for peer connection to reconnect");a-n<this.peerConnectionTimeout&&this.primaryPC!==void 0;){if(a-n>minReconnectWait&&((e=this.primaryPC)===null||e===void 0?void 0:e.connectionState)==="connected"&&(this.pcState=PCState.Connected),this.pcState===PCState.Connected)return;yield sleep(100),a=Date.now()}throw new ConnectionError("could not establish PC connection")})}sendDataPacket(e,n){return __awaiter(this,void 0,void 0,function*(){const a=DataPacket.encode(e).finish();yield this.ensurePublisherConnected(n);const s=this.dataChannelForKind(n);s&&s.send(a),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var a,s,c;return __awaiter(this,void 0,void 0,function*(){const u=n?this.subscriber:this.publisher,d=n?"Subscriber":"Publisher";if(!u)throw new ConnectionError("".concat(d," connection not set"));!n&&!(!((a=this.publisher)===null||a===void 0)&&a.isICEConnected)&&((s=this.publisher)===null||s===void 0?void 0:s.pc.iceConnectionState)!=="checking"&&this.negotiate();const m=this.dataChannelForKind(e,n);if((m==null?void 0:m.readyState)==="open")return;const _=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<_;){if(u.isICEConnected&&((c=this.dataChannelForKind(e,n))===null||c===void 0?void 0:c.readyState)==="open")return;yield sleep(50)}throw new ConnectionError("could not establish ".concat(d," connection, state: ").concat(u.pc.iceConnectionState))})}ensurePublisherConnected(e){return __awaiter(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.primaryPC||this.primaryPC.connectionState==="closed"||this.primaryPC.connectionState==="failed"||this.hasPublished&&this.subscriberPrimary&&(!this.publisher||this.publisher.pc.connectionState==="closed"||this.publisher.pc.connectionState==="failed")||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return new Promise((e,n)=>{if(!this.publisher){n(new NegotiationError("publisher is not defined"));return}this.hasPublished=!0;const a=()=>{livekitLogger.debug("engine disconnected while negotiation was ongoing"),c(),e()};this.on(EngineEvent.Closing,a);const s=setTimeout(()=>{n("negotiation timed out"),this.handleDisconnect("negotiation",ReconnectReason$1.RR_SIGNAL_DISCONNECTED)},this.peerConnectionTimeout),c=()=>{clearTimeout(s),this.off(EngineEvent.Closing,a)};this.publisher.once(PCEvents.NegotiationStarted,()=>{var u;(u=this.publisher)===null||u===void 0||u.once(PCEvents.NegotiationComplete,()=>{c(),e()})}),this.publisher.negotiate(u=>{c(),n(u),u instanceof NegotiationError&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",ReconnectReason$1.RR_UNKOWN)})})}dataChannelForKind(e,n){if(n){if(e===DataPacket_Kind$1.LOSSY)return this.lossyDCSub;if(e===DataPacket_Kind$1.RELIABLE)return this.reliableDCSub}else{if(e===DataPacket_Kind$1.LOSSY)return this.lossyDC;if(e===DataPacket_Kind$1.RELIABLE)return this.reliableDC}}failNext(){this.shouldFailNext=!0}clearReconnectTimeout(){this.reconnectTimeout&&CriticalTimers.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){isWeb()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){isWeb()&&window.removeEventListener("online",this.handleBrowserOnLine)}}function getConnectedAddress(t){var e;return __awaiter(this,void 0,void 0,function*(){let n="";const a=new Map,s=new Map;if((yield t.getStats()).forEach(d=>{switch(d.type){case"transport":n=d.selectedCandidatePairId;break;case"candidate-pair":n===""&&d.selected&&(n=d.id),a.set(d.id,d);break;case"remote-candidate":s.set(d.id,"".concat(d.address,":").concat(d.port));break}}),n==="")return;const u=(e=a.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(u!==void 0)return s.get(u)})}class SignalReconnectError extends Error{}const monitorFrequency=2e3;function computeBitrate(t,e){if(!e)return 0;let n,a;return"bytesReceived"in t?(n=t.bytesReceived,a=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,a=e.bytesSent),n===void 0||a===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-a)*8*1e3/(t.timestamp-e.timestamp)}const defaultDimensionsTimeout=1e3;class LocalTrack extends Track{constructor(e,n,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;super(e,n),this._isUpstreamPaused=!1,this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this.emit(TrackEvent.Ended,this)},this._mediaStreamTrack.addEventListener("ended",this.handleEnded),this.constraints=a??e.getConstraints(),this.reacquireTrack=!1,this.providedByUser=s,this.muteLock=new Mutex,this.pauseUpstreamLock=new Mutex}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==Track.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:defaultDimensionsTimeout;return __awaiter(this,void 0,void 0,function*(){if(this.kind===Track.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");const n=Date.now();for(;Date.now()-n<e;){const a=this.dimensions;if(a)return a;yield sleep(50)}throw new TrackInvalidError("unable to get track dimensions after timeout")})}getDeviceId(){return __awaiter(this,void 0,void 0,function*(){if(this.source===Track.Source.ScreenShare)return;const{deviceId:e,groupId:n}=this._mediaStreamTrack.getSettings(),a=this.kind===Track.Kind.Audio?"audioinput":"videoinput";return DeviceManager.getInstance().normalizeDeviceId(a,e,n)})}mute(){return __awaiter(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return __awaiter(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return __awaiter(this,void 0,void 0,function*(){if(!this.sender)throw new TrackInvalidError("unable to replace an unpublished track");return this.attachedElements.forEach(a=>{detachTrack(this._mediaStreamTrack,a)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this.providedByUser||this._mediaStreamTrack.stop(),e.addEventListener("ended",this.handleEnded),livekitLogger.debug("replace MediaStreamTrack"),this.sender&&(yield this.sender.replaceTrack(e)),this._mediaStreamTrack=e,this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(a=>{attachToElement(e,a)}),this.mediaStream=new MediaStream([e]),this.providedByUser=n,this})}restart(e){return __awaiter(this,void 0,void 0,function*(){e||(e=this.constraints),livekitLogger.debug("restarting track with constraints",e);const n={audio:!1,video:!1};this.kind===Track.Kind.Video?n.video=e:n.audio=e,this.attachedElements.forEach(c=>{detachTrack(this._mediaStreamTrack,c)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const a=yield navigator.mediaDevices.getUserMedia(n),s=a.getTracks()[0];return s.addEventListener("ended",this.handleEnded),livekitLogger.debug("re-acquired MediaStreamTrack"),this.sender&&(yield this.sender.replaceTrack(s)),this._mediaStreamTrack=s,yield this.resumeUpstream(),this.attachedElements.forEach(c=>{attachToElement(s,c)}),this.mediaStream=a,this.constraints=e,this.emit(TrackEvent.Restarted,this),this})}setTrackMuted(e){livekitLogger.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted")),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?TrackEvent.Muted:TrackEvent.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return __awaiter(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),isMobile()&&(livekitLogger.debug("visibility changed, is in Background: ".concat(this.isInBackground)),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(livekitLogger.debug("track needs to be reaquired, restarting ".concat(this.source)),yield this.restart(),this.reacquireTrack=!1))})}pauseUpstream(){return __awaiter(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){livekitLogger.warn("unable to pause upstream for an unpublished track");return}this._isUpstreamPaused=!0,this.emit(TrackEvent.UpstreamPaused,this);const n=this.kind===Track.Kind.Audio?getEmptyAudioStreamTrack():getEmptyVideoStreamTrack();yield this.sender.replaceTrack(n)}finally{e()}})}resumeUpstream(){return __awaiter(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){livekitLogger.warn("unable to resume upstream for an unpublished track");return}this._isUpstreamPaused=!1,this.emit(TrackEvent.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}}class LocalAudioTrack extends LocalTrack{constructor(e,n){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;super(e,Track.Kind.Audio,n,a),this.stopOnMute=!1,this.monitorSender=()=>__awaiter(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(c){livekitLogger.error("could not get audio sender stats",{error:c});return}s&&this.prevStats&&(this._currentBitrate=computeBitrate(s,this.prevStats)),this.prevStats=s}),this.checkForSilence()}setDeviceId(e){return __awaiter(this,void 0,void 0,function*(){this.constraints.deviceId!==e&&(this.constraints.deviceId=e,this.isMuted||(yield this.restartTrack()))})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return __awaiter(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Track.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(livekitLogger.debug("stopping mic track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return __awaiter(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Track.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended")&&!this.isUserProvided&&(livekitLogger.debug("reacquiring mic track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return __awaiter(this,void 0,void 0,function*(){let n;if(e){const a=constraintsForOptions({audio:e});typeof a.audio!="boolean"&&(n=a.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return __awaiter(this,void 0,void 0,function*(){const a=yield n.restart.call(this,e);return this.checkForSilence(),a})}startMonitor(){isWeb()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},monitorFrequency)))}getSenderStats(){var e;return __awaiter(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let a;return n.forEach(s=>{s.type==="outbound-rtp"&&(a={type:"audio",streamId:s.id,packetsSent:s.packetsSent,packetsLost:s.packetsLost,bytesSent:s.bytesSent,timestamp:s.timestamp,roundTripTime:s.roundTripTime,jitter:s.jitter})}),a})}checkForSilence(){return __awaiter(this,void 0,void 0,function*(){const e=yield detectSilence(this);return e&&(this.isMuted||livekitLogger.warn("silence detected on local audio track"),this.emit(TrackEvent.AudioSilenceDetected)),e})}}const refreshSubscribedCodecAfterNewCodec=5e3;class LocalVideoTrack extends LocalTrack{constructor(e,n){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;super(e,Track.Kind.Video,n,a),this.simulcastCodecs=new Map,this.monitorSender=()=>__awaiter(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(u){livekitLogger.error("could not get audio sender stats",{error:u});return}const c=new Map(s.map(u=>[u.rid,u]));if(this.prevStats){let u=0;c.forEach((d,m)=>{var _;const b=(_=this.prevStats)===null||_===void 0?void 0:_.get(m);u+=computeBitrate(d,b)}),this._currentBitrate=u}this.prevStats=c}),this.senderLock=new Mutex}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!isWeb())return;const a=(n=this.sender)===null||n===void 0?void 0:n.getParameters();a&&(this.encodings=a.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},monitorFrequency))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return __awaiter(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Track.Source.Camera&&!this.isUserProvided&&(livekitLogger.debug("stopping camera track"),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return __awaiter(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===Track.Source.Camera&&!this.isUserProvided&&(livekitLogger.debug("reacquiring camera track"),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}getSenderStats(){var e;return __awaiter(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],a=yield this.sender.getStats();return a.forEach(s=>{var c;if(s.type==="outbound-rtp"){const u={type:"video",streamId:s.id,frameHeight:s.frameHeight,frameWidth:s.frameWidth,firCount:s.firCount,pliCount:s.pliCount,nackCount:s.nackCount,packetsSent:s.packetsSent,bytesSent:s.bytesSent,framesSent:s.framesSent,timestamp:s.timestamp,rid:(c=s.rid)!==null&&c!==void 0?c:s.id,retransmittedPacketsSent:s.retransmittedPacketsSent,qualityLimitationReason:s.qualityLimitationReason,qualityLimitationResolutionChanges:s.qualityLimitationResolutionChanges},d=a.get(s.remoteId);d&&(u.jitter=d.jitter,u.packetsLost=d.packetsLost,u.roundTripTime=d.roundTripTime),n.push(u)}}),n})}setPublishingQuality(e){const n=[];for(let a=VideoQuality$1.LOW;a<=VideoQuality$1.HIGH;a+=1)n.push({quality:a,enabled:a<=e});livekitLogger.debug("setting publishing quality. max quality ".concat(e)),this.setPublishingLayers(n)}setDeviceId(e){return __awaiter(this,void 0,void 0,function*(){this.constraints.deviceId!==e&&(this.constraints.deviceId=e,this.isMuted||(yield this.restartTrack()))})}restartTrack(e){return __awaiter(this,void 0,void 0,function*(){let n;if(e){const a=constraintsForOptions({video:e});typeof a.video!="boolean"&&(n=a.video)}yield this.restart(n)})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const a={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,a),a}setSimulcastTrackSender(e,n){const a=this.simulcastCodecs.get(e);a&&(a.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},refreshSubscribedCodecAfterNewCodec))}setPublishingCodecs(e){var n,a,s,c,u,d,m;return __awaiter(this,void 0,void 0,function*(){if(livekitLogger.debug("setting publishing codecs",{codecs:e,currentCodec:this.codec}),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const _=[];try{for(n=!0,a=__asyncValues(e);s=yield a.next(),c=s.done,!c;){m=s.value,n=!1;try{const b=m;if(!this.codec||this.codec===b.codec)yield this.setPublishingLayers(b.qualities);else{const S=this.simulcastCodecs.get(b.codec);if(livekitLogger.debug("try setPublishingCodec for ".concat(b.codec),S),!S||!S.sender){for(const k of b.qualities)if(k.enabled){_.push(b.codec);break}}else S.encodings&&(livekitLogger.debug("try setPublishingLayersForSender ".concat(b.codec)),yield setPublishingLayersForSender(S.sender,S.encodings,b.qualities,this.senderLock))}}finally{n=!0}}}catch(b){u={error:b}}finally{try{!n&&!c&&(d=a.return)&&(yield d.call(a))}finally{if(u)throw u.error}}return _})}setPublishingLayers(e){return __awaiter(this,void 0,void 0,function*(){livekitLogger.debug("setting publishing layers",e),!(!this.sender||!this.encodings)&&(yield setPublishingLayersForSender(this.sender,this.encodings,e,this.senderLock))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return __awaiter(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),isMobile()&&this.isInBackground&&this.source===Track.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function setPublishingLayersForSender(t,e,n,a){return __awaiter(this,void 0,void 0,function*(){const s=yield a.lock();livekitLogger.debug("setPublishingLayersForSender",{sender:t,qualities:n,senderEncodings:e});try{const c=t.getParameters(),{encodings:u}=c;if(!u)return;if(u.length!==e.length){livekitLogger.warn("cannot set publishing layers, encodings mismatch");return}let d=!1;u.forEach((m,_)=>{var b;let S=(b=m.rid)!==null&&b!==void 0?b:"";S===""&&(S="q");const k=videoQualityForRid(S),w=n.find(O=>O.quality===k);w&&m.active!==w.enabled&&(d=!0,m.active=w.enabled,livekitLogger.debug("setting layer ".concat(w.quality," to ").concat(m.active?"enabled":"disabled")),isFireFox()&&(w.enabled?(m.scaleResolutionDownBy=e[_].scaleResolutionDownBy,m.maxBitrate=e[_].maxBitrate,m.maxFrameRate=e[_].maxFrameRate):(m.scaleResolutionDownBy=4,m.maxBitrate=10,m.maxFrameRate=2)))}),d&&(c.encodings=u,yield t.setParameters(c))}finally{s()}})}function videoQualityForRid(t){switch(t){case"f":return VideoQuality$1.HIGH;case"h":return VideoQuality$1.MEDIUM;case"q":return VideoQuality$1.LOW;default:return VideoQuality$1.UNRECOGNIZED}}function videoLayersFromEncodings(t,e,n){return n?n.map(a=>{var s,c,u;const d=(s=a.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let m=videoQualityForRid((c=a.rid)!==null&&c!==void 0?c:"");return m===VideoQuality$1.UNRECOGNIZED&&n.length===1&&(m=VideoQuality$1.HIGH),{quality:m,width:t/d,height:e/d,bitrate:(u=a.maxBitrate)!==null&&u!==void 0?u:0,ssrc:0}}):[{quality:VideoQuality$1.HIGH,width:t,height:e,bitrate:0,ssrc:0}]}class RemoteTrack extends Track{constructor(e,n,a,s){super(e,a),this.sid=n,this.receiver=s}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?TrackEvent.Muted:TrackEvent.Unmuted,this))}setMediaStream(e){this.mediaStream=e,e.onremovetrack=()=>{this.receiver=void 0,this._currentBitrate=0,this.emit(TrackEvent.Ended,this)}}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),monitorFrequency))}}class RemoteAudioTrack extends RemoteTrack{constructor(e,n,a,s,c){super(e,n,Track.Kind.Audio,a),this.monitorReceiver=()=>__awaiter(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const u=yield this.getReceiverStats();u&&this.prevStats&&this.receiver&&(this._currentBitrate=computeBitrate(u,this.prevStats)),this.prevStats=u}),this.audioContext=s,this.webAudioPluginNodes=[],c&&(this.sinkId=c.deviceId)}setVolume(e){var n;for(const a of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):a.volume=e;this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return __awaiter(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(supportsSetSinkId(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.elementVolume&&(e.volume=this.elementVolume),this.sinkId&&supportsSetSinkId(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(livekitLogger.debug("using audio context mapping"),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let a=this.sourceNode;this.webAudioPluginNodes.forEach(s=>{a.connect(s),a=s}),this.gainNode=e.createGain(),a.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(TrackEvent.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(s=>{this.emit(TrackEvent.AudioPlaybackFailed,s)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return __awaiter(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(a=>{a.type==="inbound-rtp"&&(n={type:"audio",timestamp:a.timestamp,jitter:a.jitter,bytesReceived:a.bytesReceived,concealedSamples:a.concealedSamples,concealmentEvents:a.concealmentEvents,silentConcealedSamples:a.silentConcealedSamples,silentConcealmentEvents:a.silentConcealmentEvents,totalAudioEnergy:a.totalAudioEnergy,totalSamplesDuration:a.totalSamplesDuration})}),n})}}const REACTION_DELAY=100;class RemoteVideoTrack extends RemoteTrack{constructor(e,n,a,s){super(e,n,Track.Kind.Video,a),this.elementInfos=[],this.isObserved=!1,this.monitorReceiver=()=>__awaiter(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const c=yield this.getReceiverStats();c&&this.prevStats&&this.receiver&&(this._currentBitrate=computeBitrate(c,this.prevStats)),this.prevStats=c}),this.debouncedHandleResize=r(()=>{this.updateDimensions()},REACTION_DELAY),this.adaptiveStreamSettings=s}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this.isAdaptiveStream&&!this.isObserved&&livekitLogger.warn("When using adaptiveStream, you need to use remoteVideoTrack.attach() to add the track to a HTMLVideoElement, otherwise your video tracks might never start"),this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?detachTrack(this._mediaStreamTrack,n):attachToElement(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new HTMLElementInfo(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility(),this.isObserved=!0):livekitLogger.warn("visibility resize observer not triggered")}stopObservingElementInfo(e){if(!this.isAdaptiveStream){livekitLogger.warn("stopObservingElementInfo ignored");return}const n=this.elementInfos.filter(a=>a===e);for(const a of n)a.stopObserving();this.elementInfos=this.elementInfos.filter(a=>a!==e),this.updateVisibility()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const a of n)this.stopObservingElement(a);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return __awaiter(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(a=>{a.type==="inbound-rtp"&&(n={type:"video",framesDecoded:a.framesDecoded,framesDropped:a.framesDropped,framesReceived:a.framesReceived,packetsReceived:a.packetsReceived,packetsLost:a.packetsLost,frameWidth:a.frameWidth,frameHeight:a.frameHeight,pliCount:a.pliCount,firCount:a.firCount,nackCount:a.nackCount,jitter:a.jitter,timestamp:a.timestamp,bytesReceived:a.bytesReceived,decoderImplementation:a.decoderImplementation})}),n})}stopObservingElement(e){const n=this.elementInfos.filter(a=>a.element===e);for(const a of n)a.stopObserving();this.elementInfos=this.elementInfos.filter(a=>a.element!==e)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return __awaiter(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const a=this.elementInfos.reduce((d,m)=>Math.max(d,m.visibilityChangedAt||0),0),s=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,c=this.elementInfos.some(d=>d.pictureInPicture),u=this.elementInfos.some(d=>d.visible)&&!s||c;if(this.lastVisible!==u){if(!u&&Date.now()-a<REACTION_DELAY){CriticalTimers.setTimeout(()=>{this.updateVisibility()},REACTION_DELAY);return}this.lastVisible=u,this.emit(TrackEvent.VisibilityChanged,u,this)}}updateDimensions(){var e,n,a,s;let c=0,u=0;for(const d of this.elementInfos){const m=(n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity)!==null&&n!==void 0?n:1,_=m==="screen"?getDevicePixelRatio():m,b=d.width()*_,S=d.height()*_;b+S>c+u&&(c=b,u=S)}((a=this.lastDimensions)===null||a===void 0?void 0:a.width)===c&&((s=this.lastDimensions)===null||s===void 0?void 0:s.height)===u||(this.lastDimensions={width:c,height:u},this.emit(TrackEvent.VideoDimensionsChanged,this.lastDimensions,this))}}class HTMLElementInfo{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=a=>{var s;const{target:c,isIntersecting:u}=a;c===this.element&&(this.isIntersecting=u,this.visibilityChangedAt=Date.now(),(s=this.handleVisibilityChanged)===null||s===void 0||s.call(this))},this.onEnterPiP=()=>{var a;this.isPiP=!0,(a=this.handleVisibilityChanged)===null||a===void 0||a.call(this)},this.onLeavePiP=()=>{var a;this.isPiP=!1,(a=this.handleVisibilityChanged)===null||a===void 0||a.call(this)},this.element=e,this.isIntersecting=n??isElementInViewport(e),this.isPiP=isWeb()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=isElementInViewport(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,getIntersectionObserver().observe(this.element),getResizeObserver().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,n;(e=getIntersectionObserver())===null||e===void 0||e.unobserve(this.element),(n=getResizeObserver())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function isElementInViewport(t){let e=t.offsetTop,n=t.offsetLeft;const a=t.offsetWidth,s=t.offsetHeight,{hidden:c}=t,{opacity:u,display:d}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&e+s>window.pageYOffset&&n+a>window.pageXOffset&&!c&&(u!==""?parseFloat(u)>0:!0)&&d!=="none"}class TrackPublication extends eventsExports$1.EventEmitter{constructor(e,n,a){super(),this.metadataMuted=!1,this.handleMuted=()=>{this.emit(TrackEvent.Muted)},this.handleUnmuted=()=>{this.emit(TrackEvent.Unmuted)},this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=a,this.source=Track.Source.Unknown}setTrack(e){this.track&&(this.track.off(TrackEvent.Muted,this.handleMuted),this.track.off(TrackEvent.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(TrackEvent.Muted,this.handleMuted),e.on(TrackEvent.Unmuted,this.handleUnmuted))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get audioTrack(){if(this.track instanceof LocalAudioTrack||this.track instanceof RemoteAudioTrack)return this.track}get videoTrack(){if(this.track instanceof LocalVideoTrack||this.track instanceof RemoteVideoTrack)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=Track.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===Track.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.trackInfo=e,livekitLogger.trace("update publication info",{info:e})}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(TrackPublication||(TrackPublication={}));class LocalTrackPublication extends TrackPublication{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,a){super(e,n.sid,n.name),this.track=void 0,this.handleTrackEnded=()=>{this.emit(TrackEvent.Ended)},this.updateInfo(n),this.setTrack(a)}setTrack(e){this.track&&this.track.off(TrackEvent.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(TrackEvent.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return __awaiter(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return __awaiter(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return __awaiter(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return __awaiter(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var ConnectionQuality$2;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Unknown="unknown"})(ConnectionQuality$2||(ConnectionQuality$2={}));function qualityFromProto(t){switch(t){case ConnectionQuality$1.EXCELLENT:return ConnectionQuality$2.Excellent;case ConnectionQuality$1.GOOD:return ConnectionQuality$2.Good;case ConnectionQuality$1.POOR:return ConnectionQuality$2.Poor;default:return ConnectionQuality$2.Unknown}}class Participant extends eventsExports$1.EventEmitter{constructor(e,n,a,s){super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=ConnectionQuality$2.Unknown,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=a,this.metadata=s,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,n]of this.tracks)if(n.source===e)return n}getTrackByName(e){for(const[,n]of this.tracks)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrack(Track.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrack(Track.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack(Track.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(this.participantInfo.joinedAt*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this.setName(e.name),this.setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,livekitLogger.trace("update participant info",{info:e}),!0)}setMetadata(e){const n=this.metadata!==e,a=this.metadata;this.metadata=e,n&&this.emit(ParticipantEvent.ParticipantMetadataChanged,a)}setName(e){const n=this.name!==e;this.name=e,n&&this.emit(ParticipantEvent.ParticipantNameChanged,e)}setPermissions(e){var n,a,s,c,u;const d=this.permissions,m=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((a=this.permissions)===null||a===void 0?void 0:a.canSubscribe)||e.canPublishData!==((s=this.permissions)===null||s===void 0?void 0:s.canPublishData)||e.hidden!==((c=this.permissions)===null||c===void 0?void 0:c.hidden)||e.recorder!==((u=this.permissions)===null||u===void 0?void 0:u.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((_,b)=>{var S;return _!==((S=this.permissions)===null||S===void 0?void 0:S.canPublishSources[b])});return this.permissions=e,m&&this.emit(ParticipantEvent.ParticipantPermissionsChanged,d),m}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(ParticipantEvent.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=qualityFromProto(e),n!==this._connectionQuality&&this.emit(ParticipantEvent.ConnectionQualityChanged,this._connectionQuality)}addTrackPublication(e){e.on(TrackEvent.Muted,()=>{this.emit(ParticipantEvent.TrackMuted,e)}),e.on(TrackEvent.Unmuted,()=>{this.emit(ParticipantEvent.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case Track.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case Track.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function trackPermissionToProto(t){var e,n,a;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return{participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(a=t.allowAll)!==null&&a!==void 0?a:!1,trackSids:t.allowedTrackSids||[]}}class RemoteTrackPublication extends TrackPublication{constructor(e,n,a){super(e,n.sid,n.name),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=VideoQuality$1.HIGH,this.handleEnded=s=>{this.setTrack(void 0),this.emit(TrackEvent.Ended,s)},this.handleVisibilityChange=s=>{livekitLogger.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(s),{trackSid:this.trackSid}),this.disabled=!s,this.emitTrackUpdate()},this.handleVideoDimensionsChange=s=>{livekitLogger.debug("adaptivestream video dimensions ".concat(s.width,"x").concat(s.height),{trackSid:this.trackSid}),this.videoDimensions=s,this.emitTrackUpdate()},this.subscribed=a,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,a=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const s={trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[{participantSid:"",trackSids:[this.trackSid]}]};this.emit(TrackEvent.UpdateSubscription,s),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(a)}get subscriptionStatus(){return this.subscribed===!1?TrackPublication.SubscriptionStatus.Unsubscribed:super.isSubscribed?TrackPublication.SubscriptionStatus.Subscribed:TrackPublication.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?TrackPublication.PermissionStatus.Allowed:TrackPublication.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,a;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((a=this.videoDimensions)===null||a===void 0?void 0:a.height)===e.height||(this.track instanceof RemoteVideoTrack&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof RemoteVideoTrack&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,a=this.permissionStatus,s=this.track;s!==e&&(s&&(s.off(TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),s.off(TrackEvent.VisibilityChanged,this.handleVisibilityChange),s.off(TrackEvent.Ended,this.handleEnded),s.detach(),s.stopMonitor(),this.emit(TrackEvent.Unsubscribed,s)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(TrackEvent.VisibilityChanged,this.handleVisibilityChange),e.on(TrackEvent.Ended,this.handleEnded),this.emit(TrackEvent.Subscribed,e)),this.emitPermissionUpdateIfChanged(a),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,a=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(a),this.emitSubscriptionUpdateIfChanged(n)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?TrackEvent.Muted:TrackEvent.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(TrackEvent.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(TrackEvent.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===Track.Kind.Video&&this.isAdaptiveStream?(livekitLogger.warn("adaptive stream is enabled, cannot change video track settings",{trackSid:this.trackSid}),!1):this.isDesired?!0:(livekitLogger.warn("cannot update track settings when not subscribed",{trackSid:this.trackSid}),!1)}get isAdaptiveStream(){return this.track instanceof RemoteVideoTrack&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=UpdateTrackSettings.fromPartial({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=this.videoDimensions.width,e.height=this.videoDimensions.height):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=VideoQuality$1.HIGH,this.emit(TrackEvent.UpdateSettings,e)}}class RemoteParticipant extends Participant{static fromParticipantInfo(e,n){return new RemoteParticipant(e,n.sid,n.identity,n.name,n.metadata)}constructor(e,n,a,s,c){super(n,a||"",s,c),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(TrackEvent.UpdateSettings,n=>{livekitLogger.debug("send update settings",n),this.signalClient.sendUpdateTrackSettings(n)}),e.on(TrackEvent.UpdateSubscription,n=>{n.participantTracks.forEach(a=>{a.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(TrackEvent.SubscriptionPermissionChanged,n=>{this.emit(ParticipantEvent.TrackSubscriptionPermissionChanged,e,n)}),e.on(TrackEvent.SubscriptionStatusChanged,n=>{this.emit(ParticipantEvent.TrackSubscriptionStatusChanged,e,n)}),e.on(TrackEvent.Subscribed,n=>{this.emit(ParticipantEvent.TrackSubscribed,n,e)}),e.on(TrackEvent.Unsubscribed,n=>{this.emit(ParticipantEvent.TrackUnsubscribed,n,e)})}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setVolume(e){this.volume=e;const n=this.getTrack(Track.Source.Microphone);n&&n.track&&n.track.setVolume(e)}getVolume(){const e=this.getTrack(Track.Source.Microphone);return e&&e.track?e.track.getVolume():this.volume}addSubscribedMediaTrack(e,n,a,s,c,u){let d=this.getTrackPublication(n);if(d||n.startsWith("TR")||this.tracks.forEach(b=>{!d&&e.kind===b.kind.toString()&&(d=b)}),!d){if(u===0){livekitLogger.error("could not find published track",{participant:this.sid,trackSid:n}),this.emit(ParticipantEvent.TrackSubscriptionFailed,n);return}u===void 0&&(u=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,a,s,c,u-1)},150);return}if(e.readyState==="ended"){livekitLogger.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",{participant:this.sid,trackSid:n}),this.emit(ParticipantEvent.TrackSubscriptionFailed,n);return}const m=e.kind==="video";let _;return m?_=new RemoteVideoTrack(e,n,s,c):_=new RemoteAudioTrack(e,n,s,this.audioContext,this.audioOutput),_.source=d.source,_.isMuted=d.isMuted,_.setMediaStream(a),_.start(),d.setTrack(_),this.volume!==void 0&&_ instanceof RemoteAudioTrack&&_.source===Track.Source.Microphone&&_.setVolume(this.volume),d}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,a=new Map;return e.tracks.forEach(s=>{var c;let u=this.getTrackPublication(s.sid);if(u)u.updateInfo(s);else{const d=Track.kindFromProto(s.type);if(!d)return;u=new RemoteTrackPublication(d,s,(c=this.signalClient.connectOptions)===null||c===void 0?void 0:c.autoSubscribe),u.updateInfo(s),a.set(s.sid,u);const m=Array.from(this.tracks.values()).find(_=>_.source===(u==null?void 0:u.source));m&&u.source!==Track.Source.Unknown&&livekitLogger.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(u.source),{oldTrack:m,newTrack:u,participant:this,participantInfo:e}),this.addTrackPublication(u)}n.set(s.sid,u)}),this.tracks.forEach(s=>{n.has(s.trackSid)||(livekitLogger.trace("detected removed track on remote participant, unpublishing",{publication:s,participantSid:this.sid}),this.unpublishTrack(s.trackSid,!0))}),a.forEach(s=>{this.emit(ParticipantEvent.TrackPublished,s)}),!0}unpublishTrack(e,n){const a=this.tracks.get(e);if(!a)return;const{track:s}=a;switch(s&&(s.stop(),a.setTrack(void 0)),this.tracks.delete(e),a.kind){case Track.Kind.Audio:this.audioTracks.delete(e);break;case Track.Kind.Video:this.videoTracks.delete(e);break}n&&this.emit(ParticipantEvent.TrackUnpublished,a)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(n=>n.track instanceof RemoteAudioTrack&&n.track.setAudioContext(e))}setAudioOutput(e){return __awaiter(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTracks.forEach(a=>{var s;a.track instanceof RemoteAudioTrack&&n.push(a.track.setSinkId((s=e.deviceId)!==null&&s!==void 0?s:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];return livekitLogger.trace("participant event",{participant:this.sid,event:e,args:a}),super.emit(e,...a)}}function mediaTrackToLocalTrack(t,e){switch(t.kind){case"audio":return new LocalAudioTrack(t,e,!1);case"video":return new LocalVideoTrack(t,e,!1);default:throw new TrackInvalidError("unsupported track type: ".concat(t.kind))}}const presets169=Object.values(VideoPresets),presets43=Object.values(VideoPresets43),presetsScreenShare=Object.values(ScreenSharePresets),defaultSimulcastPresets169=[VideoPresets.h180,VideoPresets.h360],defaultSimulcastPresets43=[VideoPresets43.h180,VideoPresets43.h360],computeDefaultScreenShareSimulcastPresets=t=>[{scaleResolutionDownBy:2,fps:3}].map(n=>{var a;return new VideoPreset(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((a=t.encoding.maxFramerate)!==null&&a!==void 0?a:30)/n.fps)))),n.fps,t.encoding.priority)}),videoRids=["q","h","f"];function computeVideoEncodings(t,e,n,a){var s,c;let u=a==null?void 0:a.videoEncoding;t&&(u=a==null?void 0:a.screenShareEncoding);const d=a==null?void 0:a.simulcast,m=a==null?void 0:a.scalabilityMode,_=a==null?void 0:a.videoCodec;if(!u&&!d&&!m||!e||!n)return[{}];u||(u=determineAppropriateEncoding(t,e,n,_),livekitLogger.debug("using video encoding",u));const b=new VideoPreset(e,n,u.maxBitrate,u.maxFramerate);if(m&&isSVCCodec(_)){livekitLogger.debug("using svc with scalabilityMode ".concat(m));const w=[];switch(m){case"L3T3":for(let O=0;O<3;O+=1)w.push({rid:videoRids[2-O],scaleResolutionDownBy:Math.pow(2,O),maxBitrate:u.maxBitrate/Math.pow(3,O),maxFramerate:b.encoding.maxFramerate,scalabilityMode:"L3T3"});return livekitLogger.debug("encodings",w),w;default:throw new Error("unsupported scalabilityMode: ".concat(m))}}if(!d)return[u];let S=[];t?S=(s=sortPresets(a==null?void 0:a.screenShareSimulcastLayers))!==null&&s!==void 0?s:defaultSimulcastLayers(t,b):S=(c=sortPresets(a==null?void 0:a.videoSimulcastLayers))!==null&&c!==void 0?c:defaultSimulcastLayers(t,b);let k;if(S.length>0){const w=S[0];S.length>1&&([,k]=S);const O=Math.max(e,n);if(O>=960&&k)return encodingsFromPresets(e,n,[w,k,b]);if(O>=480)return encodingsFromPresets(e,n,[w,b])}return encodingsFromPresets(e,n,[b])}function computeTrackBackupEncodings(t,e,n){var a,s,c,u;if(!n.backupCodec||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&livekitLogger.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const d=t.mediaStreamTrack.getSettings(),m=(a=d.width)!==null&&a!==void 0?a:(s=t.dimensions)===null||s===void 0?void 0:s.width,_=(c=d.height)!==null&&c!==void 0?c:(u=t.dimensions)===null||u===void 0?void 0:u.height;return computeVideoEncodings(t.source===Track.Source.ScreenShare,m,_,n)}function determineAppropriateEncoding(t,e,n,a){const s=presetsForResolution(t,e,n);let{encoding:c}=s[0];const u=Math.max(e,n);for(let d=0;d<s.length;d+=1){const m=s[d];if(c=m.encoding,m.width>=u)break}if(a)switch(a){case"av1":c=Object.assign({},c),c.maxBitrate=c.maxBitrate*.7;break;case"vp9":c=Object.assign({},c),c.maxBitrate=c.maxBitrate*.85;break}return c}function presetsForResolution(t,e,n){if(t)return presetsScreenShare;const a=e>n?e/n:n/e;return Math.abs(a-16/9)<Math.abs(a-4/3)?presets169:presets43}function defaultSimulcastLayers(t,e){if(t)return computeDefaultScreenShareSimulcastPresets(e);const{width:n,height:a}=e,s=n>a?n/a:a/n;return Math.abs(s-16/9)<Math.abs(s-4/3)?defaultSimulcastPresets169:defaultSimulcastPresets43}function encodingsFromPresets(t,e,n){const a=[];if(n.forEach((s,c)=>{if(c>=videoRids.length)return;const u=Math.min(t,e),m={rid:videoRids[c],scaleResolutionDownBy:Math.max(1,u/Math.min(s.width,s.height)),maxBitrate:s.encoding.maxBitrate};s.encoding.maxFramerate&&(m.maxFramerate=s.encoding.maxFramerate),s.encoding.priority&&(m.priority=s.encoding.priority,m.networkPriority=s.encoding.priority),a.push(m)}),isReactNative()&&getReactNativeOs()==="ios"){let s;a.forEach(u=>{s?u.maxFramerate&&u.maxFramerate>s&&(s=u.maxFramerate):s=u.maxFramerate});let c=!0;a.forEach(u=>{var d;u.maxFramerate!=s&&(c&&(c=!1,livekitLogger.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),livekitLogger.info('Setting framerate of encoding "'.concat((d=u.rid)!==null&&d!==void 0?d:"",'" to ').concat(s)),u.maxFramerate=s)})}return a}function sortPresets(t){if(t)return t.sort((e,n)=>{const{encoding:a}=e,{encoding:s}=n;return a.maxBitrate>s.maxBitrate?1:a.maxBitrate<s.maxBitrate?-1:a.maxBitrate===s.maxBitrate&&a.maxFramerate&&s.maxFramerate?a.maxFramerate>s.maxFramerate?1:-1:0})}class LocalParticipant extends Participant{constructor(e,n,a,s){super(e,n),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Future)},this.handleReconnected=()=>{var c,u;(u=(c=this.reconnectFuture)===null||c===void 0?void 0:c.resolve)===null||u===void 0||u.call(c),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var c,u;(u=(c=this.reconnectFuture)===null||c===void 0?void 0:c.reject)===null||u===void 0||u.call(c,"Got disconnected during publishing attempt"),this.reconnectFuture=void 0},this.updateTrackSubscriptionPermissions=()=>{livekitLogger.debug("updating track subscription permissions",{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions}),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(c=>trackPermissionToProto(c)))},this.onTrackUnmuted=c=>{this.onTrackMuted(c,c.isUpstreamPaused)},this.onTrackMuted=(c,u)=>{if(u===void 0&&(u=!0),!c.sid){livekitLogger.error("could not update mute status for unpublished track",c);return}this.engine.updateMuteStatus(c.sid,u)},this.onTrackUpstreamPaused=c=>{livekitLogger.debug("upstream paused"),this.onTrackMuted(c,!0)},this.onTrackUpstreamResumed=c=>{livekitLogger.debug("upstream resumed"),this.onTrackMuted(c,c.isMuted)},this.handleSubscribedQualityUpdate=c=>__awaiter(this,void 0,void 0,function*(){var u,d,m,_,b,S;if(!(!((b=this.roomOptions)===null||b===void 0)&&b.dynacast))return;const k=this.videoTracks.get(c.trackSid);if(!k){livekitLogger.warn("received subscribed quality update for unknown track",{method:"handleSubscribedQualityUpdate",sid:c.trackSid});return}if(c.subscribedCodecs.length>0){if(!k.videoTrack)return;const N=yield k.videoTrack.setPublishingCodecs(c.subscribedCodecs);try{for(var w=!0,O=__asyncValues(N),P;P=yield O.next(),u=P.done,!u;){_=P.value,w=!1;try{const I=_;isBackupCodec(I)&&(livekitLogger.debug("publish ".concat(I," for ").concat(k.videoTrack.sid)),yield this.publishAdditionalCodecForTrack(k.videoTrack,I,k.options))}finally{w=!0}}}catch(I){d={error:I}}finally{try{!w&&!u&&(m=O.return)&&(yield m.call(O))}finally{if(d)throw d.error}}}else c.subscribedQualities.length>0&&(yield(S=k.videoTrack)===null||S===void 0?void 0:S.setPublishingLayers(c.subscribedQualities))}),this.handleLocalTrackUnpublished=c=>{const u=this.tracks.get(c.trackSid);if(!u){livekitLogger.warn("received unpublished event for unknown track",{method:"handleLocalTrackUnpublished",trackSid:c.trackSid});return}this.unpublishTrack(u.track)},this.handleTrackEnded=c=>__awaiter(this,void 0,void 0,function*(){if(c.source===Track.Source.ScreenShare||c.source===Track.Source.ScreenShareAudio)livekitLogger.debug("unpublishing local track due to TrackEnded",{track:c.sid}),this.unpublishTrack(c);else if(c.isUserProvided)yield c.mute();else if(c instanceof LocalAudioTrack||c instanceof LocalVideoTrack)try{if(isWeb())try{const u=yield navigator==null?void 0:navigator.permissions.query({name:c.source===Track.Source.Camera?"camera":"microphone"});if(u&&u.state==="denied")throw livekitLogger.warn("user has revoked access to ".concat(c.source)),u.onchange=()=>{u.state!=="denied"&&(c.isMuted||c.restartTrack(),u.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}c.isMuted||(livekitLogger.debug("track ended, attempting to use a different device"),yield c.restartTrack())}catch{livekitLogger.warn("could not restart track, muting instead"),yield c.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=a,this.roomOptions=s,this.setupEngine(a)}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.client.onRemoteMuteChanged=(n,a)=>{const s=this.tracks.get(n);!s||!s.track||(a?s.mute():s.unmute())},this.engine.client.onSubscribedQualityUpdate=this.handleSubscribedQualityUpdate,this.engine.client.onLocalTrackUnpublished=this.handleLocalTrackUnpublished,this.engine.on(EngineEvent.Connected,this.handleReconnected).on(EngineEvent.Restarted,this.handleReconnected).on(EngineEvent.Resumed,this.handleReconnected).on(EngineEvent.Restarting,this.handleReconnecting).on(EngineEvent.Resuming,this.handleReconnecting).on(EngineEvent.Disconnected,this.handleDisconnected)}setMetadata(e){var n;super.setMetadata(e),this.engine.client.sendUpdateLocalMetadata(e,(n=this.name)!==null&&n!==void 0?n:"")}setName(e){var n;super.setName(e),this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",e)}setCameraEnabled(e,n,a){return this.setTrackEnabled(Track.Source.Camera,e,n,a)}setMicrophoneEnabled(e,n,a){return this.setTrackEnabled(Track.Source.Microphone,e,n,a)}setScreenShareEnabled(e,n,a){return this.setTrackEnabled(Track.Source.ScreenShare,e,n,a)}setTrackEnabled(e,n,a,s){var c,u;return __awaiter(this,void 0,void 0,function*(){livekitLogger.debug("setTrackEnabled",{source:e,enabled:n});let d=this.getTrack(e);if(n)if(d)yield d.unmute();else{let m;if(this.pendingPublishing.has(e)){livekitLogger.info("skipping duplicate published source",{source:e});return}this.pendingPublishing.add(e);try{switch(e){case Track.Source.Camera:m=yield this.createTracks({video:(c=a)!==null&&c!==void 0?c:!0});break;case Track.Source.Microphone:m=yield this.createTracks({audio:(u=a)!==null&&u!==void 0?u:!0});break;case Track.Source.ScreenShare:m=yield this.createScreenTracks(Object.assign({},a));break;default:throw new TrackInvalidError(e)}const _=[];for(const S of m)livekitLogger.info("publishing track",{localTrack:S}),_.push(this.publishTrack(S,s));[d]=yield Promise.all(_)}catch(_){throw _ instanceof Error&&!(_ instanceof TrackInvalidError)&&this.emit(ParticipantEvent.MediaDevicesError,_),_}finally{this.pendingPublishing.delete(e)}}else if(d&&d.track)if(e===Track.Source.ScreenShare){d=yield this.unpublishTrack(d.track);const m=this.getTrack(Track.Source.ScreenShareAudio);m&&m.track&&this.unpublishTrack(m.track)}else yield d.mute();return d})}enableCameraAndMicrophone(){return __awaiter(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(Track.Source.Camera)||this.pendingPublishing.has(Track.Source.Microphone))){this.pendingPublishing.add(Track.Source.Camera),this.pendingPublishing.add(Track.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(Track.Source.Camera),this.pendingPublishing.delete(Track.Source.Microphone)}}})}createTracks(e){var n,a;return __awaiter(this,void 0,void 0,function*(){const s=mergeDefaultOptions(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(a=this.roomOptions)===null||a===void 0?void 0:a.videoCaptureDefaults),c=constraintsForOptions(s);let u;try{u=yield navigator.mediaDevices.getUserMedia(c)}catch(d){throw d instanceof Error&&(c.audio&&(this.microphoneError=d),c.video&&(this.cameraError=d)),d}return c.audio&&(this.microphoneError=void 0),c.video&&(this.cameraError=void 0),u.getTracks().map(d=>{const m=d.kind==="audio";m?e.audio:e.video;let _;const b=m?c.audio:c.video;typeof b!="boolean"&&(_=b);const S=mediaTrackToLocalTrack(d,_);return S.kind===Track.Kind.Video?S.source=Track.Source.Camera:S.kind===Track.Kind.Audio&&(S.source=Track.Source.Microphone),S.mediaStream=u,S})})}createScreenTracks(e){var n;return __awaiter(this,void 0,void 0,function*(){e===void 0&&(e={}),e.resolution===void 0&&(e.resolution=ScreenSharePresets.h1080fps15.resolution);let a=!0;if(e.resolution&&(isSafari()?a={width:{max:e.resolution.width},height:{max:e.resolution.height},frameRate:e.resolution.frameRate}:a={width:{ideal:e.resolution.width},height:{ideal:e.resolution.height},frameRate:e.resolution.frameRate}),navigator.mediaDevices.getDisplayMedia===void 0)throw new DeviceUnsupportedError("getDisplayMedia not supported");const s=yield navigator.mediaDevices.getDisplayMedia({audio:(n=e.audio)!==null&&n!==void 0?n:!1,video:a,controller:e.controller,selfBrowserSurface:e.selfBrowserSurface,surfaceSwitching:e.surfaceSwitching,systemAudio:e.systemAudio}),c=s.getVideoTracks();if(c.length===0)throw new TrackInvalidError("no video track found");const u=new LocalVideoTrack(c[0],void 0,!1);u.source=Track.Source.ScreenShare;const d=[u];if(s.getAudioTracks().length>0){const m=new LocalAudioTrack(s.getAudioTracks()[0],void 0,!1);m.source=Track.Source.ScreenShareAudio,d.push(m)}return d})}publishTrack(e,n){var a,s,c;return __awaiter(this,void 0,void 0,function*(){if(yield(a=this.reconnectFuture)===null||a===void 0?void 0:a.promise,e instanceof LocalTrack&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e)),e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new LocalAudioTrack(e,void 0,!0);break;case"video":e=new LocalVideoTrack(e,void 0,!0);break;default:throw new TrackInvalidError("unsupported MediaStreamTrack kind ".concat(e.kind))}let u;if(this.tracks.forEach(b=>{b.track&&b.track===e&&(u=b)}),u)return livekitLogger.warn("track has already been published, skipping"),u;const d=(n==null?void 0:n.forceStereo)||"channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2;d&&(n||(n={}),n.dtx===void 0&&livekitLogger.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work."),n.red===void 0&&livekitLogger.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(s=n.dtx)!==null&&s!==void 0||(n.dtx=!1),(c=n.red)!==null&&c!==void 0||(n.red=!1));const m=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);m.source&&(e.source=m.source);const _=this.publish(e,m,n,d);this.pendingPublishPromises.set(e,_);try{return yield _}catch(b){throw b}finally{this.pendingPublishPromises.delete(e)}})}publish(e,n,a,s){var c,u,d,m,_,b,S,k,w,O,P,N;return __awaiter(this,void 0,void 0,function*(){const I=Array.from(this.tracks.values()).find(W=>e instanceof LocalTrack&&W.source===e.source);if(I&&e.source!==Track.Source.Unknown)try{throw Error("publishing a second track with the same source: ".concat(e.source))}catch(W){W instanceof Error&&livekitLogger.warn(W.message,{oldTrack:I,newTrack:e,trace:W.stack})}n.stopMicTrackOnMute&&e instanceof LocalAudioTrack&&(e.stopOnMute=!0),e.source===Track.Source.ScreenShare&&isFireFox()&&(n.simulcast=!1),n.videoCodec==="av1"&&!supportsAV1()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!supportsVP9()&&(n.videoCodec=void 0),e.on(TrackEvent.Muted,this.onTrackMuted),e.on(TrackEvent.Unmuted,this.onTrackUnmuted),e.on(TrackEvent.Ended,this.handleTrackEnded),e.on(TrackEvent.UpstreamPaused,this.onTrackUpstreamPaused),e.on(TrackEvent.UpstreamResumed,this.onTrackUpstreamResumed);const U=AddTrackRequest.fromPartial({cid:e.mediaStreamTrack.id,name:a==null?void 0:a.name,type:Track.kindToProto(e.kind),muted:e.isMuted,source:Track.sourceToProto(e.source),disableDtx:!(!((c=n.dtx)!==null&&c!==void 0)||c),stereo:s,disableRed:!(!((u=n.red)!==null&&u!==void 0)||u)});let $,x;if(e.kind===Track.Kind.Video){let W={width:0,height:0};try{W=yield e.waitForDimensions()}catch{const ee=(m=(d=this.roomOptions.videoCaptureDefaults)===null||d===void 0?void 0:d.resolution)!==null&&m!==void 0?m:VideoPresets.h720.resolution;W={width:ee.width,height:ee.height},livekitLogger.error("could not determine track dimensions, using defaults",W)}if(U.width=W.width,U.height=W.height,e instanceof LocalVideoTrack&&(isSVCCodec(n.videoCodec)&&(n.scalabilityMode=(_=n.scalabilityMode)!==null&&_!==void 0?_:"L3T3"),n.videoCodec&&n.backupCodec&&n.videoCodec!==n.backupCodec.codec)){const Z=Object.assign({},n);Z.simulcast=!0,x=computeTrackBackupEncodings(e,n.backupCodec.codec,Z),U.simulcastCodecs=[{codec:n.videoCodec,cid:e.mediaStreamTrack.id,enableSimulcastLayers:!0},{codec:n.backupCodec.codec,cid:"",enableSimulcastLayers:!0}]}$=computeVideoEncodings(e.source===Track.Source.ScreenShare,W.width,W.height,n),U.layers=videoLayersFromEncodings(U.width,U.height,x??$)}else e.kind===Track.Kind.Audio&&($=[{maxBitrate:(S=(b=n.audioPreset)===null||b===void 0?void 0:b.maxBitrate)!==null&&S!==void 0?S:n.audioBitrate,priority:(w=(k=n.audioPreset)===null||k===void 0?void 0:k.priority)!==null&&w!==void 0?w:"high",networkPriority:(P=(O=n.audioPreset)===null||O===void 0?void 0:O.priority)!==null&&P!==void 0?P:"high"}]);if(!this.engine||this.engine.isClosed)throw new UnexpectedConnectionState("cannot publish track when not connected");const C=yield this.engine.addTrack(U);let H=!1,q=!1;if(C.codecs.forEach(W=>{isCodecEqual(W.mimeType,n.videoCodec)?H=!0:n.backupCodec&&isCodecEqual(W.mimeType,n.backupCodec.codec)&&(q=!0)}),U.simulcastCodecs.length>0){if(!H&&!q)throw Error("cannot publish track, codec not supported by server");if(!H&&n.backupCodec){const W=n.backupCodec;n=Object.assign({},n),livekitLogger.debug("primary codec ".concat(n.videoCodec," not supported, fallback to ").concat(W.codec)),n.videoCodec=W.codec,n.videoEncoding=W.encoding,$=x}}const K=new LocalTrackPublication(e.kind,C,e);if(K.options=n,e.sid=C.sid,!this.engine.publisher)throw new UnexpectedConnectionState("publisher is closed");return livekitLogger.debug("publishing ".concat(e.kind," with encodings"),{encodings:$,trackInfo:C}),e.sender=yield this.engine.createSender(e,n,$),e.codec&&isSVCCodec(e.codec)&&$&&(!((N=$[0])===null||N===void 0)&&N.maxBitrate)&&this.engine.publisher.setTrackCodecBitrate(U.cid,e.codec,$[0].maxBitrate/1e3),this.engine.negotiate(),e instanceof LocalVideoTrack?e.startMonitor(this.engine.client):e instanceof LocalAudioTrack&&e.startMonitor(),this.addTrackPublication(K),this.emit(ParticipantEvent.LocalTrackPublished,K),K})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,a){var s;return __awaiter(this,void 0,void 0,function*(){let c;if(this.tracks.forEach(S=>{S.track&&S.track===e&&(c=S)}),!c)throw new TrackInvalidError("track is not published");if(!(e instanceof LocalVideoTrack))throw new TrackInvalidError("track is not a video track");const u=Object.assign(Object.assign({},(s=this.roomOptions)===null||s===void 0?void 0:s.publishDefaults),a),d=computeTrackBackupEncodings(e,n,u);if(!d){livekitLogger.info("backup codec has been disabled, ignoring request to add additional codec for track");return}const m=e.addSimulcastTrack(n,d),_=AddTrackRequest.fromPartial({cid:m.mediaStreamTrack.id,type:Track.kindToProto(e.kind),muted:e.isMuted,source:Track.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:u.videoCodec,cid:m.mediaStreamTrack.id,enableSimulcastLayers:u.simulcast}]});if(_.layers=videoLayersFromEncodings(_.width,_.height,d),!this.engine||this.engine.isClosed)throw new UnexpectedConnectionState("cannot publish track when not connected");const b=yield this.engine.addTrack(_);yield this.engine.createSimulcastSender(e,m,u,d),this.engine.negotiate(),livekitLogger.debug("published ".concat(n," for track ").concat(e.sid),{encodings:d,trackInfo:b})})}unpublishTrack(e,n){var a,s;return __awaiter(this,void 0,void 0,function*(){const c=this.getPublicationForTrack(e);if(livekitLogger.debug("unpublishing track",{track:e,method:"unpublishTrack"}),!c||!c.track){livekitLogger.warn("track was not unpublished because no publication was found",{track:e,method:"unpublishTrack"});return}e=c.track,e.off(TrackEvent.Muted,this.onTrackMuted),e.off(TrackEvent.Unmuted,this.onTrackUnmuted),e.off(TrackEvent.Ended,this.handleTrackEnded),e.off(TrackEvent.UpstreamPaused,this.onTrackUpstreamPaused),e.off(TrackEvent.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(s=(a=this.roomOptions)===null||a===void 0?void 0:a.stopLocalTrackOnUnpublish)!==null&&s!==void 0?s:!0),n&&e.stop();let u=!1;const d=e.sender;if(e.sender=void 0,this.engine.publisher&&this.engine.publisher.pc.connectionState!=="closed"&&d)try{if(this.engine.removeTrack(d)&&(u=!0),e instanceof LocalVideoTrack){for(const[,m]of e.simulcastCodecs)m.sender&&(this.engine.removeTrack(m.sender)&&(u=!0),m.sender=void 0);e.simulcastCodecs.clear()}}catch(m){livekitLogger.warn("failed to unpublish track",{error:m,method:"unpublishTrack"})}switch(this.tracks.delete(c.trackSid),c.kind){case Track.Kind.Audio:this.audioTracks.delete(c.trackSid);break;case Track.Kind.Video:this.videoTracks.delete(c.trackSid);break}return this.emit(ParticipantEvent.LocalTrackUnpublished,c),c.setTrack(void 0),u&&(yield this.engine.negotiate()),c})}unpublishTracks(e){return __awaiter(this,void 0,void 0,function*(){return(yield Promise.all(e.map(a=>this.unpublishTrack(a)))).filter(a=>a instanceof LocalTrackPublication)})}republishAllTracks(e){return __awaiter(this,void 0,void 0,function*(){const n=[];this.tracks.forEach(a=>{a.track&&(e&&(a.options=Object.assign(Object.assign({},a.options),e)),n.push(a))}),yield Promise.all(n.map(a=>__awaiter(this,void 0,void 0,function*(){const s=a.track;yield this.unpublishTrack(s,!1),yield this.publishTrack(s,a.options)})))})}publishData(e,n){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return __awaiter(this,void 0,void 0,function*(){const s=Array.isArray(a)?a:a==null?void 0:a.destination,c=[],u=Array.isArray(a)?void 0:a.topic;s!==void 0&&s.forEach(m=>{m instanceof RemoteParticipant?c.push(m.sid):c.push(m)});const d={kind:n,value:{$case:"user",user:{participantSid:this.sid,payload:e,destinationSids:c,topic:u}}};yield this.engine.sendDataPacket(d,n)})}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isConnected&&this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var a,s;const c=this.tracks.get(n.sid);if(c){const u=c.isMuted||((s=(a=c.track)===null||a===void 0?void 0:a.isUpstreamPaused)!==null&&s!==void 0?s:!1);u!==n.muted&&(livekitLogger.debug("updating server mute state after reconcile",{sid:n.sid,muted:u}),this.engine.client.sendMuteTrack(n.sid,u))}}),!0)}getPublicationForTrack(e){let n;return this.tracks.forEach(a=>{const s=a.track;s&&(e instanceof MediaStreamTrack?(s instanceof LocalAudioTrack||s instanceof LocalVideoTrack)&&s.mediaStreamTrack===e&&(n=a):e===s&&(n=a))}),n}publishedTracksInfo(){const e=[];return this.tracks.forEach(n=>{n.track!==void 0&&e.push({cid:n.track.mediaStreamID,track:n.trackInfo})}),e}dataChannelsInfo(){const e=[],n=(a,s)=>{(a==null?void 0:a.id)!==void 0&&a.id!==null&&e.push({label:a.label,id:a.id,target:s})};return n(this.engine.dataChannelForKind(DataPacket_Kind$1.LOSSY),SignalTarget.PUBLISHER),n(this.engine.dataChannelForKind(DataPacket_Kind$1.RELIABLE),SignalTarget.PUBLISHER),n(this.engine.dataChannelForKind(DataPacket_Kind$1.LOSSY,!0),SignalTarget.SUBSCRIBER),n(this.engine.dataChannelForKind(DataPacket_Kind$1.RELIABLE,!0),SignalTarget.SUBSCRIBER),e}}var ConnectionState;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting"})(ConnectionState||(ConnectionState={}));const connectionReconcileFrequency=2*1e3;class Room extends eventsExports$1.EventEmitter{constructor(e){var n;super(),n=this,this.state=ConnectionState.Disconnected,this.activeSpeakers=[],this.audioEnabled=!0,this.connect=(a,s,c)=>__awaiter(this,void 0,void 0,function*(){const u=yield this.disconnectLock.lock();if(this.state===ConnectionState.Connected)return livekitLogger.info("already connected to room ".concat(this.name)),u(),Promise.resolve();if(this.connectFuture)return u(),this.connectFuture.promise;this.setAndEmitConnectionState(ConnectionState.Connecting);const d=new RegionUrlProvider(a,s),m=(_,b,S)=>__awaiter(this,void 0,void 0,function*(){var k;this.abortController&&this.abortController.abort(),this.abortController=new AbortController,u==null||u();try{yield this.attemptConnection(S??a,s,c,this.abortController),this.abortController=void 0,_()}catch(w){if(isCloud(new URL(a))&&w instanceof ConnectionError&&w.reason!==3){let O=null;try{O=yield d.getNextBestRegionUrl((k=this.abortController)===null||k===void 0?void 0:k.signal)}catch(P){if(P instanceof ConnectionError&&(P.status===401||P.reason===3)){b(P);return}}O?(livekitLogger.debug("initial connection failed, retrying with another region"),yield m(_,b,O)):b(w)}else b(w)}});return this.connectFuture=new Future(m,()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(a,s,c,u,d,m)=>__awaiter(this,void 0,void 0,function*(){const _=yield c.join(a,s,{autoSubscribe:u.autoSubscribe,publishOnly:u.publishOnly,adaptiveStream:typeof d.adaptiveStream=="object"?!0:d.adaptiveStream,maxRetries:u.maxRetries},m.signal);let b=_.serverInfo;if(b||(b={version:_.serverVersion,region:_.serverRegion}),livekitLogger.debug("connected to Livekit Server ".concat(Object.entries(b).map(S=>{let[k,w]=S;return"".concat(k,": ").concat(w)}).join(", "))),!_.serverVersion)throw new UnsupportedServer("unknown server version");return _.serverVersion==="0.15.1"&&this.options.dynacast&&(livekitLogger.debug("disabling dynacast due to server version"),d.dynacast=!1),_}),this.applyJoinResponse=a=>{const s=a.participant;this.localParticipant.sid=s.sid,this.localParticipant.identity=s.identity,this.handleParticipantUpdates([s,...a.otherParticipants]),a.room&&this.handleRoomUpdate(a.room)},this.attemptConnection=(a,s,c,u)=>__awaiter(this,void 0,void 0,function*(){var d;this.state===ConnectionState.Reconnecting?(livekitLogger.info("Reconnection attempt replaced by new connection attempt"),this.recreateEngine()):this.maybeCreateEngine(),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},roomConnectOptionDefaults),c),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const m=yield this.connectSignal(a,s,this.engine,this.connOptions,this.options,u);this.applyJoinResponse(m),this.setupLocalParticipantEvents(),this.emit(RoomEvent.SignalConnected)}catch(m){this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish);const _=new ConnectionError("could not establish signal connection");throw m instanceof Error&&(_.message="".concat(_.message,": ").concat(m.message)),m instanceof ConnectionError&&(_.reason=m.reason,_.status=m.status),livekitLogger.debug("error trying to establish signal connection",{error:m}),_}if(u.signal.aborted)throw this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),new ConnectionError("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,u)}catch(m){throw this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),m}isWeb()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave),(d=navigator.mediaDevices)===null||d===void 0||d.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(ConnectionState.Connected),this.emit(RoomEvent.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return __awaiter(n,void 0,void 0,function*(){var s,c,u,d;const m=yield this.disconnectLock.lock();try{if(this.state===ConnectionState.Disconnected){livekitLogger.debug("already disconnected");return}livekitLogger.info("disconnect from room",{identity:this.localParticipant.identity}),(this.state===ConnectionState.Connecting||this.state===ConnectionState.Reconnecting)&&(livekitLogger.warn("abort connection attempt"),(s=this.abortController)===null||s===void 0||s.abort(),(u=(c=this.connectFuture)===null||c===void 0?void 0:c.reject)===null||u===void 0||u.call(c,new ConnectionError("Client initiated disconnect")),this.connectFuture=void 0),!((d=this.engine)===null||d===void 0)&&d.client.isConnected&&(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(a,DisconnectReason$1.CLIENT_INITIATED),this.engine=void 0}finally{m()}})},this.onPageLeave=()=>__awaiter(this,void 0,void 0,function*(){yield this.disconnect()}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const a of this.participants.values())this.handleParticipantDisconnected(a.sid,a);this.setAndEmitConnectionState(ConnectionState.Reconnecting)&&this.emit(RoomEvent.Reconnecting)},this.handleSignalRestarted=a=>__awaiter(this,void 0,void 0,function*(){livekitLogger.debug("signal reconnected to server",{region:a.serverRegion}),this.cachedParticipantSids=[],this.applyJoinResponse(a);try{const s=[];this.localParticipant.tracks.forEach(c=>{c.track&&s.push(c)}),yield Promise.all(s.map(c=>__awaiter(this,void 0,void 0,function*(){const u=c.track;this.localParticipant.unpublishTrack(u,!1),u.isMuted||((u instanceof LocalAudioTrack||u instanceof LocalVideoTrack)&&!u.isUserProvided&&(livekitLogger.debug("restarting existing track",{track:c.trackSid}),yield u.restartTrack()),livekitLogger.debug("publishing new track",{track:c.trackSid}),yield this.localParticipant.publishTrack(u,c.options))})))}catch(s){livekitLogger.error("error trying to re-publish tracks after reconnection",{error:s})}try{yield this.engine.waitForRestarted(),livekitLogger.debug("fully reconnected to server",{region:a.serverRegion})}catch{return}this.setAndEmitConnectionState(ConnectionState.Connected),this.emit(RoomEvent.Reconnected),this.registerConnectionReconcile(),this.participants.forEach(s=>{this.emit(RoomEvent.ParticipantConnected,s)})}),this.handleParticipantUpdates=a=>{a.forEach(s=>{if(s.identity===this.localParticipant.identity){this.localParticipant.updateInfo(s);return}const c=this.identityToSid.get(s.identity);c&&c!==s.sid&&this.handleParticipantDisconnected(c,this.participants.get(c));let u=this.participants.get(s.sid);const d=!u;s.state===ParticipantInfo_State$1.DISCONNECTED?this.handleParticipantDisconnected(s.sid,u):(u=this.getOrCreateParticipant(s.sid,s),d||u.updateInfo(s))})},this.handleActiveSpeakersUpdate=a=>{const s=[],c={};a.forEach(u=>{if(c[u.sid]=!0,u.sid===this.localParticipant.sid)this.localParticipant.audioLevel=u.level,this.localParticipant.setIsSpeaking(!0),s.push(this.localParticipant);else{const d=this.participants.get(u.sid);d&&(d.audioLevel=u.level,d.setIsSpeaking(!0),s.push(d))}}),c[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(u=>{c[u.sid]||(u.audioLevel=0,u.setIsSpeaking(!1))}),this.activeSpeakers=s,this.emitWhenConnected(RoomEvent.ActiveSpeakersChanged,s)},this.handleSpeakersChanged=a=>{const s=new Map;this.activeSpeakers.forEach(u=>{s.set(u.sid,u)}),a.forEach(u=>{let d=this.participants.get(u.sid);u.sid===this.localParticipant.sid&&(d=this.localParticipant),d&&(d.audioLevel=u.level,d.setIsSpeaking(u.active),u.active?s.set(u.sid,d):s.delete(u.sid))});const c=Array.from(s.values());c.sort((u,d)=>d.audioLevel-u.audioLevel),this.activeSpeakers=c,this.emitWhenConnected(RoomEvent.ActiveSpeakersChanged,c)},this.handleStreamStateUpdate=a=>{a.streamStates.forEach(s=>{const c=this.participants.get(s.participantSid);if(!c)return;const u=c.getTrackPublication(s.trackSid);!u||!u.track||(u.track.streamState=Track.streamStateFromProto(s.state),c.emit(ParticipantEvent.TrackStreamStateChanged,u,u.track.streamState),this.emitWhenConnected(RoomEvent.TrackStreamStateChanged,u,u.track.streamState,c))})},this.handleSubscriptionPermissionUpdate=a=>{const s=this.participants.get(a.participantSid);if(!s)return;const c=s.getTrackPublication(a.trackSid);c&&c.setAllowed(a.allowed)},this.handleDataPacket=(a,s)=>{const c=this.participants.get(a.participantSid);this.emit(RoomEvent.DataReceived,a.payload,c,s,a.topic),c==null||c.emit(ParticipantEvent.DataReceived,a.payload,s)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(RoomEvent.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=a=>{livekitLogger.warn("could not playback audio",a),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(RoomEvent.AudioPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>__awaiter(this,void 0,void 0,function*(){this.emit(RoomEvent.MediaDevicesChanged)}),this.handleRoomUpdate=a=>{const s=this.roomInfo;this.roomInfo=a,s&&s.metadata!==a.metadata&&this.emitWhenConnected(RoomEvent.RoomMetadataChanged,a.metadata),(s==null?void 0:s.activeRecording)!==a.activeRecording&&this.emitWhenConnected(RoomEvent.RecordingStatusChanged,a.activeRecording)},this.handleConnectionQualityUpdate=a=>{a.updates.forEach(s=>{if(s.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(s.quality);return}const c=this.participants.get(s.participantSid);c&&c.setConnectionQuality(s.quality)})},this.onLocalParticipantMetadataChanged=a=>{this.emit(RoomEvent.ParticipantMetadataChanged,a,this.localParticipant)},this.onLocalParticipantNameChanged=a=>{this.emit(RoomEvent.ParticipantNameChanged,a,this.localParticipant)},this.onLocalTrackMuted=a=>{this.emit(RoomEvent.TrackMuted,a,this.localParticipant)},this.onLocalTrackUnmuted=a=>{this.emit(RoomEvent.TrackUnmuted,a,this.localParticipant)},this.onLocalTrackPublished=a=>__awaiter(this,void 0,void 0,function*(){this.emit(RoomEvent.LocalTrackPublished,a,this.localParticipant),a.track instanceof LocalAudioTrack&&(yield a.track.checkForSilence())&&this.emit(RoomEvent.LocalAudioSilenceDetected,a)}),this.onLocalTrackUnpublished=a=>{this.emit(RoomEvent.LocalTrackUnpublished,a,this.localParticipant)},this.onLocalConnectionQualityChanged=a=>{this.emit(RoomEvent.ConnectionQualityChanged,a,this.localParticipant)},this.onMediaDevicesError=a=>{this.emit(RoomEvent.MediaDevicesError,a)},this.onLocalParticipantPermissionsChanged=a=>{this.emit(RoomEvent.ParticipantPermissionsChanged,a,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.cachedParticipantSids=[],this.identityToSid=new Map,this.options=Object.assign(Object.assign({},roomOptionDefaults),e),this.options.audioCaptureDefaults=Object.assign(Object.assign({},audioDefaults),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},videoDefaults),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},publishDefaults),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Mutex,this.localParticipant=new LocalParticipant("","",this.engine,this.options)}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&n!==void 0?n:""}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new RTCEngine(this.options),this.engine.client.onParticipantUpdate=this.handleParticipantUpdates,this.engine.client.onRoomUpdate=this.handleRoomUpdate,this.engine.client.onSpeakersChanged=this.handleSpeakersChanged,this.engine.client.onStreamStateUpdate=this.handleStreamStateUpdate,this.engine.client.onSubscriptionPermissionUpdate=this.handleSubscriptionPermissionUpdate,this.engine.client.onConnectionQuality=this.handleConnectionQualityUpdate,this.engine.on(EngineEvent.MediaTrackAdded,(e,n,a)=>{this.onTrackAdded(e,n,a)}).on(EngineEvent.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(EngineEvent.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(EngineEvent.DataPacketReceived,this.handleDataPacket).on(EngineEvent.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(ConnectionState.Reconnecting)&&this.emit(RoomEvent.Reconnecting),this.cachedParticipantSids=Array.from(this.participants.keys())}).on(EngineEvent.Resumed,()=>{this.setAndEmitConnectionState(ConnectionState.Connected),this.emit(RoomEvent.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),Array.from(this.participants.values()).filter(n=>!this.cachedParticipantSids.includes(n.sid)).forEach(n=>this.emit(RoomEvent.ParticipantConnected,n)),this.cachedParticipantSids=[]}).on(EngineEvent.SignalResumed,()=>{this.state===ConnectionState.Reconnecting&&this.sendSyncState()}).on(EngineEvent.Restarting,this.handleRestarting).on(EngineEvent.SignalRestarted,this.handleSignalRestarted).on(EngineEvent.DCBufferStatusChanged,(e,n)=>{this.emit(RoomEvent.DCBufferStatusChanged,e,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return DeviceManager.getInstance().getDevices(e,n)}prepareConnection(e){return __awaiter(this,void 0,void 0,function*(){yield fetch("http".concat(e.substring(2)),{method:"HEAD"})})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const n=this.identityToSid.get(e);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e){return __awaiter(this,void 0,void 0,function*(){let n=()=>{},a;switch(e){case"signal-reconnect":yield this.engine.client.close(),this.engine.client.onClose&&this.engine.client.onClose("simulate disconnect");break;case"speaker":a=SimulateScenario.fromPartial({scenario:{$case:"speakerUpdate",speakerUpdate:3}});break;case"node-failure":a=SimulateScenario.fromPartial({scenario:{$case:"nodeFailure",nodeFailure:!0}});break;case"server-leave":a=SimulateScenario.fromPartial({scenario:{$case:"serverLeave",serverLeave:!0}});break;case"migration":a=SimulateScenario.fromPartial({scenario:{$case:"migration",migration:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.close(),this.engine.client.onClose&&this.engine.client.onClose("simulate resume-reconnect");break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.close(),this.engine.client.onClose&&this.engine.client.onClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":a=SimulateScenario.fromPartial({scenario:{$case:"switchCandidateProtocol",switchCandidateProtocol:e==="force-tls"?2:1}}),n=()=>__awaiter(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s({reason:DisconnectReason$1.CLIENT_INITIATED,canReconnect:!0})});break}a&&(this.engine.client.sendSimulateScenario(a),n())})}startAudio(){return __awaiter(this,void 0,void 0,function*(){yield this.acquireAudioContext();const e=[];this.participants.forEach(n=>{n.audioTracks.forEach(a=>{a.track&&a.track.attachedElements.forEach(s=>{e.push(s)})})});try{yield Promise.all(e.map(n=>(n.muted=!1,n.play()))),this.handleAudioPlaybackStarted()}catch(n){throw this.handleAudioPlaybackFailed(n),n}})}get canPlaybackAudio(){return this.audioEnabled}getActiveAudioOutputDevice(){var e,n;return(n=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&n!==void 0?n:""}switchActiveDevice(e,n){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var s,c;return __awaiter(this,void 0,void 0,function*(){const u=a?{exact:n}:n;if(e==="audioinput"){const d=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=u;const m=Array.from(this.localParticipant.audioTracks.values()).filter(_=>_.source===Track.Source.Microphone);try{yield Promise.all(m.map(_=>{var b;return(b=_.audioTrack)===null||b===void 0?void 0:b.setDeviceId(u)}))}catch(_){throw this.options.audioCaptureDefaults.deviceId=d,_}}else if(e==="videoinput"){const d=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=u;const m=Array.from(this.localParticipant.videoTracks.values()).filter(_=>_.source===Track.Source.Camera);try{yield Promise.all(m.map(_=>{var b;return(b=_.videoTrack)===null||b===void 0?void 0:b.setDeviceId(u)}))}catch(_){throw this.options.videoCaptureDefaults.deviceId=d,_}}else if(e==="audiooutput"){if(!supportsSetSinkId())throw new Error("cannot switch audio output, setSinkId not supported");(s=(c=this.options).audioOutput)!==null&&s!==void 0||(c.audioOutput={});const d=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n;try{yield Promise.all(Array.from(this.participants.values()).map(m=>m.setAudioOutput({deviceId:n})))}catch(m){throw this.options.audioOutput.deviceId=d,m}}})}setupLocalParticipantEvents(){this.localParticipant.on(ParticipantEvent.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ParticipantEvent.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(ParticipantEvent.TrackMuted,this.onLocalTrackMuted).on(ParticipantEvent.TrackUnmuted,this.onLocalTrackUnmuted).on(ParticipantEvent.LocalTrackPublished,this.onLocalTrackPublished).on(ParticipantEvent.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ParticipantEvent.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ParticipantEvent.MediaDevicesError,this.onMediaDevicesError).on(ParticipantEvent.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.maybeCreateEngine()}onTrackAdded(e,n,a){if(this.state===ConnectionState.Connecting||this.state===ConnectionState.Reconnecting){const _=()=>{this.onTrackAdded(e,n,a),b()},b=()=>{this.off(RoomEvent.Reconnected,_),this.off(RoomEvent.Connected,_),this.off(RoomEvent.Disconnected,b)};this.once(RoomEvent.Reconnected,_),this.once(RoomEvent.Connected,_),this.once(RoomEvent.Disconnected,b);return}if(this.state===ConnectionState.Disconnected){livekitLogger.warn("skipping incoming track after Room disconnected");return}const s=unpackStreamId(n.id),c=s[0];let u=s[1];if((!u||u==="")&&(u=e.id),c===this.localParticipant.sid){livekitLogger.warn("tried to create RemoteParticipant for local participant");return}const d=this.getOrCreateParticipant(c);let m;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?m=this.options.adaptiveStream:m={}),d.addSubscribedMediaTrack(e,u,n,a,m)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var a;if(this.clearConnectionReconcile(),this.state!==ConnectionState.Disconnected)try{this.participants.forEach(s=>{s.tracks.forEach(c=>{s.unpublishTrack(c.trackSid)})}),this.localParticipant.tracks.forEach(s=>{var c,u;s.track&&this.localParticipant.unpublishTrack(s.track,e),e&&((c=s.track)===null||c===void 0||c.detach(),(u=s.track)===null||u===void 0||u.stop())}),this.localParticipant.off(ParticipantEvent.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ParticipantEvent.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(ParticipantEvent.TrackMuted,this.onLocalTrackMuted).off(ParticipantEvent.TrackUnmuted,this.onLocalTrackUnmuted).off(ParticipantEvent.LocalTrackPublished,this.onLocalTrackPublished).off(ParticipantEvent.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ParticipantEvent.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ParticipantEvent.MediaDevicesError,this.onMediaDevicesError).off(ParticipantEvent.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),isWeb()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),(a=navigator.mediaDevices)===null||a===void 0||a.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(ConnectionState.Disconnected),this.emit(RoomEvent.Disconnected,n)}}handleParticipantDisconnected(e,n){this.participants.delete(e),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(a=>{n.unpublishTrack(a.trackSid,!0)}),this.emit(RoomEvent.ParticipantDisconnected,n))}acquireAudioContext(){var e,n;return __awaiter(this,void 0,void 0,function*(){typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?(this.audioContext=this.options.expWebAudioMix.audioContext,yield this.audioContext.resume()):this.audioContext=(e=getNewAudioContext())!==null&&e!==void 0?e:void 0,this.options.expWebAudioMix&&this.participants.forEach(s=>s.setAudioContext(this.audioContext));const a=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";a!==this.canPlaybackAudio&&(this.audioEnabled=a,this.emit(RoomEvent.AudioPlaybackStatusChanged,a))})}createParticipant(e,n){let a;return n?a=RemoteParticipant.fromParticipantInfo(this.engine.client,n):a=new RemoteParticipant(this.engine.client,e,"",void 0,void 0),this.options.expWebAudioMix&&a.setAudioContext(this.audioContext),a}getOrCreateParticipant(e,n){if(this.participants.has(e))return this.participants.get(e);const a=this.createParticipant(e,n);return this.participants.set(e,a),n&&(this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(RoomEvent.ParticipantConnected,a)),a.on(ParticipantEvent.TrackPublished,s=>{this.emitWhenConnected(RoomEvent.TrackPublished,s,a)}).on(ParticipantEvent.TrackSubscribed,(s,c)=>{s.kind===Track.Kind.Audio&&(s.on(TrackEvent.AudioPlaybackStarted,this.handleAudioPlaybackStarted),s.on(TrackEvent.AudioPlaybackFailed,this.handleAudioPlaybackFailed)),this.emit(RoomEvent.TrackSubscribed,s,c,a)}).on(ParticipantEvent.TrackUnpublished,s=>{this.emit(RoomEvent.TrackUnpublished,s,a)}).on(ParticipantEvent.TrackUnsubscribed,(s,c)=>{this.emit(RoomEvent.TrackUnsubscribed,s,c,a)}).on(ParticipantEvent.TrackSubscriptionFailed,s=>{this.emit(RoomEvent.TrackSubscriptionFailed,s,a)}).on(ParticipantEvent.TrackMuted,s=>{this.emitWhenConnected(RoomEvent.TrackMuted,s,a)}).on(ParticipantEvent.TrackUnmuted,s=>{this.emitWhenConnected(RoomEvent.TrackUnmuted,s,a)}).on(ParticipantEvent.ParticipantMetadataChanged,s=>{this.emitWhenConnected(RoomEvent.ParticipantMetadataChanged,s,a)}).on(ParticipantEvent.ParticipantNameChanged,s=>{this.emitWhenConnected(RoomEvent.ParticipantNameChanged,s,a)}).on(ParticipantEvent.ConnectionQualityChanged,s=>{this.emitWhenConnected(RoomEvent.ConnectionQualityChanged,s,a)}).on(ParticipantEvent.ParticipantPermissionsChanged,s=>{this.emitWhenConnected(RoomEvent.ParticipantPermissionsChanged,s,a)}).on(ParticipantEvent.TrackSubscriptionStatusChanged,(s,c)=>{this.emitWhenConnected(RoomEvent.TrackSubscriptionStatusChanged,s,c,a)}).on(ParticipantEvent.TrackSubscriptionPermissionChanged,(s,c)=>{this.emitWhenConnected(RoomEvent.TrackSubscriptionPermissionChanged,s,c,a)}),n&&a.updateInfo(n),a}sendSyncState(){var e,n;if(this.engine.subscriber===void 0||this.engine.subscriber.pc.localDescription===null)return;const a=this.engine.subscriber.pc.localDescription,s=this.engine.subscriber.pc.remoteDescription,c=(n=(e=this.connOptions)===null||e===void 0?void 0:e.autoSubscribe)!==null&&n!==void 0?n:!0,u=new Array;this.participants.forEach(d=>{d.tracks.forEach(m=>{m.isDesired!==c&&u.push(m.trackSid)})}),this.engine.client.sendSyncState({answer:toProtoSessionDescription({sdp:a.sdp,type:a.type}),offer:s?toProtoSessionDescription({sdp:s.sdp,type:s.type}):void 0,subscription:{trackSids:u,subscribe:!c,participantTracks:[]},publishTracks:this.localParticipant.publishedTracksInfo(),dataChannels:this.localParticipant.dataChannelsInfo()})}updateSubscriptions(){for(const e of this.participants.values())for(const n of e.videoTracks.values())n.isSubscribed&&n instanceof RemoteTrackPublication&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=CriticalTimers.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,livekitLogger.warn("detected connection state mismatch",{numFailures:e}),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,DisconnectReason$1.STATE_MISMATCH))):e=0},connectionReconcileFrequency)}clearConnectionReconcile(){this.connectionReconcileInterval&&CriticalTimers.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(RoomEvent.ConnectionStateChanged,this.state),!0)}emitWhenConnected(e){if(this.state===ConnectionState.Connected){for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];return this.emit(e,...a)}return!1}simulateParticipants(e){var n,a;return __awaiter(this,void 0,void 0,function*(){const s=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),c=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo={sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:new Date().getTime(),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1},this.localParticipant.updateInfo(ParticipantInfo.fromPartial({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(RoomEvent.SignalConnected),this.emit(RoomEvent.Connected),this.setAndEmitConnectionState(ConnectionState.Connected),s.video){const u=new LocalTrackPublication(Track.Kind.Video,TrackInfo.fromPartial({source:TrackSource$2.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType$1.AUDIO,name:"video-dummy"}),new LocalVideoTrack(s.useRealTracks?(yield navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:createDummyVideoStreamTrack((n=160*c.aspectRatios[0])!==null&&n!==void 0?n:1,160,!0,!0)));this.localParticipant.addTrackPublication(u),this.localParticipant.emit(ParticipantEvent.LocalTrackPublished,u)}if(s.audio){const u=new LocalTrackPublication(Track.Kind.Audio,TrackInfo.fromPartial({source:TrackSource$2.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType$1.AUDIO}),new LocalAudioTrack(s.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:getEmptyAudioStreamTrack()));this.localParticipant.addTrackPublication(u),this.localParticipant.emit(ParticipantEvent.LocalTrackPublished,u)}for(let u=0;u<c.count-1;u+=1){let d=ParticipantInfo.fromPartial({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(u),state:ParticipantInfo_State$1.ACTIVE,tracks:[],joinedAt:Date.now()});const m=this.getOrCreateParticipant(d.identity,d);if(c.video){const _=createDummyVideoStreamTrack((a=160*c.aspectRatios[u%c.aspectRatios.length])!==null&&a!==void 0?a:1,160,!1,!0),b=TrackInfo.fromPartial({source:TrackSource$2.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType$1.AUDIO});m.addSubscribedMediaTrack(_,b.sid,new MediaStream([_])),d.tracks=[...d.tracks,b]}if(c.audio){const _=getEmptyAudioStreamTrack(),b=TrackInfo.fromPartial({source:TrackSource$2.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:TrackType$1.AUDIO});m.addSubscribedMediaTrack(_,b.sid,new MediaStream([_])),d.tracks=[...d.tracks,b]}m.updateInfo(d)}})}emit(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];return e!==RoomEvent.ActiveSpeakersChanged&&livekitLogger.debug("room event ".concat(e),{event:e,args:a}),super.emit(e,...a)}}var CheckStatus;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(CheckStatus||(CheckStatus={}));class Checker extends eventsExports$1.EventEmitter{constructor(e,n){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=CheckStatus.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Room(a.roomOptions),this.connectOptions=a.connectOptions,a.errorsAsWarnings&&(this.errorsAsWarnings=a.errorsAsWarnings)}run(e){return __awaiter(this,void 0,void 0,function*(){if(this.status!==CheckStatus.IDLE)throw Error("check is running already");this.setStatus(CheckStatus.RUNNING),this.appendMessage("".concat(this.name," started."));try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==CheckStatus.SKIPPED&&this.setStatus(this.isSuccess()?CheckStatus.SUCCESS:CheckStatus.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return __awaiter(this,void 0,void 0,function*(){return this.room.state===ConnectionState.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return __awaiter(this,void 0,void 0,function*(){this.room&&this.room.state!==ConnectionState.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(CheckStatus.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function createLocalTracks(t){var e,n;return __awaiter(this,void 0,void 0,function*(){t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio=!0),(n=t.video)!==null&&n!==void 0||(t.video=!0);const a=mergeDefaultOptions(t,audioDefaults,videoDefaults),s=constraintsForOptions(a),c=navigator.mediaDevices.getUserMedia(s);t.audio&&(DeviceManager.userMediaPromiseMap.set("audioinput",c),c.catch(()=>DeviceManager.userMediaPromiseMap.delete("audioinput"))),t.video&&(DeviceManager.userMediaPromiseMap.set("videoinput",c),c.catch(()=>DeviceManager.userMediaPromiseMap.delete("videoinput")));const u=yield c;return u.getTracks().map(d=>{const m=d.kind==="audio";m?t.audio:t.video;let _;const b=m?s.audio:s.video;typeof b!="boolean"&&(_=b);const S=mediaTrackToLocalTrack(d,_);return S.kind===Track.Kind.Video?S.source=Track.Source.Camera:S.kind===Track.Kind.Audio&&(S.source=Track.Source.Microphone),S.mediaStream=u,S})})}function createLocalVideoTrack(t){return __awaiter(this,void 0,void 0,function*(){return(yield createLocalTracks({audio:!1,video:t}))[0]})}function createLocalAudioTrack(t){return __awaiter(this,void 0,void 0,function*(){return(yield createLocalTracks({audio:t,video:!1}))[0]})}class PublishAudioCheck extends Checker{get description(){return"Can publish audio"}perform(){var e;return __awaiter(this,void 0,void 0,function*(){const n=yield this.connect(),a=yield createLocalAudioTrack();n.localParticipant.publishTrack(a),yield new Promise(u=>setTimeout(u,3e3));const s=yield(e=a.sender)===null||e===void 0?void 0:e.getStats();if(!s)throw new Error("Could not get RTCStats");let c=0;if(s.forEach(u=>{u.type==="outbound-rtp"&&u.mediaType==="audio"&&(c=u.packetsSent)}),c===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(c," audio packets"))})}}class PublishVideoCheck extends Checker{get description(){return"Can publish video"}perform(){var e;return __awaiter(this,void 0,void 0,function*(){const n=yield this.connect(),a=yield createLocalVideoTrack();n.localParticipant.publishTrack(a),yield new Promise(u=>setTimeout(u,3e3));const s=yield(e=a.sender)===null||e===void 0?void 0:e.getStats();if(!s)throw new Error("Could not get RTCStats");let c=0;if(s.forEach(u=>{u.type==="outbound-rtp"&&u.mediaType==="video"&&(c=u.packetsSent)}),c===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(c," video packets"))})}}class ReconnectCheck extends Checker{get description(){return"Resuming connection after interruption"}perform(){var e;return __awaiter(this,void 0,void 0,function*(){const n=yield this.connect();let a=!1,s=!1,c;const u=new Promise(m=>{setTimeout(m,5e3),c=m});n.on(RoomEvent.Reconnecting,()=>{a=!0}).on(RoomEvent.Reconnected,()=>{s=!0,c(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const d=n.engine.client.onClose;if(d&&d(""),yield u,a){if(!s||n.state!==ConnectionState.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class TURNCheck extends Checker{get description(){return"Can connect via TURN"}perform(){var e,n;return __awaiter(this,void 0,void 0,function*(){const a=new SignalClient,s=yield a.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0});let c=!1,u=!1,d=!1;for(let m of s.iceServers)for(let _ of m.urls)_.startsWith("turn:")?(u=!0,d=!0):_.startsWith("turns:")&&(u=!0,d=!0,c=!0),_.startsWith("stun:")&&(d=!0);d?u&&!c&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield a.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||u?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(m=>setTimeout(m,0)))})}}class WebRTCCheck extends Checker{get description(){return"Establishing WebRTC connection"}perform(){return __awaiter(this,void 0,void 0,function*(){try{console.log("initiating room connection"),this.room=yield this.connect(),console.log("now the room is connected")}catch(e){throw this.appendWarning("ports need to be open on firewall in order to connect."),e}})}}class WebSocketCheck extends Checker{get description(){return"Connecting to signal connection via WebSocket"}perform(){return __awaiter(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let e=new SignalClient;const n=yield e.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0});this.appendMessage("Connected to server, version ".concat(n.serverVersion,".")),yield e.close()})}}class ConnectionCheck extends eventsExports$1.EventEmitter{constructor(e,n){super(),this.checkResults=new Map,this.url=e,this.token=n}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:CheckStatus.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==CheckStatus.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return __awaiter(this,void 0,void 0,function*(){const n=this.getNextCheckId(),a=new e(this.url,this.token),s=u=>{this.updateCheck(n,u)};a.on("update",s);const c=yield a.run();return a.off("update",s),c})}checkWebsocket(){return __awaiter(this,void 0,void 0,function*(){return this.createAndRunCheck(WebSocketCheck)})}checkWebRTC(){return __awaiter(this,void 0,void 0,function*(){return this.createAndRunCheck(WebRTCCheck)})}checkTURN(){return __awaiter(this,void 0,void 0,function*(){return this.createAndRunCheck(TURNCheck)})}checkReconnect(){return __awaiter(this,void 0,void 0,function*(){return this.createAndRunCheck(ReconnectCheck)})}checkPublishAudio(){return __awaiter(this,void 0,void 0,function*(){return this.createAndRunCheck(PublishAudioCheck)})}checkPublishVideo(){return __awaiter(this,void 0,void 0,function*(){return this.createAndRunCheck(PublishVideoCheck)})}}var MavModeFlag=(t=>(t[t.MAV_MODE_FLAG_SAFETY_ARMED=128]="MAV_MODE_FLAG_SAFETY_ARMED",t[t.MAV_MODE_FLAG_MANUAL_INPUT_ENABLED=64]="MAV_MODE_FLAG_MANUAL_INPUT_ENABLED",t[t.MAV_MODE_FLAG_HIL_ENABLED=32]="MAV_MODE_FLAG_HIL_ENABLED",t[t.MAV_MODE_FLAG_STABILIZE_ENABLED=16]="MAV_MODE_FLAG_STABILIZE_ENABLED",t[t.MAV_MODE_FLAG_GUIDED_ENABLED=8]="MAV_MODE_FLAG_GUIDED_ENABLED",t[t.MAV_MODE_FLAG_AUTO_ENABLED=4]="MAV_MODE_FLAG_AUTO_ENABLED",t[t.MAV_MODE_FLAG_TEST_ENABLED=2]="MAV_MODE_FLAG_TEST_ENABLED",t[t.MAV_MODE_FLAG_CUSTOM_MODE_ENABLED=1]="MAV_MODE_FLAG_CUSTOM_MODE_ENABLED",t))(MavModeFlag||{}),MavState=(t=>(t.MAV_STATE_UNINIT="MAV_STATE_UNINIT",t.MAV_STATE_BOOT="MAV_STATE_BOOT",t.MAV_STATE_CALIBRATING="MAV_STATE_CALIBRATING",t.MAV_STATE_STANDBY="MAV_STATE_STANDBY",t.MAV_STATE_ACTIVE="MAV_STATE_ACTIVE",t.MAV_STATE_CRITICAL="MAV_STATE_CRITICAL",t.MAV_STATE_EMERGENCY="MAV_STATE_EMERGENCY",t.MAV_STATE_POWEROFF="MAV_STATE_POWEROFF",t.MAV_STATE_FLIGHT_TERMINATION="MAV_STATE_FLIGHT_TERMINATION",t))(MavState||{}),MavSeverity=(t=>(t.MAV_SEVERITY_EMERGENCY="MAV_SEVERITY_EMERGENCY",t.MAV_SEVERITY_ALERT="MAV_SEVERITY_ALERT",t.MAV_SEVERITY_CRITICAL="MAV_SEVERITY_CRITICAL",t.MAV_SEVERITY_ERROR="MAV_SEVERITY_ERROR",t.MAV_SEVERITY_WARNING="MAV_SEVERITY_WARNING",t.MAV_SEVERITY_NOTICE="MAV_SEVERITY_NOTICE",t.MAV_SEVERITY_INFO="MAV_SEVERITY_INFO",t.MAV_SEVERITY_DEBUG="MAV_SEVERITY_DEBUG",t))(MavSeverity||{}),MAVLinkType=(t=>(t.ACTUATOR_CONTROL_TARGET="ACTUATOR_CONTROL_TARGET",t.ACTUATOR_OUTPUT_STATUS="ACTUATOR_OUTPUT_STATUS",t.ADAP_TUNING="ADAP_TUNING",t.ADSB_VEHICLE="ADSB_VEHICLE",t.AHRS="AHRS",t.AHRS2="AHRS2",t.AHRS3="AHRS3",t.AIRSPEED_AUTOCAL="AIRSPEED_AUTOCAL",t.AIS_VESSEL="AIS_VESSEL",t.ALTITUDE="ALTITUDE",t.AOA_SSA="AOA_SSA",t.AP_ADC="AP_ADC",t.ATT_POS_MOCAP="ATT_POS_MOCAP",t.ATTITUDE="ATTITUDE",t.ATTITUDE_QUATERNION="ATTITUDE_QUATERNION",t.ATTITUDE_QUATERNION_COV="ATTITUDE_QUATERNION_COV",t.ATTITUDE_TARGET="ATTITUDE_TARGET",t.AUTH_KEY="AUTH_KEY",t.AUTOPILOT_STATE_FOR_GIMBAL_DEVICE="AUTOPILOT_STATE_FOR_GIMBAL_DEVICE",t.AUTOPILOT_VERSION="AUTOPILOT_VERSION",t.AUTOPILOT_VERSION_REQUEST="AUTOPILOT_VERSION_REQUEST",t.BATTERY_STATUS="BATTERY_STATUS",t.BATTERY2="BATTERY2",t.BUTTON_CHANGE="BUTTON_CHANGE",t.CAMERA_CAPTURE_STATUS="CAMERA_CAPTURE_STATUS",t.CAMERA_FEEDBACK="CAMERA_FEEDBACK",t.CAMERA_IMAGE_CAPTURED="CAMERA_IMAGE_CAPTURED",t.CAMERA_INFORMATION="CAMERA_INFORMATION",t.CAMERA_SETTINGS="CAMERA_SETTINGS",t.CAMERA_STATUS="CAMERA_STATUS",t.CAMERA_TRIGGER="CAMERA_TRIGGER",t.CELLULAR_CONFIG="CELLULAR_CONFIG",t.CELLULAR_STATUS="CELLULAR_STATUS",t.CHANGE_OPERATOR_CONTROL="CHANGE_OPERATOR_CONTROL",t.CHANGE_OPERATOR_CONTROL_ACK="CHANGE_OPERATOR_CONTROL_ACK",t.COLLISION="COLLISION",t.COMMAND_ACK="COMMAND_ACK",t.COMMAND_CANCEL="COMMAND_CANCEL",t.COMMAND_INT="COMMAND_INT",t.COMMAND_LONG="COMMAND_LONG",t.COMPASSMOT_STATUS="COMPASSMOT_STATUS",t.COMPONENT_INFORMATION="COMPONENT_INFORMATION",t.CONTROL_SYSTEM_STATE="CONTROL_SYSTEM_STATE",t.DATA_STREAM="DATA_STREAM",t.DATA_TRANSMISSION_HANDSHAKE="DATA_TRANSMISSION_HANDSHAKE",t.DATA16="DATA16",t.DATA32="DATA32",t.DATA64="DATA64",t.DATA96="DATA96",t.DEBUG="DEBUG",t.DEBUG_FLOAT_ARRAY="DEBUG_FLOAT_ARRAY",t.DEBUG_VECT="DEBUG_VECT",t.DEEPSTALL="DEEPSTALL",t.DEVICE_OP_READ="DEVICE_OP_READ",t.DEVICE_OP_READ_REPLY="DEVICE_OP_READ_REPLY",t.DEVICE_OP_WRITE="DEVICE_OP_WRITE",t.DEVICE_OP_WRITE_REPLY="DEVICE_OP_WRITE_REPLY",t.DIGICAM_CONFIGURE="DIGICAM_CONFIGURE",t.DIGICAM_CONTROL="DIGICAM_CONTROL",t.DISTANCE_SENSOR="DISTANCE_SENSOR",t.EFI_STATUS="EFI_STATUS",t.EKF_STATUS_REPORT="EKF_STATUS_REPORT",t.ENCAPSULATED_DATA="ENCAPSULATED_DATA",t.ESC_TELEMETRY_1_TO_4="ESC_TELEMETRY_1_TO_4",t.ESC_TELEMETRY_5_TO_8="ESC_TELEMETRY_5_TO_8",t.ESC_TELEMETRY_9_TO_12="ESC_TELEMETRY_9_TO_12",t.ESTIMATOR_STATUS="ESTIMATOR_STATUS",t.EXTENDED_SYS_STATE="EXTENDED_SYS_STATE",t.FENCE_FETCH_POINT="FENCE_FETCH_POINT",t.FENCE_POINT="FENCE_POINT",t.FENCE_STATUS="FENCE_STATUS",t.FILE_TRANSFER_PROTOCOL="FILE_TRANSFER_PROTOCOL",t.FLIGHT_INFORMATION="FLIGHT_INFORMATION",t.FOLLOW_TARGET="FOLLOW_TARGET",t.GENERATOR_STATUS="GENERATOR_STATUS",t.GIMBAL_CONTROL="GIMBAL_CONTROL",t.GIMBAL_DEVICE_ATTITUDE_STATUS="GIMBAL_DEVICE_ATTITUDE_STATUS",t.GIMBAL_DEVICE_INFORMATION="GIMBAL_DEVICE_INFORMATION",t.GIMBAL_DEVICE_SET_ATTITUDE="GIMBAL_DEVICE_SET_ATTITUDE",t.GIMBAL_MANAGER_INFORMATION="GIMBAL_MANAGER_INFORMATION",t.GIMBAL_MANAGER_SET_ATTITUDE="GIMBAL_MANAGER_SET_ATTITUDE",t.GIMBAL_MANAGER_SET_TILTPAN="GIMBAL_MANAGER_SET_TILTPAN",t.GIMBAL_MANAGER_STATUS="GIMBAL_MANAGER_STATUS",t.GIMBAL_REPORT="GIMBAL_REPORT",t.GIMBAL_TORQUE_CMD_REPORT="GIMBAL_TORQUE_CMD_REPORT",t.GLOBAL_POSITION_INT="GLOBAL_POSITION_INT",t.GLOBAL_POSITION_INT_COV="GLOBAL_POSITION_INT_COV",t.GLOBAL_VISION_POSITION_ESTIMATE="GLOBAL_VISION_POSITION_ESTIMATE",t.GOPRO_GET_REQUEST="GOPRO_GET_REQUEST",t.GOPRO_GET_RESPONSE="GOPRO_GET_RESPONSE",t.GOPRO_HEARTBEAT="GOPRO_HEARTBEAT",t.GOPRO_SET_REQUEST="GOPRO_SET_REQUEST",t.GOPRO_SET_RESPONSE="GOPRO_SET_RESPONSE",t.GPS_GLOBAL_ORIGIN="GPS_GLOBAL_ORIGIN",t.GPS_INJECT_DATA="GPS_INJECT_DATA",t.GPS_INPUT="GPS_INPUT",t.GPS_RAW_INT="GPS_RAW_INT",t.GPS_RTCM_DATA="GPS_RTCM_DATA",t.GPS_RTK="GPS_RTK",t.GPS_STATUS="GPS_STATUS",t.GPS2_RAW="GPS2_RAW",t.GPS2_RTK="GPS2_RTK",t.HEARTBEAT="HEARTBEAT",t.HIGH_LATENCY="HIGH_LATENCY",t.HIGH_LATENCY2="HIGH_LATENCY2",t.HIGHRES_IMU="HIGHRES_IMU",t.HIL_ACTUATOR_CONTROLS="HIL_ACTUATOR_CONTROLS",t.HIL_CONTROLS="HIL_CONTROLS",t.HIL_GPS="HIL_GPS",t.HIL_OPTICAL_FLOW="HIL_OPTICAL_FLOW",t.HIL_RC_INPUTS_RAW="HIL_RC_INPUTS_RAW",t.HIL_SENSOR="HIL_SENSOR",t.HIL_STATE="HIL_STATE",t.HIL_STATE_QUATERNION="HIL_STATE_QUATERNION",t.HOME_POSITION="HOME_POSITION",t.HWSTATUS="HWSTATUS",t.ISBD_LINK_STATUS="ISBD_LINK_STATUS",t.LANDING_TARGET="LANDING_TARGET",t.LED_CONTROL="LED_CONTROL",t.LIMITS_STATUS="LIMITS_STATUS",t.LINK_NODE_STATUS="LINK_NODE_STATUS",t.LOCAL_POSITION_NED="LOCAL_POSITION_NED",t.LOCAL_POSITION_NED_COV="LOCAL_POSITION_NED_COV",t.LOCAL_POSITION_NED_SYSTEM_GLOBAL_OFFSET="LOCAL_POSITION_NED_SYSTEM_GLOBAL_OFFSET",t.LOG_DATA="LOG_DATA",t.LOG_ENTRY="LOG_ENTRY",t.LOG_ERASE="LOG_ERASE",t.LOG_REQUEST_DATA="LOG_REQUEST_DATA",t.LOG_REQUEST_END="LOG_REQUEST_END",t.LOG_REQUEST_LIST="LOG_REQUEST_LIST",t.LOGGING_ACK="LOGGING_ACK",t.LOGGING_DATA="LOGGING_DATA",t.LOGGING_DATA_ACKED="LOGGING_DATA_ACKED",t.MAG_CAL_PROGRESS="MAG_CAL_PROGRESS",t.MAG_CAL_REPORT="MAG_CAL_REPORT",t.MANUAL_CONTROL="MANUAL_CONTROL",t.MANUAL_SETPOINT="MANUAL_SETPOINT",t.MEMINFO="MEMINFO",t.MEMORY_VECT="MEMORY_VECT",t.MESSAGE_INTERVAL="MESSAGE_INTERVAL",t.MISSION_ACK="MISSION_ACK",t.MISSION_CHANGED="MISSION_CHANGED",t.MISSION_CLEAR_ALL="MISSION_CLEAR_ALL",t.MISSION_COUNT="MISSION_COUNT",t.MISSION_CURRENT="MISSION_CURRENT",t.MISSION_ITEM="MISSION_ITEM",t.MISSION_ITEM_INT="MISSION_ITEM_INT",t.MISSION_ITEM_REACHED="MISSION_ITEM_REACHED",t.MISSION_REQUEST="MISSION_REQUEST",t.MISSION_REQUEST_INT="MISSION_REQUEST_INT",t.MISSION_REQUEST_LIST="MISSION_REQUEST_LIST",t.MISSION_REQUEST_PARTIAL_LIST="MISSION_REQUEST_PARTIAL_LIST",t.MISSION_SET_CURRENT="MISSION_SET_CURRENT",t.MISSION_WRITE_PARTIAL_LIST="MISSION_WRITE_PARTIAL_LIST",t.MOUNT_CONFIGURE="MOUNT_CONFIGURE",t.MOUNT_CONTROL="MOUNT_CONTROL",t.MOUNT_ORIENTATION="MOUNT_ORIENTATION",t.MOUNT_STATUS="MOUNT_STATUS",t.NAMED_VALUE_FLOAT="NAMED_VALUE_FLOAT",t.NAMED_VALUE_INT="NAMED_VALUE_INT",t.NAV_CONTROLLER_OUTPUT="NAV_CONTROLLER_OUTPUT",t.OBSTACLE_DISTANCE="OBSTACLE_DISTANCE",t.ODOMETRY="ODOMETRY",t.ONBOARD_COMPUTER_STATUS="ONBOARD_COMPUTER_STATUS",t.OPEN_DRONE_ID_AUTHENTICATION="OPEN_DRONE_ID_AUTHENTICATION",t.OPEN_DRONE_ID_BASIC_ID="OPEN_DRONE_ID_BASIC_ID",t.OPEN_DRONE_ID_LOCATION="OPEN_DRONE_ID_LOCATION",t.OPEN_DRONE_ID_MESSAGE_PACK="OPEN_DRONE_ID_MESSAGE_PACK",t.OPEN_DRONE_ID_OPERATOR_ID="OPEN_DRONE_ID_OPERATOR_ID",t.OPEN_DRONE_ID_SELF_ID="OPEN_DRONE_ID_SELF_ID",t.OPEN_DRONE_ID_SYSTEM="OPEN_DRONE_ID_SYSTEM",t.OPTICAL_FLOW="OPTICAL_FLOW",t.OPTICAL_FLOW_RAD="OPTICAL_FLOW_RAD",t.ORBIT_EXECUTION_STATUS="ORBIT_EXECUTION_STATUS",t.PARAM_EXT_ACK="PARAM_EXT_ACK",t.PARAM_EXT_REQUEST_LIST="PARAM_EXT_REQUEST_LIST",t.PARAM_EXT_REQUEST_READ="PARAM_EXT_REQUEST_READ",t.PARAM_EXT_SET="PARAM_EXT_SET",t.PARAM_EXT_VALUE="PARAM_EXT_VALUE",t.PARAM_MAP_RC="PARAM_MAP_RC",t.PARAM_REQUEST_LIST="PARAM_REQUEST_LIST",t.PARAM_REQUEST_READ="PARAM_REQUEST_READ",t.PARAM_SET="PARAM_SET",t.PARAM_VALUE="PARAM_VALUE",t.PID_TUNING="PID_TUNING",t.PING="PING",t.PLAY_TUNE="PLAY_TUNE",t.PLAY_TUNE_V2="PLAY_TUNE_V2",t.POSITION_TARGET_GLOBAL_INT="POSITION_TARGET_GLOBAL_INT",t.POSITION_TARGET_LOCAL_NED="POSITION_TARGET_LOCAL_NED",t.POWER_STATUS="POWER_STATUS",t.PROTOCOL_VERSION="PROTOCOL_VERSION",t.RADIO="RADIO",t.RADIO_STATUS="RADIO_STATUS",t.RALLY_FETCH_POINT="RALLY_FETCH_POINT",t.RALLY_POINT="RALLY_POINT",t.RANGEFINDER="RANGEFINDER",t.RAW_IMU="RAW_IMU",t.RAW_PRESSURE="RAW_PRESSURE",t.RAW_RPM="RAW_RPM",t.RC_CHANNELS="RC_CHANNELS",t.RC_CHANNELS_OVERRIDE="RC_CHANNELS_OVERRIDE",t.RC_CHANNELS_RAW="RC_CHANNELS_RAW",t.RC_CHANNELS_SCALED="RC_CHANNELS_SCALED",t.REMOTE_LOG_BLOCK_STATUS="REMOTE_LOG_BLOCK_STATUS",t.REMOTE_LOG_DATA_BLOCK="REMOTE_LOG_DATA_BLOCK",t.REQUEST_DATA_STREAM="REQUEST_DATA_STREAM",t.RESOURCE_REQUEST="RESOURCE_REQUEST",t.RPM="RPM",t.SAFETY_ALLOWED_AREA="SAFETY_ALLOWED_AREA",t.SAFETY_SET_ALLOWED_AREA="SAFETY_SET_ALLOWED_AREA",t.SCALED_IMU="SCALED_IMU",t.SCALED_IMU2="SCALED_IMU2",t.SCALED_IMU3="SCALED_IMU3",t.SCALED_PRESSURE="SCALED_PRESSURE",t.SCALED_PRESSURE2="SCALED_PRESSURE2",t.SCALED_PRESSURE3="SCALED_PRESSURE3",t.SENSOR_OFFSETS="SENSOR_OFFSETS",t.SERIAL_CONTROL="SERIAL_CONTROL",t.SERVO_OUTPUT_RAW="SERVO_OUTPUT_RAW",t.SET_ACTUATOR_CONTROL_TARGET="SET_ACTUATOR_CONTROL_TARGET",t.SET_ATTITUDE_TARGET="SET_ATTITUDE_TARGET",t.SET_GPS_GLOBAL_ORIGIN="SET_GPS_GLOBAL_ORIGIN",t.SET_HOME_POSITION="SET_HOME_POSITION",t.SET_MAG_OFFSETS="SET_MAG_OFFSETS",t.SET_MODE="SET_MODE",t.SET_POSITION_TARGET_GLOBAL_INT="SET_POSITION_TARGET_GLOBAL_INT",t.SET_POSITION_TARGET_LOCAL_NED="SET_POSITION_TARGET_LOCAL_NED",t.SETUP_SIGNING="SETUP_SIGNING",t.SIM_STATE="SIM_STATE",t.SIMSTATE="SIMSTATE",t.SMART_BATTERY_INFO="SMART_BATTERY_INFO",t.SMART_BATTERY_STATUS="SMART_BATTERY_STATUS",t.STATUSTEXT="STATUSTEXT",t.STORAGE_INFORMATION="STORAGE_INFORMATION",t.SUPPORTED_TUNES="SUPPORTED_TUNES",t.SYS_STATUS="SYS_STATUS",t.SYSTEM_TIME="SYSTEM_TIME",t.TERRAIN_CHECK="TERRAIN_CHECK",t.TERRAIN_DATA="TERRAIN_DATA",t.TERRAIN_REPORT="TERRAIN_REPORT",t.TERRAIN_REQUEST="TERRAIN_REQUEST",t.TIME_ESTIMATE_TO_TARGET="TIME_ESTIMATE_TO_TARGET",t.TIMESYNC="TIMESYNC",t.TRAJECTORY_REPRESENTATION_BEZIER="TRAJECTORY_REPRESENTATION_BEZIER",t.TRAJECTORY_REPRESENTATION_WAYPOINTS="TRAJECTORY_REPRESENTATION_WAYPOINTS",t.TUNNEL="TUNNEL",t.UAVCAN_NODE_INFO="UAVCAN_NODE_INFO",t.UAVCAN_NODE_STATUS="UAVCAN_NODE_STATUS",t.UTM_GLOBAL_POSITION="UTM_GLOBAL_POSITION",t.V2_EXTENSION="V2_EXTENSION",t.VFR_HUD="VFR_HUD",t.VIBRATION="VIBRATION",t.VICON_POSITION_ESTIMATE="VICON_POSITION_ESTIMATE",t.VIDEO_STREAM_INFORMATION="VIDEO_STREAM_INFORMATION",t.VIDEO_STREAM_STATUS="VIDEO_STREAM_STATUS",t.VISION_POSITION_DELTA="VISION_POSITION_DELTA",t.VISION_POSITION_ESTIMATE="VISION_POSITION_ESTIMATE",t.VISION_SPEED_ESTIMATE="VISION_SPEED_ESTIMATE",t.WHEEL_DISTANCE="WHEEL_DISTANCE",t.WIFI_CONFIG_AP="WIFI_CONFIG_AP",t.WIND="WIND",t.WIND_COV="WIND_COV",t))(MAVLinkType||{}),ConnectionStates=(t=>(t.init="Init",t.connecting="Connecting",t.connected="Connected",t.reconnecting="Reconnecting",t.disconnectedOk="Disconnected",t.failed="Failed",t))(ConnectionStates||{});new TextEncoder;const TD=new TextDecoder,DECODE_TXT=t=>TD.decode(t),ENCRYPTED_AUTH_TOKEN_PREFIX="AUTHTOKEN:",SEA_LEVEL_PRESSURE=1013.25;MAVLinkType.HEARTBEAT,MAVLinkType.ATTITUDE,MAVLinkType.SYS_STATUS,MAVLinkType.STATUSTEXT,MAVLinkType.SCALED_PRESSURE,MAVLinkType.SCALED_PRESSURE2,MAVLinkType.SCALED_PRESSURE3;const LIVEKIT_FRONTEND_ROOM_CONNECTION_CONFIG={autoSubscribe:!1,maxRetries:6,peerConnectionTimeout:15e3};new DefaultReconnectPolicy;const LIVEKIT_FRONTEND_ROOM_CONFIG={reconnectPolicy:new DefaultReconnectPolicy,dynacast:!0,disconnectOnPageLeave:!0,adaptiveStream:!0},SIMPLEPEER_BASE_CONFIG={initiator:!0,trickle:!0,config:{bundlePolicy:"balanced",iceTransportPolicy:"all"}};let computedTracker=[];function nStore(t){let e=[],n=(u,d=!0)=>(e.includes(u)||e.push(u),d&&u(t),()=>{e=e.filter(m=>m!=u)});function a(u){if(u===t&&(t===null||typeof t!="object"))return;let d=t;t=u;for(let m of e)m(t,d)}function s(){let u=computedTracker[computedTracker.length-1];return u&&n(u[0],!1),t}if(typeof t=="function")return computed(t);function c(){for(let u of e)u(t,t)}return{subscribe:n,set:a,get:s,refresh:c,update:u=>{typeof u=="function"&&a(u(t))}}}function computed(t){let e=nStore(null),n=[a];return a(),e;function a(){if(computedTracker.includes(n))throw Error("Circular computation");computedTracker.push(n);let s;try{s=t()}catch(c){throw computedTracker.pop(),c}computedTracker.pop(),e.set(s)}}async function listLivekitRoomsWithoutSDK(t,e){return await fetch(t+"/twirp/livekit.RoomService/ListRooms",{method:"POST",cache:"no-cache",mode:"cors",body:"{}",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e}}).then(n=>n.json()).then(n=>{const a=n.rooms;if(!Array.isArray(a))throw new Error(`Error getting livekit room list from ${t} - ${JSON.stringify(n)}`);return a.filter(s=>s.num_participants>0)}).catch(n=>{throw new Error(`Error getting livekit room list from  - ${t}: ${n}`)})}function getAuthTokenFromLivekitRoomMetadata(t,e="accessTokens"){try{const a=JSON.parse(t).accessTokens;if(!a||!Array.isArray(a)||a.length===0)return console.warn("Failed to get tokens list from livekit room metadata"),null;{const s=a[Math.floor(Math.random()*1e5)%a.length],c=s.split("|");if(c.length===4){const[u,d,m,_]=c;return{encrypted:!0,salt:d,iv:m,token:_,userGivenIdentity:u}}else if(c.length===2){const u=s.split("|"),[d,m]=u;return{encrypted:!1,token:m,userGivenIdentity:d}}else return console.log("Invalid auth token found in metadata: "+s),null}}catch(n){return console.warn("Error parsing livekit room metadata: "+t,n),null}}function waitfor(t){return new Promise(e=>{setTimeout(()=>{e()},t)})}function changesSubscribe(t,e){let n=!1;return t.subscribe(s=>{if(n==!1){n=!0;return}e(s)})}function getWebsocketURL(t,e=!1){return t.replace("http","ws")}/**
* @license
* Copyright 2009 The Closure Library Authors
* Copyright 2020 Daniel Wirtz / The long.js Authors.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
* SPDX-License-Identifier: Apache-2.0
*/var wasm=null;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Long(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Long.prototype.__isLong__;Object.defineProperty(Long.prototype,"__isLong__",{value:!0});function isLong(t){return(t&&t.__isLong__)===!0}function ctz32(t){var e=Math.clz32(t&-t);return t?31-e:e}Long.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(t,e){var n,a,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(a=UINT_CACHE[t],a)?a:(n=fromBits(t,0,!0),s&&(UINT_CACHE[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(a=INT_CACHE[t],a)?a:(n=fromBits(t,t<0?-1:0,!1),s&&(INT_CACHE[t]=n),n))}Long.fromInt=fromInt;function fromNumber(t,e){if(isNaN(t))return e?UZERO:ZERO;if(e){if(t<0)return UZERO;if(t>=TWO_PWR_64_DBL)return MAX_UNSIGNED_VALUE}else{if(t<=-TWO_PWR_63_DBL)return MIN_VALUE;if(t+1>=TWO_PWR_63_DBL)return MAX_VALUE}return t<0?fromNumber(-t,e).neg():fromBits(t%TWO_PWR_32_DBL|0,t/TWO_PWR_32_DBL|0,e)}Long.fromNumber=fromNumber;function fromBits(t,e,n){return new Long(t,e,n)}Long.fromBits=fromBits;var pow_dbl=Math.pow;function fromString(t,e,n){if(t.length===0)throw Error("empty string");if(typeof e=="number"?(n=e,e=!1):e=!!e,t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return e?UZERO:ZERO;if(n=n||10,n<2||36<n)throw RangeError("radix");var a;if((a=t.indexOf("-"))>0)throw Error("interior hyphen");if(a===0)return fromString(t.substring(1),e,n).neg();for(var s=fromNumber(pow_dbl(n,8)),c=ZERO,u=0;u<t.length;u+=8){var d=Math.min(8,t.length-u),m=parseInt(t.substring(u,u+d),n);if(d<8){var _=fromNumber(pow_dbl(n,d));c=c.mul(_).add(fromNumber(m))}else c=c.mul(s),c=c.add(fromNumber(m))}return c.unsigned=e,c}Long.fromString=fromString;function fromValue(t,e){return typeof t=="number"?fromNumber(t,e):typeof t=="string"?fromString(t,e):fromBits(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Long.fromValue=fromValue;var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long.ZERO=ZERO;var UZERO=fromInt(0,!0);Long.UZERO=UZERO;var ONE=fromInt(1);Long.ONE=ONE;var UONE=fromInt(1,!0);Long.UONE=UONE;var NEG_ONE=fromInt(-1);Long.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long.MIN_VALUE=MIN_VALUE;var LongPrototype=Long.prototype;LongPrototype.toInt=function(){return this.unsigned?this.low>>>0:this.low};LongPrototype.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)};LongPrototype.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(MIN_VALUE)){var n=fromNumber(e),a=this.div(n),s=a.mul(n).sub(this);return a.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var c=fromNumber(pow_dbl(e,6),this.unsigned),u=this,d="";;){var m=u.div(c),_=u.sub(m.mul(c)).toInt()>>>0,b=_.toString(e);if(u=m,u.isZero())return b+d;for(;b.length<6;)b="0"+b;d=""+b+d}};LongPrototype.getHighBits=function(){return this.high};LongPrototype.getHighBitsUnsigned=function(){return this.high>>>0};LongPrototype.getLowBits=function(){return this.low};LongPrototype.getLowBitsUnsigned=function(){return this.low>>>0};LongPrototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};LongPrototype.isZero=function(){return this.high===0&&this.low===0};LongPrototype.eqz=LongPrototype.isZero;LongPrototype.isNegative=function(){return!this.unsigned&&this.high<0};LongPrototype.isPositive=function(){return this.unsigned||this.high>=0};LongPrototype.isOdd=function(){return(this.low&1)===1};LongPrototype.isEven=function(){return(this.low&1)===0};LongPrototype.equals=function(e){return isLong(e)||(e=fromValue(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};LongPrototype.eq=LongPrototype.equals;LongPrototype.notEquals=function(e){return!this.eq(e)};LongPrototype.neq=LongPrototype.notEquals;LongPrototype.ne=LongPrototype.notEquals;LongPrototype.lessThan=function(e){return this.comp(e)<0};LongPrototype.lt=LongPrototype.lessThan;LongPrototype.lessThanOrEqual=function(e){return this.comp(e)<=0};LongPrototype.lte=LongPrototype.lessThanOrEqual;LongPrototype.le=LongPrototype.lessThanOrEqual;LongPrototype.greaterThan=function(e){return this.comp(e)>0};LongPrototype.gt=LongPrototype.greaterThan;LongPrototype.greaterThanOrEqual=function(e){return this.comp(e)>=0};LongPrototype.gte=LongPrototype.greaterThanOrEqual;LongPrototype.ge=LongPrototype.greaterThanOrEqual;LongPrototype.compare=function(e){if(isLong(e)||(e=fromValue(e)),this.eq(e))return 0;var n=this.isNegative(),a=e.isNegative();return n&&!a?-1:!n&&a?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};LongPrototype.comp=LongPrototype.compare;LongPrototype.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)};LongPrototype.neg=LongPrototype.negate;LongPrototype.add=function(e){isLong(e)||(e=fromValue(e));var n=this.high>>>16,a=this.high&65535,s=this.low>>>16,c=this.low&65535,u=e.high>>>16,d=e.high&65535,m=e.low>>>16,_=e.low&65535,b=0,S=0,k=0,w=0;return w+=c+_,k+=w>>>16,w&=65535,k+=s+m,S+=k>>>16,k&=65535,S+=a+d,b+=S>>>16,S&=65535,b+=n+u,b&=65535,fromBits(k<<16|w,b<<16|S,this.unsigned)};LongPrototype.subtract=function(e){return isLong(e)||(e=fromValue(e)),this.add(e.neg())};LongPrototype.sub=LongPrototype.subtract;LongPrototype.multiply=function(e){if(this.isZero())return this;if(isLong(e)||(e=fromValue(e)),wasm){var n=wasm.mul(this.low,this.high,e.low,e.high);return fromBits(n,wasm.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?UZERO:ZERO;if(this.eq(MIN_VALUE))return e.isOdd()?MIN_VALUE:ZERO;if(e.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(TWO_PWR_24)&&e.lt(TWO_PWR_24))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var a=this.high>>>16,s=this.high&65535,c=this.low>>>16,u=this.low&65535,d=e.high>>>16,m=e.high&65535,_=e.low>>>16,b=e.low&65535,S=0,k=0,w=0,O=0;return O+=u*b,w+=O>>>16,O&=65535,w+=c*b,k+=w>>>16,w&=65535,w+=u*_,k+=w>>>16,w&=65535,k+=s*b,S+=k>>>16,k&=65535,k+=c*_,S+=k>>>16,k&=65535,k+=u*m,S+=k>>>16,k&=65535,S+=a*b+s*_+c*m+u*d,S&=65535,fromBits(w<<16|O,S<<16|k,this.unsigned)};LongPrototype.mul=LongPrototype.multiply;LongPrototype.divide=function(e){if(isLong(e)||(e=fromValue(e)),e.isZero())throw Error("division by zero");if(wasm){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,e.low,e.high);return fromBits(n,wasm.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?UZERO:ZERO;var a,s,c;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return UZERO;if(e.gt(this.shru(1)))return UONE;c=UZERO}else{if(this.eq(MIN_VALUE)){if(e.eq(ONE)||e.eq(NEG_ONE))return MIN_VALUE;if(e.eq(MIN_VALUE))return ONE;var u=this.shr(1);return a=u.div(e).shl(1),a.eq(ZERO)?e.isNegative()?ONE:NEG_ONE:(s=this.sub(e.mul(a)),c=a.add(s.div(e)),c)}else if(e.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();c=ZERO}for(s=this;s.gte(e);){a=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var d=Math.ceil(Math.log(a)/Math.LN2),m=d<=48?1:pow_dbl(2,d-48),_=fromNumber(a),b=_.mul(e);b.isNegative()||b.gt(s);)a-=m,_=fromNumber(a,this.unsigned),b=_.mul(e);_.isZero()&&(_=ONE),c=c.add(_),s=s.sub(b)}return c};LongPrototype.div=LongPrototype.divide;LongPrototype.modulo=function(e){if(isLong(e)||(e=fromValue(e)),wasm){var n=(this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,e.low,e.high);return fromBits(n,wasm.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};LongPrototype.mod=LongPrototype.modulo;LongPrototype.rem=LongPrototype.modulo;LongPrototype.not=function(){return fromBits(~this.low,~this.high,this.unsigned)};LongPrototype.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};LongPrototype.clz=LongPrototype.countLeadingZeros;LongPrototype.countTrailingZeros=function(){return this.low?ctz32(this.low):ctz32(this.high)+32};LongPrototype.ctz=LongPrototype.countTrailingZeros;LongPrototype.and=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low&e.low,this.high&e.high,this.unsigned)};LongPrototype.or=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low|e.low,this.high|e.high,this.unsigned)};LongPrototype.xor=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low^e.low,this.high^e.high,this.unsigned)};LongPrototype.shiftLeft=function(e){return isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits(0,this.low<<e-32,this.unsigned)};LongPrototype.shl=LongPrototype.shiftLeft;LongPrototype.shiftRight=function(e){return isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};LongPrototype.shr=LongPrototype.shiftRight;LongPrototype.shiftRightUnsigned=function(e){return isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?fromBits(this.high,0,this.unsigned):fromBits(this.high>>>e-32,0,this.unsigned)};LongPrototype.shru=LongPrototype.shiftRightUnsigned;LongPrototype.shr_u=LongPrototype.shiftRightUnsigned;LongPrototype.rotateLeft=function(e){var n;return isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?fromBits(this.high,this.low,this.unsigned):e<32?(n=32-e,fromBits(this.low<<e|this.high>>>n,this.high<<e|this.low>>>n,this.unsigned)):(e-=32,n=32-e,fromBits(this.high<<e|this.low>>>n,this.low<<e|this.high>>>n,this.unsigned))};LongPrototype.rotl=LongPrototype.rotateLeft;LongPrototype.rotateRight=function(e){var n;return isLong(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?fromBits(this.high,this.low,this.unsigned):e<32?(n=32-e,fromBits(this.high<<n|this.low>>>e,this.low<<n|this.high>>>e,this.unsigned)):(e-=32,n=32-e,fromBits(this.low<<n|this.high>>>e,this.high<<n|this.low>>>e,this.unsigned))};LongPrototype.rotr=LongPrototype.rotateRight;LongPrototype.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this};LongPrototype.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)};LongPrototype.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};LongPrototype.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};LongPrototype.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Long.fromBytes=function(e,n,a){return a?Long.fromBytesLE(e,n):Long.fromBytesBE(e,n)};Long.fromBytesLE=function(e,n){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Long.fromBytesBE=function(e,n){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};var indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=t;function t(e,n){for(var a=new Array(arguments.length-1),s=0,c=2,u=!0;c<arguments.length;)a[s++]=arguments[c++];return new Promise(function(m,_){a[s]=function(S){if(u)if(u=!1,S)_(S);else{for(var k=new Array(arguments.length-1),w=0;w<k.length;)k[w++]=arguments[w];m.apply(null,k)}};try{e.apply(n||null,a)}catch(b){u&&(u=!1,_(b))}})}return aspromise}var base64$1={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(t){var e=t;e.length=function(d){var m=d.length;if(!m)return 0;for(var _=0;--m%4>1&&d.charAt(m)==="=";)++_;return Math.ceil(d.length*3)/4-_};for(var n=new Array(64),a=new Array(123),s=0;s<64;)a[n[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;e.encode=function(d,m,_){for(var b=null,S=[],k=0,w=0,O;m<_;){var P=d[m++];switch(w){case 0:S[k++]=n[P>>2],O=(P&3)<<4,w=1;break;case 1:S[k++]=n[O|P>>4],O=(P&15)<<2,w=2;break;case 2:S[k++]=n[O|P>>6],S[k++]=n[P&63],w=0;break}k>8191&&((b||(b=[])).push(String.fromCharCode.apply(String,S)),k=0)}return w&&(S[k++]=n[O],S[k++]=61,w===1&&(S[k++]=61)),b?(k&&b.push(String.fromCharCode.apply(String,S.slice(0,k))),b.join("")):String.fromCharCode.apply(String,S.slice(0,k))};var c="invalid encoding";e.decode=function(d,m,_){for(var b=_,S=0,k,w=0;w<d.length;){var O=d.charCodeAt(w++);if(O===61&&S>1)break;if((O=a[O])===void 0)throw Error(c);switch(S){case 0:k=O,S=1;break;case 1:m[_++]=k<<2|(O&48)>>4,k=O,S=2;break;case 2:m[_++]=(k&15)<<4|(O&60)>>2,k=O,S=3;break;case 3:m[_++]=(k&3)<<6|O,S=0;break}}if(S===1)throw Error(c);return _-b},e.test=function(d){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(d)}}(base64$1)),base64$1}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=t;function t(){this._listeners={}}return t.prototype.on=function(n,a,s){return(this._listeners[n]||(this._listeners[n]=[])).push({fn:a,ctx:s||this}),this},t.prototype.off=function(n,a){if(n===void 0)this._listeners={};else if(a===void 0)this._listeners[n]=[];else for(var s=this._listeners[n],c=0;c<s.length;)s[c].fn===a?s.splice(c,1):++c;return this},t.prototype.emit=function(n){var a=this._listeners[n];if(a){for(var s=[],c=1;c<arguments.length;)s.push(arguments[c++]);for(c=0;c<a.length;)a[c].fn.apply(a[c++].ctx,s)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=t(t);function t(c){return typeof Float32Array<"u"?function(){var u=new Float32Array([-0]),d=new Uint8Array(u.buffer),m=d[3]===128;function _(w,O,P){u[0]=w,O[P]=d[0],O[P+1]=d[1],O[P+2]=d[2],O[P+3]=d[3]}function b(w,O,P){u[0]=w,O[P]=d[3],O[P+1]=d[2],O[P+2]=d[1],O[P+3]=d[0]}c.writeFloatLE=m?_:b,c.writeFloatBE=m?b:_;function S(w,O){return d[0]=w[O],d[1]=w[O+1],d[2]=w[O+2],d[3]=w[O+3],u[0]}function k(w,O){return d[3]=w[O],d[2]=w[O+1],d[1]=w[O+2],d[0]=w[O+3],u[0]}c.readFloatLE=m?S:k,c.readFloatBE=m?k:S}():function(){function u(m,_,b,S){var k=_<0?1:0;if(k&&(_=-_),_===0)m(1/_>0?0:2147483648,b,S);else if(isNaN(_))m(2143289344,b,S);else if(_>34028234663852886e22)m((k<<31|2139095040)>>>0,b,S);else if(_<11754943508222875e-54)m((k<<31|Math.round(_/1401298464324817e-60))>>>0,b,S);else{var w=Math.floor(Math.log(_)/Math.LN2),O=Math.round(_*Math.pow(2,-w)*8388608)&8388607;m((k<<31|w+127<<23|O)>>>0,b,S)}}c.writeFloatLE=u.bind(null,e),c.writeFloatBE=u.bind(null,n);function d(m,_,b){var S=m(_,b),k=(S>>31)*2+1,w=S>>>23&255,O=S&8388607;return w===255?O?NaN:k*(1/0):w===0?k*1401298464324817e-60*O:k*Math.pow(2,w-150)*(O+8388608)}c.readFloatLE=d.bind(null,a),c.readFloatBE=d.bind(null,s)}(),typeof Float64Array<"u"?function(){var u=new Float64Array([-0]),d=new Uint8Array(u.buffer),m=d[7]===128;function _(w,O,P){u[0]=w,O[P]=d[0],O[P+1]=d[1],O[P+2]=d[2],O[P+3]=d[3],O[P+4]=d[4],O[P+5]=d[5],O[P+6]=d[6],O[P+7]=d[7]}function b(w,O,P){u[0]=w,O[P]=d[7],O[P+1]=d[6],O[P+2]=d[5],O[P+3]=d[4],O[P+4]=d[3],O[P+5]=d[2],O[P+6]=d[1],O[P+7]=d[0]}c.writeDoubleLE=m?_:b,c.writeDoubleBE=m?b:_;function S(w,O){return d[0]=w[O],d[1]=w[O+1],d[2]=w[O+2],d[3]=w[O+3],d[4]=w[O+4],d[5]=w[O+5],d[6]=w[O+6],d[7]=w[O+7],u[0]}function k(w,O){return d[7]=w[O],d[6]=w[O+1],d[5]=w[O+2],d[4]=w[O+3],d[3]=w[O+4],d[2]=w[O+5],d[1]=w[O+6],d[0]=w[O+7],u[0]}c.readDoubleLE=m?S:k,c.readDoubleBE=m?k:S}():function(){function u(m,_,b,S,k,w){var O=S<0?1:0;if(O&&(S=-S),S===0)m(0,k,w+_),m(1/S>0?0:2147483648,k,w+b);else if(isNaN(S))m(0,k,w+_),m(2146959360,k,w+b);else if(S>17976931348623157e292)m(0,k,w+_),m((O<<31|2146435072)>>>0,k,w+b);else{var P;if(S<22250738585072014e-324)P=S/5e-324,m(P>>>0,k,w+_),m((O<<31|P/4294967296)>>>0,k,w+b);else{var N=Math.floor(Math.log(S)/Math.LN2);N===1024&&(N=1023),P=S*Math.pow(2,-N),m(P*4503599627370496>>>0,k,w+_),m((O<<31|N+1023<<20|P*1048576&1048575)>>>0,k,w+b)}}}c.writeDoubleLE=u.bind(null,e,0,4),c.writeDoubleBE=u.bind(null,n,4,0);function d(m,_,b,S,k){var w=m(S,k+_),O=m(S,k+b),P=(O>>31)*2+1,N=O>>>20&2047,I=4294967296*(O&1048575)+w;return N===2047?I?NaN:P*(1/0):N===0?P*5e-324*I:P*Math.pow(2,N-1075)*(I+4503599627370496)}c.readDoubleLE=d.bind(null,a,0,4),c.readDoubleBE=d.bind(null,s,4,0)}(),c}function e(c,u,d){u[d]=c&255,u[d+1]=c>>>8&255,u[d+2]=c>>>16&255,u[d+3]=c>>>24}function n(c,u,d){u[d]=c>>>24,u[d+1]=c>>>16&255,u[d+2]=c>>>8&255,u[d+3]=c&255}function a(c,u){return(c[u]|c[u+1]<<8|c[u+2]<<16|c[u+3]<<24)>>>0}function s(c,u){return(c[u]<<24|c[u+1]<<16|c[u+2]<<8|c[u+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}return inquire_1}var utf8$2={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(t){var e=t;e.length=function(a){for(var s=0,c=0,u=0;u<a.length;++u)c=a.charCodeAt(u),c<128?s+=1:c<2048?s+=2:(c&64512)===55296&&(a.charCodeAt(u+1)&64512)===56320?(++u,s+=4):s+=3;return s},e.read=function(a,s,c){var u=c-s;if(u<1)return"";for(var d=null,m=[],_=0,b;s<c;)b=a[s++],b<128?m[_++]=b:b>191&&b<224?m[_++]=(b&31)<<6|a[s++]&63:b>239&&b<365?(b=((b&7)<<18|(a[s++]&63)<<12|(a[s++]&63)<<6|a[s++]&63)-65536,m[_++]=55296+(b>>10),m[_++]=56320+(b&1023)):m[_++]=(b&15)<<12|(a[s++]&63)<<6|a[s++]&63,_>8191&&((d||(d=[])).push(String.fromCharCode.apply(String,m)),_=0);return d?(_&&d.push(String.fromCharCode.apply(String,m.slice(0,_))),d.join("")):String.fromCharCode.apply(String,m.slice(0,_))},e.write=function(a,s,c){for(var u=c,d,m,_=0;_<a.length;++_)d=a.charCodeAt(_),d<128?s[c++]=d:d<2048?(s[c++]=d>>6|192,s[c++]=d&63|128):(d&64512)===55296&&((m=a.charCodeAt(_+1))&64512)===56320?(d=65536+((d&1023)<<10)+(m&1023),++_,s[c++]=d>>18|240,s[c++]=d>>12&63|128,s[c++]=d>>6&63|128,s[c++]=d&63|128):(s[c++]=d>>12|224,s[c++]=d>>6&63|128,s[c++]=d&63|128);return c-u}}(utf8$2)),utf8$2}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=t;function t(e,n,a){var s=a||8192,c=s>>>1,u=null,d=s;return function(_){if(_<1||_>c)return e(_);d+_>s&&(u=e(s),d=0);var b=n.call(u,d,d+=_);return d&7&&(d=(d|7)+1),b}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=e;var t=requireMinimal();function e(c,u){this.lo=c>>>0,this.hi=u>>>0}var n=e.zero=new e(0,0);n.toNumber=function(){return 0},n.zzEncode=n.zzDecode=function(){return this},n.length=function(){return 1};var a=e.zeroHash="\0\0\0\0\0\0\0\0";e.fromNumber=function(u){if(u===0)return n;var d=u<0;d&&(u=-u);var m=u>>>0,_=(u-m)/4294967296>>>0;return d&&(_=~_>>>0,m=~m>>>0,++m>4294967295&&(m=0,++_>4294967295&&(_=0))),new e(m,_)},e.from=function(u){if(typeof u=="number")return e.fromNumber(u);if(t.isString(u))if(t.Long)u=t.Long.fromString(u);else return e.fromNumber(parseInt(u,10));return u.low||u.high?new e(u.low>>>0,u.high>>>0):n},e.prototype.toNumber=function(u){if(!u&&this.hi>>>31){var d=~this.lo+1>>>0,m=~this.hi>>>0;return d||(m=m+1>>>0),-(d+m*4294967296)}return this.lo+this.hi*4294967296},e.prototype.toLong=function(u){return t.Long?new t.Long(this.lo|0,this.hi|0,!!u):{low:this.lo|0,high:this.hi|0,unsigned:!!u}};var s=String.prototype.charCodeAt;return e.fromHash=function(u){return u===a?n:new e((s.call(u,0)|s.call(u,1)<<8|s.call(u,2)<<16|s.call(u,3)<<24)>>>0,(s.call(u,4)|s.call(u,5)<<8|s.call(u,6)<<16|s.call(u,7)<<24)>>>0)},e.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},e.prototype.zzEncode=function(){var u=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^u)>>>0,this.lo=(this.lo<<1^u)>>>0,this},e.prototype.zzDecode=function(){var u=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^u)>>>0,this.hi=(this.hi>>>1^u)>>>0,this},e.prototype.length=function(){var u=this.lo,d=(this.lo>>>28|this.hi<<4)>>>0,m=this.hi>>>24;return m===0?d===0?u<16384?u<128?1:2:u<2097152?3:4:d<16384?d<128?5:6:d<2097152?7:8:m<128?9:10},longbits}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(t){var e=t;e.asPromise=requireAspromise(),e.base64=requireBase64(),e.EventEmitter=requireEventemitter(),e.float=requireFloat(),e.inquire=requireInquire(),e.utf8=requireUtf8(),e.pool=requirePool(),e.LongBits=requireLongbits(),e.isNode=!!(typeof commonjsGlobal$1<"u"&&commonjsGlobal$1&&commonjsGlobal$1.process&&commonjsGlobal$1.process.versions&&commonjsGlobal$1.process.versions.node),e.global=e.isNode&&commonjsGlobal$1||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal$1,e.emptyArray=Object.freeze?Object.freeze([]):[],e.emptyObject=Object.freeze?Object.freeze({}):{},e.isInteger=Number.isInteger||function(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c},e.isString=function(c){return typeof c=="string"||c instanceof String},e.isObject=function(c){return c&&typeof c=="object"},e.isset=e.isSet=function(c,u){var d=c[u];return d!=null&&c.hasOwnProperty(u)?typeof d!="object"||(Array.isArray(d)?d.length:Object.keys(d).length)>0:!1},e.Buffer=function(){try{var s=e.inquire("buffer").Buffer;return s.prototype.utf8Write?s:null}catch{return null}}(),e._Buffer_from=null,e._Buffer_allocUnsafe=null,e.newBuffer=function(c){return typeof c=="number"?e.Buffer?e._Buffer_allocUnsafe(c):new e.Array(c):e.Buffer?e._Buffer_from(c):typeof Uint8Array>"u"?c:new Uint8Array(c)},e.Array=typeof Uint8Array<"u"?Uint8Array:Array,e.Long=e.global.dcodeIO&&e.global.dcodeIO.Long||e.global.Long||e.inquire("long"),e.key2Re=/^true|false|0|1$/,e.key32Re=/^-?(?:0|[1-9][0-9]*)$/,e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,e.longToHash=function(c){return c?e.LongBits.from(c).toHash():e.LongBits.zeroHash},e.longFromHash=function(c,u){var d=e.LongBits.fromHash(c);return e.Long?e.Long.fromBits(d.lo,d.hi,u):d.toNumber(!!u)};function n(s,c,u){for(var d=Object.keys(c),m=0;m<d.length;++m)(s[d[m]]===void 0||!u)&&(s[d[m]]=c[d[m]]);return s}e.merge=n,e.lcFirst=function(c){return c.charAt(0).toLowerCase()+c.substring(1)};function a(s){function c(u,d){if(!(this instanceof c))return new c(u,d);Object.defineProperty(this,"message",{get:function(){return u}}),Error.captureStackTrace?Error.captureStackTrace(this,c):Object.defineProperty(this,"stack",{value:new Error().stack||""}),d&&n(this,d)}return c.prototype=Object.create(Error.prototype,{constructor:{value:c,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return s},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),c}e.newError=a,e.ProtocolError=a("ProtocolError"),e.oneOfGetter=function(c){for(var u={},d=0;d<c.length;++d)u[c[d]]=1;return function(){for(var m=Object.keys(this),_=m.length-1;_>-1;--_)if(u[m[_]]===1&&this[m[_]]!==void 0&&this[m[_]]!==null)return m[_]}},e.oneOfSetter=function(c){return function(u){for(var d=0;d<c.length;++d)c[d]!==u&&delete this[c[d]]}},e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},e._configure=function(){var s=e.Buffer;if(!s){e._Buffer_from=e._Buffer_allocUnsafe=null;return}e._Buffer_from=s.from!==Uint8Array.from&&s.from||function(u,d){return new s(u,d)},e._Buffer_allocUnsafe=s.allocUnsafe||function(u){return new s(u)}}}(minimal$1)),minimal$1}var writer=Writer$1,util$5=requireMinimal(),BufferWriter$1,LongBits$1=util$5.LongBits,base64=util$5.base64,utf8$1=util$5.utf8;function Op(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}function noop$2(){}function State(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Writer$1(){this.len=0,this.head=new Op(noop$2,0,0),this.tail=this.head,this.states=null}var create$1=function t(){return util$5.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$1();Writer$1.alloc=function t(e){return new util$5.Array(e)};util$5.Array!==Array&&(Writer$1.alloc=util$5.pool(Writer$1.alloc,util$5.Array.prototype.subarray));Writer$1.prototype._push=function t(e,n,a){return this.tail=this.tail.next=new Op(e,n,a),this.len+=n,this};function writeByte(t,e,n){e[n]=t&255}function writeVarint32(t,e,n){for(;t>127;)e[n++]=t&127|128,t>>>=7;e[n]=t}function VarintOp(t,e){this.len=t,this.next=void 0,this.val=e}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer$1.prototype.uint32=function t(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Writer$1.prototype.int32=function t(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)};Writer$1.prototype.sint32=function t(e){return this.uint32((e<<1^e>>31)>>>0)};function writeVarint64(t,e,n){for(;t.hi;)e[n++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[n++]=t.lo&127|128,t.lo=t.lo>>>7;e[n++]=t.lo}Writer$1.prototype.uint64=function t(e){var n=LongBits$1.from(e);return this._push(writeVarint64,n.length(),n)};Writer$1.prototype.int64=Writer$1.prototype.uint64;Writer$1.prototype.sint64=function t(e){var n=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,n.length(),n)};Writer$1.prototype.bool=function t(e){return this._push(writeByte,1,e?1:0)};function writeFixed32(t,e,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}Writer$1.prototype.fixed32=function t(e){return this._push(writeFixed32,4,e>>>0)};Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32;Writer$1.prototype.fixed64=function t(e){var n=LongBits$1.from(e);return this._push(writeFixed32,4,n.lo)._push(writeFixed32,4,n.hi)};Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64;Writer$1.prototype.float=function t(e){return this._push(util$5.float.writeFloatLE,4,e)};Writer$1.prototype.double=function t(e){return this._push(util$5.float.writeDoubleLE,8,e)};var writeBytes=util$5.Array.prototype.set?function t(e,n,a){n.set(e,a)}:function t(e,n,a){for(var s=0;s<e.length;++s)n[a+s]=e[s]};Writer$1.prototype.bytes=function t(e){var n=e.length>>>0;if(!n)return this._push(writeByte,1,0);if(util$5.isString(e)){var a=Writer$1.alloc(n=base64.length(e));base64.decode(e,a,0),e=a}return this.uint32(n)._push(writeBytes,n,e)};Writer$1.prototype.string=function t(e){var n=utf8$1.length(e);return n?this.uint32(n)._push(utf8$1.write,n,e):this._push(writeByte,1,0)};Writer$1.prototype.fork=function t(){return this.states=new State(this),this.head=this.tail=new Op(noop$2,0,0),this.len=0,this};Writer$1.prototype.reset=function t(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$2,0,0),this.len=0),this};Writer$1.prototype.ldelim=function t(){var e=this.head,n=this.tail,a=this.len;return this.reset().uint32(a),a&&(this.tail.next=e.next,this.tail=n,this.len+=a),this};Writer$1.prototype.finish=function t(){for(var e=this.head.next,n=this.constructor.alloc(this.len),a=0;e;)e.fn(e.val,n,a),a+=e.len,e=e.next;return n};Writer$1._configure=function(t){BufferWriter$1=t,Writer$1.create=create$1(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$4=requireMinimal();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$4._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$4.Buffer&&util$4.Buffer.prototype instanceof Uint8Array&&util$4.Buffer.prototype.set.name==="set"?function(e,n,a){n.set(e,a)}:function(e,n,a){if(e.copy)e.copy(n,a,0,e.length);else for(var s=0;s<e.length;)n[a++]=e[s++]}};BufferWriter.prototype.bytes=function t(e){util$4.isString(e)&&(e=util$4._Buffer_from(e,"base64"));var n=e.length>>>0;return this.uint32(n),n&&this._push(BufferWriter.writeBytesBuffer,n,e),this};function writeStringBuffer(t,e,n){t.length<40?util$4.utf8.write(t,e,n):e.utf8Write?e.utf8Write(t,n):e.write(t,n)}BufferWriter.prototype.string=function t(e){var n=util$4.Buffer.byteLength(e);return this.uint32(n),n&&this._push(writeStringBuffer,n,e),this};BufferWriter._configure();var reader=Reader$1,util$3=requireMinimal(),BufferReader$1,LongBits=util$3.LongBits,utf8=util$3.utf8;function indexOutOfRange(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Reader$1(t){this.buf=t,this.pos=0,this.len=t.length}var create_array=typeof Uint8Array<"u"?function t(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")}:function t(e){if(Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")},create=function t(){return util$3.Buffer?function(n){return(Reader$1.create=function(s){return util$3.Buffer.isBuffer(s)?new BufferReader$1(s):create_array(s)})(n)}:create_array};Reader$1.create=create();Reader$1.prototype._slice=util$3.Array.prototype.subarray||util$3.Array.prototype.slice;Reader$1.prototype.uint32=function t(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return e}}();Reader$1.prototype.int32=function t(){return this.uint32()|0};Reader$1.prototype.sint32=function t(){var e=this.uint32();return e>>>1^-(e&1)|0};function readLongVarint(){var t=new LongBits(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw indexOutOfRange(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw indexOutOfRange(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function t(){return this.uint32()!==0};function readFixed32_end(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Reader$1.prototype.fixed32=function t(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader$1.prototype.sfixed32=function t(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function t(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=util$3.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Reader$1.prototype.double=function t(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=util$3.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Reader$1.prototype.bytes=function t(){var e=this.uint32(),n=this.pos,a=this.pos+e;if(a>this.len)throw indexOutOfRange(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(n,a);if(n===a){var s=util$3.Buffer;return s?s.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,n,a)};Reader$1.prototype.string=function t(){var e=this.bytes();return utf8.read(e,0,e.length)};Reader$1.prototype.skip=function t(e){if(typeof e=="number"){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this};Reader$1.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Reader$1._configure=function(t){BufferReader$1=t,Reader$1.create=create(),BufferReader$1._configure();var e=util$3.Long?"toLong":"toNumber";util$3.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[e](!1)},uint64:function(){return readLongVarint.call(this)[e](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[e](!1)},fixed64:function(){return readFixed64.call(this)[e](!0)},sfixed64:function(){return readFixed64.call(this)[e](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$2=requireMinimal();function BufferReader(t){Reader.call(this,t)}BufferReader._configure=function(){util$2.Buffer&&(BufferReader.prototype._slice=util$2.Buffer.prototype.slice)};BufferReader.prototype.string=function t(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};BufferReader._configure();var rpc={},service=Service,util$1=requireMinimal();(Service.prototype=Object.create(util$1.EventEmitter.prototype)).constructor=Service;function Service(t,e,n){if(typeof t!="function")throw TypeError("rpcImpl must be a function");util$1.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=!!e,this.responseDelimited=!!n}Service.prototype.rpcCall=function t(e,n,a,s,c){if(!s)throw TypeError("request must be specified");var u=this;if(!c)return util$1.asPromise(t,u,e,n,a,s);if(!u.rpcImpl){setTimeout(function(){c(Error("already ended"))},0);return}try{return u.rpcImpl(e,n[u.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(m,_){if(m)return u.emit("error",m,e),c(m);if(_===null){u.end(!0);return}if(!(_ instanceof a))try{_=a[u.responseDelimited?"decodeDelimited":"decode"](_)}catch(b){return u.emit("error",b,e),c(b)}return u.emit("data",_,e),c(null,_)})}catch(d){u.emit("error",d,e),setTimeout(function(){c(d)},0);return}};Service.prototype.end=function t(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};(function(t){var e=t;e.Service=service})(rpc);var roots={};(function(t){var e=t;e.build="minimal",e.Writer=writer,e.BufferWriter=writer_buffer,e.Reader=reader,e.BufferReader=reader_buffer,e.util=requireMinimal(),e.rpc=rpc,e.roots=roots,e.configure=n;function n(){e.util._configure(),e.Writer._configure(e.BufferWriter),e.Reader._configure(e.BufferReader)}n()})(indexMinimal);var minimal=indexMinimal;const _m0=getDefaultExportFromCjs$1(minimal);_m0.util.Long!==Long&&(_m0.util.Long=Long,_m0.configure());var AudioCodec;(function(t){t[t.DEFAULT_AC=0]="DEFAULT_AC",t[t.OPUS=1]="OPUS",t[t.AAC=2]="AAC",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(AudioCodec||(AudioCodec={}));var VideoCodec;(function(t){t[t.DEFAULT_VC=0]="DEFAULT_VC",t[t.H264_BASELINE=1]="H264_BASELINE",t[t.H264_MAIN=2]="H264_MAIN",t[t.H264_HIGH=3]="H264_HIGH",t[t.VP8=4]="VP8",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(VideoCodec||(VideoCodec={}));var ImageCodec;(function(t){t[t.IC_DEFAULT=0]="IC_DEFAULT",t[t.IC_JPEG=1]="IC_JPEG",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ImageCodec||(ImageCodec={}));var TrackType;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO",t[t.DATA=2]="DATA",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(TrackType||(TrackType={}));var TrackSource$1;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CAMERA=1]="CAMERA",t[t.MICROPHONE=2]="MICROPHONE",t[t.SCREEN_SHARE=3]="SCREEN_SHARE",t[t.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(TrackSource$1||(TrackSource$1={}));var VideoQuality;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.OFF=3]="OFF",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(VideoQuality||(VideoQuality={}));var ConnectionQuality;(function(t){t[t.POOR=0]="POOR",t[t.GOOD=1]="GOOD",t[t.EXCELLENT=2]="EXCELLENT",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ConnectionQuality||(ConnectionQuality={}));var ClientConfigSetting;(function(t){t[t.UNSET=0]="UNSET",t[t.DISABLED=1]="DISABLED",t[t.ENABLED=2]="ENABLED",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ClientConfigSetting||(ClientConfigSetting={}));var DisconnectReason;(function(t){t[t.UNKNOWN_REASON=0]="UNKNOWN_REASON",t[t.CLIENT_INITIATED=1]="CLIENT_INITIATED",t[t.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",t[t.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",t[t.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",t[t.ROOM_DELETED=5]="ROOM_DELETED",t[t.STATE_MISMATCH=6]="STATE_MISMATCH",t[t.JOIN_FAILURE=7]="JOIN_FAILURE",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(DisconnectReason||(DisconnectReason={}));var ReconnectReason;(function(t){t[t.RR_UNKNOWN=0]="RR_UNKNOWN",t[t.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",t[t.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",t[t.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",t[t.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ReconnectReason||(ReconnectReason={}));var SubscriptionError;(function(t){t[t.SE_UNKNOWN=0]="SE_UNKNOWN",t[t.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",t[t.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(SubscriptionError||(SubscriptionError={}));var ParticipantInfo_State;(function(t){t[t.JOINING=0]="JOINING",t[t.JOINED=1]="JOINED",t[t.ACTIVE=2]="ACTIVE",t[t.DISCONNECTED=3]="DISCONNECTED",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ParticipantInfo_State||(ParticipantInfo_State={}));var Encryption_Type;(function(t){t[t.NONE=0]="NONE",t[t.GCM=1]="GCM",t[t.CUSTOM=2]="CUSTOM",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(Encryption_Type||(Encryption_Type={}));var DataPacket_Kind;(function(t){t[t.RELIABLE=0]="RELIABLE",t[t.LOSSY=1]="LOSSY",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(DataPacket_Kind||(DataPacket_Kind={}));var ServerInfo_Edition;(function(t){t[t.Standard=0]="Standard",t[t.Cloud=1]="Cloud",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ServerInfo_Edition||(ServerInfo_Edition={}));var ClientInfo_SDK;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JS=1]="JS",t[t.SWIFT=2]="SWIFT",t[t.ANDROID=3]="ANDROID",t[t.FLUTTER=4]="FLUTTER",t[t.GO=5]="GO",t[t.UNITY=6]="UNITY",t[t.REACT_NATIVE=7]="REACT_NATIVE",t[t.RUST=8]="RUST",t[t.PYTHON=9]="PYTHON",t[t.CPP=10]="CPP",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ClientInfo_SDK||(ClientInfo_SDK={}));_m0.util.Long!==Long&&(_m0.util.Long=Long,_m0.configure());var EncodedFileType;(function(t){t[t.DEFAULT_FILETYPE=0]="DEFAULT_FILETYPE",t[t.MP4=1]="MP4",t[t.OGG=2]="OGG",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(EncodedFileType||(EncodedFileType={}));var SegmentedFileProtocol;(function(t){t[t.DEFAULT_SEGMENTED_FILE_PROTOCOL=0]="DEFAULT_SEGMENTED_FILE_PROTOCOL",t[t.HLS_PROTOCOL=1]="HLS_PROTOCOL",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(SegmentedFileProtocol||(SegmentedFileProtocol={}));var SegmentedFileSuffix;(function(t){t[t.INDEX=0]="INDEX",t[t.TIMESTAMP=1]="TIMESTAMP",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(SegmentedFileSuffix||(SegmentedFileSuffix={}));var ImageFileSuffix;(function(t){t[t.IMAGE_SUFFIX_INDEX=0]="IMAGE_SUFFIX_INDEX",t[t.IMAGE_SUFFIX_TIMESTAMP=1]="IMAGE_SUFFIX_TIMESTAMP",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(ImageFileSuffix||(ImageFileSuffix={}));var StreamProtocol;(function(t){t[t.DEFAULT_PROTOCOL=0]="DEFAULT_PROTOCOL",t[t.RTMP=1]="RTMP",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(StreamProtocol||(StreamProtocol={}));var EncodingOptionsPreset;(function(t){t[t.H264_720P_30=0]="H264_720P_30",t[t.H264_720P_60=1]="H264_720P_60",t[t.H264_1080P_30=2]="H264_1080P_30",t[t.H264_1080P_60=3]="H264_1080P_60",t[t.PORTRAIT_H264_720P_30=4]="PORTRAIT_H264_720P_30",t[t.PORTRAIT_H264_720P_60=5]="PORTRAIT_H264_720P_60",t[t.PORTRAIT_H264_1080P_30=6]="PORTRAIT_H264_1080P_30",t[t.PORTRAIT_H264_1080P_60=7]="PORTRAIT_H264_1080P_60",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(EncodingOptionsPreset||(EncodingOptionsPreset={}));var EgressStatus;(function(t){t[t.EGRESS_STARTING=0]="EGRESS_STARTING",t[t.EGRESS_ACTIVE=1]="EGRESS_ACTIVE",t[t.EGRESS_ENDING=2]="EGRESS_ENDING",t[t.EGRESS_COMPLETE=3]="EGRESS_COMPLETE",t[t.EGRESS_FAILED=4]="EGRESS_FAILED",t[t.EGRESS_ABORTED=5]="EGRESS_ABORTED",t[t.EGRESS_LIMIT_REACHED=6]="EGRESS_LIMIT_REACHED",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(EgressStatus||(EgressStatus={}));var StreamInfo_Status;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.FINISHED=1]="FINISHED",t[t.FAILED=2]="FAILED",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(StreamInfo_Status||(StreamInfo_Status={}));_m0.util.Long!==Long&&(_m0.util.Long=Long,_m0.configure());var mapObj={exports:{}};const isObject=t=>typeof t=="object"&&t!==null,mapObjectSkip=Symbol("skip"),isObjectCustom=t=>isObject(t)&&!(t instanceof RegExp)&&!(t instanceof Error)&&!(t instanceof Date),mapObject=(t,e,n,a=new WeakMap)=>{if(n={deep:!1,target:{},...n},a.has(t))return a.get(t);a.set(t,n.target);const{target:s}=n;delete n.target;const c=u=>u.map(d=>isObjectCustom(d)?mapObject(d,e,n,a):d);if(Array.isArray(t))return c(t);for(const[u,d]of Object.entries(t)){const m=e(u,d,t);if(m===mapObjectSkip)continue;let[_,b,{shouldRecurse:S=!0}={}]=m;_!=="__proto__"&&(n.deep&&S&&isObjectCustom(b)&&(b=Array.isArray(b)?c(b):mapObject(b,e,n,a)),s[_]=b)}return s};mapObj.exports=(t,e,n)=>{if(!isObject(t))throw new TypeError(`Expected an object, got \`${t}\` (${typeof t})`);return mapObject(t,e,n)};mapObj.exports.mapObjectSkip=mapObjectSkip;var camelcase={exports:{}};const UPPERCASE=/[\p{Lu}]/u,LOWERCASE=/[\p{Ll}]/u,LEADING_CAPITAL=/^[\p{Lu}](?![\p{Lu}])/gu,IDENTIFIER=/([\p{Alpha}\p{N}_]|$)/u,SEPARATORS=/[_.\- ]+/,LEADING_SEPARATORS=new RegExp("^"+SEPARATORS.source),SEPARATORS_AND_IDENTIFIER=new RegExp(SEPARATORS.source+IDENTIFIER.source,"gu"),NUMBERS_AND_IDENTIFIER=new RegExp("\\d+"+IDENTIFIER.source,"gu"),preserveCamelCase=(t,e,n)=>{let a=!1,s=!1,c=!1;for(let u=0;u<t.length;u++){const d=t[u];a&&UPPERCASE.test(d)?(t=t.slice(0,u)+"-"+t.slice(u),a=!1,c=s,s=!0,u++):s&&c&&LOWERCASE.test(d)?(t=t.slice(0,u-1)+"-"+t.slice(u-1),c=s,s=!1,a=!0):(a=e(d)===d&&n(d)!==d,c=s,s=n(d)===d&&e(d)!==d)}return t},preserveConsecutiveUppercase=(t,e)=>(LEADING_CAPITAL.lastIndex=0,t.replace(LEADING_CAPITAL,n=>e(n))),postProcess=(t,e)=>(SEPARATORS_AND_IDENTIFIER.lastIndex=0,NUMBERS_AND_IDENTIFIER.lastIndex=0,t.replace(SEPARATORS_AND_IDENTIFIER,(n,a)=>e(a)).replace(NUMBERS_AND_IDENTIFIER,n=>e(n))),camelCase=(t,e)=>{if(!(typeof t=="string"||Array.isArray(t)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(t)?t=t.map(c=>c.trim()).filter(c=>c.length).join("-"):t=t.trim(),t.length===0)return"";const n=e.locale===!1?c=>c.toLowerCase():c=>c.toLocaleLowerCase(e.locale),a=e.locale===!1?c=>c.toUpperCase():c=>c.toLocaleUpperCase(e.locale);return t.length===1?e.pascalCase?a(t):n(t):(t!==n(t)&&(t=preserveCamelCase(t,n,a)),t=t.replace(LEADING_SEPARATORS,""),e.preserveConsecutiveUppercase?t=preserveConsecutiveUppercase(t,n):t=n(t),e.pascalCase&&(t=a(t.charAt(0))+t.slice(1)),postProcess(t,a))};camelcase.exports=camelCase;camelcase.exports.default=camelCase;class QuickLRU{constructor(e={}){if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(e,n){if(this.cache.set(e,n),this._size++,this._size>=this.maxSize){if(this._size=0,typeof this.onEviction=="function")for(const[a,s]of this.oldCache.entries())this.onEviction(a,s);this.oldCache=this.cache,this.cache=new Map}}get(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){const n=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,n),n}}set(e,n){return this.cache.has(e)?this.cache.set(e,n):this._set(e,n),this}has(e){return this.cache.has(e)||this.oldCache.has(e)}peek(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e))return this.oldCache.get(e)}delete(e){const n=this.cache.delete(e);return n&&this._size--,this.oldCache.delete(e)||n}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache)yield e;for(const e of this.oldCache){const[n]=e;this.cache.has(n)||(yield e)}}get size(){let e=0;for(const n of this.oldCache.keys())this.cache.has(n)||e++;return Math.min(this._size+e,this.maxSize)}}var quickLru=QuickLRU;const QuickLru=quickLru;new QuickLru({maxSize:1e5});var IngressInput;(function(t){t[t.RTMP_INPUT=0]="RTMP_INPUT",t[t.WHIP_INPUT=1]="WHIP_INPUT",t[t.URL_INPUT=2]="URL_INPUT",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(IngressInput||(IngressInput={}));var IngressAudioEncodingPreset;(function(t){t[t.OPUS_STEREO_96KBPS=0]="OPUS_STEREO_96KBPS",t[t.OPUS_MONO_64KBS=1]="OPUS_MONO_64KBS",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(IngressAudioEncodingPreset||(IngressAudioEncodingPreset={}));var IngressVideoEncodingPreset;(function(t){t[t.H264_720P_30FPS_3_LAYERS=0]="H264_720P_30FPS_3_LAYERS",t[t.H264_1080P_30FPS_3_LAYERS=1]="H264_1080P_30FPS_3_LAYERS",t[t.H264_540P_25FPS_2_LAYERS=2]="H264_540P_25FPS_2_LAYERS",t[t.H264_720P_30FPS_1_LAYER=3]="H264_720P_30FPS_1_LAYER",t[t.H264_1080P_30FPS_1_LAYER=4]="H264_1080P_30FPS_1_LAYER",t[t.H264_720P_30FPS_3_LAYERS_HIGH_MOTION=5]="H264_720P_30FPS_3_LAYERS_HIGH_MOTION",t[t.H264_1080P_30FPS_3_LAYERS_HIGH_MOTION=6]="H264_1080P_30FPS_3_LAYERS_HIGH_MOTION",t[t.H264_540P_25FPS_2_LAYERS_HIGH_MOTION=7]="H264_540P_25FPS_2_LAYERS_HIGH_MOTION",t[t.H264_720P_30FPS_1_LAYER_HIGH_MOTION=8]="H264_720P_30FPS_1_LAYER_HIGH_MOTION",t[t.H264_1080P_30FPS_1_LAYER_HIGH_MOTION=9]="H264_1080P_30FPS_1_LAYER_HIGH_MOTION",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(IngressVideoEncodingPreset||(IngressVideoEncodingPreset={}));var IngressState_Status;(function(t){t[t.ENDPOINT_INACTIVE=0]="ENDPOINT_INACTIVE",t[t.ENDPOINT_BUFFERING=1]="ENDPOINT_BUFFERING",t[t.ENDPOINT_PUBLISHING=2]="ENDPOINT_PUBLISHING",t[t.ENDPOINT_ERROR=3]="ENDPOINT_ERROR",t[t.ENDPOINT_COMPLETE=4]="ENDPOINT_COMPLETE",t[t.UNRECOGNIZED=-1]="UNRECOGNIZED"})(IngressState_Status||(IngressState_Status={}));_m0.util.Long!==Long&&(_m0.util.Long=Long,_m0.configure());_m0.util.Long!==Long&&(_m0.util.Long=Long,_m0.configure());var TrackSource;(function(t){t.CAMERA="camera",t.MICROPHONE="microphone",t.SCREEN_SHARE="screen_share",t.SCREEN_SHARE_AUDIO="screen_share_audio"})(TrackSource||(TrackSource={}));function getKeyMaterial(t){let e=new TextEncoder;return window.crypto.subtle.importKey("raw",e.encode(t),{name:"PBKDF2"},!1,["deriveBits","deriveKey"])}function getKey(t,e){return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:e,iterations:1e5,hash:"SHA-256"},t,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function decrypt(t,e,n,a){console.log("decrypting",t,e,n,a);const s=base64ToBytes(t),c=base64ToBytes(e),u=base64ToBytes(n);let d=await getKeyMaterial(a),m=await getKey(d,c);try{let _=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:u},m,s);return DECODE_TXT(_)}catch(_){console.warn("Failed to decrypt",_)}}const base64codes=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];function getBase64Code(t){if(t>=base64codes.length)throw new Error("Unable to parse base64 string.");const e=base64codes[t];if(e===255)throw new Error("Unable to parse base64 string.");return e}function base64ToBytes(t){if(t.length%4!==0)throw new Error("Unable to parse base64 string.");const e=t.indexOf("=");if(e!==-1&&e<t.length-2)throw new Error("Unable to parse base64 string.");let n=t.endsWith("==")?2:t.endsWith("=")?1:0,a=t.length,s=new Uint8Array(3*(a/4)),c;for(let u=0,d=0;u<a;u+=4,d+=3)c=getBase64Code(t.charCodeAt(u))<<18|getBase64Code(t.charCodeAt(u+1))<<12|getBase64Code(t.charCodeAt(u+2))<<6|getBase64Code(t.charCodeAt(u+3)),s[d]=c>>16,s[d+1]=c>>8&255,s[d+2]=c&255;return s.subarray(0,s.length-n)}const appendLog=console.log;class LivekitGenericConnection{constructor(){de(this,"config");de(this,"lastMsgRecivedTimestamp");de(this,"connectionState");de(this,"latestRecivedDataMessage");de(this,"participantConnectionEvents");de(this,"_rovRoomName");de(this,"_accessToken");de(this,"_reconnectAttemptCount",0);de(this,"_shouldReconnect");de(this,"_videoElem");de(this,"_roomConn");this.config={},this._shouldReconnect=!0,this.connectionState=nStore(ConnectionStates.init),this.latestRecivedDataMessage=nStore(null),this.participantConnectionEvents=nStore(null)}async init(e){this.config=e,this._shouldReconnect=!0,this._roomConn=new Room(e.roomConfig),this._roomConn.on(RoomEvent.DCBufferStatusChanged,n=>{appendLog("LK: DCBufferStatusChanged ",n)}).on(RoomEvent.SignalConnected,async()=>{appendLog(`LK: Signal connection established to ${this.config.hostUrl}`)}).on(RoomEvent.Connected,async()=>{appendLog(`LK: Connected to room: ${this._roomConn.name} via ${this.config.hostUrl}`),this.connectionState.set(ConnectionStates.connected)}).on(RoomEvent.Disconnected,n=>{this.connectionState.set(ConnectionStates.disconnectedOk);let a=this._shouldReconnect&&!!this._roomConn;n===DisconnectReason$1.DUPLICATE_IDENTITY?(console.warn("LK: disconnected from room - duplicate identity"),a=!1):n===DisconnectReason$1.CLIENT_INITIATED?(console.log("LK: disconnected from room - client initiated"),a=!1):n===DisconnectReason$1.SERVER_SHUTDOWN?(console.log("LK: disconnected from room - server shutdown"),a=!1):n===DisconnectReason$1.PARTICIPANT_REMOVED?(console.log("LK: disconnected from room - participant removed"),a=!1):n===DisconnectReason$1.ROOM_DELETED?(console.log("LK: disconnected from room - room deleted"),a=!1):n===DisconnectReason$1.STATE_MISMATCH?(console.log("LK: disconnected from room - state mismatch"),a=!1):n===DisconnectReason$1.JOIN_FAILURE?console.log("LK: disconnected from room - join failure"):n===DisconnectReason$1.UNKNOWN_REASON?console.log("LK: disconnected from room - unknown reason"):n===DisconnectReason$1.UNRECOGNIZED&&console.log("LK: disconnected from room - unrecognized"),a?this._reconnect():this.close()}).on(RoomEvent.Reconnecting,()=>{appendLog(`LK: Reconnecting to room ${this._roomConn.name} via ${this.config.hostUrl}`),this.connectionState.set(ConnectionStates.reconnecting)}).on(RoomEvent.Reconnected,async()=>{appendLog("LK: Successfully reconnected. server",await this._roomConn.engine.getConnectedServerAddress()),this.connectionState.set(ConnectionStates.connected)}).on(RoomEvent.ParticipantMetadataChanged,n=>{appendLog("LK: Participant Metadata Changed",n)}).on(RoomEvent.ParticipantConnected,async n=>{appendLog(`LK: Participant ${n.identity} (${n.sid}) connected`,n.metadata),this.participantConnectionEvents.set({id:n.identity,joined:!0}),n.on(ParticipantEvent.ConnectionQualityChanged,()=>{appendLog("LK: ParticipantEvent.ConnectionQualityChanged",n.connectionQuality)})}).on(RoomEvent.ParticipantDisconnected,n=>{appendLog(`LK: Participant ${n.identity} (${n.sid}) disconnected`),this.participantConnectionEvents.set({id:n.identity,joined:!1})}).on(RoomEvent.MediaDevicesError,n=>{const a=MediaDeviceFailure.getFailure(n);appendLog("LK: Media device failure",a)}).on(RoomEvent.ConnectionQualityChanged,(n,a)=>{appendLog(`LK: connection quality for ${a?a.identity:"[no identity]"} changed to ${n}`)}).on(RoomEvent.RoomMetadataChanged,n=>{appendLog("LK: new metadata for room",n)}).on(RoomEvent.MediaDevicesChanged,()=>{appendLog("LK: MediaDevicesChanged")}).on(RoomEvent.LocalTrackUnpublished,(n,a)=>{appendLog("LK: LocalTrackUnpublished",n.trackSid,"by participant",a.identity,"source",n.track?n.track.source:"[no track found]")}).on(RoomEvent.LocalTrackPublished,(n,a)=>{appendLog("LK: LocalVideoTrackPublished",n.trackSid,"by participant",a.identity,"source",n.track?n.track.source:"[no track found]")}).on(RoomEvent.MediaDevicesError,n=>{const a=MediaDeviceFailure.getFailure(n);appendLog("LK: media device failure",a)}).on(RoomEvent.AudioPlaybackStatusChanged,()=>{appendLog("LK: AudioPlaybackStatusChanged. canPlaybackAudio =",this._roomConn.canPlaybackAudio)})}async start(e,n){this._rovRoomName=e,this._accessToken=n,this._shouldReconnect=!0;const a=Date.now();console.log(`LK: Starting conn with ${e} via ${this.config.hostUrl} token = ${n}`);try{const s=setTimeout(()=>{console.log(`livekit connect timeout for ${this.config.hostUrl}`),this._reconnect()},16e3);await this._connect(),clearTimeout(s),console.log(`LK: Connected in ${Date.now()-a}ms ${this.config.hostUrl}`)}catch(s){console.log(`LK: Error connecting to ${this.config.hostUrl}`,s),this._reconnect()}}async sendMessage(e,n=!0,a=[]){const s=a.map(c=>{const u=this.getParticipantSid(c);return u||console.warn("LK: SendMessge: No participant found for livekit identity: ",c),u});await this._roomConn.localParticipant.publishData(e,n?DataPacket_Kind$1.RELIABLE:DataPacket_Kind$1.LOSSY,{destination:s})}getParticipantSid(e){const n=[...this._roomConn.participants.values()].find(a=>a.identity===e);return n?n.sid:null}getLivekitIdentitiy(){return this._roomConn?this._roomConn.localParticipant.identity:null}getRoomName(){return this._roomConn?this._roomConn.name:this._rovRoomName}async close(){this._shouldReconnect=!1,this._roomConn&&(console.info("LK: Closing Livekit Connection: ",this._rovRoomName,this.config.hostUrl),await this._roomConn.disconnect(!0))}async _connect(){await this._roomConn.connect(getWebsocketURL(this.config.hostUrl),this._accessToken,this.config.roomConnectionConfig),console.info("LK: Connected to room",this._roomConn.name,this._roomConn)}async _reconnect(){try{await this._roomConn.disconnect(!0)}catch(e){console.error("LK: Error disconnecting from room",e)}if(this._shouldReconnect!=!1)if(this._reconnectAttemptCount<this.config.reconnectAttempts){const e=this._reconnectAttemptCount*800;this._reconnectAttemptCount++,await waitfor(e);try{await this._connect()}catch(n){throw console.error("LK: Error reconnecting to room",n),n}}else console.error("LK: Failed to reconnect after ",this._reconnectAttemptCount,"/",this.config.reconnectAttempts,"attempts"),this._fail()}_fail(){this._shouldReconnect=!1,this.connectionState.set(ConnectionStates.failed)}}class LivekitViewerConnection extends LivekitGenericConnection{constructor(){super();de(this,"remoteVideoTrack");this.remoteVideoTrack=nStore(null)}subscribeToTracks(n){this._rovRoomName===n.identity&&n.tracks.forEach(a=>{a.setSubscribed(!0)})}async init(n){await super.init(n),this._roomConn.on(RoomEvent.DataReceived,async(a,s)=>{if(!s)return console.warn("LK: Ignoring received data message with no participant. This can happen when the message is sent before connection completes or if the message comes from the server: ",a);if(s.identity!==this._rovRoomName)return;const c=s.identity;s.sid,this.lastMsgRecivedTimestamp=Date.now(),this.latestRecivedDataMessage.set({senderId:c,msg:a})}).on(RoomEvent.Connected,()=>{this._roomConn.participants.forEach(this.subscribeToTracks.bind(this))}).on(RoomEvent.ParticipantConnected,a=>{this.subscribeToTracks(a)}).on(RoomEvent.TrackPublished,(a,s)=>{this.subscribeToTracks(s)}).on(RoomEvent.TrackSubscribed,(a,s,c)=>{if(a.kind===Track.Kind.Video){const u=this.remoteVideoTrack.get();u&&(console.warn("LK: already subscribed to video track, unsubscribing from old track",this.remoteVideoTrack.get()),u.stop()),appendLog("LK: subscribed to video",a.source),this.remoteVideoTrack.set(a),a.on("upstreamPaused",()=>{console.log("LK: video upstream paused")}),a.on("muted",()=>{console.log("LK: video muted")}),a.on("ended",()=>{console.log("LK: video ended")})}else console.warn("LK: Subscribed to unknown track kind: ",a.kind,a.source)}).on(RoomEvent.TrackUnsubscribed,(a,s,c)=>{appendLog("LK: Unsubscribed from track",s.trackSid," from participant: ",c.identity)})}}const $Reader=minimal.Reader,$Writer=minimal.Writer,$util=minimal.util,$root=minimal.roots.default||(minimal.roots.default={}),rov_actions_proto=$root.rov_actions_proto=(()=>{const t={};return t.LogLevel=function(){const e={},n=Object.create(e);return n[e[0]="Debug"]=0,n[e[1]="Info"]=1,n[e[2]="Warning"]=2,n[e[3]="Error"]=3,n[e[4]="Critical"]=4,n}(),t.SensorMeasurmentTypes=function(){const e={},n=Object.create(e);return n[e[0]="depth_meters"]=0,n[e[1]="water_temp_celsius"]=1,n[e[2]="pressure_mbar"]=2,n[e[3]="yaw_degrees"]=3,n[e[4]="pitch_degrees"]=4,n[e[5]="roll_degrees"]=5,n[e[6]="x_acceleration_m_s2"]=6,n[e[7]="y_acceleration_m_s2"]=7,n[e[8]="z_acceleration_m_s2"]=8,n[e[9]="battery_voltage"]=9,n[e[10]="battery_current_amps"]=10,n[e[11]="internal_temp_celsius"]=11,n}(),t.Measurement=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.MeasurementType=0,e.prototype.Value=0,e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.MeasurementType!=null&&Object.hasOwnProperty.call(a,"MeasurementType")&&s.uint32(8).int32(a.MeasurementType),a.Value!=null&&Object.hasOwnProperty.call(a,"Value")&&s.uint32(21).float(a.Value),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.Measurement;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.MeasurementType=a.int32();break}case 2:{u.Value=a.float();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.MeasurementType!=null&&a.hasOwnProperty("MeasurementType"))switch(a.MeasurementType){default:return"MeasurementType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:break}return a.Value!=null&&a.hasOwnProperty("Value")&&typeof a.Value!="number"?"Value: number expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.Measurement)return a;let s=new $root.rov_actions_proto.Measurement;switch(a.MeasurementType){default:if(typeof a.MeasurementType=="number"){s.MeasurementType=a.MeasurementType;break}break;case"depth_meters":case 0:s.MeasurementType=0;break;case"water_temp_celsius":case 1:s.MeasurementType=1;break;case"pressure_mbar":case 2:s.MeasurementType=2;break;case"yaw_degrees":case 3:s.MeasurementType=3;break;case"pitch_degrees":case 4:s.MeasurementType=4;break;case"roll_degrees":case 5:s.MeasurementType=5;break;case"x_acceleration_m_s2":case 6:s.MeasurementType=6;break;case"y_acceleration_m_s2":case 7:s.MeasurementType=7;break;case"z_acceleration_m_s2":case 8:s.MeasurementType=8;break;case"battery_voltage":case 9:s.MeasurementType=9;break;case"battery_current_amps":case 10:s.MeasurementType=10;break;case"internal_temp_celsius":case 11:s.MeasurementType=11;break}return a.Value!=null&&(s.Value=Number(a.Value)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.MeasurementType=s.enums===String?"depth_meters":0,c.Value=0),a.MeasurementType!=null&&a.hasOwnProperty("MeasurementType")&&(c.MeasurementType=s.enums===String?$root.rov_actions_proto.SensorMeasurmentTypes[a.MeasurementType]===void 0?a.MeasurementType:$root.rov_actions_proto.SensorMeasurmentTypes[a.MeasurementType]:a.MeasurementType),a.Value!=null&&a.hasOwnProperty("Value")&&(c.Value=s.json&&!isFinite(a.Value)?String(a.Value):a.Value),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.Measurement"},e}(),t.DataTransportMethod=function(){const e={},n=Object.create(e);return n[e[0]="LivekitReliable"]=0,n[e[1]="LivekitUnreliable"]=1,n[e[3]="DirectUnreliable"]=3,n}(),t.InternalWebpageEvent=function(){const e={},n=Object.create(e);return n[e[0]="Nothing"]=0,n[e[1]="RovConnected"]=1,n[e[2]="RovDisconnected"]=2,n[e[3]="UserConnected"]=3,n[e[4]="UserDisconnected"]=4,n}(),t.PingAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Time!=null&&Object.hasOwnProperty.call(a,"Time")&&s.uint32(8).int64(a.Time),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.PingAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Time=a.int64();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.Time!=null&&a.hasOwnProperty("Time")&&!$util.isInteger(a.Time)&&!(a.Time&&$util.isInteger(a.Time.low)&&$util.isInteger(a.Time.high))?"Time: integer|Long expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.PingAction)return a;let s=new $root.rov_actions_proto.PingAction;return a.Time!=null&&($util.Long?(s.Time=$util.Long.fromValue(a.Time)).unsigned=!1:typeof a.Time=="string"?s.Time=parseInt(a.Time,10):typeof a.Time=="number"?s.Time=a.Time:typeof a.Time=="object"&&(s.Time=new $util.LongBits(a.Time.low>>>0,a.Time.high>>>0).toNumber())),s},e.toObject=function(a,s){s||(s={});let c={};if(s.defaults)if($util.Long){let u=new $util.Long(0,0,!1);c.Time=s.longs===String?u.toString():s.longs===Number?u.toNumber():u}else c.Time=s.longs===String?"0":0;return a.Time!=null&&a.hasOwnProperty("Time")&&(typeof a.Time=="number"?c.Time=s.longs===String?String(a.Time):a.Time:c.Time=s.longs===String?$util.Long.prototype.toString.call(a.Time):s.longs===Number?new $util.LongBits(a.Time.low>>>0,a.Time.high>>>0).toNumber():a.Time),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.PingAction"},e}(),t.PasswordAttemptAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Password="",e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Password!=null&&Object.hasOwnProperty.call(a,"Password")&&s.uint32(10).string(a.Password),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.PasswordAttemptAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Password=a.string();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.Password!=null&&a.hasOwnProperty("Password")&&!$util.isString(a.Password)?"Password: string expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.PasswordAttemptAction)return a;let s=new $root.rov_actions_proto.PasswordAttemptAction;return a.Password!=null&&(s.Password=String(a.Password)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.Password=""),a.Password!=null&&a.hasOwnProperty("Password")&&(c.Password=a.Password),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.PasswordAttemptAction"},e}(),t.AuthTokenAttemptAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Token="",e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Token!=null&&Object.hasOwnProperty.call(a,"Token")&&s.uint32(10).string(a.Token),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.AuthTokenAttemptAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Token=a.string();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.Token!=null&&a.hasOwnProperty("Token")&&!$util.isString(a.Token)?"Token: string expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.AuthTokenAttemptAction)return a;let s=new $root.rov_actions_proto.AuthTokenAttemptAction;return a.Token!=null&&(s.Token=String(a.Token)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.Token=""),a.Token!=null&&a.hasOwnProperty("Token")&&(c.Token=a.Token),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.AuthTokenAttemptAction"},e}(),t.TakeControlAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.TakeControlAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.TakeControlAction?a:new $root.rov_actions_proto.TakeControlAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.TakeControlAction"},e}(),t.MoveAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.VelocityX=0,e.prototype.VelocityY=0,e.prototype.VelocityZ=0,e.prototype.AngularVelocityYaw=0,e.prototype.ButtonBitmask=0,e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.VelocityX!=null&&Object.hasOwnProperty.call(a,"VelocityX")&&s.uint32(13).float(a.VelocityX),a.VelocityY!=null&&Object.hasOwnProperty.call(a,"VelocityY")&&s.uint32(21).float(a.VelocityY),a.VelocityZ!=null&&Object.hasOwnProperty.call(a,"VelocityZ")&&s.uint32(29).float(a.VelocityZ),a.AngularVelocityYaw!=null&&Object.hasOwnProperty.call(a,"AngularVelocityYaw")&&s.uint32(37).float(a.AngularVelocityYaw),a.ButtonBitmask!=null&&Object.hasOwnProperty.call(a,"ButtonBitmask")&&s.uint32(40).int32(a.ButtonBitmask),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.MoveAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.VelocityX=a.float();break}case 2:{u.VelocityY=a.float();break}case 3:{u.VelocityZ=a.float();break}case 4:{u.AngularVelocityYaw=a.float();break}case 5:{u.ButtonBitmask=a.int32();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.VelocityX!=null&&a.hasOwnProperty("VelocityX")&&typeof a.VelocityX!="number"?"VelocityX: number expected":a.VelocityY!=null&&a.hasOwnProperty("VelocityY")&&typeof a.VelocityY!="number"?"VelocityY: number expected":a.VelocityZ!=null&&a.hasOwnProperty("VelocityZ")&&typeof a.VelocityZ!="number"?"VelocityZ: number expected":a.AngularVelocityYaw!=null&&a.hasOwnProperty("AngularVelocityYaw")&&typeof a.AngularVelocityYaw!="number"?"AngularVelocityYaw: number expected":a.ButtonBitmask!=null&&a.hasOwnProperty("ButtonBitmask")&&!$util.isInteger(a.ButtonBitmask)?"ButtonBitmask: integer expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.MoveAction)return a;let s=new $root.rov_actions_proto.MoveAction;return a.VelocityX!=null&&(s.VelocityX=Number(a.VelocityX)),a.VelocityY!=null&&(s.VelocityY=Number(a.VelocityY)),a.VelocityZ!=null&&(s.VelocityZ=Number(a.VelocityZ)),a.AngularVelocityYaw!=null&&(s.AngularVelocityYaw=Number(a.AngularVelocityYaw)),a.ButtonBitmask!=null&&(s.ButtonBitmask=a.ButtonBitmask|0),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.VelocityX=0,c.VelocityY=0,c.VelocityZ=0,c.AngularVelocityYaw=0,c.ButtonBitmask=0),a.VelocityX!=null&&a.hasOwnProperty("VelocityX")&&(c.VelocityX=s.json&&!isFinite(a.VelocityX)?String(a.VelocityX):a.VelocityX),a.VelocityY!=null&&a.hasOwnProperty("VelocityY")&&(c.VelocityY=s.json&&!isFinite(a.VelocityY)?String(a.VelocityY):a.VelocityY),a.VelocityZ!=null&&a.hasOwnProperty("VelocityZ")&&(c.VelocityZ=s.json&&!isFinite(a.VelocityZ)?String(a.VelocityZ):a.VelocityZ),a.AngularVelocityYaw!=null&&a.hasOwnProperty("AngularVelocityYaw")&&(c.AngularVelocityYaw=s.json&&!isFinite(a.AngularVelocityYaw)?String(a.AngularVelocityYaw):a.AngularVelocityYaw),a.ButtonBitmask!=null&&a.hasOwnProperty("ButtonBitmask")&&(c.ButtonBitmask=a.ButtonBitmask),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.MoveAction"},e}(),t.BeginVideoStreamAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.BeginVideoStreamAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.BeginVideoStreamAction?a:new $root.rov_actions_proto.BeginVideoStreamAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.BeginVideoStreamAction"},e}(),t.TakePhotoAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.TakePhotoAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.TakePhotoAction?a:new $root.rov_actions_proto.TakePhotoAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.TakePhotoAction"},e}(),t.StartVideoRecAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.StartVideoRecAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.StartVideoRecAction?a:new $root.rov_actions_proto.StartVideoRecAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.StartVideoRecAction"},e}(),t.StopVideoRecAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.StopVideoRecAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.StopVideoRecAction?a:new $root.rov_actions_proto.StopVideoRecAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.StopVideoRecAction"},e}(),t.ToogleLightsAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.ToogleLightsAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.ToogleLightsAction?a:new $root.rov_actions_proto.ToogleLightsAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.ToogleLightsAction"},e}(),t.ShutdownRovAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.ShutdownRovAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.ShutdownRovAction?a:new $root.rov_actions_proto.ShutdownRovAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.ShutdownRovAction"},e}(),t.RebootRovAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.RebootRovAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.RebootRovAction?a:new $root.rov_actions_proto.RebootRovAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.RebootRovAction"},e}(),t.EnableWifiAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.EnableWifiAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.EnableWifiAction?a:new $root.rov_actions_proto.EnableWifiAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.EnableWifiAction"},e}(),t.DisableWifiAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.DisableWifiAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.DisableWifiAction?a:new $root.rov_actions_proto.DisableWifiAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.DisableWifiAction"},e}(),t.RovStatusReportAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.RovStatusReportAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.RovStatusReportAction?a:new $root.rov_actions_proto.RovStatusReportAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.RovStatusReportAction"},e}(),t.RestartRovServicesAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.RestartRovServicesAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.RestartRovServicesAction?a:new $root.rov_actions_proto.RestartRovServicesAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.RestartRovServicesAction"},e}(),t.RovLogsAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.RovLogsAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.RovLogsAction?a:new $root.rov_actions_proto.RovLogsAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.RovLogsAction"},e}(),t.RefreshAllSensorsAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.RefreshAllSensorsAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.RefreshAllSensorsAction?a:new $root.rov_actions_proto.RefreshAllSensorsAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.RefreshAllSensorsAction"},e}(),t.MavlinkAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Message=$util.newBuffer([]),e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Message!=null&&Object.hasOwnProperty.call(a,"Message")&&s.uint32(10).bytes(a.Message),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.MavlinkAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Message=a.bytes();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.Message!=null&&a.hasOwnProperty("Message")&&!(a.Message&&typeof a.Message.length=="number"||$util.isString(a.Message))?"Message: buffer expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.MavlinkAction)return a;let s=new $root.rov_actions_proto.MavlinkAction;return a.Message!=null&&(typeof a.Message=="string"?$util.base64.decode(a.Message,s.Message=$util.newBuffer($util.base64.length(a.Message)),0):a.Message.length>=0&&(s.Message=a.Message)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(s.bytes===String?c.Message="":(c.Message=[],s.bytes!==Array&&(c.Message=$util.newBuffer(c.Message)))),a.Message!=null&&a.hasOwnProperty("Message")&&(c.Message=s.bytes===String?$util.base64.encode(a.Message,0,a.Message.length):s.bytes===Array?Array.prototype.slice.call(a.Message):a.Message),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.MavlinkAction"},e}(),t.SimplepeerSignalAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Message="",e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Message!=null&&Object.hasOwnProperty.call(a,"Message")&&s.uint32(10).string(a.Message),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.SimplepeerSignalAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Message=a.string();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.Message!=null&&a.hasOwnProperty("Message")&&!$util.isString(a.Message)?"Message: string expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.SimplepeerSignalAction)return a;let s=new $root.rov_actions_proto.SimplepeerSignalAction;return a.Message!=null&&(s.Message=String(a.Message)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.Message=""),a.Message!=null&&a.hasOwnProperty("Message")&&(c.Message=a.Message),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.SimplepeerSignalAction"},e}(),t.DisarmAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.DisarmAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.DisarmAction?a:new $root.rov_actions_proto.DisarmAction},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.DisarmAction"},e}(),t.SetAutopilotModeAction=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.mode=0,e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.mode!=null&&Object.hasOwnProperty.call(a,"mode")&&s.uint32(8).int32(a.mode),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.SetAutopilotModeAction;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.mode=a.int32();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.mode!=null&&a.hasOwnProperty("mode")&&!$util.isInteger(a.mode)?"mode: integer expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.SetAutopilotModeAction)return a;let s=new $root.rov_actions_proto.SetAutopilotModeAction;return a.mode!=null&&(s.mode=a.mode|0),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.mode=0),a.mode!=null&&a.hasOwnProperty("mode")&&(c.mode=a.mode),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.SetAutopilotModeAction"},e}(),t.ActionBackendMetadata=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.FromUserId="",e.prototype.InternalWebpageEvt=0,e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.FromUserId!=null&&Object.hasOwnProperty.call(a,"FromUserId")&&s.uint32(10).string(a.FromUserId),a.InternalWebpageEvt!=null&&Object.hasOwnProperty.call(a,"InternalWebpageEvt")&&s.uint32(16).int32(a.InternalWebpageEvt),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.ActionBackendMetadata;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.FromUserId=a.string();break}case 2:{u.InternalWebpageEvt=a.int32();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.FromUserId!=null&&a.hasOwnProperty("FromUserId")&&!$util.isString(a.FromUserId))return"FromUserId: string expected";if(a.InternalWebpageEvt!=null&&a.hasOwnProperty("InternalWebpageEvt"))switch(a.InternalWebpageEvt){default:return"InternalWebpageEvt: enum value expected";case 0:case 1:case 2:case 3:case 4:break}return null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.ActionBackendMetadata)return a;let s=new $root.rov_actions_proto.ActionBackendMetadata;switch(a.FromUserId!=null&&(s.FromUserId=String(a.FromUserId)),a.InternalWebpageEvt){default:if(typeof a.InternalWebpageEvt=="number"){s.InternalWebpageEvt=a.InternalWebpageEvt;break}break;case"Nothing":case 0:s.InternalWebpageEvt=0;break;case"RovConnected":case 1:s.InternalWebpageEvt=1;break;case"RovDisconnected":case 2:s.InternalWebpageEvt=2;break;case"UserConnected":case 3:s.InternalWebpageEvt=3;break;case"UserDisconnected":case 4:s.InternalWebpageEvt=4;break}return s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.FromUserId="",c.InternalWebpageEvt=s.enums===String?"Nothing":0),a.FromUserId!=null&&a.hasOwnProperty("FromUserId")&&(c.FromUserId=a.FromUserId),a.InternalWebpageEvt!=null&&a.hasOwnProperty("InternalWebpageEvt")&&(c.InternalWebpageEvt=s.enums===String?$root.rov_actions_proto.InternalWebpageEvent[a.InternalWebpageEvt]===void 0?a.InternalWebpageEvt:$root.rov_actions_proto.InternalWebpageEvent[a.InternalWebpageEvt]:a.InternalWebpageEvt),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.ActionBackendMetadata"},e}(),t.RovAction=function(){function e(a){if(a)for(let s=Object.keys(a),c=0;c<s.length;++c)a[s[c]]!=null&&(this[s[c]]=a[s[c]])}e.prototype.BackendMetadata=null,e.prototype.ExchangeId=0,e.prototype.Ping=null,e.prototype.PasswordAttempt=null,e.prototype.AuthTokenAttempt=null,e.prototype.TakeControl=null,e.prototype.Move=null,e.prototype.BeginVideoStream=null,e.prototype.TakePhoto=null,e.prototype.StartVideoRec=null,e.prototype.StopVideoRec=null,e.prototype.ToogleLights=null,e.prototype.ShutdownRov=null,e.prototype.RebootRov=null,e.prototype.EnableWifi=null,e.prototype.DisableWifi=null,e.prototype.RovStatusReport=null,e.prototype.RestartRovServices=null,e.prototype.RovLogs=null,e.prototype.RefreshAllSensors=null,e.prototype.Mavlink=null,e.prototype.SimplepeerSignal=null,e.prototype.Disarm=null,e.prototype.SetAutopilotMode=null;let n;return Object.defineProperty(e.prototype,"Body",{get:$util.oneOfGetter(n=["Ping","PasswordAttempt","AuthTokenAttempt","TakeControl","Move","BeginVideoStream","TakePhoto","StartVideoRec","StopVideoRec","ToogleLights","ShutdownRov","RebootRov","EnableWifi","DisableWifi","RovStatusReport","RestartRovServices","RovLogs","RefreshAllSensors","Mavlink","SimplepeerSignal","Disarm","SetAutopilotMode"]),set:$util.oneOfSetter(n)}),e.create=function(s){return new e(s)},e.encode=function(s,c){return c||(c=$Writer.create()),s.BackendMetadata!=null&&Object.hasOwnProperty.call(s,"BackendMetadata")&&$root.rov_actions_proto.ActionBackendMetadata.encode(s.BackendMetadata,c.uint32(10).fork()).ldelim(),s.ExchangeId!=null&&Object.hasOwnProperty.call(s,"ExchangeId")&&c.uint32(16).int32(s.ExchangeId),s.Ping!=null&&Object.hasOwnProperty.call(s,"Ping")&&$root.rov_actions_proto.PingAction.encode(s.Ping,c.uint32(26).fork()).ldelim(),s.PasswordAttempt!=null&&Object.hasOwnProperty.call(s,"PasswordAttempt")&&$root.rov_actions_proto.PasswordAttemptAction.encode(s.PasswordAttempt,c.uint32(34).fork()).ldelim(),s.AuthTokenAttempt!=null&&Object.hasOwnProperty.call(s,"AuthTokenAttempt")&&$root.rov_actions_proto.AuthTokenAttemptAction.encode(s.AuthTokenAttempt,c.uint32(42).fork()).ldelim(),s.TakeControl!=null&&Object.hasOwnProperty.call(s,"TakeControl")&&$root.rov_actions_proto.TakeControlAction.encode(s.TakeControl,c.uint32(50).fork()).ldelim(),s.Move!=null&&Object.hasOwnProperty.call(s,"Move")&&$root.rov_actions_proto.MoveAction.encode(s.Move,c.uint32(58).fork()).ldelim(),s.BeginVideoStream!=null&&Object.hasOwnProperty.call(s,"BeginVideoStream")&&$root.rov_actions_proto.BeginVideoStreamAction.encode(s.BeginVideoStream,c.uint32(66).fork()).ldelim(),s.TakePhoto!=null&&Object.hasOwnProperty.call(s,"TakePhoto")&&$root.rov_actions_proto.TakePhotoAction.encode(s.TakePhoto,c.uint32(74).fork()).ldelim(),s.StartVideoRec!=null&&Object.hasOwnProperty.call(s,"StartVideoRec")&&$root.rov_actions_proto.StartVideoRecAction.encode(s.StartVideoRec,c.uint32(82).fork()).ldelim(),s.StopVideoRec!=null&&Object.hasOwnProperty.call(s,"StopVideoRec")&&$root.rov_actions_proto.StopVideoRecAction.encode(s.StopVideoRec,c.uint32(90).fork()).ldelim(),s.ToogleLights!=null&&Object.hasOwnProperty.call(s,"ToogleLights")&&$root.rov_actions_proto.ToogleLightsAction.encode(s.ToogleLights,c.uint32(98).fork()).ldelim(),s.ShutdownRov!=null&&Object.hasOwnProperty.call(s,"ShutdownRov")&&$root.rov_actions_proto.ShutdownRovAction.encode(s.ShutdownRov,c.uint32(106).fork()).ldelim(),s.RebootRov!=null&&Object.hasOwnProperty.call(s,"RebootRov")&&$root.rov_actions_proto.RebootRovAction.encode(s.RebootRov,c.uint32(114).fork()).ldelim(),s.EnableWifi!=null&&Object.hasOwnProperty.call(s,"EnableWifi")&&$root.rov_actions_proto.EnableWifiAction.encode(s.EnableWifi,c.uint32(122).fork()).ldelim(),s.DisableWifi!=null&&Object.hasOwnProperty.call(s,"DisableWifi")&&$root.rov_actions_proto.DisableWifiAction.encode(s.DisableWifi,c.uint32(130).fork()).ldelim(),s.RovStatusReport!=null&&Object.hasOwnProperty.call(s,"RovStatusReport")&&$root.rov_actions_proto.RovStatusReportAction.encode(s.RovStatusReport,c.uint32(138).fork()).ldelim(),s.RestartRovServices!=null&&Object.hasOwnProperty.call(s,"RestartRovServices")&&$root.rov_actions_proto.RestartRovServicesAction.encode(s.RestartRovServices,c.uint32(146).fork()).ldelim(),s.RovLogs!=null&&Object.hasOwnProperty.call(s,"RovLogs")&&$root.rov_actions_proto.RovLogsAction.encode(s.RovLogs,c.uint32(154).fork()).ldelim(),s.RefreshAllSensors!=null&&Object.hasOwnProperty.call(s,"RefreshAllSensors")&&$root.rov_actions_proto.RefreshAllSensorsAction.encode(s.RefreshAllSensors,c.uint32(162).fork()).ldelim(),s.Mavlink!=null&&Object.hasOwnProperty.call(s,"Mavlink")&&$root.rov_actions_proto.MavlinkAction.encode(s.Mavlink,c.uint32(170).fork()).ldelim(),s.SimplepeerSignal!=null&&Object.hasOwnProperty.call(s,"SimplepeerSignal")&&$root.rov_actions_proto.SimplepeerSignalAction.encode(s.SimplepeerSignal,c.uint32(178).fork()).ldelim(),s.Disarm!=null&&Object.hasOwnProperty.call(s,"Disarm")&&$root.rov_actions_proto.DisarmAction.encode(s.Disarm,c.uint32(186).fork()).ldelim(),s.SetAutopilotMode!=null&&Object.hasOwnProperty.call(s,"SetAutopilotMode")&&$root.rov_actions_proto.SetAutopilotModeAction.encode(s.SetAutopilotMode,c.uint32(194).fork()).ldelim(),c},e.encodeDelimited=function(s,c){return this.encode(s,c).ldelim()},e.decode=function(s,c){s instanceof $Reader||(s=$Reader.create(s));let u=c===void 0?s.len:s.pos+c,d=new $root.rov_actions_proto.RovAction;for(;s.pos<u;){let m=s.uint32();switch(m>>>3){case 1:{d.BackendMetadata=$root.rov_actions_proto.ActionBackendMetadata.decode(s,s.uint32());break}case 2:{d.ExchangeId=s.int32();break}case 3:{d.Ping=$root.rov_actions_proto.PingAction.decode(s,s.uint32());break}case 4:{d.PasswordAttempt=$root.rov_actions_proto.PasswordAttemptAction.decode(s,s.uint32());break}case 5:{d.AuthTokenAttempt=$root.rov_actions_proto.AuthTokenAttemptAction.decode(s,s.uint32());break}case 6:{d.TakeControl=$root.rov_actions_proto.TakeControlAction.decode(s,s.uint32());break}case 7:{d.Move=$root.rov_actions_proto.MoveAction.decode(s,s.uint32());break}case 8:{d.BeginVideoStream=$root.rov_actions_proto.BeginVideoStreamAction.decode(s,s.uint32());break}case 9:{d.TakePhoto=$root.rov_actions_proto.TakePhotoAction.decode(s,s.uint32());break}case 10:{d.StartVideoRec=$root.rov_actions_proto.StartVideoRecAction.decode(s,s.uint32());break}case 11:{d.StopVideoRec=$root.rov_actions_proto.StopVideoRecAction.decode(s,s.uint32());break}case 12:{d.ToogleLights=$root.rov_actions_proto.ToogleLightsAction.decode(s,s.uint32());break}case 13:{d.ShutdownRov=$root.rov_actions_proto.ShutdownRovAction.decode(s,s.uint32());break}case 14:{d.RebootRov=$root.rov_actions_proto.RebootRovAction.decode(s,s.uint32());break}case 15:{d.EnableWifi=$root.rov_actions_proto.EnableWifiAction.decode(s,s.uint32());break}case 16:{d.DisableWifi=$root.rov_actions_proto.DisableWifiAction.decode(s,s.uint32());break}case 17:{d.RovStatusReport=$root.rov_actions_proto.RovStatusReportAction.decode(s,s.uint32());break}case 18:{d.RestartRovServices=$root.rov_actions_proto.RestartRovServicesAction.decode(s,s.uint32());break}case 19:{d.RovLogs=$root.rov_actions_proto.RovLogsAction.decode(s,s.uint32());break}case 20:{d.RefreshAllSensors=$root.rov_actions_proto.RefreshAllSensorsAction.decode(s,s.uint32());break}case 21:{d.Mavlink=$root.rov_actions_proto.MavlinkAction.decode(s,s.uint32());break}case 22:{d.SimplepeerSignal=$root.rov_actions_proto.SimplepeerSignalAction.decode(s,s.uint32());break}case 23:{d.Disarm=$root.rov_actions_proto.DisarmAction.decode(s,s.uint32());break}case 24:{d.SetAutopilotMode=$root.rov_actions_proto.SetAutopilotModeAction.decode(s,s.uint32());break}default:s.skipType(m&7);break}}return d},e.decodeDelimited=function(s){return s instanceof $Reader||(s=new $Reader(s)),this.decode(s,s.uint32())},e.verify=function(s){if(typeof s!="object"||s===null)return"object expected";let c={};if(s.BackendMetadata!=null&&s.hasOwnProperty("BackendMetadata")){let u=$root.rov_actions_proto.ActionBackendMetadata.verify(s.BackendMetadata);if(u)return"BackendMetadata."+u}if(s.ExchangeId!=null&&s.hasOwnProperty("ExchangeId")&&!$util.isInteger(s.ExchangeId))return"ExchangeId: integer expected";if(s.Ping!=null&&s.hasOwnProperty("Ping")){c.Body=1;{let u=$root.rov_actions_proto.PingAction.verify(s.Ping);if(u)return"Ping."+u}}if(s.PasswordAttempt!=null&&s.hasOwnProperty("PasswordAttempt")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.PasswordAttemptAction.verify(s.PasswordAttempt);if(u)return"PasswordAttempt."+u}}if(s.AuthTokenAttempt!=null&&s.hasOwnProperty("AuthTokenAttempt")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.AuthTokenAttemptAction.verify(s.AuthTokenAttempt);if(u)return"AuthTokenAttempt."+u}}if(s.TakeControl!=null&&s.hasOwnProperty("TakeControl")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.TakeControlAction.verify(s.TakeControl);if(u)return"TakeControl."+u}}if(s.Move!=null&&s.hasOwnProperty("Move")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.MoveAction.verify(s.Move);if(u)return"Move."+u}}if(s.BeginVideoStream!=null&&s.hasOwnProperty("BeginVideoStream")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.BeginVideoStreamAction.verify(s.BeginVideoStream);if(u)return"BeginVideoStream."+u}}if(s.TakePhoto!=null&&s.hasOwnProperty("TakePhoto")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.TakePhotoAction.verify(s.TakePhoto);if(u)return"TakePhoto."+u}}if(s.StartVideoRec!=null&&s.hasOwnProperty("StartVideoRec")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.StartVideoRecAction.verify(s.StartVideoRec);if(u)return"StartVideoRec."+u}}if(s.StopVideoRec!=null&&s.hasOwnProperty("StopVideoRec")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.StopVideoRecAction.verify(s.StopVideoRec);if(u)return"StopVideoRec."+u}}if(s.ToogleLights!=null&&s.hasOwnProperty("ToogleLights")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.ToogleLightsAction.verify(s.ToogleLights);if(u)return"ToogleLights."+u}}if(s.ShutdownRov!=null&&s.hasOwnProperty("ShutdownRov")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.ShutdownRovAction.verify(s.ShutdownRov);if(u)return"ShutdownRov."+u}}if(s.RebootRov!=null&&s.hasOwnProperty("RebootRov")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.RebootRovAction.verify(s.RebootRov);if(u)return"RebootRov."+u}}if(s.EnableWifi!=null&&s.hasOwnProperty("EnableWifi")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.EnableWifiAction.verify(s.EnableWifi);if(u)return"EnableWifi."+u}}if(s.DisableWifi!=null&&s.hasOwnProperty("DisableWifi")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.DisableWifiAction.verify(s.DisableWifi);if(u)return"DisableWifi."+u}}if(s.RovStatusReport!=null&&s.hasOwnProperty("RovStatusReport")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.RovStatusReportAction.verify(s.RovStatusReport);if(u)return"RovStatusReport."+u}}if(s.RestartRovServices!=null&&s.hasOwnProperty("RestartRovServices")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.RestartRovServicesAction.verify(s.RestartRovServices);if(u)return"RestartRovServices."+u}}if(s.RovLogs!=null&&s.hasOwnProperty("RovLogs")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.RovLogsAction.verify(s.RovLogs);if(u)return"RovLogs."+u}}if(s.RefreshAllSensors!=null&&s.hasOwnProperty("RefreshAllSensors")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.RefreshAllSensorsAction.verify(s.RefreshAllSensors);if(u)return"RefreshAllSensors."+u}}if(s.Mavlink!=null&&s.hasOwnProperty("Mavlink")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.MavlinkAction.verify(s.Mavlink);if(u)return"Mavlink."+u}}if(s.SimplepeerSignal!=null&&s.hasOwnProperty("SimplepeerSignal")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.SimplepeerSignalAction.verify(s.SimplepeerSignal);if(u)return"SimplepeerSignal."+u}}if(s.Disarm!=null&&s.hasOwnProperty("Disarm")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.DisarmAction.verify(s.Disarm);if(u)return"Disarm."+u}}if(s.SetAutopilotMode!=null&&s.hasOwnProperty("SetAutopilotMode")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.SetAutopilotModeAction.verify(s.SetAutopilotMode);if(u)return"SetAutopilotMode."+u}}return null},e.fromObject=function(s){if(s instanceof $root.rov_actions_proto.RovAction)return s;let c=new $root.rov_actions_proto.RovAction;if(s.BackendMetadata!=null){if(typeof s.BackendMetadata!="object")throw TypeError(".rov_actions_proto.RovAction.BackendMetadata: object expected");c.BackendMetadata=$root.rov_actions_proto.ActionBackendMetadata.fromObject(s.BackendMetadata)}if(s.ExchangeId!=null&&(c.ExchangeId=s.ExchangeId|0),s.Ping!=null){if(typeof s.Ping!="object")throw TypeError(".rov_actions_proto.RovAction.Ping: object expected");c.Ping=$root.rov_actions_proto.PingAction.fromObject(s.Ping)}if(s.PasswordAttempt!=null){if(typeof s.PasswordAttempt!="object")throw TypeError(".rov_actions_proto.RovAction.PasswordAttempt: object expected");c.PasswordAttempt=$root.rov_actions_proto.PasswordAttemptAction.fromObject(s.PasswordAttempt)}if(s.AuthTokenAttempt!=null){if(typeof s.AuthTokenAttempt!="object")throw TypeError(".rov_actions_proto.RovAction.AuthTokenAttempt: object expected");c.AuthTokenAttempt=$root.rov_actions_proto.AuthTokenAttemptAction.fromObject(s.AuthTokenAttempt)}if(s.TakeControl!=null){if(typeof s.TakeControl!="object")throw TypeError(".rov_actions_proto.RovAction.TakeControl: object expected");c.TakeControl=$root.rov_actions_proto.TakeControlAction.fromObject(s.TakeControl)}if(s.Move!=null){if(typeof s.Move!="object")throw TypeError(".rov_actions_proto.RovAction.Move: object expected");c.Move=$root.rov_actions_proto.MoveAction.fromObject(s.Move)}if(s.BeginVideoStream!=null){if(typeof s.BeginVideoStream!="object")throw TypeError(".rov_actions_proto.RovAction.BeginVideoStream: object expected");c.BeginVideoStream=$root.rov_actions_proto.BeginVideoStreamAction.fromObject(s.BeginVideoStream)}if(s.TakePhoto!=null){if(typeof s.TakePhoto!="object")throw TypeError(".rov_actions_proto.RovAction.TakePhoto: object expected");c.TakePhoto=$root.rov_actions_proto.TakePhotoAction.fromObject(s.TakePhoto)}if(s.StartVideoRec!=null){if(typeof s.StartVideoRec!="object")throw TypeError(".rov_actions_proto.RovAction.StartVideoRec: object expected");c.StartVideoRec=$root.rov_actions_proto.StartVideoRecAction.fromObject(s.StartVideoRec)}if(s.StopVideoRec!=null){if(typeof s.StopVideoRec!="object")throw TypeError(".rov_actions_proto.RovAction.StopVideoRec: object expected");c.StopVideoRec=$root.rov_actions_proto.StopVideoRecAction.fromObject(s.StopVideoRec)}if(s.ToogleLights!=null){if(typeof s.ToogleLights!="object")throw TypeError(".rov_actions_proto.RovAction.ToogleLights: object expected");c.ToogleLights=$root.rov_actions_proto.ToogleLightsAction.fromObject(s.ToogleLights)}if(s.ShutdownRov!=null){if(typeof s.ShutdownRov!="object")throw TypeError(".rov_actions_proto.RovAction.ShutdownRov: object expected");c.ShutdownRov=$root.rov_actions_proto.ShutdownRovAction.fromObject(s.ShutdownRov)}if(s.RebootRov!=null){if(typeof s.RebootRov!="object")throw TypeError(".rov_actions_proto.RovAction.RebootRov: object expected");c.RebootRov=$root.rov_actions_proto.RebootRovAction.fromObject(s.RebootRov)}if(s.EnableWifi!=null){if(typeof s.EnableWifi!="object")throw TypeError(".rov_actions_proto.RovAction.EnableWifi: object expected");c.EnableWifi=$root.rov_actions_proto.EnableWifiAction.fromObject(s.EnableWifi)}if(s.DisableWifi!=null){if(typeof s.DisableWifi!="object")throw TypeError(".rov_actions_proto.RovAction.DisableWifi: object expected");c.DisableWifi=$root.rov_actions_proto.DisableWifiAction.fromObject(s.DisableWifi)}if(s.RovStatusReport!=null){if(typeof s.RovStatusReport!="object")throw TypeError(".rov_actions_proto.RovAction.RovStatusReport: object expected");c.RovStatusReport=$root.rov_actions_proto.RovStatusReportAction.fromObject(s.RovStatusReport)}if(s.RestartRovServices!=null){if(typeof s.RestartRovServices!="object")throw TypeError(".rov_actions_proto.RovAction.RestartRovServices: object expected");c.RestartRovServices=$root.rov_actions_proto.RestartRovServicesAction.fromObject(s.RestartRovServices)}if(s.RovLogs!=null){if(typeof s.RovLogs!="object")throw TypeError(".rov_actions_proto.RovAction.RovLogs: object expected");c.RovLogs=$root.rov_actions_proto.RovLogsAction.fromObject(s.RovLogs)}if(s.RefreshAllSensors!=null){if(typeof s.RefreshAllSensors!="object")throw TypeError(".rov_actions_proto.RovAction.RefreshAllSensors: object expected");c.RefreshAllSensors=$root.rov_actions_proto.RefreshAllSensorsAction.fromObject(s.RefreshAllSensors)}if(s.Mavlink!=null){if(typeof s.Mavlink!="object")throw TypeError(".rov_actions_proto.RovAction.Mavlink: object expected");c.Mavlink=$root.rov_actions_proto.MavlinkAction.fromObject(s.Mavlink)}if(s.SimplepeerSignal!=null){if(typeof s.SimplepeerSignal!="object")throw TypeError(".rov_actions_proto.RovAction.SimplepeerSignal: object expected");c.SimplepeerSignal=$root.rov_actions_proto.SimplepeerSignalAction.fromObject(s.SimplepeerSignal)}if(s.Disarm!=null){if(typeof s.Disarm!="object")throw TypeError(".rov_actions_proto.RovAction.Disarm: object expected");c.Disarm=$root.rov_actions_proto.DisarmAction.fromObject(s.Disarm)}if(s.SetAutopilotMode!=null){if(typeof s.SetAutopilotMode!="object")throw TypeError(".rov_actions_proto.RovAction.SetAutopilotMode: object expected");c.SetAutopilotMode=$root.rov_actions_proto.SetAutopilotModeAction.fromObject(s.SetAutopilotMode)}return c},e.toObject=function(s,c){c||(c={});let u={};return c.defaults&&(u.BackendMetadata=null,u.ExchangeId=0),s.BackendMetadata!=null&&s.hasOwnProperty("BackendMetadata")&&(u.BackendMetadata=$root.rov_actions_proto.ActionBackendMetadata.toObject(s.BackendMetadata,c)),s.ExchangeId!=null&&s.hasOwnProperty("ExchangeId")&&(u.ExchangeId=s.ExchangeId),s.Ping!=null&&s.hasOwnProperty("Ping")&&(u.Ping=$root.rov_actions_proto.PingAction.toObject(s.Ping,c),c.oneofs&&(u.Body="Ping")),s.PasswordAttempt!=null&&s.hasOwnProperty("PasswordAttempt")&&(u.PasswordAttempt=$root.rov_actions_proto.PasswordAttemptAction.toObject(s.PasswordAttempt,c),c.oneofs&&(u.Body="PasswordAttempt")),s.AuthTokenAttempt!=null&&s.hasOwnProperty("AuthTokenAttempt")&&(u.AuthTokenAttempt=$root.rov_actions_proto.AuthTokenAttemptAction.toObject(s.AuthTokenAttempt,c),c.oneofs&&(u.Body="AuthTokenAttempt")),s.TakeControl!=null&&s.hasOwnProperty("TakeControl")&&(u.TakeControl=$root.rov_actions_proto.TakeControlAction.toObject(s.TakeControl,c),c.oneofs&&(u.Body="TakeControl")),s.Move!=null&&s.hasOwnProperty("Move")&&(u.Move=$root.rov_actions_proto.MoveAction.toObject(s.Move,c),c.oneofs&&(u.Body="Move")),s.BeginVideoStream!=null&&s.hasOwnProperty("BeginVideoStream")&&(u.BeginVideoStream=$root.rov_actions_proto.BeginVideoStreamAction.toObject(s.BeginVideoStream,c),c.oneofs&&(u.Body="BeginVideoStream")),s.TakePhoto!=null&&s.hasOwnProperty("TakePhoto")&&(u.TakePhoto=$root.rov_actions_proto.TakePhotoAction.toObject(s.TakePhoto,c),c.oneofs&&(u.Body="TakePhoto")),s.StartVideoRec!=null&&s.hasOwnProperty("StartVideoRec")&&(u.StartVideoRec=$root.rov_actions_proto.StartVideoRecAction.toObject(s.StartVideoRec,c),c.oneofs&&(u.Body="StartVideoRec")),s.StopVideoRec!=null&&s.hasOwnProperty("StopVideoRec")&&(u.StopVideoRec=$root.rov_actions_proto.StopVideoRecAction.toObject(s.StopVideoRec,c),c.oneofs&&(u.Body="StopVideoRec")),s.ToogleLights!=null&&s.hasOwnProperty("ToogleLights")&&(u.ToogleLights=$root.rov_actions_proto.ToogleLightsAction.toObject(s.ToogleLights,c),c.oneofs&&(u.Body="ToogleLights")),s.ShutdownRov!=null&&s.hasOwnProperty("ShutdownRov")&&(u.ShutdownRov=$root.rov_actions_proto.ShutdownRovAction.toObject(s.ShutdownRov,c),c.oneofs&&(u.Body="ShutdownRov")),s.RebootRov!=null&&s.hasOwnProperty("RebootRov")&&(u.RebootRov=$root.rov_actions_proto.RebootRovAction.toObject(s.RebootRov,c),c.oneofs&&(u.Body="RebootRov")),s.EnableWifi!=null&&s.hasOwnProperty("EnableWifi")&&(u.EnableWifi=$root.rov_actions_proto.EnableWifiAction.toObject(s.EnableWifi,c),c.oneofs&&(u.Body="EnableWifi")),s.DisableWifi!=null&&s.hasOwnProperty("DisableWifi")&&(u.DisableWifi=$root.rov_actions_proto.DisableWifiAction.toObject(s.DisableWifi,c),c.oneofs&&(u.Body="DisableWifi")),s.RovStatusReport!=null&&s.hasOwnProperty("RovStatusReport")&&(u.RovStatusReport=$root.rov_actions_proto.RovStatusReportAction.toObject(s.RovStatusReport,c),c.oneofs&&(u.Body="RovStatusReport")),s.RestartRovServices!=null&&s.hasOwnProperty("RestartRovServices")&&(u.RestartRovServices=$root.rov_actions_proto.RestartRovServicesAction.toObject(s.RestartRovServices,c),c.oneofs&&(u.Body="RestartRovServices")),s.RovLogs!=null&&s.hasOwnProperty("RovLogs")&&(u.RovLogs=$root.rov_actions_proto.RovLogsAction.toObject(s.RovLogs,c),c.oneofs&&(u.Body="RovLogs")),s.RefreshAllSensors!=null&&s.hasOwnProperty("RefreshAllSensors")&&(u.RefreshAllSensors=$root.rov_actions_proto.RefreshAllSensorsAction.toObject(s.RefreshAllSensors,c),c.oneofs&&(u.Body="RefreshAllSensors")),s.Mavlink!=null&&s.hasOwnProperty("Mavlink")&&(u.Mavlink=$root.rov_actions_proto.MavlinkAction.toObject(s.Mavlink,c),c.oneofs&&(u.Body="Mavlink")),s.SimplepeerSignal!=null&&s.hasOwnProperty("SimplepeerSignal")&&(u.SimplepeerSignal=$root.rov_actions_proto.SimplepeerSignalAction.toObject(s.SimplepeerSignal,c),c.oneofs&&(u.Body="SimplepeerSignal")),s.Disarm!=null&&s.hasOwnProperty("Disarm")&&(u.Disarm=$root.rov_actions_proto.DisarmAction.toObject(s.Disarm,c),c.oneofs&&(u.Body="Disarm")),s.SetAutopilotMode!=null&&s.hasOwnProperty("SetAutopilotMode")&&(u.SetAutopilotMode=$root.rov_actions_proto.SetAutopilotModeAction.toObject(s.SetAutopilotMode,c),c.oneofs&&(u.Body="SetAutopilotMode")),u},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/rov_actions_proto.RovAction"},e}(),t.DoneResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Message="",e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Message!=null&&Object.hasOwnProperty.call(a,"Message")&&s.uint32(10).string(a.Message),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.DoneResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Message=a.string();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.Message!=null&&a.hasOwnProperty("Message")&&!$util.isString(a.Message)?"Message: string expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.DoneResponse)return a;let s=new $root.rov_actions_proto.DoneResponse;return a.Message!=null&&(s.Message=String(a.Message)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.Message=""),a.Message!=null&&a.hasOwnProperty("Message")&&(c.Message=a.Message),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.DoneResponse"},e}(),t.ErrorResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Message="",e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Message!=null&&Object.hasOwnProperty.call(a,"Message")&&s.uint32(10).string(a.Message),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.ErrorResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Message=a.string();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.Message!=null&&a.hasOwnProperty("Message")&&!$util.isString(a.Message)?"Message: string expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.ErrorResponse)return a;let s=new $root.rov_actions_proto.ErrorResponse;return a.Message!=null&&(s.Message=String(a.Message)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.Message=""),a.Message!=null&&a.hasOwnProperty("Message")&&(c.Message=a.Message),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.ErrorResponse"},e}(),t.PongResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Time!=null&&Object.hasOwnProperty.call(a,"Time")&&s.uint32(8).int64(a.Time),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.PongResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Time=a.int64();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.Time!=null&&a.hasOwnProperty("Time")&&!$util.isInteger(a.Time)&&!(a.Time&&$util.isInteger(a.Time.low)&&$util.isInteger(a.Time.high))?"Time: integer|Long expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.PongResponse)return a;let s=new $root.rov_actions_proto.PongResponse;return a.Time!=null&&($util.Long?(s.Time=$util.Long.fromValue(a.Time)).unsigned=!1:typeof a.Time=="string"?s.Time=parseInt(a.Time,10):typeof a.Time=="number"?s.Time=a.Time:typeof a.Time=="object"&&(s.Time=new $util.LongBits(a.Time.low>>>0,a.Time.high>>>0).toNumber())),s},e.toObject=function(a,s){s||(s={});let c={};if(s.defaults)if($util.Long){let u=new $util.Long(0,0,!1);c.Time=s.longs===String?u.toString():s.longs===Number?u.toNumber():u}else c.Time=s.longs===String?"0":0;return a.Time!=null&&a.hasOwnProperty("Time")&&(typeof a.Time=="number"?c.Time=s.longs===String?String(a.Time):a.Time:c.Time=s.longs===String?$util.Long.prototype.toString.call(a.Time):s.longs===Number?new $util.LongBits(a.Time.low>>>0,a.Time.high>>>0).toNumber():a.Time),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.PongResponse"},e}(),t.SensorUpdatesResponse=function(){function e(n){if(this.MeasurementUpdates=[],n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.MeasurementUpdates=$util.emptyArray,e.create=function(a){return new e(a)},e.encode=function(a,s){if(s||(s=$Writer.create()),a.MeasurementUpdates!=null&&a.MeasurementUpdates.length)for(let c=0;c<a.MeasurementUpdates.length;++c)$root.rov_actions_proto.Measurement.encode(a.MeasurementUpdates[c],s.uint32(10).fork()).ldelim();return s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.SensorUpdatesResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.MeasurementUpdates&&u.MeasurementUpdates.length||(u.MeasurementUpdates=[]),u.MeasurementUpdates.push($root.rov_actions_proto.Measurement.decode(a,a.uint32()));break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.MeasurementUpdates!=null&&a.hasOwnProperty("MeasurementUpdates")){if(!Array.isArray(a.MeasurementUpdates))return"MeasurementUpdates: array expected";for(let s=0;s<a.MeasurementUpdates.length;++s){let c=$root.rov_actions_proto.Measurement.verify(a.MeasurementUpdates[s]);if(c)return"MeasurementUpdates."+c}}return null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.SensorUpdatesResponse)return a;let s=new $root.rov_actions_proto.SensorUpdatesResponse;if(a.MeasurementUpdates){if(!Array.isArray(a.MeasurementUpdates))throw TypeError(".rov_actions_proto.SensorUpdatesResponse.MeasurementUpdates: array expected");s.MeasurementUpdates=[];for(let c=0;c<a.MeasurementUpdates.length;++c){if(typeof a.MeasurementUpdates[c]!="object")throw TypeError(".rov_actions_proto.SensorUpdatesResponse.MeasurementUpdates: object expected");s.MeasurementUpdates[c]=$root.rov_actions_proto.Measurement.fromObject(a.MeasurementUpdates[c])}}return s},e.toObject=function(a,s){s||(s={});let c={};if((s.arrays||s.defaults)&&(c.MeasurementUpdates=[]),a.MeasurementUpdates&&a.MeasurementUpdates.length){c.MeasurementUpdates=[];for(let u=0;u<a.MeasurementUpdates.length;++u)c.MeasurementUpdates[u]=$root.rov_actions_proto.Measurement.toObject(a.MeasurementUpdates[u],s)}return c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.SensorUpdatesResponse"},e}(),t.PasswordRequiredResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.RovId="",e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.RovId!=null&&Object.hasOwnProperty.call(a,"RovId")&&s.uint32(10).string(a.RovId),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.PasswordRequiredResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.RovId=a.string();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.RovId!=null&&a.hasOwnProperty("RovId")&&!$util.isString(a.RovId)?"RovId: string expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.PasswordRequiredResponse)return a;let s=new $root.rov_actions_proto.PasswordRequiredResponse;return a.RovId!=null&&(s.RovId=String(a.RovId)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.RovId=""),a.RovId!=null&&a.hasOwnProperty("RovId")&&(c.RovId=a.RovId),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.PasswordRequiredResponse"},e}(),t.PasswordAcceptedResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.AuthToken="",e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.AuthToken!=null&&Object.hasOwnProperty.call(a,"AuthToken")&&s.uint32(10).string(a.AuthToken),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.PasswordAcceptedResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.AuthToken=a.string();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.AuthToken!=null&&a.hasOwnProperty("AuthToken")&&!$util.isString(a.AuthToken)?"AuthToken: string expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.PasswordAcceptedResponse)return a;let s=new $root.rov_actions_proto.PasswordAcceptedResponse;return a.AuthToken!=null&&(s.AuthToken=String(a.AuthToken)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.AuthToken=""),a.AuthToken!=null&&a.hasOwnProperty("AuthToken")&&(c.AuthToken=a.AuthToken),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.PasswordAcceptedResponse"},e}(),t.PasswordInvalidResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.PasswordInvalidResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":null},e.fromObject=function(a){return a instanceof $root.rov_actions_proto.PasswordInvalidResponse?a:new $root.rov_actions_proto.PasswordInvalidResponse},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.PasswordInvalidResponse"},e}(),t.DriverChangedResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.DriverPeerId="",e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.DriverPeerId!=null&&Object.hasOwnProperty.call(a,"DriverPeerId")&&s.uint32(10).string(a.DriverPeerId),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.DriverChangedResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.DriverPeerId=a.string();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.DriverPeerId!=null&&a.hasOwnProperty("DriverPeerId")&&!$util.isString(a.DriverPeerId)?"DriverPeerId: string expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.DriverChangedResponse)return a;let s=new $root.rov_actions_proto.DriverChangedResponse;return a.DriverPeerId!=null&&(s.DriverPeerId=String(a.DriverPeerId)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.DriverPeerId=""),a.DriverPeerId!=null&&a.hasOwnProperty("DriverPeerId")&&(c.DriverPeerId=a.DriverPeerId),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.DriverChangedResponse"},e}(),t.ClientConnectedResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.ClientPeerId="",e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.ClientPeerId!=null&&Object.hasOwnProperty.call(a,"ClientPeerId")&&s.uint32(10).string(a.ClientPeerId),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.ClientConnectedResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.ClientPeerId=a.string();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.ClientPeerId!=null&&a.hasOwnProperty("ClientPeerId")&&!$util.isString(a.ClientPeerId)?"ClientPeerId: string expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.ClientConnectedResponse)return a;let s=new $root.rov_actions_proto.ClientConnectedResponse;return a.ClientPeerId!=null&&(s.ClientPeerId=String(a.ClientPeerId)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.ClientPeerId=""),a.ClientPeerId!=null&&a.hasOwnProperty("ClientPeerId")&&(c.ClientPeerId=a.ClientPeerId),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.ClientConnectedResponse"},e}(),t.ClientDisconnectedResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.ClientPeerId="",e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.ClientPeerId!=null&&Object.hasOwnProperty.call(a,"ClientPeerId")&&s.uint32(10).string(a.ClientPeerId),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.ClientDisconnectedResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.ClientPeerId=a.string();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.ClientPeerId!=null&&a.hasOwnProperty("ClientPeerId")&&!$util.isString(a.ClientPeerId)?"ClientPeerId: string expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.ClientDisconnectedResponse)return a;let s=new $root.rov_actions_proto.ClientDisconnectedResponse;return a.ClientPeerId!=null&&(s.ClientPeerId=String(a.ClientPeerId)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.ClientPeerId=""),a.ClientPeerId!=null&&a.hasOwnProperty("ClientPeerId")&&(c.ClientPeerId=a.ClientPeerId),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.ClientDisconnectedResponse"},e}(),t.HeartbeatResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Time!=null&&Object.hasOwnProperty.call(a,"Time")&&s.uint32(8).int64(a.Time),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.HeartbeatResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Time=a.int64();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.Time!=null&&a.hasOwnProperty("Time")&&!$util.isInteger(a.Time)&&!(a.Time&&$util.isInteger(a.Time.low)&&$util.isInteger(a.Time.high))?"Time: integer|Long expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.HeartbeatResponse)return a;let s=new $root.rov_actions_proto.HeartbeatResponse;return a.Time!=null&&($util.Long?(s.Time=$util.Long.fromValue(a.Time)).unsigned=!1:typeof a.Time=="string"?s.Time=parseInt(a.Time,10):typeof a.Time=="number"?s.Time=a.Time:typeof a.Time=="object"&&(s.Time=new $util.LongBits(a.Time.low>>>0,a.Time.high>>>0).toNumber())),s},e.toObject=function(a,s){s||(s={});let c={};if(s.defaults)if($util.Long){let u=new $util.Long(0,0,!1);c.Time=s.longs===String?u.toString():s.longs===Number?u.toNumber():u}else c.Time=s.longs===String?"0":0;return a.Time!=null&&a.hasOwnProperty("Time")&&(typeof a.Time=="number"?c.Time=s.longs===String?String(a.Time):a.Time:c.Time=s.longs===String?$util.Long.prototype.toString.call(a.Time):s.longs===Number?new $util.LongBits(a.Time.low>>>0,a.Time.high>>>0).toNumber():a.Time),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.HeartbeatResponse"},e}(),t.ContinuedOutputResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Message="",e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Message!=null&&Object.hasOwnProperty.call(a,"Message")&&s.uint32(10).string(a.Message),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.ContinuedOutputResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Message=a.string();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.Message!=null&&a.hasOwnProperty("Message")&&!$util.isString(a.Message)?"Message: string expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.ContinuedOutputResponse)return a;let s=new $root.rov_actions_proto.ContinuedOutputResponse;return a.Message!=null&&(s.Message=String(a.Message)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.Message=""),a.Message!=null&&a.hasOwnProperty("Message")&&(c.Message=a.Message),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.ContinuedOutputResponse"},e}(),t.MavlinkResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Message=$util.newBuffer([]),e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Message!=null&&Object.hasOwnProperty.call(a,"Message")&&s.uint32(10).bytes(a.Message),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.MavlinkResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Message=a.bytes();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.Message!=null&&a.hasOwnProperty("Message")&&!(a.Message&&typeof a.Message.length=="number"||$util.isString(a.Message))?"Message: buffer expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.MavlinkResponse)return a;let s=new $root.rov_actions_proto.MavlinkResponse;return a.Message!=null&&(typeof a.Message=="string"?$util.base64.decode(a.Message,s.Message=$util.newBuffer($util.base64.length(a.Message)),0):a.Message.length>=0&&(s.Message=a.Message)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(s.bytes===String?c.Message="":(c.Message=[],s.bytes!==Array&&(c.Message=$util.newBuffer(c.Message)))),a.Message!=null&&a.hasOwnProperty("Message")&&(c.Message=s.bytes===String?$util.base64.encode(a.Message,0,a.Message.length):s.bytes===Array?Array.prototype.slice.call(a.Message):a.Message),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.MavlinkResponse"},e}(),t.SimplepeerSignalResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Message="",e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Message!=null&&Object.hasOwnProperty.call(a,"Message")&&s.uint32(10).string(a.Message),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.SimplepeerSignalResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Message=a.string();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){return typeof a!="object"||a===null?"object expected":a.Message!=null&&a.hasOwnProperty("Message")&&!$util.isString(a.Message)?"Message: string expected":null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.SimplepeerSignalResponse)return a;let s=new $root.rov_actions_proto.SimplepeerSignalResponse;return a.Message!=null&&(s.Message=String(a.Message)),s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.Message=""),a.Message!=null&&a.hasOwnProperty("Message")&&(c.Message=a.Message),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.SimplepeerSignalResponse"},e}(),t.SystemMonitorResponse=function(){function e(n){if(this.Warnings=[],n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.CpuTemp=0,e.prototype.CpuUsage=0,e.prototype.MemoryUsage=0,e.prototype.DiskUsage=0,e.prototype.Warnings=$util.emptyArray,e.create=function(a){return new e(a)},e.encode=function(a,s){if(s||(s=$Writer.create()),a.CpuTemp!=null&&Object.hasOwnProperty.call(a,"CpuTemp")&&s.uint32(13).float(a.CpuTemp),a.CpuUsage!=null&&Object.hasOwnProperty.call(a,"CpuUsage")&&s.uint32(21).float(a.CpuUsage),a.MemoryUsage!=null&&Object.hasOwnProperty.call(a,"MemoryUsage")&&s.uint32(29).float(a.MemoryUsage),a.DiskUsage!=null&&Object.hasOwnProperty.call(a,"DiskUsage")&&s.uint32(37).float(a.DiskUsage),a.Warnings!=null&&a.Warnings.length)for(let c=0;c<a.Warnings.length;++c)s.uint32(42).string(a.Warnings[c]);return s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.SystemMonitorResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.CpuTemp=a.float();break}case 2:{u.CpuUsage=a.float();break}case 3:{u.MemoryUsage=a.float();break}case 4:{u.DiskUsage=a.float();break}case 5:{u.Warnings&&u.Warnings.length||(u.Warnings=[]),u.Warnings.push(a.string());break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.CpuTemp!=null&&a.hasOwnProperty("CpuTemp")&&typeof a.CpuTemp!="number")return"CpuTemp: number expected";if(a.CpuUsage!=null&&a.hasOwnProperty("CpuUsage")&&typeof a.CpuUsage!="number")return"CpuUsage: number expected";if(a.MemoryUsage!=null&&a.hasOwnProperty("MemoryUsage")&&typeof a.MemoryUsage!="number")return"MemoryUsage: number expected";if(a.DiskUsage!=null&&a.hasOwnProperty("DiskUsage")&&typeof a.DiskUsage!="number")return"DiskUsage: number expected";if(a.Warnings!=null&&a.hasOwnProperty("Warnings")){if(!Array.isArray(a.Warnings))return"Warnings: array expected";for(let s=0;s<a.Warnings.length;++s)if(!$util.isString(a.Warnings[s]))return"Warnings: string[] expected"}return null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.SystemMonitorResponse)return a;let s=new $root.rov_actions_proto.SystemMonitorResponse;if(a.CpuTemp!=null&&(s.CpuTemp=Number(a.CpuTemp)),a.CpuUsage!=null&&(s.CpuUsage=Number(a.CpuUsage)),a.MemoryUsage!=null&&(s.MemoryUsage=Number(a.MemoryUsage)),a.DiskUsage!=null&&(s.DiskUsage=Number(a.DiskUsage)),a.Warnings){if(!Array.isArray(a.Warnings))throw TypeError(".rov_actions_proto.SystemMonitorResponse.Warnings: array expected");s.Warnings=[];for(let c=0;c<a.Warnings.length;++c)s.Warnings[c]=String(a.Warnings[c])}return s},e.toObject=function(a,s){s||(s={});let c={};if((s.arrays||s.defaults)&&(c.Warnings=[]),s.defaults&&(c.CpuTemp=0,c.CpuUsage=0,c.MemoryUsage=0,c.DiskUsage=0),a.CpuTemp!=null&&a.hasOwnProperty("CpuTemp")&&(c.CpuTemp=s.json&&!isFinite(a.CpuTemp)?String(a.CpuTemp):a.CpuTemp),a.CpuUsage!=null&&a.hasOwnProperty("CpuUsage")&&(c.CpuUsage=s.json&&!isFinite(a.CpuUsage)?String(a.CpuUsage):a.CpuUsage),a.MemoryUsage!=null&&a.hasOwnProperty("MemoryUsage")&&(c.MemoryUsage=s.json&&!isFinite(a.MemoryUsage)?String(a.MemoryUsage):a.MemoryUsage),a.DiskUsage!=null&&a.hasOwnProperty("DiskUsage")&&(c.DiskUsage=s.json&&!isFinite(a.DiskUsage)?String(a.DiskUsage):a.DiskUsage),a.Warnings&&a.Warnings.length){c.Warnings=[];for(let u=0;u<a.Warnings.length;++u)c.Warnings[u]=a.Warnings[u]}return c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.SystemMonitorResponse"},e}(),t.LogMessageResponse=function(){function e(n){if(n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.Message="",e.prototype.Level=0,e.create=function(a){return new e(a)},e.encode=function(a,s){return s||(s=$Writer.create()),a.Message!=null&&Object.hasOwnProperty.call(a,"Message")&&s.uint32(10).string(a.Message),a.Level!=null&&Object.hasOwnProperty.call(a,"Level")&&s.uint32(16).int32(a.Level),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.LogMessageResponse;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.Message=a.string();break}case 2:{u.Level=a.int32();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.Message!=null&&a.hasOwnProperty("Message")&&!$util.isString(a.Message))return"Message: string expected";if(a.Level!=null&&a.hasOwnProperty("Level"))switch(a.Level){default:return"Level: enum value expected";case 0:case 1:case 2:case 3:case 4:break}return null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.LogMessageResponse)return a;let s=new $root.rov_actions_proto.LogMessageResponse;switch(a.Message!=null&&(s.Message=String(a.Message)),a.Level){default:if(typeof a.Level=="number"){s.Level=a.Level;break}break;case"Debug":case 0:s.Level=0;break;case"Info":case 1:s.Level=1;break;case"Warning":case 2:s.Level=2;break;case"Error":case 3:s.Level=3;break;case"Critical":case 4:s.Level=4;break}return s},e.toObject=function(a,s){s||(s={});let c={};return s.defaults&&(c.Message="",c.Level=s.enums===String?"Debug":0),a.Message!=null&&a.hasOwnProperty("Message")&&(c.Message=a.Message),a.Level!=null&&a.hasOwnProperty("Level")&&(c.Level=s.enums===String?$root.rov_actions_proto.LogLevel[a.Level]===void 0?a.Level:$root.rov_actions_proto.LogLevel[a.Level]:a.Level),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.LogMessageResponse"},e}(),t.ResponseBackendMetadata=function(){function e(n){if(this.TargetUserIds=[],n)for(let a=Object.keys(n),s=0;s<a.length;++s)n[a[s]]!=null&&(this[a[s]]=n[a[s]])}return e.prototype.TargetUserIds=$util.emptyArray,e.prototype.TransportMethod=0,e.create=function(a){return new e(a)},e.encode=function(a,s){if(s||(s=$Writer.create()),a.TargetUserIds!=null&&a.TargetUserIds.length)for(let c=0;c<a.TargetUserIds.length;++c)s.uint32(10).string(a.TargetUserIds[c]);return a.TransportMethod!=null&&Object.hasOwnProperty.call(a,"TransportMethod")&&s.uint32(16).int32(a.TransportMethod),s},e.encodeDelimited=function(a,s){return this.encode(a,s).ldelim()},e.decode=function(a,s){a instanceof $Reader||(a=$Reader.create(a));let c=s===void 0?a.len:a.pos+s,u=new $root.rov_actions_proto.ResponseBackendMetadata;for(;a.pos<c;){let d=a.uint32();switch(d>>>3){case 1:{u.TargetUserIds&&u.TargetUserIds.length||(u.TargetUserIds=[]),u.TargetUserIds.push(a.string());break}case 2:{u.TransportMethod=a.int32();break}default:a.skipType(d&7);break}}return u},e.decodeDelimited=function(a){return a instanceof $Reader||(a=new $Reader(a)),this.decode(a,a.uint32())},e.verify=function(a){if(typeof a!="object"||a===null)return"object expected";if(a.TargetUserIds!=null&&a.hasOwnProperty("TargetUserIds")){if(!Array.isArray(a.TargetUserIds))return"TargetUserIds: array expected";for(let s=0;s<a.TargetUserIds.length;++s)if(!$util.isString(a.TargetUserIds[s]))return"TargetUserIds: string[] expected"}if(a.TransportMethod!=null&&a.hasOwnProperty("TransportMethod"))switch(a.TransportMethod){default:return"TransportMethod: enum value expected";case 0:case 1:case 3:break}return null},e.fromObject=function(a){if(a instanceof $root.rov_actions_proto.ResponseBackendMetadata)return a;let s=new $root.rov_actions_proto.ResponseBackendMetadata;if(a.TargetUserIds){if(!Array.isArray(a.TargetUserIds))throw TypeError(".rov_actions_proto.ResponseBackendMetadata.TargetUserIds: array expected");s.TargetUserIds=[];for(let c=0;c<a.TargetUserIds.length;++c)s.TargetUserIds[c]=String(a.TargetUserIds[c])}switch(a.TransportMethod){default:if(typeof a.TransportMethod=="number"){s.TransportMethod=a.TransportMethod;break}break;case"LivekitReliable":case 0:s.TransportMethod=0;break;case"LivekitUnreliable":case 1:s.TransportMethod=1;break;case"DirectUnreliable":case 3:s.TransportMethod=3;break}return s},e.toObject=function(a,s){s||(s={});let c={};if((s.arrays||s.defaults)&&(c.TargetUserIds=[]),s.defaults&&(c.TransportMethod=s.enums===String?"LivekitReliable":0),a.TargetUserIds&&a.TargetUserIds.length){c.TargetUserIds=[];for(let u=0;u<a.TargetUserIds.length;++u)c.TargetUserIds[u]=a.TargetUserIds[u]}return a.TransportMethod!=null&&a.hasOwnProperty("TransportMethod")&&(c.TransportMethod=s.enums===String?$root.rov_actions_proto.DataTransportMethod[a.TransportMethod]===void 0?a.TransportMethod:$root.rov_actions_proto.DataTransportMethod[a.TransportMethod]:a.TransportMethod),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(a){return a===void 0&&(a="type.googleapis.com"),a+"/rov_actions_proto.ResponseBackendMetadata"},e}(),t.RovResponse=function(){function e(a){if(a)for(let s=Object.keys(a),c=0;c<s.length;++c)a[s[c]]!=null&&(this[s[c]]=a[s[c]])}e.prototype.BackendMetadata=null,e.prototype.ExchangeId=0,e.prototype.Done=null,e.prototype.Error=null,e.prototype.Pong=null,e.prototype.ContinuedOutput=null,e.prototype.SensorUpdates=null,e.prototype.PasswordRequired=null,e.prototype.PasswordAccepted=null,e.prototype.PasswordInvalid=null,e.prototype.DriverChanged=null,e.prototype.ClientConnected=null,e.prototype.ClientDisconnected=null,e.prototype.Heartbeat=null,e.prototype.Mavlink=null,e.prototype.SimplepeerSignal=null,e.prototype.SystemMonitor=null,e.prototype.LogMessage=null;let n;return Object.defineProperty(e.prototype,"Body",{get:$util.oneOfGetter(n=["Done","Error","Pong","ContinuedOutput","SensorUpdates","PasswordRequired","PasswordAccepted","PasswordInvalid","DriverChanged","ClientConnected","ClientDisconnected","Heartbeat","Mavlink","SimplepeerSignal","SystemMonitor","LogMessage"]),set:$util.oneOfSetter(n)}),e.create=function(s){return new e(s)},e.encode=function(s,c){return c||(c=$Writer.create()),s.BackendMetadata!=null&&Object.hasOwnProperty.call(s,"BackendMetadata")&&$root.rov_actions_proto.ResponseBackendMetadata.encode(s.BackendMetadata,c.uint32(10).fork()).ldelim(),s.ExchangeId!=null&&Object.hasOwnProperty.call(s,"ExchangeId")&&c.uint32(16).int32(s.ExchangeId),s.Done!=null&&Object.hasOwnProperty.call(s,"Done")&&$root.rov_actions_proto.DoneResponse.encode(s.Done,c.uint32(26).fork()).ldelim(),s.Error!=null&&Object.hasOwnProperty.call(s,"Error")&&$root.rov_actions_proto.ErrorResponse.encode(s.Error,c.uint32(34).fork()).ldelim(),s.Pong!=null&&Object.hasOwnProperty.call(s,"Pong")&&$root.rov_actions_proto.PongResponse.encode(s.Pong,c.uint32(42).fork()).ldelim(),s.ContinuedOutput!=null&&Object.hasOwnProperty.call(s,"ContinuedOutput")&&$root.rov_actions_proto.ContinuedOutputResponse.encode(s.ContinuedOutput,c.uint32(50).fork()).ldelim(),s.SensorUpdates!=null&&Object.hasOwnProperty.call(s,"SensorUpdates")&&$root.rov_actions_proto.SensorUpdatesResponse.encode(s.SensorUpdates,c.uint32(58).fork()).ldelim(),s.PasswordRequired!=null&&Object.hasOwnProperty.call(s,"PasswordRequired")&&$root.rov_actions_proto.PasswordRequiredResponse.encode(s.PasswordRequired,c.uint32(66).fork()).ldelim(),s.PasswordAccepted!=null&&Object.hasOwnProperty.call(s,"PasswordAccepted")&&$root.rov_actions_proto.PasswordAcceptedResponse.encode(s.PasswordAccepted,c.uint32(74).fork()).ldelim(),s.PasswordInvalid!=null&&Object.hasOwnProperty.call(s,"PasswordInvalid")&&$root.rov_actions_proto.PasswordInvalidResponse.encode(s.PasswordInvalid,c.uint32(82).fork()).ldelim(),s.DriverChanged!=null&&Object.hasOwnProperty.call(s,"DriverChanged")&&$root.rov_actions_proto.DriverChangedResponse.encode(s.DriverChanged,c.uint32(106).fork()).ldelim(),s.ClientConnected!=null&&Object.hasOwnProperty.call(s,"ClientConnected")&&$root.rov_actions_proto.ClientConnectedResponse.encode(s.ClientConnected,c.uint32(114).fork()).ldelim(),s.ClientDisconnected!=null&&Object.hasOwnProperty.call(s,"ClientDisconnected")&&$root.rov_actions_proto.ClientDisconnectedResponse.encode(s.ClientDisconnected,c.uint32(122).fork()).ldelim(),s.Heartbeat!=null&&Object.hasOwnProperty.call(s,"Heartbeat")&&$root.rov_actions_proto.HeartbeatResponse.encode(s.Heartbeat,c.uint32(130).fork()).ldelim(),s.Mavlink!=null&&Object.hasOwnProperty.call(s,"Mavlink")&&$root.rov_actions_proto.MavlinkResponse.encode(s.Mavlink,c.uint32(138).fork()).ldelim(),s.SimplepeerSignal!=null&&Object.hasOwnProperty.call(s,"SimplepeerSignal")&&$root.rov_actions_proto.SimplepeerSignalResponse.encode(s.SimplepeerSignal,c.uint32(146).fork()).ldelim(),s.SystemMonitor!=null&&Object.hasOwnProperty.call(s,"SystemMonitor")&&$root.rov_actions_proto.SystemMonitorResponse.encode(s.SystemMonitor,c.uint32(154).fork()).ldelim(),s.LogMessage!=null&&Object.hasOwnProperty.call(s,"LogMessage")&&$root.rov_actions_proto.LogMessageResponse.encode(s.LogMessage,c.uint32(162).fork()).ldelim(),c},e.encodeDelimited=function(s,c){return this.encode(s,c).ldelim()},e.decode=function(s,c){s instanceof $Reader||(s=$Reader.create(s));let u=c===void 0?s.len:s.pos+c,d=new $root.rov_actions_proto.RovResponse;for(;s.pos<u;){let m=s.uint32();switch(m>>>3){case 1:{d.BackendMetadata=$root.rov_actions_proto.ResponseBackendMetadata.decode(s,s.uint32());break}case 2:{d.ExchangeId=s.int32();break}case 3:{d.Done=$root.rov_actions_proto.DoneResponse.decode(s,s.uint32());break}case 4:{d.Error=$root.rov_actions_proto.ErrorResponse.decode(s,s.uint32());break}case 5:{d.Pong=$root.rov_actions_proto.PongResponse.decode(s,s.uint32());break}case 6:{d.ContinuedOutput=$root.rov_actions_proto.ContinuedOutputResponse.decode(s,s.uint32());break}case 7:{d.SensorUpdates=$root.rov_actions_proto.SensorUpdatesResponse.decode(s,s.uint32());break}case 8:{d.PasswordRequired=$root.rov_actions_proto.PasswordRequiredResponse.decode(s,s.uint32());break}case 9:{d.PasswordAccepted=$root.rov_actions_proto.PasswordAcceptedResponse.decode(s,s.uint32());break}case 10:{d.PasswordInvalid=$root.rov_actions_proto.PasswordInvalidResponse.decode(s,s.uint32());break}case 13:{d.DriverChanged=$root.rov_actions_proto.DriverChangedResponse.decode(s,s.uint32());break}case 14:{d.ClientConnected=$root.rov_actions_proto.ClientConnectedResponse.decode(s,s.uint32());break}case 15:{d.ClientDisconnected=$root.rov_actions_proto.ClientDisconnectedResponse.decode(s,s.uint32());break}case 16:{d.Heartbeat=$root.rov_actions_proto.HeartbeatResponse.decode(s,s.uint32());break}case 17:{d.Mavlink=$root.rov_actions_proto.MavlinkResponse.decode(s,s.uint32());break}case 18:{d.SimplepeerSignal=$root.rov_actions_proto.SimplepeerSignalResponse.decode(s,s.uint32());break}case 19:{d.SystemMonitor=$root.rov_actions_proto.SystemMonitorResponse.decode(s,s.uint32());break}case 20:{d.LogMessage=$root.rov_actions_proto.LogMessageResponse.decode(s,s.uint32());break}default:s.skipType(m&7);break}}return d},e.decodeDelimited=function(s){return s instanceof $Reader||(s=new $Reader(s)),this.decode(s,s.uint32())},e.verify=function(s){if(typeof s!="object"||s===null)return"object expected";let c={};if(s.BackendMetadata!=null&&s.hasOwnProperty("BackendMetadata")){let u=$root.rov_actions_proto.ResponseBackendMetadata.verify(s.BackendMetadata);if(u)return"BackendMetadata."+u}if(s.ExchangeId!=null&&s.hasOwnProperty("ExchangeId")&&!$util.isInteger(s.ExchangeId))return"ExchangeId: integer expected";if(s.Done!=null&&s.hasOwnProperty("Done")){c.Body=1;{let u=$root.rov_actions_proto.DoneResponse.verify(s.Done);if(u)return"Done."+u}}if(s.Error!=null&&s.hasOwnProperty("Error")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.ErrorResponse.verify(s.Error);if(u)return"Error."+u}}if(s.Pong!=null&&s.hasOwnProperty("Pong")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.PongResponse.verify(s.Pong);if(u)return"Pong."+u}}if(s.ContinuedOutput!=null&&s.hasOwnProperty("ContinuedOutput")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.ContinuedOutputResponse.verify(s.ContinuedOutput);if(u)return"ContinuedOutput."+u}}if(s.SensorUpdates!=null&&s.hasOwnProperty("SensorUpdates")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.SensorUpdatesResponse.verify(s.SensorUpdates);if(u)return"SensorUpdates."+u}}if(s.PasswordRequired!=null&&s.hasOwnProperty("PasswordRequired")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.PasswordRequiredResponse.verify(s.PasswordRequired);if(u)return"PasswordRequired."+u}}if(s.PasswordAccepted!=null&&s.hasOwnProperty("PasswordAccepted")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.PasswordAcceptedResponse.verify(s.PasswordAccepted);if(u)return"PasswordAccepted."+u}}if(s.PasswordInvalid!=null&&s.hasOwnProperty("PasswordInvalid")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.PasswordInvalidResponse.verify(s.PasswordInvalid);if(u)return"PasswordInvalid."+u}}if(s.DriverChanged!=null&&s.hasOwnProperty("DriverChanged")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.DriverChangedResponse.verify(s.DriverChanged);if(u)return"DriverChanged."+u}}if(s.ClientConnected!=null&&s.hasOwnProperty("ClientConnected")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.ClientConnectedResponse.verify(s.ClientConnected);if(u)return"ClientConnected."+u}}if(s.ClientDisconnected!=null&&s.hasOwnProperty("ClientDisconnected")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.ClientDisconnectedResponse.verify(s.ClientDisconnected);if(u)return"ClientDisconnected."+u}}if(s.Heartbeat!=null&&s.hasOwnProperty("Heartbeat")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.HeartbeatResponse.verify(s.Heartbeat);if(u)return"Heartbeat."+u}}if(s.Mavlink!=null&&s.hasOwnProperty("Mavlink")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.MavlinkResponse.verify(s.Mavlink);if(u)return"Mavlink."+u}}if(s.SimplepeerSignal!=null&&s.hasOwnProperty("SimplepeerSignal")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.SimplepeerSignalResponse.verify(s.SimplepeerSignal);if(u)return"SimplepeerSignal."+u}}if(s.SystemMonitor!=null&&s.hasOwnProperty("SystemMonitor")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.SystemMonitorResponse.verify(s.SystemMonitor);if(u)return"SystemMonitor."+u}}if(s.LogMessage!=null&&s.hasOwnProperty("LogMessage")){if(c.Body===1)return"Body: multiple values";c.Body=1;{let u=$root.rov_actions_proto.LogMessageResponse.verify(s.LogMessage);if(u)return"LogMessage."+u}}return null},e.fromObject=function(s){if(s instanceof $root.rov_actions_proto.RovResponse)return s;let c=new $root.rov_actions_proto.RovResponse;if(s.BackendMetadata!=null){if(typeof s.BackendMetadata!="object")throw TypeError(".rov_actions_proto.RovResponse.BackendMetadata: object expected");c.BackendMetadata=$root.rov_actions_proto.ResponseBackendMetadata.fromObject(s.BackendMetadata)}if(s.ExchangeId!=null&&(c.ExchangeId=s.ExchangeId|0),s.Done!=null){if(typeof s.Done!="object")throw TypeError(".rov_actions_proto.RovResponse.Done: object expected");c.Done=$root.rov_actions_proto.DoneResponse.fromObject(s.Done)}if(s.Error!=null){if(typeof s.Error!="object")throw TypeError(".rov_actions_proto.RovResponse.Error: object expected");c.Error=$root.rov_actions_proto.ErrorResponse.fromObject(s.Error)}if(s.Pong!=null){if(typeof s.Pong!="object")throw TypeError(".rov_actions_proto.RovResponse.Pong: object expected");c.Pong=$root.rov_actions_proto.PongResponse.fromObject(s.Pong)}if(s.ContinuedOutput!=null){if(typeof s.ContinuedOutput!="object")throw TypeError(".rov_actions_proto.RovResponse.ContinuedOutput: object expected");c.ContinuedOutput=$root.rov_actions_proto.ContinuedOutputResponse.fromObject(s.ContinuedOutput)}if(s.SensorUpdates!=null){if(typeof s.SensorUpdates!="object")throw TypeError(".rov_actions_proto.RovResponse.SensorUpdates: object expected");c.SensorUpdates=$root.rov_actions_proto.SensorUpdatesResponse.fromObject(s.SensorUpdates)}if(s.PasswordRequired!=null){if(typeof s.PasswordRequired!="object")throw TypeError(".rov_actions_proto.RovResponse.PasswordRequired: object expected");c.PasswordRequired=$root.rov_actions_proto.PasswordRequiredResponse.fromObject(s.PasswordRequired)}if(s.PasswordAccepted!=null){if(typeof s.PasswordAccepted!="object")throw TypeError(".rov_actions_proto.RovResponse.PasswordAccepted: object expected");c.PasswordAccepted=$root.rov_actions_proto.PasswordAcceptedResponse.fromObject(s.PasswordAccepted)}if(s.PasswordInvalid!=null){if(typeof s.PasswordInvalid!="object")throw TypeError(".rov_actions_proto.RovResponse.PasswordInvalid: object expected");c.PasswordInvalid=$root.rov_actions_proto.PasswordInvalidResponse.fromObject(s.PasswordInvalid)}if(s.DriverChanged!=null){if(typeof s.DriverChanged!="object")throw TypeError(".rov_actions_proto.RovResponse.DriverChanged: object expected");c.DriverChanged=$root.rov_actions_proto.DriverChangedResponse.fromObject(s.DriverChanged)}if(s.ClientConnected!=null){if(typeof s.ClientConnected!="object")throw TypeError(".rov_actions_proto.RovResponse.ClientConnected: object expected");c.ClientConnected=$root.rov_actions_proto.ClientConnectedResponse.fromObject(s.ClientConnected)}if(s.ClientDisconnected!=null){if(typeof s.ClientDisconnected!="object")throw TypeError(".rov_actions_proto.RovResponse.ClientDisconnected: object expected");c.ClientDisconnected=$root.rov_actions_proto.ClientDisconnectedResponse.fromObject(s.ClientDisconnected)}if(s.Heartbeat!=null){if(typeof s.Heartbeat!="object")throw TypeError(".rov_actions_proto.RovResponse.Heartbeat: object expected");c.Heartbeat=$root.rov_actions_proto.HeartbeatResponse.fromObject(s.Heartbeat)}if(s.Mavlink!=null){if(typeof s.Mavlink!="object")throw TypeError(".rov_actions_proto.RovResponse.Mavlink: object expected");c.Mavlink=$root.rov_actions_proto.MavlinkResponse.fromObject(s.Mavlink)}if(s.SimplepeerSignal!=null){if(typeof s.SimplepeerSignal!="object")throw TypeError(".rov_actions_proto.RovResponse.SimplepeerSignal: object expected");c.SimplepeerSignal=$root.rov_actions_proto.SimplepeerSignalResponse.fromObject(s.SimplepeerSignal)}if(s.SystemMonitor!=null){if(typeof s.SystemMonitor!="object")throw TypeError(".rov_actions_proto.RovResponse.SystemMonitor: object expected");c.SystemMonitor=$root.rov_actions_proto.SystemMonitorResponse.fromObject(s.SystemMonitor)}if(s.LogMessage!=null){if(typeof s.LogMessage!="object")throw TypeError(".rov_actions_proto.RovResponse.LogMessage: object expected");c.LogMessage=$root.rov_actions_proto.LogMessageResponse.fromObject(s.LogMessage)}return c},e.toObject=function(s,c){c||(c={});let u={};return c.defaults&&(u.BackendMetadata=null,u.ExchangeId=0),s.BackendMetadata!=null&&s.hasOwnProperty("BackendMetadata")&&(u.BackendMetadata=$root.rov_actions_proto.ResponseBackendMetadata.toObject(s.BackendMetadata,c)),s.ExchangeId!=null&&s.hasOwnProperty("ExchangeId")&&(u.ExchangeId=s.ExchangeId),s.Done!=null&&s.hasOwnProperty("Done")&&(u.Done=$root.rov_actions_proto.DoneResponse.toObject(s.Done,c),c.oneofs&&(u.Body="Done")),s.Error!=null&&s.hasOwnProperty("Error")&&(u.Error=$root.rov_actions_proto.ErrorResponse.toObject(s.Error,c),c.oneofs&&(u.Body="Error")),s.Pong!=null&&s.hasOwnProperty("Pong")&&(u.Pong=$root.rov_actions_proto.PongResponse.toObject(s.Pong,c),c.oneofs&&(u.Body="Pong")),s.ContinuedOutput!=null&&s.hasOwnProperty("ContinuedOutput")&&(u.ContinuedOutput=$root.rov_actions_proto.ContinuedOutputResponse.toObject(s.ContinuedOutput,c),c.oneofs&&(u.Body="ContinuedOutput")),s.SensorUpdates!=null&&s.hasOwnProperty("SensorUpdates")&&(u.SensorUpdates=$root.rov_actions_proto.SensorUpdatesResponse.toObject(s.SensorUpdates,c),c.oneofs&&(u.Body="SensorUpdates")),s.PasswordRequired!=null&&s.hasOwnProperty("PasswordRequired")&&(u.PasswordRequired=$root.rov_actions_proto.PasswordRequiredResponse.toObject(s.PasswordRequired,c),c.oneofs&&(u.Body="PasswordRequired")),s.PasswordAccepted!=null&&s.hasOwnProperty("PasswordAccepted")&&(u.PasswordAccepted=$root.rov_actions_proto.PasswordAcceptedResponse.toObject(s.PasswordAccepted,c),c.oneofs&&(u.Body="PasswordAccepted")),s.PasswordInvalid!=null&&s.hasOwnProperty("PasswordInvalid")&&(u.PasswordInvalid=$root.rov_actions_proto.PasswordInvalidResponse.toObject(s.PasswordInvalid,c),c.oneofs&&(u.Body="PasswordInvalid")),s.DriverChanged!=null&&s.hasOwnProperty("DriverChanged")&&(u.DriverChanged=$root.rov_actions_proto.DriverChangedResponse.toObject(s.DriverChanged,c),c.oneofs&&(u.Body="DriverChanged")),s.ClientConnected!=null&&s.hasOwnProperty("ClientConnected")&&(u.ClientConnected=$root.rov_actions_proto.ClientConnectedResponse.toObject(s.ClientConnected,c),c.oneofs&&(u.Body="ClientConnected")),s.ClientDisconnected!=null&&s.hasOwnProperty("ClientDisconnected")&&(u.ClientDisconnected=$root.rov_actions_proto.ClientDisconnectedResponse.toObject(s.ClientDisconnected,c),c.oneofs&&(u.Body="ClientDisconnected")),s.Heartbeat!=null&&s.hasOwnProperty("Heartbeat")&&(u.Heartbeat=$root.rov_actions_proto.HeartbeatResponse.toObject(s.Heartbeat,c),c.oneofs&&(u.Body="Heartbeat")),s.Mavlink!=null&&s.hasOwnProperty("Mavlink")&&(u.Mavlink=$root.rov_actions_proto.MavlinkResponse.toObject(s.Mavlink,c),c.oneofs&&(u.Body="Mavlink")),s.SimplepeerSignal!=null&&s.hasOwnProperty("SimplepeerSignal")&&(u.SimplepeerSignal=$root.rov_actions_proto.SimplepeerSignalResponse.toObject(s.SimplepeerSignal,c),c.oneofs&&(u.Body="SimplepeerSignal")),s.SystemMonitor!=null&&s.hasOwnProperty("SystemMonitor")&&(u.SystemMonitor=$root.rov_actions_proto.SystemMonitorResponse.toObject(s.SystemMonitor,c),c.oneofs&&(u.Body="SystemMonitor")),s.LogMessage!=null&&s.hasOwnProperty("LogMessage")&&(u.LogMessage=$root.rov_actions_proto.LogMessageResponse.toObject(s.LogMessage,c),c.oneofs&&(u.Body="LogMessage")),u},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal.util.toJSONOptions)},e.getTypeUrl=function(s){return s===void 0&&(s="type.googleapis.com"),s+"/rov_actions_proto.RovResponse"},e}(),t})();var browser$2={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var t=1e3,e=t*60,n=e*60,a=n*24,s=a*7,c=a*365.25;ms=function(b,S){S=S||{};var k=typeof b;if(k==="string"&&b.length>0)return u(b);if(k==="number"&&isFinite(b))return S.long?m(b):d(b);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(b))};function u(b){if(b=String(b),!(b.length>100)){var S=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(b);if(S){var k=parseFloat(S[1]),w=(S[2]||"ms").toLowerCase();switch(w){case"years":case"year":case"yrs":case"yr":case"y":return k*c;case"weeks":case"week":case"w":return k*s;case"days":case"day":case"d":return k*a;case"hours":case"hour":case"hrs":case"hr":case"h":return k*n;case"minutes":case"minute":case"mins":case"min":case"m":return k*e;case"seconds":case"second":case"secs":case"sec":case"s":return k*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return k;default:return}}}}function d(b){var S=Math.abs(b);return S>=a?Math.round(b/a)+"d":S>=n?Math.round(b/n)+"h":S>=e?Math.round(b/e)+"m":S>=t?Math.round(b/t)+"s":b+"ms"}function m(b){var S=Math.abs(b);return S>=a?_(b,S,a,"day"):S>=n?_(b,S,n,"hour"):S>=e?_(b,S,e,"minute"):S>=t?_(b,S,t,"second"):b+" ms"}function _(b,S,k,w){var O=S>=k*1.5;return Math.round(b/k)+" "+w+(O?"s":"")}return ms}function setup(t){n.debug=n,n.default=n,n.coerce=m,n.disable=c,n.enable=s,n.enabled=u,n.humanize=requireMs(),n.destroy=_,Object.keys(t).forEach(b=>{n[b]=t[b]}),n.names=[],n.skips=[],n.formatters={};function e(b){let S=0;for(let k=0;k<b.length;k++)S=(S<<5)-S+b.charCodeAt(k),S|=0;return n.colors[Math.abs(S)%n.colors.length]}n.selectColor=e;function n(b){let S,k=null,w,O;function P(...N){if(!P.enabled)return;const I=P,U=Number(new Date),$=U-(S||U);I.diff=$,I.prev=S,I.curr=U,S=U,N[0]=n.coerce(N[0]),typeof N[0]!="string"&&N.unshift("%O");let x=0;N[0]=N[0].replace(/%([a-zA-Z%])/g,(H,q)=>{if(H==="%%")return"%";x++;const K=n.formatters[q];if(typeof K=="function"){const W=N[x];H=K.call(I,W),N.splice(x,1),x--}return H}),n.formatArgs.call(I,N),(I.log||n.log).apply(I,N)}return P.namespace=b,P.useColors=n.useColors(),P.color=n.selectColor(b),P.extend=a,P.destroy=n.destroy,Object.defineProperty(P,"enabled",{enumerable:!0,configurable:!1,get:()=>k!==null?k:(w!==n.namespaces&&(w=n.namespaces,O=n.enabled(b)),O),set:N=>{k=N}}),typeof n.init=="function"&&n.init(P),P}function a(b,S){const k=n(this.namespace+(typeof S>"u"?":":S)+b);return k.log=this.log,k}function s(b){n.save(b),n.namespaces=b,n.names=[],n.skips=[];let S;const k=(typeof b=="string"?b:"").split(/[\s,]+/),w=k.length;for(S=0;S<w;S++)k[S]&&(b=k[S].replace(/\*/g,".*?"),b[0]==="-"?n.skips.push(new RegExp("^"+b.slice(1)+"$")):n.names.push(new RegExp("^"+b+"$")))}function c(){const b=[...n.names.map(d),...n.skips.map(d).map(S=>"-"+S)].join(",");return n.enable(""),b}function u(b){if(b[b.length-1]==="*")return!0;let S,k;for(S=0,k=n.skips.length;S<k;S++)if(n.skips[S].test(b))return!1;for(S=0,k=n.names.length;S<k;S++)if(n.names[S].test(b))return!0;return!1}function d(b){return b.toString().substring(2,b.toString().length-2).replace(/\.\*\?$/,"*")}function m(b){return b instanceof Error?b.stack||b.message:b}function _(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var common=setup;(function(t,e){e.formatArgs=a,e.save=s,e.load=c,e.useColors=n,e.storage=u(),e.destroy=(()=>{let m=!1;return()=>{m||(m=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(m){if(m[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+m[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const _="color: "+this.color;m.splice(1,0,_,"color: inherit");let b=0,S=0;m[0].replace(/%[a-zA-Z%]/g,k=>{k!=="%%"&&(b++,k==="%c"&&(S=b))}),m.splice(S,0,_)}e.log=console.debug||console.log||(()=>{});function s(m){try{m?e.storage.setItem("debug",m):e.storage.removeItem("debug")}catch{}}function c(){let m;try{m=e.storage.getItem("debug")}catch{}return!m&&typeof dist.process<"u"&&"env"in dist.process&&(m={}.DEBUG),m}function u(){try{return localStorage}catch{}}t.exports=common(e);const{formatters:d}=t.exports;d.j=function(m){try{return JSON.stringify(m)}catch(_){return"[UnexpectedJSONParseError]: "+_.message}}})(browser$2,browser$2.exports);var browserExports$1=browser$2.exports,getBrowserRtc=function t(){if(typeof globalThis>"u")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null},browser$1={exports:{}},safeBuffer={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(t,e){var n=buffer,a=n.Buffer;function s(u,d){for(var m in u)d[m]=u[m]}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?t.exports=n:(s(n,e),e.Buffer=c);function c(u,d,m){return a(u,d,m)}c.prototype=Object.create(a.prototype),s(a,c),c.from=function(u,d,m){if(typeof u=="number")throw new TypeError("Argument must not be a number");return a(u,d,m)},c.alloc=function(u,d,m){if(typeof u!="number")throw new TypeError("Argument must be a number");var _=a(u);return d!==void 0?typeof m=="string"?_.fill(d,m):_.fill(d):_.fill(0),_},c.allocUnsafe=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return a(u)},c.allocUnsafeSlow=function(u){if(typeof u!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(u)}})(safeBuffer,safeBuffer.exports);var safeBufferExports=safeBuffer.exports,MAX_BYTES=65536,MAX_UINT32=4294967295;function oldBrowser(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var Buffer$1=safeBufferExports.Buffer,crypto=commonjsGlobal$1.crypto||commonjsGlobal$1.msCrypto;crypto&&crypto.getRandomValues?browser$1.exports=randomBytes:browser$1.exports=oldBrowser;function randomBytes(t,e){if(t>MAX_UINT32)throw new RangeError("requested too many random bytes");var n=Buffer$1.allocUnsafe(t);if(t>0)if(t>MAX_BYTES)for(var a=0;a<t;a+=MAX_BYTES)crypto.getRandomValues(n.slice(a,a+MAX_BYTES));else crypto.getRandomValues(n);return typeof e=="function"?dist.process.nextTick(function(){e(null,n)}):n}var browserExports=browser$1.exports,readableBrowser={exports:{}},events={exports:{}},R=typeof Reflect=="object"?Reflect:null,ReflectApply=R&&typeof R.apply=="function"?R.apply:function t(e,n,a){return Function.prototype.apply.call(e,n,a)},ReflectOwnKeys;R&&typeof R.ownKeys=="function"?ReflectOwnKeys=R.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ReflectOwnKeys=function(e){return Object.getOwnPropertyNames(e)};function ProcessEmitWarning(t){console&&console.warn&&console.warn(t)}var NumberIsNaN=Number.isNaN||function t(e){return e!==e};function EventEmitter(){EventEmitter.init.call(this)}events.exports=EventEmitter;events.exports.once=once$2;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=void 0;EventEmitter.prototype._eventsCount=0;EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(t){if(typeof t!="number"||t<0||NumberIsNaN(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");defaultMaxListeners=t}});EventEmitter.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};EventEmitter.prototype.setMaxListeners=function t(e){if(typeof e!="number"||e<0||NumberIsNaN(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function _getMaxListeners(t){return t._maxListeners===void 0?EventEmitter.defaultMaxListeners:t._maxListeners}EventEmitter.prototype.getMaxListeners=function t(){return _getMaxListeners(this)};EventEmitter.prototype.emit=function t(e){for(var n=[],a=1;a<arguments.length;a++)n.push(arguments[a]);var s=e==="error",c=this._events;if(c!==void 0)s=s&&c.error===void 0;else if(!s)return!1;if(s){var u;if(n.length>0&&(u=n[0]),u instanceof Error)throw u;var d=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw d.context=u,d}var m=c[e];if(m===void 0)return!1;if(typeof m=="function")ReflectApply(m,this,n);else for(var _=m.length,b=arrayClone(m,_),a=0;a<_;++a)ReflectApply(b[a],this,n);return!0};function _addListener(t,e,n,a){var s,c,u;if(checkListener(n),c=t._events,c===void 0?(c=t._events=Object.create(null),t._eventsCount=0):(c.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),c=t._events),u=c[e]),u===void 0)u=c[e]=n,++t._eventsCount;else if(typeof u=="function"?u=c[e]=a?[n,u]:[u,n]:a?u.unshift(n):u.push(n),s=_getMaxListeners(t),s>0&&u.length>s&&!u.warned){u.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=t,d.type=e,d.count=u.length,ProcessEmitWarning(d)}return t}EventEmitter.prototype.addListener=function t(e,n){return _addListener(this,e,n,!1)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function t(e,n){return _addListener(this,e,n,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(t,e,n){var a={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},s=onceWrapper.bind(a);return s.listener=n,a.wrapFn=s,s}EventEmitter.prototype.once=function t(e,n){return checkListener(n),this.on(e,_onceWrap(this,e,n)),this};EventEmitter.prototype.prependOnceListener=function t(e,n){return checkListener(n),this.prependListener(e,_onceWrap(this,e,n)),this};EventEmitter.prototype.removeListener=function t(e,n){var a,s,c,u,d;if(checkListener(n),s=this._events,s===void 0)return this;if(a=s[e],a===void 0)return this;if(a===n||a.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,a.listener||n));else if(typeof a!="function"){for(c=-1,u=a.length-1;u>=0;u--)if(a[u]===n||a[u].listener===n){d=a[u].listener,c=u;break}if(c<0)return this;c===0?a.shift():spliceOne(a,c),a.length===1&&(s[e]=a[0]),s.removeListener!==void 0&&this.emit("removeListener",e,d||n)}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.removeAllListeners=function t(e){var n,a,s;if(a=this._events,a===void 0)return this;if(a.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):a[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete a[e]),this;if(arguments.length===0){var c=Object.keys(a),u;for(s=0;s<c.length;++s)u=c[s],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=a[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(s=n.length-1;s>=0;s--)this.removeListener(e,n[s]);return this};function _listeners(t,e,n){var a=t._events;if(a===void 0)return[];var s=a[e];return s===void 0?[]:typeof s=="function"?n?[s.listener||s]:[s]:n?unwrapListeners(s):arrayClone(s,s.length)}EventEmitter.prototype.listeners=function t(e){return _listeners(this,e,!0)};EventEmitter.prototype.rawListeners=function t(e){return _listeners(this,e,!1)};EventEmitter.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):listenerCount.call(t,e)};EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}EventEmitter.prototype.eventNames=function t(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(t,e){for(var n=new Array(e),a=0;a<e;++a)n[a]=t[a];return n}function spliceOne(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function unwrapListeners(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function once$2(t,e){return new Promise(function(n,a){function s(u){t.removeListener(e,c),a(u)}function c(){typeof t.removeListener=="function"&&t.removeListener("error",s),n([].slice.call(arguments))}eventTargetAgnosticAddListener(t,e,c,{once:!0}),e!=="error"&&addErrorHandlerIfEventEmitter(t,s,{once:!0})})}function addErrorHandlerIfEventEmitter(t,e,n){typeof t.on=="function"&&eventTargetAgnosticAddListener(t,"error",e,n)}function eventTargetAgnosticAddListener(t,e,n,a){if(typeof t.on=="function")a.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function s(c){a.once&&t.removeEventListener(e,s),n(c)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var eventsExports=events.exports,streamBrowser=eventsExports.EventEmitter,util={},types={},shams$1=function t(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},n=Symbol("test"),a=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(a)!=="[object Symbol]")return!1;var s=42;e[n]=s;for(n in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var c=Object.getOwnPropertySymbols(e);if(c.length!==1||c[0]!==n||!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(e,n);if(u.value!==s||u.enumerable!==!0)return!1}return!0},hasSymbols$2=shams$1,shams=function t(){return hasSymbols$2()&&!!Symbol.toStringTag},origSymbol=typeof Symbol<"u"&&Symbol,hasSymbolSham=shams$1,hasSymbols$1=function t(){return typeof origSymbol!="function"||typeof Symbol!="function"||typeof origSymbol("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:hasSymbolSham()},test={foo:{}},$Object=Object,hasProto$1=function t(){return{__proto__:test}.foo===test.foo&&!({__proto__:null}instanceof $Object)},ERROR_MESSAGE="Function.prototype.bind called on incompatible ",toStr$3=Object.prototype.toString,max$1=Math.max,funcType="[object Function]",concatty=function t(e,n){for(var a=[],s=0;s<e.length;s+=1)a[s]=e[s];for(var c=0;c<n.length;c+=1)a[c+e.length]=n[c];return a},slicy=function t(e,n){for(var a=[],s=n||0,c=0;s<e.length;s+=1,c+=1)a[c]=e[s];return a},joiny=function(t,e){for(var n="",a=0;a<t.length;a+=1)n+=t[a],a+1<t.length&&(n+=e);return n},implementation$1=function t(e){var n=this;if(typeof n!="function"||toStr$3.apply(n)!==funcType)throw new TypeError(ERROR_MESSAGE+n);for(var a=slicy(arguments,1),s,c=function(){if(this instanceof s){var b=n.apply(this,concatty(a,arguments));return Object(b)===b?b:this}return n.apply(e,concatty(a,arguments))},u=max$1(0,n.length-a.length),d=[],m=0;m<u;m++)d[m]="$"+m;if(s=Function("binder","return function ("+joiny(d,",")+"){ return binder.apply(this,arguments); }")(c),n.prototype){var _=function(){};_.prototype=n.prototype,s.prototype=new _,_.prototype=null}return s},implementation=implementation$1,functionBind=Function.prototype.bind||implementation,call$1=Function.prototype.call,$hasOwn=Object.prototype.hasOwnProperty,bind$1=functionBind,hasown=bind$1.call(call$1,$hasOwn),undefined$1,$SyntaxError$1=SyntaxError,$Function=Function,$TypeError$2=TypeError,getEvalledConstructor=function(t){try{return $Function('"use strict"; return ('+t+").constructor;")()}catch{}},$gOPD$1=Object.getOwnPropertyDescriptor;if($gOPD$1)try{$gOPD$1({},"")}catch{$gOPD$1=null}var throwTypeError=function(){throw new $TypeError$2},ThrowTypeError=$gOPD$1?function(){try{return arguments.callee,throwTypeError}catch{try{return $gOPD$1(arguments,"callee").get}catch{return throwTypeError}}}():throwTypeError,hasSymbols=hasSymbols$1(),hasProto=hasProto$1(),getProto$1=Object.getPrototypeOf||(hasProto?function(t){return t.__proto__}:null),needsEval={},TypedArray=typeof Uint8Array>"u"||!getProto$1?undefined$1:getProto$1(Uint8Array),INTRINSICS={"%AggregateError%":typeof AggregateError>"u"?undefined$1:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?undefined$1:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols&&getProto$1?getProto$1([][Symbol.iterator]()):undefined$1,"%AsyncFromSyncIteratorPrototype%":undefined$1,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":typeof Atomics>"u"?undefined$1:Atomics,"%BigInt%":typeof BigInt>"u"?undefined$1:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?undefined$1:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?undefined$1:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?undefined$1:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?undefined$1:Float32Array,"%Float64Array%":typeof Float64Array>"u"?undefined$1:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?undefined$1:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":typeof Int8Array>"u"?undefined$1:Int8Array,"%Int16Array%":typeof Int16Array>"u"?undefined$1:Int16Array,"%Int32Array%":typeof Int32Array>"u"?undefined$1:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols&&getProto$1?getProto$1(getProto$1([][Symbol.iterator]())):undefined$1,"%JSON%":typeof JSON=="object"?JSON:undefined$1,"%Map%":typeof Map>"u"?undefined$1:Map,"%MapIteratorPrototype%":typeof Map>"u"||!hasSymbols||!getProto$1?undefined$1:getProto$1(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?undefined$1:Promise,"%Proxy%":typeof Proxy>"u"?undefined$1:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?undefined$1:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?undefined$1:Set,"%SetIteratorPrototype%":typeof Set>"u"||!hasSymbols||!getProto$1?undefined$1:getProto$1(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?undefined$1:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols&&getProto$1?getProto$1(""[Symbol.iterator]()):undefined$1,"%Symbol%":hasSymbols?Symbol:undefined$1,"%SyntaxError%":$SyntaxError$1,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError$2,"%Uint8Array%":typeof Uint8Array>"u"?undefined$1:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?undefined$1:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?undefined$1:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?undefined$1:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?undefined$1:WeakMap,"%WeakRef%":typeof WeakRef>"u"?undefined$1:WeakRef,"%WeakSet%":typeof WeakSet>"u"?undefined$1:WeakSet};if(getProto$1)try{null.error}catch(t){var errorProto=getProto$1(getProto$1(t));INTRINSICS["%Error.prototype%"]=errorProto}var doEval=function t(e){var n;if(e==="%AsyncFunction%")n=getEvalledConstructor("async function () {}");else if(e==="%GeneratorFunction%")n=getEvalledConstructor("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=getEvalledConstructor("async function* () {}");else if(e==="%AsyncGenerator%"){var a=t("%AsyncGeneratorFunction%");a&&(n=a.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=t("%AsyncGenerator%");s&&getProto$1&&(n=getProto$1(s.prototype))}return INTRINSICS[e]=n,n},LEGACY_ALIASES={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},bind=functionBind,hasOwn=hasown,$concat=bind.call(Function.call,Array.prototype.concat),$spliceApply=bind.call(Function.apply,Array.prototype.splice),$replace=bind.call(Function.call,String.prototype.replace),$strSlice=bind.call(Function.call,String.prototype.slice),$exec=bind.call(Function.call,RegExp.prototype.exec),rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=function t(e){var n=$strSlice(e,0,1),a=$strSlice(e,-1);if(n==="%"&&a!=="%")throw new $SyntaxError$1("invalid intrinsic syntax, expected closing `%`");if(a==="%"&&n!=="%")throw new $SyntaxError$1("invalid intrinsic syntax, expected opening `%`");var s=[];return $replace(e,rePropName,function(c,u,d,m){s[s.length]=d?$replace(m,reEscapeChar,"$1"):u||c}),s},getBaseIntrinsic=function t(e,n){var a=e,s;if(hasOwn(LEGACY_ALIASES,a)&&(s=LEGACY_ALIASES[a],a="%"+s[0]+"%"),hasOwn(INTRINSICS,a)){var c=INTRINSICS[a];if(c===needsEval&&(c=doEval(a)),typeof c>"u"&&!n)throw new $TypeError$2("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:a,value:c}}throw new $SyntaxError$1("intrinsic "+e+" does not exist!")},getIntrinsic=function t(e,n){if(typeof e!="string"||e.length===0)throw new $TypeError$2("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new $TypeError$2('"allowMissing" argument must be a boolean');if($exec(/^%?[^%]*%?$/,e)===null)throw new $SyntaxError$1("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var a=stringToPath(e),s=a.length>0?a[0]:"",c=getBaseIntrinsic("%"+s+"%",n),u=c.name,d=c.value,m=!1,_=c.alias;_&&(s=_[0],$spliceApply(a,$concat([0,1],_)));for(var b=1,S=!0;b<a.length;b+=1){var k=a[b],w=$strSlice(k,0,1),O=$strSlice(k,-1);if((w==='"'||w==="'"||w==="`"||O==='"'||O==="'"||O==="`")&&w!==O)throw new $SyntaxError$1("property names with quotes must have matching quotes");if((k==="constructor"||!S)&&(m=!0),s+="."+k,u="%"+s+"%",hasOwn(INTRINSICS,u))d=INTRINSICS[u];else if(d!=null){if(!(k in d)){if(!n)throw new $TypeError$2("base intrinsic for "+e+" exists, but the property is not available.");return}if($gOPD$1&&b+1>=a.length){var P=$gOPD$1(d,k);S=!!P,S&&"get"in P&&!("originalValue"in P.get)?d=P.get:d=d[k]}else S=hasOwn(d,k),d=d[k];S&&!m&&(INTRINSICS[u]=d)}}return d},callBind$2={exports:{}},GetIntrinsic$4=getIntrinsic,$defineProperty$1=GetIntrinsic$4("%Object.defineProperty%",!0),hasPropertyDescriptors$1=function t(){if($defineProperty$1)try{return $defineProperty$1({},"a",{value:1}),!0}catch{return!1}return!1};hasPropertyDescriptors$1.hasArrayLengthDefineBug=function t(){if(!hasPropertyDescriptors$1())return null;try{return $defineProperty$1([],"length",{value:1}).length!==1}catch{return!0}};var hasPropertyDescriptors_1=hasPropertyDescriptors$1,GetIntrinsic$3=getIntrinsic,$gOPD=GetIntrinsic$3("%Object.getOwnPropertyDescriptor%",!0);if($gOPD)try{$gOPD([],"length")}catch{$gOPD=null}var gopd$1=$gOPD,hasPropertyDescriptors=hasPropertyDescriptors_1(),GetIntrinsic$2=getIntrinsic,$defineProperty=hasPropertyDescriptors&&GetIntrinsic$2("%Object.defineProperty%",!0);if($defineProperty)try{$defineProperty({},"a",{value:1})}catch{$defineProperty=!1}var $SyntaxError=GetIntrinsic$2("%SyntaxError%"),$TypeError$1=GetIntrinsic$2("%TypeError%"),gopd=gopd$1,defineDataProperty=function t(e,n,a){if(!e||typeof e!="object"&&typeof e!="function")throw new $TypeError$1("`obj` must be an object or a function`");if(typeof n!="string"&&typeof n!="symbol")throw new $TypeError$1("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new $TypeError$1("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new $TypeError$1("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new $TypeError$1("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new $TypeError$1("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,d=arguments.length>6?arguments[6]:!1,m=!!gopd&&gopd(e,n);if($defineProperty)$defineProperty(e,n,{configurable:u===null&&m?m.configurable:!u,enumerable:s===null&&m?m.enumerable:!s,value:a,writable:c===null&&m?m.writable:!c});else if(d||!s&&!c&&!u)e[n]=a;else throw new $SyntaxError("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},GetIntrinsic$1=getIntrinsic,define=defineDataProperty,hasDescriptors=hasPropertyDescriptors_1(),gOPD$1=gopd$1,$TypeError=GetIntrinsic$1("%TypeError%"),$floor=GetIntrinsic$1("%Math.floor%"),setFunctionLength=function t(e,n){if(typeof e!="function")throw new $TypeError("`fn` is not a function");if(typeof n!="number"||n<0||n>4294967295||$floor(n)!==n)throw new $TypeError("`length` must be a positive 32-bit integer");var a=arguments.length>2&&!!arguments[2],s=!0,c=!0;if("length"in e&&gOPD$1){var u=gOPD$1(e,"length");u&&!u.configurable&&(s=!1),u&&!u.writable&&(c=!1)}return(s||c||!a)&&(hasDescriptors?define(e,"length",n,!0,!0):define(e,"length",n)),e};(function(t){var e=functionBind,n=getIntrinsic,a=setFunctionLength,s=n("%TypeError%"),c=n("%Function.prototype.apply%"),u=n("%Function.prototype.call%"),d=n("%Reflect.apply%",!0)||e.call(u,c),m=n("%Object.defineProperty%",!0),_=n("%Math.max%");if(m)try{m({},"a",{value:1})}catch{m=null}t.exports=function(k){if(typeof k!="function")throw new s("a function is required");var w=d(e,u,arguments);return a(w,1+_(0,k.length-(arguments.length-1)),!0)};var b=function(){return d(e,c,arguments)};m?m(t.exports,"apply",{value:b}):t.exports.apply=b})(callBind$2);var callBindExports=callBind$2.exports,GetIntrinsic=getIntrinsic,callBind$1=callBindExports,$indexOf$1=callBind$1(GetIntrinsic("String.prototype.indexOf")),callBound$2=function t(e,n){var a=GetIntrinsic(e,!!n);return typeof a=="function"&&$indexOf$1(e,".prototype.")>-1?callBind$1(a):a},hasToStringTag$3=shams(),callBound$1=callBound$2,$toString$1=callBound$1("Object.prototype.toString"),isStandardArguments=function t(e){return hasToStringTag$3&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:$toString$1(e)==="[object Arguments]"},isLegacyArguments=function t(e){return isStandardArguments(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&$toString$1(e)!=="[object Array]"&&$toString$1(e.callee)==="[object Function]"},supportsStandardArguments=function(){return isStandardArguments(arguments)}();isStandardArguments.isLegacyArguments=isLegacyArguments;var isArguments=supportsStandardArguments?isStandardArguments:isLegacyArguments,toStr$2=Object.prototype.toString,fnToStr$1=Function.prototype.toString,isFnRegex=/^\s*(?:function)?\*/,hasToStringTag$2=shams(),getProto=Object.getPrototypeOf,getGeneratorFunc=function(){if(!hasToStringTag$2)return!1;try{return Function("return function*() {}")()}catch{}},GeneratorFunction,isGeneratorFunction=function t(e){if(typeof e!="function")return!1;if(isFnRegex.test(fnToStr$1.call(e)))return!0;if(!hasToStringTag$2){var n=toStr$2.call(e);return n==="[object GeneratorFunction]"}if(!getProto)return!1;if(typeof GeneratorFunction>"u"){var a=getGeneratorFunc();GeneratorFunction=a?getProto(a):!1}return getProto(e)===GeneratorFunction},fnToStr=Function.prototype.toString,reflectApply=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,badArrayLike,isCallableMarker;if(typeof reflectApply=="function"&&typeof Object.defineProperty=="function")try{badArrayLike=Object.defineProperty({},"length",{get:function(){throw isCallableMarker}}),isCallableMarker={},reflectApply(function(){throw 42},null,badArrayLike)}catch(t){t!==isCallableMarker&&(reflectApply=null)}else reflectApply=null;var constructorRegex=/^\s*class\b/,isES6ClassFn=function t(e){try{var n=fnToStr.call(e);return constructorRegex.test(n)}catch{return!1}},tryFunctionObject=function t(e){try{return isES6ClassFn(e)?!1:(fnToStr.call(e),!0)}catch{return!1}},toStr$1=Object.prototype.toString,objectClass="[object Object]",fnClass="[object Function]",genClass="[object GeneratorFunction]",ddaClass="[object HTMLAllCollection]",ddaClass2="[object HTML document.all class]",ddaClass3="[object HTMLCollection]",hasToStringTag$1=typeof Symbol=="function"&&!!Symbol.toStringTag,isIE68=!(0 in[,]),isDDA=function t(){return!1};if(typeof document=="object"){var all=document.all;toStr$1.call(all)===toStr$1.call(document.all)&&(isDDA=function(e){if((isIE68||!e)&&(typeof e>"u"||typeof e=="object"))try{var n=toStr$1.call(e);return(n===ddaClass||n===ddaClass2||n===ddaClass3||n===objectClass)&&e("")==null}catch{}return!1})}var isCallable$1=reflectApply?function t(e){if(isDDA(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{reflectApply(e,null,badArrayLike)}catch(n){if(n!==isCallableMarker)return!1}return!isES6ClassFn(e)&&tryFunctionObject(e)}:function t(e){if(isDDA(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(hasToStringTag$1)return tryFunctionObject(e);if(isES6ClassFn(e))return!1;var n=toStr$1.call(e);return n!==fnClass&&n!==genClass&&!/^\[object HTML/.test(n)?!1:tryFunctionObject(e)},isCallable=isCallable$1,toStr=Object.prototype.toString,hasOwnProperty=Object.prototype.hasOwnProperty,forEachArray=function t(e,n,a){for(var s=0,c=e.length;s<c;s++)hasOwnProperty.call(e,s)&&(a==null?n(e[s],s,e):n.call(a,e[s],s,e))},forEachString=function t(e,n,a){for(var s=0,c=e.length;s<c;s++)a==null?n(e.charAt(s),s,e):n.call(a,e.charAt(s),s,e)},forEachObject=function t(e,n,a){for(var s in e)hasOwnProperty.call(e,s)&&(a==null?n(e[s],s,e):n.call(a,e[s],s,e))},forEach$1=function t(e,n,a){if(!isCallable(n))throw new TypeError("iterator must be a function");var s;arguments.length>=3&&(s=a),toStr.call(e)==="[object Array]"?forEachArray(e,n,s):typeof e=="string"?forEachString(e,n,s):forEachObject(e,n,s)},forEach_1=forEach$1,possibleNames=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],g$1=typeof globalThis>"u"?commonjsGlobal$1:globalThis,availableTypedArrays$1=function t(){for(var e=[],n=0;n<possibleNames.length;n++)typeof g$1[possibleNames[n]]=="function"&&(e[e.length]=possibleNames[n]);return e},forEach=forEach_1,availableTypedArrays=availableTypedArrays$1,callBind=callBindExports,callBound=callBound$2,gOPD=gopd$1,$toString=callBound("Object.prototype.toString"),hasToStringTag=shams(),g=typeof globalThis>"u"?commonjsGlobal$1:globalThis,typedArrays=availableTypedArrays(),$slice=callBound("String.prototype.slice"),getPrototypeOf=Object.getPrototypeOf,$indexOf=callBound("Array.prototype.indexOf",!0)||function t(e,n){for(var a=0;a<e.length;a+=1)if(e[a]===n)return a;return-1},cache={__proto__:null};hasToStringTag&&gOPD&&getPrototypeOf?forEach(typedArrays,function(t){var e=new g[t];if(Symbol.toStringTag in e){var n=getPrototypeOf(e),a=gOPD(n,Symbol.toStringTag);if(!a){var s=getPrototypeOf(n);a=gOPD(s,Symbol.toStringTag)}cache["$"+t]=callBind(a.get)}}):forEach(typedArrays,function(t){var e=new g[t],n=e.slice||e.set;n&&(cache["$"+t]=callBind(n))});var tryTypedArrays=function t(e){var n=!1;return forEach(cache,function(a,s){if(!n)try{"$"+a(e)===s&&(n=$slice(s,1))}catch{}}),n},trySlices=function t(e){var n=!1;return forEach(cache,function(a,s){if(!n)try{a(e),n=$slice(s,1)}catch{}}),n},whichTypedArray$1=function t(e){if(!e||typeof e!="object")return!1;if(!hasToStringTag){var n=$slice($toString(e),8,-1);return $indexOf(typedArrays,n)>-1?n:n!=="Object"?!1:trySlices(e)}return gOPD?tryTypedArrays(e):null},whichTypedArray=whichTypedArray$1,isTypedArray=function t(e){return!!whichTypedArray(e)};(function(t){var e=isArguments,n=isGeneratorFunction,a=whichTypedArray$1,s=isTypedArray;function c(ne){return ne.call.bind(ne)}var u=typeof BigInt<"u",d=typeof Symbol<"u",m=c(Object.prototype.toString),_=c(Number.prototype.valueOf),b=c(String.prototype.valueOf),S=c(Boolean.prototype.valueOf);if(u)var k=c(BigInt.prototype.valueOf);if(d)var w=c(Symbol.prototype.valueOf);function O(ne,be){if(typeof ne!="object")return!1;try{return be(ne),!0}catch{return!1}}t.isArgumentsObject=e,t.isGeneratorFunction=n,t.isTypedArray=s;function P(ne){return typeof Promise<"u"&&ne instanceof Promise||ne!==null&&typeof ne=="object"&&typeof ne.then=="function"&&typeof ne.catch=="function"}t.isPromise=P;function N(ne){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(ne):s(ne)||Q(ne)}t.isArrayBufferView=N;function I(ne){return a(ne)==="Uint8Array"}t.isUint8Array=I;function U(ne){return a(ne)==="Uint8ClampedArray"}t.isUint8ClampedArray=U;function $(ne){return a(ne)==="Uint16Array"}t.isUint16Array=$;function x(ne){return a(ne)==="Uint32Array"}t.isUint32Array=x;function C(ne){return a(ne)==="Int8Array"}t.isInt8Array=C;function H(ne){return a(ne)==="Int16Array"}t.isInt16Array=H;function q(ne){return a(ne)==="Int32Array"}t.isInt32Array=q;function K(ne){return a(ne)==="Float32Array"}t.isFloat32Array=K;function W(ne){return a(ne)==="Float64Array"}t.isFloat64Array=W;function Z(ne){return a(ne)==="BigInt64Array"}t.isBigInt64Array=Z;function ee(ne){return a(ne)==="BigUint64Array"}t.isBigUint64Array=ee;function ie(ne){return m(ne)==="[object Map]"}ie.working=typeof Map<"u"&&ie(new Map);function se(ne){return typeof Map>"u"?!1:ie.working?ie(ne):ne instanceof Map}t.isMap=se;function ce(ne){return m(ne)==="[object Set]"}ce.working=typeof Set<"u"&&ce(new Set);function fe(ne){return typeof Set>"u"?!1:ce.working?ce(ne):ne instanceof Set}t.isSet=fe;function pe(ne){return m(ne)==="[object WeakMap]"}pe.working=typeof WeakMap<"u"&&pe(new WeakMap);function ue(ne){return typeof WeakMap>"u"?!1:pe.working?pe(ne):ne instanceof WeakMap}t.isWeakMap=ue;function ge(ne){return m(ne)==="[object WeakSet]"}ge.working=typeof WeakSet<"u"&&ge(new WeakSet);function he(ne){return ge(ne)}t.isWeakSet=he;function _e(ne){return m(ne)==="[object ArrayBuffer]"}_e.working=typeof ArrayBuffer<"u"&&_e(new ArrayBuffer);function re(ne){return typeof ArrayBuffer>"u"?!1:_e.working?_e(ne):ne instanceof ArrayBuffer}t.isArrayBuffer=re;function V(ne){return m(ne)==="[object DataView]"}V.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&V(new DataView(new ArrayBuffer(1),0,1));function Q(ne){return typeof DataView>"u"?!1:V.working?V(ne):ne instanceof DataView}t.isDataView=Q;var j=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function le(ne){return m(ne)==="[object SharedArrayBuffer]"}function J(ne){return typeof j>"u"?!1:(typeof le.working>"u"&&(le.working=le(new j)),le.working?le(ne):ne instanceof j)}t.isSharedArrayBuffer=J;function z(ne){return m(ne)==="[object AsyncFunction]"}t.isAsyncFunction=z;function X(ne){return m(ne)==="[object Map Iterator]"}t.isMapIterator=X;function te(ne){return m(ne)==="[object Set Iterator]"}t.isSetIterator=te;function oe(ne){return m(ne)==="[object Generator]"}t.isGeneratorObject=oe;function B(ne){return m(ne)==="[object WebAssembly.Module]"}t.isWebAssemblyCompiledModule=B;function F(ne){return O(ne,_)}t.isNumberObject=F;function Y(ne){return O(ne,b)}t.isStringObject=Y;function ae(ne){return O(ne,S)}t.isBooleanObject=ae;function ve(ne){return u&&O(ne,k)}t.isBigIntObject=ve;function me(ne){return d&&O(ne,w)}t.isSymbolObject=me;function ye(ne){return F(ne)||Y(ne)||ae(ne)||ve(ne)||me(ne)}t.isBoxedPrimitive=ye;function Ee(ne){return typeof Uint8Array<"u"&&(re(ne)||J(ne))}t.isAnyArrayBuffer=Ee,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(ne){Object.defineProperty(t,ne,{enumerable:!1,value:function(){throw new Error(ne+" is not supported in userland")}})})})(types);var isBufferBrowser=function t(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"},inherits_browser={exports:{}};typeof Object.create=="function"?inherits_browser.exports=function(e,n){n&&(e.super_=n,e.prototype=Object.create(n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(e,n){if(n){e.super_=n;var a=function(){};a.prototype=n.prototype,e.prototype=new a,e.prototype.constructor=e}};var inherits_browserExports=inherits_browser.exports;(function(t){var e=Object.getOwnPropertyDescriptors||function(Q){for(var j=Object.keys(Q),le={},J=0;J<j.length;J++)le[j[J]]=Object.getOwnPropertyDescriptor(Q,j[J]);return le},n=/%[sdj%]/g;t.format=function(V){if(!C(V)){for(var Q=[],j=0;j<arguments.length;j++)Q.push(u(arguments[j]));return Q.join(" ")}for(var j=1,le=arguments,J=le.length,z=String(V).replace(n,function(te){if(te==="%%")return"%";if(j>=J)return te;switch(te){case"%s":return String(le[j++]);case"%d":return Number(le[j++]);case"%j":try{return JSON.stringify(le[j++])}catch{return"[Circular]"}default:return te}}),X=le[j];j<J;X=le[++j])U(X)||!W(X)?z+=" "+X:z+=" "+u(X);return z},t.deprecate=function(V,Q){if(typeof dist.process<"u"&&dist.process.noDeprecation===!0)return V;if(typeof dist.process>"u")return function(){return t.deprecate(V,Q).apply(this,arguments)};var j=!1;function le(){if(!j){if(dist.process.throwDeprecation)throw new Error(Q);dist.process.traceDeprecation?console.trace(Q):console.error(Q),j=!0}return V.apply(this,arguments)}return le};var a={},s=/^$/;if({}.NODE_DEBUG){var c={}.NODE_DEBUG;c=c.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),s=new RegExp("^"+c+"$","i")}t.debuglog=function(V){if(V=V.toUpperCase(),!a[V])if(s.test(V)){var Q=dist.process.pid;a[V]=function(){var j=t.format.apply(t,arguments);console.error("%s %d: %s",V,Q,j)}}else a[V]=function(){};return a[V]};function u(V,Q){var j={seen:[],stylize:m};return arguments.length>=3&&(j.depth=arguments[2]),arguments.length>=4&&(j.colors=arguments[3]),I(Q)?j.showHidden=Q:Q&&t._extend(j,Q),q(j.showHidden)&&(j.showHidden=!1),q(j.depth)&&(j.depth=2),q(j.colors)&&(j.colors=!1),q(j.customInspect)&&(j.customInspect=!0),j.colors&&(j.stylize=d),b(j,V,j.depth)}t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function d(V,Q){var j=u.styles[Q];return j?"\x1B["+u.colors[j][0]+"m"+V+"\x1B["+u.colors[j][1]+"m":V}function m(V,Q){return V}function _(V){var Q={};return V.forEach(function(j,le){Q[j]=!0}),Q}function b(V,Q,j){if(V.customInspect&&Q&&ie(Q.inspect)&&Q.inspect!==t.inspect&&!(Q.constructor&&Q.constructor.prototype===Q)){var le=Q.inspect(j,V);return C(le)||(le=b(V,le,j)),le}var J=S(V,Q);if(J)return J;var z=Object.keys(Q),X=_(z);if(V.showHidden&&(z=Object.getOwnPropertyNames(Q)),ee(Q)&&(z.indexOf("message")>=0||z.indexOf("description")>=0))return k(Q);if(z.length===0){if(ie(Q)){var te=Q.name?": "+Q.name:"";return V.stylize("[Function"+te+"]","special")}if(K(Q))return V.stylize(RegExp.prototype.toString.call(Q),"regexp");if(Z(Q))return V.stylize(Date.prototype.toString.call(Q),"date");if(ee(Q))return k(Q)}var oe="",B=!1,F=["{","}"];if(N(Q)&&(B=!0,F=["[","]"]),ie(Q)){var Y=Q.name?": "+Q.name:"";oe=" [Function"+Y+"]"}if(K(Q)&&(oe=" "+RegExp.prototype.toString.call(Q)),Z(Q)&&(oe=" "+Date.prototype.toUTCString.call(Q)),ee(Q)&&(oe=" "+k(Q)),z.length===0&&(!B||Q.length==0))return F[0]+oe+F[1];if(j<0)return K(Q)?V.stylize(RegExp.prototype.toString.call(Q),"regexp"):V.stylize("[Object]","special");V.seen.push(Q);var ae;return B?ae=w(V,Q,j,X,z):ae=z.map(function(ve){return O(V,Q,j,X,ve,B)}),V.seen.pop(),P(ae,oe,F)}function S(V,Q){if(q(Q))return V.stylize("undefined","undefined");if(C(Q)){var j="'"+JSON.stringify(Q).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return V.stylize(j,"string")}if(x(Q))return V.stylize(""+Q,"number");if(I(Q))return V.stylize(""+Q,"boolean");if(U(Q))return V.stylize("null","null")}function k(V){return"["+Error.prototype.toString.call(V)+"]"}function w(V,Q,j,le,J){for(var z=[],X=0,te=Q.length;X<te;++X)ge(Q,String(X))?z.push(O(V,Q,j,le,String(X),!0)):z.push("");return J.forEach(function(oe){oe.match(/^\d+$/)||z.push(O(V,Q,j,le,oe,!0))}),z}function O(V,Q,j,le,J,z){var X,te,oe;if(oe=Object.getOwnPropertyDescriptor(Q,J)||{value:Q[J]},oe.get?oe.set?te=V.stylize("[Getter/Setter]","special"):te=V.stylize("[Getter]","special"):oe.set&&(te=V.stylize("[Setter]","special")),ge(le,J)||(X="["+J+"]"),te||(V.seen.indexOf(oe.value)<0?(U(j)?te=b(V,oe.value,null):te=b(V,oe.value,j-1),te.indexOf(`
`)>-1&&(z?te=te.split(`
`).map(function(B){return"  "+B}).join(`
`).slice(2):te=`
`+te.split(`
`).map(function(B){return"   "+B}).join(`
`))):te=V.stylize("[Circular]","special")),q(X)){if(z&&J.match(/^\d+$/))return te;X=JSON.stringify(""+J),X.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(X=X.slice(1,-1),X=V.stylize(X,"name")):(X=X.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),X=V.stylize(X,"string"))}return X+": "+te}function P(V,Q,j){var le=V.reduce(function(J,z){return z.indexOf(`
`)>=0,J+z.replace(/\u001b\[\d\d?m/g,"").length+1},0);return le>60?j[0]+(Q===""?"":Q+`
 `)+" "+V.join(`,
  `)+" "+j[1]:j[0]+Q+" "+V.join(", ")+" "+j[1]}t.types=types;function N(V){return Array.isArray(V)}t.isArray=N;function I(V){return typeof V=="boolean"}t.isBoolean=I;function U(V){return V===null}t.isNull=U;function $(V){return V==null}t.isNullOrUndefined=$;function x(V){return typeof V=="number"}t.isNumber=x;function C(V){return typeof V=="string"}t.isString=C;function H(V){return typeof V=="symbol"}t.isSymbol=H;function q(V){return V===void 0}t.isUndefined=q;function K(V){return W(V)&&ce(V)==="[object RegExp]"}t.isRegExp=K,t.types.isRegExp=K;function W(V){return typeof V=="object"&&V!==null}t.isObject=W;function Z(V){return W(V)&&ce(V)==="[object Date]"}t.isDate=Z,t.types.isDate=Z;function ee(V){return W(V)&&(ce(V)==="[object Error]"||V instanceof Error)}t.isError=ee,t.types.isNativeError=ee;function ie(V){return typeof V=="function"}t.isFunction=ie;function se(V){return V===null||typeof V=="boolean"||typeof V=="number"||typeof V=="string"||typeof V=="symbol"||typeof V>"u"}t.isPrimitive=se,t.isBuffer=isBufferBrowser;function ce(V){return Object.prototype.toString.call(V)}function fe(V){return V<10?"0"+V.toString(10):V.toString(10)}var pe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ue(){var V=new Date,Q=[fe(V.getHours()),fe(V.getMinutes()),fe(V.getSeconds())].join(":");return[V.getDate(),pe[V.getMonth()],Q].join(" ")}t.log=function(){console.log("%s - %s",ue(),t.format.apply(t,arguments))},t.inherits=inherits_browserExports,t._extend=function(V,Q){if(!Q||!W(Q))return V;for(var j=Object.keys(Q),le=j.length;le--;)V[j[le]]=Q[j[le]];return V};function ge(V,Q){return Object.prototype.hasOwnProperty.call(V,Q)}var he=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;t.promisify=function(Q){if(typeof Q!="function")throw new TypeError('The "original" argument must be of type Function');if(he&&Q[he]){var j=Q[he];if(typeof j!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(j,he,{value:j,enumerable:!1,writable:!1,configurable:!0}),j}function j(){for(var le,J,z=new Promise(function(oe,B){le=oe,J=B}),X=[],te=0;te<arguments.length;te++)X.push(arguments[te]);X.push(function(oe,B){oe?J(oe):le(B)});try{Q.apply(this,X)}catch(oe){J(oe)}return z}return Object.setPrototypeOf(j,Object.getPrototypeOf(Q)),he&&Object.defineProperty(j,he,{value:j,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(j,e(Q))},t.promisify.custom=he;function _e(V,Q){if(!V){var j=new Error("Promise was rejected with a falsy value");j.reason=V,V=j}return Q(V)}function re(V){if(typeof V!="function")throw new TypeError('The "original" argument must be of type Function');function Q(){for(var j=[],le=0;le<arguments.length;le++)j.push(arguments[le]);var J=j.pop();if(typeof J!="function")throw new TypeError("The last argument must be of type Function");var z=this,X=function(){return J.apply(z,arguments)};V.apply(this,j).then(function(te){dist.process.nextTick(X.bind(null,null,te))},function(te){dist.process.nextTick(_e.bind(null,te,X))})}return Object.setPrototypeOf(Q,Object.getPrototypeOf(V)),Object.defineProperties(Q,e(V)),Q}t.callbackify=re})(util);var buffer_list,hasRequiredBuffer_list;function requireBuffer_list(){if(hasRequiredBuffer_list)return buffer_list;hasRequiredBuffer_list=1;function t(O,P){var N=Object.keys(O);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(O);P&&(I=I.filter(function(U){return Object.getOwnPropertyDescriptor(O,U).enumerable})),N.push.apply(N,I)}return N}function e(O){for(var P=1;P<arguments.length;P++){var N=arguments[P]!=null?arguments[P]:{};P%2?t(Object(N),!0).forEach(function(I){n(O,I,N[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(N)):t(Object(N)).forEach(function(I){Object.defineProperty(O,I,Object.getOwnPropertyDescriptor(N,I))})}return O}function n(O,P,N){return P=u(P),P in O?Object.defineProperty(O,P,{value:N,enumerable:!0,configurable:!0,writable:!0}):O[P]=N,O}function a(O,P){if(!(O instanceof P))throw new TypeError("Cannot call a class as a function")}function s(O,P){for(var N=0;N<P.length;N++){var I=P[N];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(O,u(I.key),I)}}function c(O,P,N){return P&&s(O.prototype,P),N&&s(O,N),Object.defineProperty(O,"prototype",{writable:!1}),O}function u(O){var P=d(O,"string");return typeof P=="symbol"?P:String(P)}function d(O,P){if(typeof O!="object"||O===null)return O;var N=O[Symbol.toPrimitive];if(N!==void 0){var I=N.call(O,P||"default");if(typeof I!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(P==="string"?String:Number)(O)}var m=buffer,_=m.Buffer,b=util,S=b.inspect,k=S&&S.custom||"inspect";function w(O,P,N){_.prototype.copy.call(O,P,N)}return buffer_list=function(){function O(){a(this,O),this.head=null,this.tail=null,this.length=0}return c(O,[{key:"push",value:function(N){var I={data:N,next:null};this.length>0?this.tail.next=I:this.head=I,this.tail=I,++this.length}},{key:"unshift",value:function(N){var I={data:N,next:this.head};this.length===0&&(this.tail=I),this.head=I,++this.length}},{key:"shift",value:function(){if(this.length!==0){var N=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,N}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(N){if(this.length===0)return"";for(var I=this.head,U=""+I.data;I=I.next;)U+=N+I.data;return U}},{key:"concat",value:function(N){if(this.length===0)return _.alloc(0);for(var I=_.allocUnsafe(N>>>0),U=this.head,$=0;U;)w(U.data,I,$),$+=U.data.length,U=U.next;return I}},{key:"consume",value:function(N,I){var U;return N<this.head.data.length?(U=this.head.data.slice(0,N),this.head.data=this.head.data.slice(N)):N===this.head.data.length?U=this.shift():U=I?this._getString(N):this._getBuffer(N),U}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(N){var I=this.head,U=1,$=I.data;for(N-=$.length;I=I.next;){var x=I.data,C=N>x.length?x.length:N;if(C===x.length?$+=x:$+=x.slice(0,N),N-=C,N===0){C===x.length?(++U,I.next?this.head=I.next:this.head=this.tail=null):(this.head=I,I.data=x.slice(C));break}++U}return this.length-=U,$}},{key:"_getBuffer",value:function(N){var I=_.allocUnsafe(N),U=this.head,$=1;for(U.data.copy(I),N-=U.data.length;U=U.next;){var x=U.data,C=N>x.length?x.length:N;if(x.copy(I,I.length-N,0,C),N-=C,N===0){C===x.length?(++$,U.next?this.head=U.next:this.head=this.tail=null):(this.head=U,U.data=x.slice(C));break}++$}return this.length-=$,I}},{key:k,value:function(N,I){return S(this,e(e({},I),{},{depth:0,customInspect:!1}))}}]),O}(),buffer_list}function destroy(t,e){var n=this,a=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return a||s?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,dist.process.nextTick(emitErrorNT,this,t)):dist.process.nextTick(emitErrorNT,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(c){!e&&c?n._writableState?n._writableState.errorEmitted?dist.process.nextTick(emitCloseNT,n):(n._writableState.errorEmitted=!0,dist.process.nextTick(emitErrorAndCloseNT,n,c)):dist.process.nextTick(emitErrorAndCloseNT,n,c):e?(dist.process.nextTick(emitCloseNT,n),e(c)):dist.process.nextTick(emitCloseNT,n)}),this)}function emitErrorAndCloseNT(t,e){emitErrorNT(t,e),emitCloseNT(t)}function emitCloseNT(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function undestroy(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT(t,e){t.emit("error",e)}function errorOrDestroy(t,e){var n=t._readableState,a=t._writableState;n&&n.autoDestroy||a&&a.autoDestroy?t.destroy(e):t.emit("error",e)}var destroy_1={destroy,undestroy,errorOrDestroy},errorsBrowser={};function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var codes={};function createErrorType(t,e,n){n||(n=Error);function a(c,u,d){return typeof e=="string"?e:e(c,u,d)}var s=function(c){_inheritsLoose(u,c);function u(d,m,_){return c.call(this,a(d,m,_))||this}return u}(n);s.prototype.name=n.name,s.prototype.code=t,codes[t]=s}function oneOf(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map(function(a){return String(a)}),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:n===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function startsWith(t,e,n){return t.substr(!n||n<0?0:+n,e.length)===e}function endsWith(t,e,n){return(n===void 0||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}function includes(t,e,n){return typeof n!="number"&&(n=0),n+e.length>t.length?!1:t.indexOf(e,n)!==-1}createErrorType("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);createErrorType("ERR_INVALID_ARG_TYPE",function(t,e,n){var a;typeof e=="string"&&startsWith(e,"not ")?(a="must not be",e=e.replace(/^not /,"")):a="must be";var s;if(endsWith(t," argument"))s="The ".concat(t," ").concat(a," ").concat(oneOf(e,"type"));else{var c=includes(t,".")?"property":"argument";s='The "'.concat(t,'" ').concat(c," ").concat(a," ").concat(oneOf(e,"type"))}return s+=". Received type ".concat(typeof n),s},TypeError);createErrorType("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");createErrorType("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});createErrorType("ERR_STREAM_PREMATURE_CLOSE","Premature close");createErrorType("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});createErrorType("ERR_MULTIPLE_CALLBACK","Callback called multiple times");createErrorType("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end");createErrorType("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);createErrorType("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);createErrorType("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");errorsBrowser.codes=codes;var ERR_INVALID_OPT_VALUE=errorsBrowser.codes.ERR_INVALID_OPT_VALUE;function highWaterMarkFrom(t,e,n){return t.highWaterMark!=null?t.highWaterMark:e?t[n]:null}function getHighWaterMark(t,e,n,a){var s=highWaterMarkFrom(e,a,n);if(s!=null){if(!(isFinite(s)&&Math.floor(s)===s)||s<0){var c=a?n:"highWaterMark";throw new ERR_INVALID_OPT_VALUE(c,s)}return Math.floor(s)}return t.objectMode?16:16*1024}var state={getHighWaterMark},browser=deprecate;function deprecate(t,e){if(config("noDeprecation"))return t;var n=!1;function a(){if(!n){if(config("throwDeprecation"))throw new Error(e);config("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}return a}function config(t){try{if(!commonjsGlobal$1.localStorage)return!1}catch{return!1}var e=commonjsGlobal$1.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}var _stream_writable,hasRequired_stream_writable;function require_stream_writable(){if(hasRequired_stream_writable)return _stream_writable;hasRequired_stream_writable=1,_stream_writable=K;function t(J){var z=this;this.next=null,this.entry=null,this.finish=function(){le(z,J)}}var e;K.WritableState=H;var n={deprecate:browser},a=streamBrowser,s=buffer.Buffer,c=(typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function u(J){return s.from(J)}function d(J){return s.isBuffer(J)||J instanceof c}var m=destroy_1,_=state,b=_.getHighWaterMark,S=errorsBrowser.codes,k=S.ERR_INVALID_ARG_TYPE,w=S.ERR_METHOD_NOT_IMPLEMENTED,O=S.ERR_MULTIPLE_CALLBACK,P=S.ERR_STREAM_CANNOT_PIPE,N=S.ERR_STREAM_DESTROYED,I=S.ERR_STREAM_NULL_VALUES,U=S.ERR_STREAM_WRITE_AFTER_END,$=S.ERR_UNKNOWN_ENCODING,x=m.errorOrDestroy;inherits_browserExports(K,a);function C(){}function H(J,z,X){e=e||require_stream_duplex(),J=J||{},typeof X!="boolean"&&(X=z instanceof e),this.objectMode=!!J.objectMode,X&&(this.objectMode=this.objectMode||!!J.writableObjectMode),this.highWaterMark=b(this,J,"writableHighWaterMark",X),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var te=J.decodeStrings===!1;this.decodeStrings=!te,this.defaultEncoding=J.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(oe){pe(z,oe)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=J.emitClose!==!1,this.autoDestroy=!!J.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}H.prototype.getBuffer=function(){for(var z=this.bufferedRequest,X=[];z;)X.push(z),z=z.next;return X},function(){try{Object.defineProperty(H.prototype,"buffer",{get:n.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var q;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(q=Function.prototype[Symbol.hasInstance],Object.defineProperty(K,Symbol.hasInstance,{value:function(z){return q.call(this,z)?!0:this!==K?!1:z&&z._writableState instanceof H}})):q=function(z){return z instanceof this};function K(J){e=e||require_stream_duplex();var z=this instanceof e;if(!z&&!q.call(K,this))return new K(J);this._writableState=new H(J,this,z),this.writable=!0,J&&(typeof J.write=="function"&&(this._write=J.write),typeof J.writev=="function"&&(this._writev=J.writev),typeof J.destroy=="function"&&(this._destroy=J.destroy),typeof J.final=="function"&&(this._final=J.final)),a.call(this)}K.prototype.pipe=function(){x(this,new P)};function W(J,z){var X=new U;x(J,X),dist.process.nextTick(z,X)}function Z(J,z,X,te){var oe;return X===null?oe=new I:typeof X!="string"&&!z.objectMode&&(oe=new k("chunk",["string","Buffer"],X)),oe?(x(J,oe),dist.process.nextTick(te,oe),!1):!0}K.prototype.write=function(J,z,X){var te=this._writableState,oe=!1,B=!te.objectMode&&d(J);return B&&!s.isBuffer(J)&&(J=u(J)),typeof z=="function"&&(X=z,z=null),B?z="buffer":z||(z=te.defaultEncoding),typeof X!="function"&&(X=C),te.ending?W(this,X):(B||Z(this,te,J,X))&&(te.pendingcb++,oe=ie(this,te,B,J,z,X)),oe},K.prototype.cork=function(){this._writableState.corked++},K.prototype.uncork=function(){var J=this._writableState;J.corked&&(J.corked--,!J.writing&&!J.corked&&!J.bufferProcessing&&J.bufferedRequest&&he(this,J))},K.prototype.setDefaultEncoding=function(z){if(typeof z=="string"&&(z=z.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((z+"").toLowerCase())>-1))throw new $(z);return this._writableState.defaultEncoding=z,this},Object.defineProperty(K.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ee(J,z,X){return!J.objectMode&&J.decodeStrings!==!1&&typeof z=="string"&&(z=s.from(z,X)),z}Object.defineProperty(K.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ie(J,z,X,te,oe,B){if(!X){var F=ee(z,te,oe);te!==F&&(X=!0,oe="buffer",te=F)}var Y=z.objectMode?1:te.length;z.length+=Y;var ae=z.length<z.highWaterMark;if(ae||(z.needDrain=!0),z.writing||z.corked){var ve=z.lastBufferedRequest;z.lastBufferedRequest={chunk:te,encoding:oe,isBuf:X,callback:B,next:null},ve?ve.next=z.lastBufferedRequest:z.bufferedRequest=z.lastBufferedRequest,z.bufferedRequestCount+=1}else se(J,z,!1,Y,te,oe,B);return ae}function se(J,z,X,te,oe,B,F){z.writelen=te,z.writecb=F,z.writing=!0,z.sync=!0,z.destroyed?z.onwrite(new N("write")):X?J._writev(oe,z.onwrite):J._write(oe,B,z.onwrite),z.sync=!1}function ce(J,z,X,te,oe){--z.pendingcb,X?(dist.process.nextTick(oe,te),dist.process.nextTick(Q,J,z),J._writableState.errorEmitted=!0,x(J,te)):(oe(te),J._writableState.errorEmitted=!0,x(J,te),Q(J,z))}function fe(J){J.writing=!1,J.writecb=null,J.length-=J.writelen,J.writelen=0}function pe(J,z){var X=J._writableState,te=X.sync,oe=X.writecb;if(typeof oe!="function")throw new O;if(fe(X),z)ce(J,X,te,z,oe);else{var B=_e(X)||J.destroyed;!B&&!X.corked&&!X.bufferProcessing&&X.bufferedRequest&&he(J,X),te?dist.process.nextTick(ue,J,X,B,oe):ue(J,X,B,oe)}}function ue(J,z,X,te){X||ge(J,z),z.pendingcb--,te(),Q(J,z)}function ge(J,z){z.length===0&&z.needDrain&&(z.needDrain=!1,J.emit("drain"))}function he(J,z){z.bufferProcessing=!0;var X=z.bufferedRequest;if(J._writev&&X&&X.next){var te=z.bufferedRequestCount,oe=new Array(te),B=z.corkedRequestsFree;B.entry=X;for(var F=0,Y=!0;X;)oe[F]=X,X.isBuf||(Y=!1),X=X.next,F+=1;oe.allBuffers=Y,se(J,z,!0,z.length,oe,"",B.finish),z.pendingcb++,z.lastBufferedRequest=null,B.next?(z.corkedRequestsFree=B.next,B.next=null):z.corkedRequestsFree=new t(z),z.bufferedRequestCount=0}else{for(;X;){var ae=X.chunk,ve=X.encoding,me=X.callback,ye=z.objectMode?1:ae.length;if(se(J,z,!1,ye,ae,ve,me),X=X.next,z.bufferedRequestCount--,z.writing)break}X===null&&(z.lastBufferedRequest=null)}z.bufferedRequest=X,z.bufferProcessing=!1}K.prototype._write=function(J,z,X){X(new w("_write()"))},K.prototype._writev=null,K.prototype.end=function(J,z,X){var te=this._writableState;return typeof J=="function"?(X=J,J=null,z=null):typeof z=="function"&&(X=z,z=null),J!=null&&this.write(J,z),te.corked&&(te.corked=1,this.uncork()),te.ending||j(this,te,X),this},Object.defineProperty(K.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function _e(J){return J.ending&&J.length===0&&J.bufferedRequest===null&&!J.finished&&!J.writing}function re(J,z){J._final(function(X){z.pendingcb--,X&&x(J,X),z.prefinished=!0,J.emit("prefinish"),Q(J,z)})}function V(J,z){!z.prefinished&&!z.finalCalled&&(typeof J._final=="function"&&!z.destroyed?(z.pendingcb++,z.finalCalled=!0,dist.process.nextTick(re,J,z)):(z.prefinished=!0,J.emit("prefinish")))}function Q(J,z){var X=_e(z);if(X&&(V(J,z),z.pendingcb===0&&(z.finished=!0,J.emit("finish"),z.autoDestroy))){var te=J._readableState;(!te||te.autoDestroy&&te.endEmitted)&&J.destroy()}return X}function j(J,z,X){z.ending=!0,Q(J,z),X&&(z.finished?dist.process.nextTick(X):J.once("finish",X)),z.ended=!0,J.writable=!1}function le(J,z,X){var te=J.entry;for(J.entry=null;te;){var oe=te.callback;z.pendingcb--,oe(X),te=te.next}z.corkedRequestsFree.next=J}return Object.defineProperty(K.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(z){this._writableState&&(this._writableState.destroyed=z)}}),K.prototype.destroy=m.destroy,K.prototype._undestroy=m.undestroy,K.prototype._destroy=function(J,z){z(J)},_stream_writable}var _stream_duplex,hasRequired_stream_duplex;function require_stream_duplex(){if(hasRequired_stream_duplex)return _stream_duplex;hasRequired_stream_duplex=1;var t=Object.keys||function(_){var b=[];for(var S in _)b.push(S);return b};_stream_duplex=u;var e=require_stream_readable(),n=require_stream_writable();inherits_browserExports(u,e);for(var a=t(n.prototype),s=0;s<a.length;s++){var c=a[s];u.prototype[c]||(u.prototype[c]=n.prototype[c])}function u(_){if(!(this instanceof u))return new u(_);e.call(this,_),n.call(this,_),this.allowHalfOpen=!0,_&&(_.readable===!1&&(this.readable=!1),_.writable===!1&&(this.writable=!1),_.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",d)))}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function d(){this._writableState.ended||dist.process.nextTick(m,this)}function m(_){_.end()}return Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(b){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=b,this._writableState.destroyed=b)}}),_stream_duplex}var string_decoder={},hasRequiredString_decoder;function requireString_decoder(){if(hasRequiredString_decoder)return string_decoder;hasRequiredString_decoder=1;var t=safeBufferExports.Buffer,e=t.isEncoding||function(I){switch(I=""+I,I&&I.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(I){if(!I)return"utf8";for(var U;;)switch(I){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return I;default:if(U)return;I=(""+I).toLowerCase(),U=!0}}function a(I){var U=n(I);if(typeof U!="string"&&(t.isEncoding===e||!e(I)))throw new Error("Unknown encoding: "+I);return U||I}string_decoder.StringDecoder=s;function s(I){this.encoding=a(I);var U;switch(this.encoding){case"utf16le":this.text=S,this.end=k,U=4;break;case"utf8":this.fillLast=m,U=4;break;case"base64":this.text=w,this.end=O,U=3;break;default:this.write=P,this.end=N;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(U)}s.prototype.write=function(I){if(I.length===0)return"";var U,$;if(this.lastNeed){if(U=this.fillLast(I),U===void 0)return"";$=this.lastNeed,this.lastNeed=0}else $=0;return $<I.length?U?U+this.text(I,$):this.text(I,$):U||""},s.prototype.end=b,s.prototype.text=_,s.prototype.fillLast=function(I){if(this.lastNeed<=I.length)return I.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);I.copy(this.lastChar,this.lastTotal-this.lastNeed,0,I.length),this.lastNeed-=I.length};function c(I){return I<=127?0:I>>5===6?2:I>>4===14?3:I>>3===30?4:I>>6===2?-1:-2}function u(I,U,$){var x=U.length-1;if(x<$)return 0;var C=c(U[x]);return C>=0?(C>0&&(I.lastNeed=C-1),C):--x<$||C===-2?0:(C=c(U[x]),C>=0?(C>0&&(I.lastNeed=C-2),C):--x<$||C===-2?0:(C=c(U[x]),C>=0?(C>0&&(C===2?C=0:I.lastNeed=C-3),C):0))}function d(I,U,$){if((U[0]&192)!==128)return I.lastNeed=0,"�";if(I.lastNeed>1&&U.length>1){if((U[1]&192)!==128)return I.lastNeed=1,"�";if(I.lastNeed>2&&U.length>2&&(U[2]&192)!==128)return I.lastNeed=2,"�"}}function m(I){var U=this.lastTotal-this.lastNeed,$=d(this,I);if($!==void 0)return $;if(this.lastNeed<=I.length)return I.copy(this.lastChar,U,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);I.copy(this.lastChar,U,0,I.length),this.lastNeed-=I.length}function _(I,U){var $=u(this,I,U);if(!this.lastNeed)return I.toString("utf8",U);this.lastTotal=$;var x=I.length-($-this.lastNeed);return I.copy(this.lastChar,0,x),I.toString("utf8",U,x)}function b(I){var U=I&&I.length?this.write(I):"";return this.lastNeed?U+"�":U}function S(I,U){if((I.length-U)%2===0){var $=I.toString("utf16le",U);if($){var x=$.charCodeAt($.length-1);if(x>=55296&&x<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=I[I.length-2],this.lastChar[1]=I[I.length-1],$.slice(0,-1)}return $}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=I[I.length-1],I.toString("utf16le",U,I.length-1)}function k(I){var U=I&&I.length?this.write(I):"";if(this.lastNeed){var $=this.lastTotal-this.lastNeed;return U+this.lastChar.toString("utf16le",0,$)}return U}function w(I,U){var $=(I.length-U)%3;return $===0?I.toString("base64",U):(this.lastNeed=3-$,this.lastTotal=3,$===1?this.lastChar[0]=I[I.length-1]:(this.lastChar[0]=I[I.length-2],this.lastChar[1]=I[I.length-1]),I.toString("base64",U,I.length-$))}function O(I){var U=I&&I.length?this.write(I):"";return this.lastNeed?U+this.lastChar.toString("base64",0,3-this.lastNeed):U}function P(I){return I.toString(this.encoding)}function N(I){return I&&I.length?this.write(I):""}return string_decoder}var ERR_STREAM_PREMATURE_CLOSE=errorsBrowser.codes.ERR_STREAM_PREMATURE_CLOSE;function once$1(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];t.apply(this,a)}}}function noop$1(){}function isRequest$1(t){return t.setHeader&&typeof t.abort=="function"}function eos$1(t,e,n){if(typeof e=="function")return eos$1(t,null,e);e||(e={}),n=once$1(n||noop$1);var a=e.readable||e.readable!==!1&&t.readable,s=e.writable||e.writable!==!1&&t.writable,c=function(){t.writable||d()},u=t._writableState&&t._writableState.finished,d=function(){s=!1,u=!0,a||n.call(t)},m=t._readableState&&t._readableState.endEmitted,_=function(){a=!1,m=!0,s||n.call(t)},b=function(O){n.call(t,O)},S=function(){var O;if(a&&!m)return(!t._readableState||!t._readableState.ended)&&(O=new ERR_STREAM_PREMATURE_CLOSE),n.call(t,O);if(s&&!u)return(!t._writableState||!t._writableState.ended)&&(O=new ERR_STREAM_PREMATURE_CLOSE),n.call(t,O)},k=function(){t.req.on("finish",d)};return isRequest$1(t)?(t.on("complete",d),t.on("abort",S),t.req?k():t.on("request",k)):s&&!t._writableState&&(t.on("end",c),t.on("close",c)),t.on("end",_),t.on("finish",d),e.error!==!1&&t.on("error",b),t.on("close",S),function(){t.removeListener("complete",d),t.removeListener("abort",S),t.removeListener("request",k),t.req&&t.req.removeListener("finish",d),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",d),t.removeListener("end",_),t.removeListener("error",b),t.removeListener("close",S)}}var endOfStream=eos$1,async_iterator,hasRequiredAsync_iterator;function requireAsync_iterator(){if(hasRequiredAsync_iterator)return async_iterator;hasRequiredAsync_iterator=1;var t;function e($,x,C){return x=n(x),x in $?Object.defineProperty($,x,{value:C,enumerable:!0,configurable:!0,writable:!0}):$[x]=C,$}function n($){var x=a($,"string");return typeof x=="symbol"?x:String(x)}function a($,x){if(typeof $!="object"||$===null)return $;var C=$[Symbol.toPrimitive];if(C!==void 0){var H=C.call($,x||"default");if(typeof H!="object")return H;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)($)}var s=endOfStream,c=Symbol("lastResolve"),u=Symbol("lastReject"),d=Symbol("error"),m=Symbol("ended"),_=Symbol("lastPromise"),b=Symbol("handlePromise"),S=Symbol("stream");function k($,x){return{value:$,done:x}}function w($){var x=$[c];if(x!==null){var C=$[S].read();C!==null&&($[_]=null,$[c]=null,$[u]=null,x(k(C,!1)))}}function O($){dist.process.nextTick(w,$)}function P($,x){return function(C,H){$.then(function(){if(x[m]){C(k(void 0,!0));return}x[b](C,H)},H)}}var N=Object.getPrototypeOf(function(){}),I=Object.setPrototypeOf((t={get stream(){return this[S]},next:function(){var x=this,C=this[d];if(C!==null)return Promise.reject(C);if(this[m])return Promise.resolve(k(void 0,!0));if(this[S].destroyed)return new Promise(function(W,Z){dist.process.nextTick(function(){x[d]?Z(x[d]):W(k(void 0,!0))})});var H=this[_],q;if(H)q=new Promise(P(H,this));else{var K=this[S].read();if(K!==null)return Promise.resolve(k(K,!1));q=new Promise(this[b])}return this[_]=q,q}},e(t,Symbol.asyncIterator,function(){return this}),e(t,"return",function(){var x=this;return new Promise(function(C,H){x[S].destroy(null,function(q){if(q){H(q);return}C(k(void 0,!0))})})}),t),N),U=function(x){var C,H=Object.create(I,(C={},e(C,S,{value:x,writable:!0}),e(C,c,{value:null,writable:!0}),e(C,u,{value:null,writable:!0}),e(C,d,{value:null,writable:!0}),e(C,m,{value:x._readableState.endEmitted,writable:!0}),e(C,b,{value:function(K,W){var Z=H[S].read();Z?(H[_]=null,H[c]=null,H[u]=null,K(k(Z,!1))):(H[c]=K,H[u]=W)},writable:!0}),C));return H[_]=null,s(x,function(q){if(q&&q.code!=="ERR_STREAM_PREMATURE_CLOSE"){var K=H[u];K!==null&&(H[_]=null,H[c]=null,H[u]=null,K(q)),H[d]=q;return}var W=H[c];W!==null&&(H[_]=null,H[c]=null,H[u]=null,W(k(void 0,!0))),H[m]=!0}),x.on("readable",O.bind(null,H)),H};return async_iterator=U,async_iterator}var fromBrowser,hasRequiredFromBrowser;function requireFromBrowser(){return hasRequiredFromBrowser||(hasRequiredFromBrowser=1,fromBrowser=function(){throw new Error("Readable.from is not available in the browser")}),fromBrowser}var _stream_readable,hasRequired_stream_readable;function require_stream_readable(){if(hasRequired_stream_readable)return _stream_readable;hasRequired_stream_readable=1,_stream_readable=W;var t;W.ReadableState=K,eventsExports.EventEmitter;var e=function(F,Y){return F.listeners(Y).length},n=streamBrowser,a=buffer.Buffer,s=(typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function c(B){return a.from(B)}function u(B){return a.isBuffer(B)||B instanceof s}var d=util,m;d&&d.debuglog?m=d.debuglog("stream"):m=function(){};var _=requireBuffer_list(),b=destroy_1,S=state,k=S.getHighWaterMark,w=errorsBrowser.codes,O=w.ERR_INVALID_ARG_TYPE,P=w.ERR_STREAM_PUSH_AFTER_EOF,N=w.ERR_METHOD_NOT_IMPLEMENTED,I=w.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,U,$,x;inherits_browserExports(W,n);var C=b.errorOrDestroy,H=["error","close","destroy","pause","resume"];function q(B,F,Y){if(typeof B.prependListener=="function")return B.prependListener(F,Y);!B._events||!B._events[F]?B.on(F,Y):Array.isArray(B._events[F])?B._events[F].unshift(Y):B._events[F]=[Y,B._events[F]]}function K(B,F,Y){t=t||require_stream_duplex(),B=B||{},typeof Y!="boolean"&&(Y=F instanceof t),this.objectMode=!!B.objectMode,Y&&(this.objectMode=this.objectMode||!!B.readableObjectMode),this.highWaterMark=k(this,B,"readableHighWaterMark",Y),this.buffer=new _,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=B.emitClose!==!1,this.autoDestroy=!!B.autoDestroy,this.destroyed=!1,this.defaultEncoding=B.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,B.encoding&&(U||(U=requireString_decoder().StringDecoder),this.decoder=new U(B.encoding),this.encoding=B.encoding)}function W(B){if(t=t||require_stream_duplex(),!(this instanceof W))return new W(B);var F=this instanceof t;this._readableState=new K(B,this,F),this.readable=!0,B&&(typeof B.read=="function"&&(this._read=B.read),typeof B.destroy=="function"&&(this._destroy=B.destroy)),n.call(this)}Object.defineProperty(W.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(F){this._readableState&&(this._readableState.destroyed=F)}}),W.prototype.destroy=b.destroy,W.prototype._undestroy=b.undestroy,W.prototype._destroy=function(B,F){F(B)},W.prototype.push=function(B,F){var Y=this._readableState,ae;return Y.objectMode?ae=!0:typeof B=="string"&&(F=F||Y.defaultEncoding,F!==Y.encoding&&(B=a.from(B,F),F=""),ae=!0),Z(this,B,F,!1,ae)},W.prototype.unshift=function(B){return Z(this,B,null,!0,!1)};function Z(B,F,Y,ae,ve){m("readableAddChunk",F);var me=B._readableState;if(F===null)me.reading=!1,pe(B,me);else{var ye;if(ve||(ye=ie(me,F)),ye)C(B,ye);else if(me.objectMode||F&&F.length>0)if(typeof F!="string"&&!me.objectMode&&Object.getPrototypeOf(F)!==a.prototype&&(F=c(F)),ae)me.endEmitted?C(B,new I):ee(B,me,F,!0);else if(me.ended)C(B,new P);else{if(me.destroyed)return!1;me.reading=!1,me.decoder&&!Y?(F=me.decoder.write(F),me.objectMode||F.length!==0?ee(B,me,F,!1):he(B,me)):ee(B,me,F,!1)}else ae||(me.reading=!1,he(B,me))}return!me.ended&&(me.length<me.highWaterMark||me.length===0)}function ee(B,F,Y,ae){F.flowing&&F.length===0&&!F.sync?(F.awaitDrain=0,B.emit("data",Y)):(F.length+=F.objectMode?1:Y.length,ae?F.buffer.unshift(Y):F.buffer.push(Y),F.needReadable&&ue(B)),he(B,F)}function ie(B,F){var Y;return!u(F)&&typeof F!="string"&&F!==void 0&&!B.objectMode&&(Y=new O("chunk",["string","Buffer","Uint8Array"],F)),Y}W.prototype.isPaused=function(){return this._readableState.flowing===!1},W.prototype.setEncoding=function(B){U||(U=requireString_decoder().StringDecoder);var F=new U(B);this._readableState.decoder=F,this._readableState.encoding=this._readableState.decoder.encoding;for(var Y=this._readableState.buffer.head,ae="";Y!==null;)ae+=F.write(Y.data),Y=Y.next;return this._readableState.buffer.clear(),ae!==""&&this._readableState.buffer.push(ae),this._readableState.length=ae.length,this};var se=1073741824;function ce(B){return B>=se?B=se:(B--,B|=B>>>1,B|=B>>>2,B|=B>>>4,B|=B>>>8,B|=B>>>16,B++),B}function fe(B,F){return B<=0||F.length===0&&F.ended?0:F.objectMode?1:B!==B?F.flowing&&F.length?F.buffer.head.data.length:F.length:(B>F.highWaterMark&&(F.highWaterMark=ce(B)),B<=F.length?B:F.ended?F.length:(F.needReadable=!0,0))}W.prototype.read=function(B){m("read",B),B=parseInt(B,10);var F=this._readableState,Y=B;if(B!==0&&(F.emittedReadable=!1),B===0&&F.needReadable&&((F.highWaterMark!==0?F.length>=F.highWaterMark:F.length>0)||F.ended))return m("read: emitReadable",F.length,F.ended),F.length===0&&F.ended?X(this):ue(this),null;if(B=fe(B,F),B===0&&F.ended)return F.length===0&&X(this),null;var ae=F.needReadable;m("need readable",ae),(F.length===0||F.length-B<F.highWaterMark)&&(ae=!0,m("length less than watermark",ae)),F.ended||F.reading?(ae=!1,m("reading or ended",ae)):ae&&(m("do read"),F.reading=!0,F.sync=!0,F.length===0&&(F.needReadable=!0),this._read(F.highWaterMark),F.sync=!1,F.reading||(B=fe(Y,F)));var ve;return B>0?ve=z(B,F):ve=null,ve===null?(F.needReadable=F.length<=F.highWaterMark,B=0):(F.length-=B,F.awaitDrain=0),F.length===0&&(F.ended||(F.needReadable=!0),Y!==B&&F.ended&&X(this)),ve!==null&&this.emit("data",ve),ve};function pe(B,F){if(m("onEofChunk"),!F.ended){if(F.decoder){var Y=F.decoder.end();Y&&Y.length&&(F.buffer.push(Y),F.length+=F.objectMode?1:Y.length)}F.ended=!0,F.sync?ue(B):(F.needReadable=!1,F.emittedReadable||(F.emittedReadable=!0,ge(B)))}}function ue(B){var F=B._readableState;m("emitReadable",F.needReadable,F.emittedReadable),F.needReadable=!1,F.emittedReadable||(m("emitReadable",F.flowing),F.emittedReadable=!0,dist.process.nextTick(ge,B))}function ge(B){var F=B._readableState;m("emitReadable_",F.destroyed,F.length,F.ended),!F.destroyed&&(F.length||F.ended)&&(B.emit("readable"),F.emittedReadable=!1),F.needReadable=!F.flowing&&!F.ended&&F.length<=F.highWaterMark,J(B)}function he(B,F){F.readingMore||(F.readingMore=!0,dist.process.nextTick(_e,B,F))}function _e(B,F){for(;!F.reading&&!F.ended&&(F.length<F.highWaterMark||F.flowing&&F.length===0);){var Y=F.length;if(m("maybeReadMore read 0"),B.read(0),Y===F.length)break}F.readingMore=!1}W.prototype._read=function(B){C(this,new N("_read()"))},W.prototype.pipe=function(B,F){var Y=this,ae=this._readableState;switch(ae.pipesCount){case 0:ae.pipes=B;break;case 1:ae.pipes=[ae.pipes,B];break;default:ae.pipes.push(B);break}ae.pipesCount+=1,m("pipe count=%d opts=%j",ae.pipesCount,F);var ve=(!F||F.end!==!1)&&B!==dist.process.stdout&&B!==dist.process.stderr,me=ve?Ee:Ae;ae.endEmitted?dist.process.nextTick(me):Y.once("end",me),B.on("unpipe",ye);function ye(Re,ke){m("onunpipe"),Re===Y&&ke&&ke.hasUnpiped===!1&&(ke.hasUnpiped=!0,Te())}function Ee(){m("onend"),B.end()}var ne=re(Y);B.on("drain",ne);var be=!1;function Te(){m("cleanup"),B.removeListener("close",we),B.removeListener("finish",Oe),B.removeListener("drain",ne),B.removeListener("error",Ce),B.removeListener("unpipe",ye),Y.removeListener("end",Ee),Y.removeListener("end",Ae),Y.removeListener("data",Se),be=!0,ae.awaitDrain&&(!B._writableState||B._writableState.needDrain)&&ne()}Y.on("data",Se);function Se(Re){m("ondata");var ke=B.write(Re);m("dest.write",ke),ke===!1&&((ae.pipesCount===1&&ae.pipes===B||ae.pipesCount>1&&oe(ae.pipes,B)!==-1)&&!be&&(m("false write response, pause",ae.awaitDrain),ae.awaitDrain++),Y.pause())}function Ce(Re){m("onerror",Re),Ae(),B.removeListener("error",Ce),e(B,"error")===0&&C(B,Re)}q(B,"error",Ce);function we(){B.removeListener("finish",Oe),Ae()}B.once("close",we);function Oe(){m("onfinish"),B.removeListener("close",we),Ae()}B.once("finish",Oe);function Ae(){m("unpipe"),Y.unpipe(B)}return B.emit("pipe",Y),ae.flowing||(m("pipe resume"),Y.resume()),B};function re(B){return function(){var Y=B._readableState;m("pipeOnDrain",Y.awaitDrain),Y.awaitDrain&&Y.awaitDrain--,Y.awaitDrain===0&&e(B,"data")&&(Y.flowing=!0,J(B))}}W.prototype.unpipe=function(B){var F=this._readableState,Y={hasUnpiped:!1};if(F.pipesCount===0)return this;if(F.pipesCount===1)return B&&B!==F.pipes?this:(B||(B=F.pipes),F.pipes=null,F.pipesCount=0,F.flowing=!1,B&&B.emit("unpipe",this,Y),this);if(!B){var ae=F.pipes,ve=F.pipesCount;F.pipes=null,F.pipesCount=0,F.flowing=!1;for(var me=0;me<ve;me++)ae[me].emit("unpipe",this,{hasUnpiped:!1});return this}var ye=oe(F.pipes,B);return ye===-1?this:(F.pipes.splice(ye,1),F.pipesCount-=1,F.pipesCount===1&&(F.pipes=F.pipes[0]),B.emit("unpipe",this,Y),this)},W.prototype.on=function(B,F){var Y=n.prototype.on.call(this,B,F),ae=this._readableState;return B==="data"?(ae.readableListening=this.listenerCount("readable")>0,ae.flowing!==!1&&this.resume()):B==="readable"&&!ae.endEmitted&&!ae.readableListening&&(ae.readableListening=ae.needReadable=!0,ae.flowing=!1,ae.emittedReadable=!1,m("on readable",ae.length,ae.reading),ae.length?ue(this):ae.reading||dist.process.nextTick(Q,this)),Y},W.prototype.addListener=W.prototype.on,W.prototype.removeListener=function(B,F){var Y=n.prototype.removeListener.call(this,B,F);return B==="readable"&&dist.process.nextTick(V,this),Y},W.prototype.removeAllListeners=function(B){var F=n.prototype.removeAllListeners.apply(this,arguments);return(B==="readable"||B===void 0)&&dist.process.nextTick(V,this),F};function V(B){var F=B._readableState;F.readableListening=B.listenerCount("readable")>0,F.resumeScheduled&&!F.paused?F.flowing=!0:B.listenerCount("data")>0&&B.resume()}function Q(B){m("readable nexttick read 0"),B.read(0)}W.prototype.resume=function(){var B=this._readableState;return B.flowing||(m("resume"),B.flowing=!B.readableListening,j(this,B)),B.paused=!1,this};function j(B,F){F.resumeScheduled||(F.resumeScheduled=!0,dist.process.nextTick(le,B,F))}function le(B,F){m("resume",F.reading),F.reading||B.read(0),F.resumeScheduled=!1,B.emit("resume"),J(B),F.flowing&&!F.reading&&B.read(0)}W.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function J(B){var F=B._readableState;for(m("flow",F.flowing);F.flowing&&B.read()!==null;);}W.prototype.wrap=function(B){var F=this,Y=this._readableState,ae=!1;B.on("end",function(){if(m("wrapped end"),Y.decoder&&!Y.ended){var ye=Y.decoder.end();ye&&ye.length&&F.push(ye)}F.push(null)}),B.on("data",function(ye){if(m("wrapped data"),Y.decoder&&(ye=Y.decoder.write(ye)),!(Y.objectMode&&ye==null)&&!(!Y.objectMode&&(!ye||!ye.length))){var Ee=F.push(ye);Ee||(ae=!0,B.pause())}});for(var ve in B)this[ve]===void 0&&typeof B[ve]=="function"&&(this[ve]=function(Ee){return function(){return B[Ee].apply(B,arguments)}}(ve));for(var me=0;me<H.length;me++)B.on(H[me],this.emit.bind(this,H[me]));return this._read=function(ye){m("wrapped _read",ye),ae&&(ae=!1,B.resume())},this},typeof Symbol=="function"&&(W.prototype[Symbol.asyncIterator]=function(){return $===void 0&&($=requireAsync_iterator()),$(this)}),Object.defineProperty(W.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(W.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(W.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(F){this._readableState&&(this._readableState.flowing=F)}}),W._fromList=z,Object.defineProperty(W.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function z(B,F){if(F.length===0)return null;var Y;return F.objectMode?Y=F.buffer.shift():!B||B>=F.length?(F.decoder?Y=F.buffer.join(""):F.buffer.length===1?Y=F.buffer.first():Y=F.buffer.concat(F.length),F.buffer.clear()):Y=F.buffer.consume(B,F.decoder),Y}function X(B){var F=B._readableState;m("endReadable",F.endEmitted),F.endEmitted||(F.ended=!0,dist.process.nextTick(te,F,B))}function te(B,F){if(m("endReadableNT",B.endEmitted,B.length),!B.endEmitted&&B.length===0&&(B.endEmitted=!0,F.readable=!1,F.emit("end"),B.autoDestroy)){var Y=F._writableState;(!Y||Y.autoDestroy&&Y.finished)&&F.destroy()}}typeof Symbol=="function"&&(W.from=function(B,F){return x===void 0&&(x=requireFromBrowser()),x(W,B,F)});function oe(B,F){for(var Y=0,ae=B.length;Y<ae;Y++)if(B[Y]===F)return Y;return-1}return _stream_readable}var _stream_transform=Transform$1,_require$codes$1=errorsBrowser.codes,ERR_METHOD_NOT_IMPLEMENTED=_require$codes$1.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK=_require$codes$1.ERR_MULTIPLE_CALLBACK,ERR_TRANSFORM_ALREADY_TRANSFORMING=_require$codes$1.ERR_TRANSFORM_ALREADY_TRANSFORMING,ERR_TRANSFORM_WITH_LENGTH_0=_require$codes$1.ERR_TRANSFORM_WITH_LENGTH_0,Duplex=require_stream_duplex();inherits_browserExports(Transform$1,Duplex);function afterTransform(t,e){var n=this._transformState;n.transforming=!1;var a=n.writecb;if(a===null)return this.emit("error",new ERR_MULTIPLE_CALLBACK);n.writechunk=null,n.writecb=null,e!=null&&this.push(e),a(t);var s=this._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}function Transform$1(t){if(!(this instanceof Transform$1))return new Transform$1(t);Duplex.call(this,t),this._transformState={afterTransform:afterTransform.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",prefinish)}function prefinish(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,n){done(t,e,n)}):done(this,null,null)}Transform$1.prototype.push=function(t,e){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,t,e)};Transform$1.prototype._transform=function(t,e,n){n(new ERR_METHOD_NOT_IMPLEMENTED("_transform()"))};Transform$1.prototype._write=function(t,e,n){var a=this._transformState;if(a.writecb=n,a.writechunk=t,a.writeencoding=e,!a.transforming){var s=this._readableState;(a.needTransform||s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}};Transform$1.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Transform$1.prototype._destroy=function(t,e){Duplex.prototype._destroy.call(this,t,function(n){e(n)})};function done(t,e,n){if(e)return t.emit("error",e);if(n!=null&&t.push(n),t._writableState.length)throw new ERR_TRANSFORM_WITH_LENGTH_0;if(t._transformState.transforming)throw new ERR_TRANSFORM_ALREADY_TRANSFORMING;return t.push(null)}var _stream_passthrough=PassThrough,Transform=_stream_transform;inherits_browserExports(PassThrough,Transform);function PassThrough(t){if(!(this instanceof PassThrough))return new PassThrough(t);Transform.call(this,t)}PassThrough.prototype._transform=function(t,e,n){n(null,t)};var eos;function once(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var _require$codes=errorsBrowser.codes,ERR_MISSING_ARGS=_require$codes.ERR_MISSING_ARGS,ERR_STREAM_DESTROYED=_require$codes.ERR_STREAM_DESTROYED;function noop(t){if(t)throw t}function isRequest(t){return t.setHeader&&typeof t.abort=="function"}function destroyer(t,e,n,a){a=once(a);var s=!1;t.on("close",function(){s=!0}),eos===void 0&&(eos=endOfStream),eos(t,{readable:e,writable:n},function(u){if(u)return a(u);s=!0,a()});var c=!1;return function(u){if(!s&&!c){if(c=!0,isRequest(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();a(u||new ERR_STREAM_DESTROYED("pipe"))}}}function call(t){t()}function pipe(t,e){return t.pipe(e)}function popCallback(t){return!t.length||typeof t[t.length-1]!="function"?noop:t.pop()}function pipeline(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var a=popCallback(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new ERR_MISSING_ARGS("streams");var s,c=e.map(function(u,d){var m=d<e.length-1,_=d>0;return destroyer(u,m,_,function(b){s||(s=b),b&&c.forEach(call),!m&&(c.forEach(call),a(s))})});return e.reduce(pipe)}var pipeline_1=pipeline;(function(t,e){e=t.exports=require_stream_readable(),e.Stream=e,e.Readable=e,e.Writable=require_stream_writable(),e.Duplex=require_stream_duplex(),e.Transform=_stream_transform,e.PassThrough=_stream_passthrough,e.finished=endOfStream,e.pipeline=pipeline_1})(readableBrowser,readableBrowser.exports);var readableBrowserExports=readableBrowser.exports;/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let promise;var queueMicrotask_1=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:commonjsGlobal$1):t=>(promise||(promise=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0));function assign(t,e){for(const n in e)Object.defineProperty(t,n,{value:e[n],enumerable:!0,configurable:!0});return t}function createError(t,e,n){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");n||(n={}),typeof e=="object"&&(n=e,e=""),e&&(n.code=e);try{return assign(t,n)}catch{n.message=t.message,n.stack=t.stack;const s=function(){};return s.prototype=Object.create(Object.getPrototypeOf(t)),assign(new s,n)}}var errCode$1=createError;/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const debug=browserExports$1("simple-peer"),getBrowserRTC=getBrowserRtc,randombytes=browserExports,stream=readableBrowserExports,queueMicrotask$1=queueMicrotask_1,errCode=errCode$1,{Buffer}=buffer,MAX_BUFFERED_AMOUNT=64*1024,ICECOMPLETE_TIMEOUT=5*1e3,CHANNEL_CLOSING_TIMEOUT=5*1e3;function filterTrickle(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function warn(t){console.warn(t)}class Peer extends stream.Duplex{constructor(e){if(e=Object.assign({allowHalfOpen:!1},e),super(e),this._id=randombytes(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||randombytes(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||Peer.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},Peer.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(n=>n),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||ICECOMPLETE_TIMEOUT,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:getBrowserRTC(),!this._wrtc)throw errCode(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(n){this.destroy(errCode(n,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=n=>{this._onIceCandidate(n)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(n=>{this.destroy(errCode(n,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=n=>{this._setupData(n)},this.streams&&this.streams.forEach(n=>{this.addStream(n)}),this._pc.ontrack=n=>{this._onTrack(n)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this.destroying){if(this.destroyed)throw errCode(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof e=="string")try{e=JSON.parse(e)}catch{e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(n=>{this._addIceCandidate(n)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(n=>{this.destroy(errCode(n,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(errCode(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){const n=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(n).catch(a=>{!n.address||n.address.endsWith(".local")?warn("Ignoring unsupported ICE candidate."):this.destroy(errCode(a,"ERR_ADD_ICE_CANDIDATE"))})}send(e){if(!this.destroying){if(this.destroyed)throw errCode(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}addTransceiver(e,n){if(!this.destroying){if(this.destroyed)throw errCode(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,n),this._needsNegotiation()}catch(a){this.destroy(errCode(a,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:n}})}}addStream(e){if(!this.destroying){if(this.destroyed)throw errCode(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),e.getTracks().forEach(n=>{this.addTrack(n,e)})}}addTrack(e,n){if(this.destroying)return;if(this.destroyed)throw errCode(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const a=this._senderMap.get(e)||new Map;let s=a.get(n);if(!s)s=this._pc.addTrack(e,n),a.set(n,s),this._senderMap.set(e,a),this._needsNegotiation();else throw s.removed?errCode(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):errCode(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,n,a){if(this.destroying)return;if(this.destroyed)throw errCode(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const s=this._senderMap.get(e),c=s?s.get(a):null;if(!c)throw errCode(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");n&&this._senderMap.set(n,s),c.replaceTrack!=null?c.replaceTrack(n):this.destroy(errCode(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,n){if(this.destroying)return;if(this.destroyed)throw errCode(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const a=this._senderMap.get(e),s=a?a.get(n):null;if(!s)throw errCode(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{s.removed=!0,this._pc.removeTrack(s)}catch(c){c.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(s):this.destroy(errCode(c,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){if(!this.destroying){if(this.destroyed)throw errCode(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),e.getTracks().forEach(n=>{this.removeTrack(n,e)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,queueMicrotask$1(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw errCode(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(e){this._destroy(e,()=>{})}_destroy(e,n){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),queueMicrotask$1(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),n()}))}_setupData(e){if(!e.channel)return this.destroy(errCode(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=MAX_BUFFERED_AMOUNT),this.channelName=this._channel.label,this._channel.onmessage=a=>{this._onChannelMessage(a)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=a=>{const s=a.error instanceof Error?a.error:new Error(`Datachannel error: ${a.message} ${a.filename}:${a.lineno}:${a.colno}`);this.destroy(errCode(s,"ERR_DATA_CHANNEL"))};let n=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(n&&this._onChannelClose(),n=!0):n=!1},CHANNEL_CLOSING_TIMEOUT)}_read(){}_write(e,n,a){if(this.destroyed)return a(errCode(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(s){return this.destroy(errCode(s,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>MAX_BUFFERED_AMOUNT?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=a):a(null)}else this._debug("write before connect"),this._chunk=e,this._cb=a}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=filterTrickle(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const n=()=>{if(this.destroyed)return;const c=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:c.type,sdp:c.sdp})},a=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?n():this.once("_iceComplete",n))},s=c=>{this.destroy(errCode(c,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(a).catch(s)}).catch(e=>{this.destroy(errCode(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=filterTrickle(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const n=()=>{if(this.destroyed)return;const c=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:c.type,sdp:c.sdp}),this.initiator||this._requestMissingTransceivers()},a=()=>{this.destroyed||(this.trickle||this._iceComplete?n():this.once("_iceComplete",n))},s=c=>{this.destroy(errCode(c,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(a).catch(s)}).catch(e=>{this.destroy(errCode(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(errCode(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,n=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,n),this.emit("iceStateChange",e,n),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(errCode(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(errCode(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const n=a=>(Object.prototype.toString.call(a.values)==="[object Array]"&&a.values.forEach(s=>{Object.assign(a,s)}),a);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(a=>{const s=[];a.forEach(c=>{s.push(n(c))}),e(null,s)},a=>e(a)):this._pc.getStats.length>0?this._pc.getStats(a=>{if(this.destroyed)return;const s=[];a.result().forEach(c=>{const u={};c.names().forEach(d=>{u[d]=c.stat(d)}),u.id=c.id,u.type=c.type,u.timestamp=c.timestamp,s.push(n(u))}),e(null,s)},a=>e(a)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats((n,a)=>{if(this.destroyed)return;n&&(a=[]);const s={},c={},u={};let d=!1;a.forEach(_=>{(_.type==="remotecandidate"||_.type==="remote-candidate")&&(s[_.id]=_),(_.type==="localcandidate"||_.type==="local-candidate")&&(c[_.id]=_),(_.type==="candidatepair"||_.type==="candidate-pair")&&(u[_.id]=_)});const m=_=>{d=!0;let b=c[_.localCandidateId];b&&(b.ip||b.address)?(this.localAddress=b.ip||b.address,this.localPort=Number(b.port)):b&&b.ipAddress?(this.localAddress=b.ipAddress,this.localPort=Number(b.portNumber)):typeof _.googLocalAddress=="string"&&(b=_.googLocalAddress.split(":"),this.localAddress=b[0],this.localPort=Number(b[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let S=s[_.remoteCandidateId];S&&(S.ip||S.address)?(this.remoteAddress=S.ip||S.address,this.remotePort=Number(S.port)):S&&S.ipAddress?(this.remoteAddress=S.ipAddress,this.remotePort=Number(S.portNumber)):typeof _.googRemoteAddress=="string"&&(S=_.googRemoteAddress.split(":"),this.remoteAddress=S[0],this.remotePort=Number(S[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(a.forEach(_=>{_.type==="transport"&&_.selectedCandidatePairId&&m(u[_.selectedCandidatePairId]),(_.type==="googCandidatePair"&&_.googActiveConnection==="true"||(_.type==="candidatepair"||_.type==="candidate-pair")&&_.selected)&&m(_)}),!d&&(!Object.keys(u).length||Object.keys(c).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(b){return this.destroy(errCode(b,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const _=this._cb;this._cb=null,_(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>MAX_BUFFERED_AMOUNT||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let n=e.data;n instanceof ArrayBuffer&&(n=Buffer.from(n)),this.push(n)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(n=>{this._debug("on track"),this.emit("track",e.track,n),this._remoteTracks.push({track:e.track,stream:n}),!this._remoteStreams.some(a=>a.id===n.id)&&(this._remoteStreams.push(n),queueMicrotask$1(()=>{this._debug("on stream"),this.emit("stream",n)}))})}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],debug.apply(null,e)}}Peer.WEBRTC_SUPPORT=!!getBrowserRTC();Peer.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};Peer.channelConfig={};var simplePeer=Peer;const SimplePeer=getDefaultExportFromCjs$1(simplePeer);class SimplePeerConnection{constructor(){de(this,"lastMsgRecivedTimestamp");de(this,"connectionState",nStore(ConnectionStates.init));de(this,"latestRecivedDataMessage",nStore(null));de(this,"outgoingSignalingMessages",nStore(null));de(this,"currentVideoStream",nStore(null));de(this,"_p");de(this,"_msgSendQueue",[]);de(this,"_reconnectAttemptCount");de(this,"_shouldReconnect")}async start(e,n=!0){this._shouldReconnect=n,e=Object.assign({},e,SimplePeer.config),this._p=new SimplePeer(e),this._p._debug=(...a)=>console.debug("SIMPLEPEER DEBUG: "+a[0],...a.slice(1)),this._reconnectAttemptCount=0,this.connectionState.set(ConnectionStates.connecting),this._p.on("signal",a=>{console.info("SIMPLEPEER: signal out",a),this.outgoingSignalingMessages.set(JSON.stringify(a))}),this._p.on("connect",()=>{console.count("SIMPLEPEER: Connected"),this._emptyMsgQueue(),this._reconnectAttemptCount=0,this.connectionState.set(ConnectionStates.connected)}),this._p.on("data",a=>{console.log("SIMPLEPEER: got a dc message: ",a),this.lastMsgRecivedTimestamp=Date.now(),this.latestRecivedDataMessage.set(a)}),this._p.on("stream",a=>{console.info("SIMPLEPEER: got video stream: ",a),this.currentVideoStream.set(a);for(let s of a.getTracks())if(s.kind==="video"){s.onmute=()=>this.currentVideoStream.set(null),s.onunmute=()=>this.currentVideoStream.set(a),s.onended=()=>this.currentVideoStream.set(null);break}}),this._p.on("close",()=>{console.log("SIMPLEPEER: connection closed"),this.currentVideoStream.set(null),this._shouldReconnect||this.connectionState.set(ConnectionStates.disconnectedOk)}),this._p.on("error",a=>{if(console.error("SIMPLEPEER: error ",a),this.currentVideoStream.set(null),this._shouldReconnect)if(this.connectionState.set(ConnectionStates.reconnecting),this._reconnectAttemptCount++,this._reconnectAttemptCount<10){setTimeout(()=>{this._p.reconnect()},2e3);return}else console.error("SIMPLEPEER: failed to reconnect after 10 attempts, giving up.");this._p.destroy(),this.connectionState.set(ConnectionStates.failed)})}stop(){this.connectionState.set(ConnectionStates.disconnectedOk),this.currentVideoStream.set(null),this._shouldReconnect=!1,this._p&&this._p.destroy()}ingestSignalingMsg(e){try{const n=JSON.parse(e);if(this._p.destroyed)return;console.info("SIMPLEPEER: signal in",n),this._p.signal(n)}catch(n){console.warn("failed to parse & ingest simplepeer signalling message: ",e,n.message)}}sendMessage(e){this._msgSendQueue.push(e),this._emptyMsgQueue()}_emptyMsgQueue(){if(!this._p||!this._p.connected)return!1;for(this._msgSendQueue.length;this._msgSendQueue.length>0;){const e=this._msgSendQueue.shift();try{this._p.send(e)}catch(n){console.error("failed to send message over simplepeer data channel: ",n.message),this._msgSendQueue.unshift(e)}}}}const appReady=nStore(!1),debugPageModeActive=nStore(!1);nStore(!1);const fullscreenOpen=nStore(!1),sidebarExpanded=nStore(!1);nStore(null);nStore("raspberrypi.local");const rovPeerIdEndNumber=nStore(0);nStore(!1);const isRovDriver=nStore(!1),ourPeerId=nStore("No Peer Id");nStore(null);nStore(null);var ToastSeverity=(t=>(t.success="success",t.info="tertiary",t.warning="warning",t.error="error",t))(ToastSeverity||{});const toastHistoryMap=new Map,toastHistoryStore=nStore([]),setToastHistory=t=>{toastHistoryMap.set(t.msg,t),toastHistoryStore.set(Array.from(toastHistoryMap.values()).reverse())};let toastTool;const setupToasts=()=>{toastTool=getToastStore(),sidebarExpanded.subscribe(t=>{t&&toastHistoryMap.forEach(e=>{e.closed=!0,toastTool.close(e.toastId)})})};function randomUUID(){const t=Math.random();return Number(t).toString(32)}const showToastMessage=(t,e=2e3,n=!0,a="tertiary",s=null)=>{const c=toastHistoryMap.get(t),u=c?c.toastId:randomUUID();if(sidebarExpanded.get())return setToastHistory({msg:t,severity:a,messageRepeatCount:c?c.messageRepeatCount+1:1,toastId:u,closed:!0}),u;if(toastTool&&(!c||!n)){let d=toastTool.trigger({classes:`variant-filled-${a} w-72`,message:t,timeout:e,callback:({id:m,status:_})=>{if(_=="closed"){const b=toastHistoryMap.get(t);b&&setToastHistory({...b,closed:!0}),s&&s()}},hoverable:!0,autohide:!0});return toastHistoryMap.set(t,{msg:t,toastId:d,closed:!1,severity:a,messageRepeatCount:1}),d}else c.closed&&toastHistoryMap.delete(t),setToastHistory({...c,messageRepeatCount:c.messageRepeatCount+1})},urlParams=new URLSearchParams(window.location.search);function getStringQueryParam(t,e){const n=urlParams.get(t);if(n==null||n===""){if(e===void 0)throw new Error("Missing required url query parameter (string): "+t);return e}return n}function getBooleanQueryParam(t,e){const n=urlParams.get(t);if(n==null||n===""){if(e===void 0)throw new Error("Missing required boolean url query parameter (boolean): "+t);return e}return n.toLowerCase()!=="false"}const LIVEKIT_LIST_ONLY_TOKEN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ2aWRlbyI6eyJyb29tTGlzdCI6dHJ1ZSwicm9vbUpvaW4iOmZhbHNlLCJjYW5QdWJsaXNoIjpmYWxzZSwiY2FuU3Vic2NyaWJlIjpmYWxzZSwiY2FuUHVibGlzaERhdGEiOmZhbHNlLCJjYW5VcGRhdGVPd25NZXRhZGF0YSI6ZmFsc2V9LCJpYXQiOjE2OTE0NTEzNDEsIm5iZiI6MTY5MTQ1MTM0MSwiZXhwIjoxMTE1MjI1MTM0MSwiaXNzIjoiQVBJSGQ3Qm9hOVJVVWlUIiwic3ViIjoibHQiLCJqdGkiOiJsdCJ9.X5fI6ceu2aLf0bc-h3PKc-u2PRzSAgVZEpK5FjScRGQ",URL_PARAMS={DEBUG_MODE:getBooleanQueryParam("DEBUG_MODE",!1),SHOW_REMOTE_LOGS:getBooleanQueryParam("SHOW_REMOTE_LOGS",!0),LIVEKIT_CLOUD_ENDPOINT:getStringQueryParam("LIVEKIT_CLOUD_URL","https://rov-web.livekit.cloud"),LIVEKIT_LOCAL_ENDPOINT:getStringQueryParam("LIVEKIT_LOCAL_URL","http://localhost:7880")},PING_INTERVAL=1e3,MOVE_MSG_TIMEOUT=100;var GPAD_STANDARD_BUTTON_INDEX=(t=>(t[t.A=0]="A",t[t.B=1]="B",t[t.X=2]="X",t[t.Y=3]="Y",t[t.LB=4]="LB",t[t.RB=5]="RB",t[t.LT=6]="LT",t[t.RT=7]="RT",t[t.SELECT=8]="SELECT",t[t.START=9]="START",t[t.LSTICK=10]="LSTICK",t[t.RSTICK=11]="RSTICK",t[t.DPAD_UP=12]="DPAD_UP",t[t.DPAD_DOWN=13]="DPAD_DOWN",t[t.DPAD_LEFT=14]="DPAD_LEFT",t[t.DPAD_RIGHT=15]="DPAD_RIGHT",t[t.VENDOR=16]="VENDOR",t))(GPAD_STANDARD_BUTTON_INDEX||{});const GPAD_STANDARD_BUTTON_INDEX_TO_MAVLINK_INDEX={0:0,1:1,2:2,3:3,4:9,5:10,8:4,9:6,10:7,11:8,12:11,13:12,14:13,15:14,16:5},GAME_CONTROLLER_BUTTON_CONFIG=[{btnName:"button_1",helpLabel:"ENABLE Thrusters / Take Control / Manual Mode",tooltipPlacement:"left"},{btnName:"button_2",helpLabel:"STOP Thrusters",tooltipPlacement:"left"},{btnName:"button_3",helpLabel:"Stablize Mode",tooltipPlacement:"left"},{btnName:"button_4",helpLabel:"Depth Hold Mode",tooltipPlacement:"left"},{btnName:"shoulder_button_front_left",helpLabel:"Open Claw",tooltipPlacement:"right",fireWhileHolding:!0},{btnName:"shoulder_button_front_right",helpLabel:"Close Claw",tooltipPlacement:"left",fireWhileHolding:!0},{btnName:"shoulder_trigger_back_left",helpLabel:"Slow motors (Use +/- button for claw)",fireWhileHolding:!0,tooltipPlacement:"right"},{btnName:"shoulder_trigger_back_right",helpLabel:"Slow motors (Use +/- button for claw)",fireWhileHolding:!0,tooltipPlacement:"left"},{btnName:"select_button",helpLabel:"Move-Roll Toggle",tooltipPlacement:"right"},{btnName:"start_button",helpLabel:"Acrobatic Mode",tooltipPlacement:"left"},{btnName:"stick_button_left",helpLabel:"Move Forward-Back & Turn (TBD: Click & Hold for alt gamepad actions)",tooltipPlacement:"right"},{btnName:"stick_button_right",helpLabel:"Move Up-Down & Left-Right",tooltipPlacement:"left"},{btnName:"d_pad_up",helpLabel:"Look Up",fireWhileHolding:!0,tooltipPlacement:"right"},{btnName:"d_pad_down",helpLabel:"Look Down",fireWhileHolding:!0,tooltipPlacement:"right"},{btnName:"d_pad_left",helpLabel:"Dim Lights",fireWhileHolding:!0,tooltipPlacement:"right"},{btnName:"d_pad_right",helpLabel:"Brighten Lights",fireWhileHolding:!0,tooltipPlacement:"right"}],ONSCREEN_GPAD_BUTTON_LABELS=["button_1","button_2","button_3","button_4","shoulder_button_front_left","shoulder_button_front_right","shoulder_trigger_back_left","shoulder_trigger_back_right","select_button","start_button","stick_button_left","stick_button_right","d_pad_up","d_pad_down","d_pad_left","d_pad_right"],ONSCREEN_GPAD_BUTTON_TOUCHED_CLASS="touched",ONSCREEN_GPAD_BUTTON_PRESSED_CLASS="pressed",networkLatencyMs=nStore(1/0),depthM=nStore(1/0),waterTempC=nStore(1/0),internalTempC=nStore(1/0);nStore(1/0);const pressureMbar=nStore(1/0),rovHeading=nStore(0),rovPitch=nStore(0),rovRoll=nStore(0);function updateSensorValues(t){for(let e of t.MeasurementUpdates)e.MeasurementType==rov_actions_proto.SensorMeasurmentTypes.pressure_mbar?(pressureMbar.set(e.Value),depthM.set((e.Value-SEA_LEVEL_PRESSURE)*.009962143853)):e.MeasurementType==rov_actions_proto.SensorMeasurmentTypes.water_temp_celsius?waterTempC.set(e.Value):e.MeasurementType==rov_actions_proto.SensorMeasurmentTypes.internal_temp_celsius?internalTempC.set(e.Value):e.MeasurementType==rov_actions_proto.SensorMeasurmentTypes.yaw_degrees?rovHeading.set(e.Value):e.MeasurementType==rov_actions_proto.SensorMeasurmentTypes.pitch_degrees?rovPitch.set(e.Value):e.MeasurementType==rov_actions_proto.SensorMeasurmentTypes.roll_degrees&&rovRoll.set(e.Value)}let modalTool;const setupModals=()=>{modalTool=getModalStore()};function modalConfirm(t,e,n){console.log("modalConfirm",t,e);const a={type:"confirm",title:t,body:e,response:s=>{s&&n&&n()}};modalTool.trigger(a)}let passwordModalOpen=!1;function modalPasswordPrompt(t,e=""){return new Promise((n,a)=>{if(passwordModalOpen)return a("Password modal already open");passwordModalOpen=!0;const s={type:"prompt",title:t,body:e,valueAttr:{type:"text",placeholder:"password",required:!0},response:c=>{console.log("modalPasswordPrompt response",c),passwordModalOpen=!1,n(c)}};try{modalTool.trigger(s)}catch(c){passwordModalOpen=!1,a(c)}})}function modalScrollingText(t,e,n){const a={type:"alert",title:t,body:e,response:s=>{n&&n(s)}};return modalTool.trigger(a),s=>{modalTool.update(c=>{let u=c.indexOf(a);return c[u].body=c[u].body+`
`+s,c})}}var FlightMode=(t=>(t[t.unknown=-1]="unknown",t[t.manual=19]="manual",t[t.stabilize=0]="stabilize",t[t.acrobatic=1]="acrobatic",t[t.depth_hold=2]="depth_hold",t[t.surface=9]="surface",t))(FlightMode||{});const FlightmodeNameMap={19:"Manual",0:"Stabilize",1:"Acrobatic",2:"Depth Hold",9:"Surface",[-1]:"Unknown"},MavStateNameMap={[MavState.MAV_STATE_UNINIT]:"Uninitialized",[MavState.MAV_STATE_BOOT]:"Booting",[MavState.MAV_STATE_CALIBRATING]:"Calibrating",[MavState.MAV_STATE_STANDBY]:"Standby",[MavState.MAV_STATE_ACTIVE]:"Active",[MavState.MAV_STATE_CRITICAL]:"Critical Failsafe",[MavState.MAV_STATE_EMERGENCY]:"Emergency",[MavState.MAV_STATE_POWEROFF]:"Powering Off",[MavState.MAV_STATE_FLIGHT_TERMINATION]:"Flight Termination"};nStore(1/0);const batteryPercent=nStore(1/0),batteryVoltage=nStore(1/0),batteryCurrent=nStore(1/0),autopilotLoad=nStore(1/0),autopilotErrorCount=nStore(0),autopilotMode=nStore(FlightMode.unknown),autopilotMavState=nStore(MavState.MAV_STATE_UNINIT),autopilotArmed=nStore(!1),cpuTempC=nStore(1/0),cpuUsagePercent=nStore(1/0),memUsagePercent=nStore(1/0),diskUsagePercent=nStore(1/0);function updateSystemMonitorDisplay(t,e,n,a,s){cpuTempC.set(t),cpuUsagePercent.set(e),memUsagePercent.set(n),diskUsagePercent.set(a),s.forEach(c=>{console.warn("System Monitor Warning: "+c),showToastMessage(c,5e3,!0,ToastSeverity.warning)})}function updateBatteryDisplay(t,e,n){batteryPercent.set(t),batteryVoltage.set(e),batteryCurrent.set(n)}function updateAutopilotFlightModeDisplay(t){t in FlightmodeNameMap?autopilotMode.set(t):(showToastMessage("ROV is in unknown flight mode: "+String(t),4e3,!0,ToastSeverity.warning),autopilotMode.set(FlightMode.unknown))}function updateAutopilotStatusDisplay(t){autopilotMavState.set(t)}function updateAutopilotLoadDisplay(t){autopilotLoad.set(t)}function updateAutopilotErrorCountDisplay(t){autopilotErrorCount.set(t)}const handleMavlinkMessage=t=>{if(!t.message)return;if(!t.message.type)return console.debug("@ invalid mavlink message rcvd: ",t);const e=t.message;switch(e.type){case"HEARTBEAT":handleHearbeatRecived(e);break;case"ATTITUDE":handleAttitudeRecived(e);break;case"SYS_STATUS":handleSystemStatusRecived(e);break;case"STATUSTEXT":handleStatusTextRecived(e);break;case"SCALED_PRESSURE":handleScaledPressureRecived(e);break;case"SCALED_PRESSURE2":handleScaledPressure2Recived(e);break;default:URL_PARAMS.DEBUG_MODE&&console.debug("@ unhandled mavlink message "+String(e.type),e)}},handleHearbeatRecived=t=>{if(t.autopilot.type=="MAV_AUTOPILOT_INVALID")return;const e=t.custom_mode;updateAutopilotFlightModeDisplay(e);const n=t.system_status.type||MavState.MAV_STATE_UNINIT;updateAutopilotStatusDisplay(n);const a=t.base_mode.bits,s=(a&MavModeFlag.MAV_MODE_FLAG_SAFETY_ARMED)>0;autopilotArmed.set(s);const c=(a&MavModeFlag.MAV_MODE_FLAG_MANUAL_INPUT_ENABLED)>0,u=(a&MavModeFlag.MAV_MODE_FLAG_HIL_ENABLED)>0,d=(a&MavModeFlag.MAV_MODE_FLAG_STABILIZE_ENABLED)>0,m=(a&MavModeFlag.MAV_MODE_FLAG_GUIDED_ENABLED)>0,_=(a&MavModeFlag.MAV_MODE_FLAG_AUTO_ENABLED)>0,b=(a&MavModeFlag.MAV_MODE_FLAG_TEST_ENABLED)>0;URL_PARAMS.DEBUG_MODE&&console.debug("@  autopilot state",n,"flight mode",e,"armed",s,"manual_enabled",c,"hil_enabled",u,"stabilize_enabled",d,"guided_enabled",m,"auto_enabled",_,"test_enabled",b)},handleAttitudeRecived=t=>{URL_PARAMS.DEBUG_MODE&&console.debug("@  attitude",t),updateSensorValues({MeasurementUpdates:[{MeasurementType:rov_actions_proto.SensorMeasurmentTypes.yaw_degrees,Value:t.yaw/Math.PI*180},{MeasurementType:rov_actions_proto.SensorMeasurmentTypes.pitch_degrees,Value:t.pitch/Math.PI*180},{MeasurementType:rov_actions_proto.SensorMeasurmentTypes.roll_degrees,Value:t.roll/Math.PI*180}]})},handleScaledPressureRecived=t=>{URL_PARAMS.DEBUG_MODE&&console.debug("@  scaled pressure",t),pressureMbar.set(t.press_abs),depthM.set((t.press_abs-SEA_LEVEL_PRESSURE)*.009962143853),internalTempC.set(t.temperature/100)},handleScaledPressure2Recived=t=>{URL_PARAMS.DEBUG_MODE&&console.debug("@  scaled pressure 2",t),waterTempC.set(t.temperature/100)},handleSystemStatusRecived=t=>{URL_PARAMS.DEBUG_MODE&&console.debug("@  system status",t);const e=t.voltage_battery/1e3,n=t.current_battery/100,a=t.errors_comm+t.errors_count1+t.errors_count2+t.errors_count3+t.errors_count4;updateBatteryDisplay(t.battery_remaining,e,n),updateAutopilotErrorCountDisplay(a),updateAutopilotLoadDisplay(t.load),t.errors_comm>0&&showToastMessage(`${a} autopilot errors detected!`,5e3,!0,ToastSeverity.warning),(e<14||t.battery_remaining>0&&t.battery_remaining<10)&&showToastMessage(`Low Battery: ${e.toFixed(2)}volts`,8e3,!0,ToastSeverity.warning),n>20&&showToastMessage(`High Current Draw: ${n.toFixed(1)} amps`,5e3,!0,ToastSeverity.error)},handleStatusTextRecived=t=>{const e=t.severity.type,n=t.text.join("");URL_PARAMS.DEBUG_MODE&&console.debug("@  status text",t);const s={[MavSeverity.MAV_SEVERITY_INFO]:ToastSeverity.info,[MavSeverity.MAV_SEVERITY_DEBUG]:ToastSeverity.info,[MavSeverity.MAV_SEVERITY_NOTICE]:ToastSeverity.info,[MavSeverity.MAV_SEVERITY_WARNING]:ToastSeverity.warning,[MavSeverity.MAV_SEVERITY_ALERT]:ToastSeverity.warning,[MavSeverity.MAV_SEVERITY_CRITICAL]:ToastSeverity.error,[MavSeverity.MAV_SEVERITY_EMERGENCY]:ToastSeverity.error,[MavSeverity.MAV_SEVERITY_ERROR]:ToastSeverity.error}[e]||ToastSeverity.info;showToastMessage(n+" - "+e,5e3,!1,s)};let lastTimeRecvdPong=NaN;class FrontendRovMsgHandlerClass{constructor(){de(this,"replyContinuityCallbacks",[])}handleRecivedMessage(e){let n=new Uint8Array(e);if(!n||n.length===0)return;const a=rov_actions_proto.RovResponse.decode(new Uint8Array(e)),s=a.ExchangeId;if(this.runExchangeCallback(a,s),a.Done)return this.handleDoneMsgRecived(a.Done,s);if(a.Error)return this.handleErrorMsgRecived(a.Error,s);if(a.Pong)return this.handlePongMsgRecived(a.Pong,s);if(a.ContinuedOutput)return this.handleContinuedOutputMsgRecived(a.ContinuedOutput,s);if(a.SensorUpdates)return this.handleSensorUpdatesMsgRecived(a.SensorUpdates,s);if(a.PasswordRequired)return this.handlePasswordRequiredMsgRecived(a.PasswordRequired,s);if(a.PasswordAccepted)return this.handlePasswordAcceptedMsgRecived(a.PasswordAccepted,s);if(a.PasswordInvalid)return this.handlePasswordInvalidMsgRecived(a.PasswordInvalid,s);if(a.DriverChanged)return this.handleDriverChangedMsgRecived(a.DriverChanged,s);if(a.ClientConnected)return this.handleClientConnectedMsgRecived(a.ClientConnected,s);if(a.ClientDisconnected)return this.handleClientDisconnectedMsgRecived(a.ClientDisconnected,s);if(a.SimplepeerSignal&&a.SimplepeerSignal.Message)frontendConnMngr.ingestSimplePeerSignallingMsg(a.SimplepeerSignal.Message);else{if(a.Mavlink)return this.handleMavlinkMessageRecived(a.Mavlink,s);if(a.SystemMonitor)return this.handleSystemMonitorMsgRecived(a.SystemMonitor,s);if(a.LogMessage)return this.handleLogMsgRecived(a.LogMessage,s);console.warn("Unhandled ROV message recived: ",a)}}handleDoneMsgRecived(e,n){URL_PARAMS.DEBUG_MODE&&console.debug("Done: ",e)}handleErrorMsgRecived(e,n){console.warn("ROV Error: ",e),showToastMessage("ROV Error: "+e.Message,2e3,null)}handlePongMsgRecived(e,n){lastTimeRecvdPong=Date.now();const a=lastTimeRecvdPong-Number.parseFloat(e.Time);networkLatencyMs.set(a)}handleContinuedOutputMsgRecived(e,n){URL_PARAMS.DEBUG_MODE&&console.debug("ContinuedOutput: ",n,e)}handleSensorUpdatesMsgRecived(e,n){URL_PARAMS.DEBUG_MODE&&console.debug("SensorUpdates: ",e),updateSensorValues(e)}handleSystemMonitorMsgRecived(e,n){updateSystemMonitorDisplay(e.CpuTemp,e.CpuUsage,e.MemoryUsage,e.DiskUsage,e.Warnings)}handlePasswordRequiredMsgRecived(e,n){URL_PARAMS.DEBUG_MODE&&console.debug("PasswordRequired for rovId:",e.RovId),modalPasswordPrompt("Enter ROV Password","").then(a=>{a?this.sendRovMessage({PasswordAttempt:{Password:a},ExchangeId:n},null):delete this.replyContinuityCallbacks[n]})}handlePasswordAcceptedMsgRecived(e,n){showToastMessage("Password Accepted",1e3,null)}handlePasswordInvalidMsgRecived(e,n){showToastMessage("Wrong Password",1e3,null),this.handlePasswordRequiredMsgRecived(e,n)}handleDriverChangedMsgRecived(e,n){let a=frontendConnMngr.currentLivekitIdentity.get();e.DriverPeerId==a?(showToastMessage("You are now the driver"),isRovDriver.set(!0)):(showToastMessage("ROV Driver is now "+e.DriverPeerId),isRovDriver.set(!1))}handleMavlinkMessageRecived(e,n){if(!e.Message)return;const a=DECODE_TXT(e.Message);try{const s=JSON.parse(a);handleMavlinkMessage(s)}catch{console.warn("@ Mav MSG RECIVED W INVALID JSON: ",a)}}handleClientConnectedMsgRecived(e,n){showToastMessage(e.ClientPeerId+" Connected to ROV",1500,null)}handleClientDisconnectedMsgRecived(e,n){showToastMessage(e.ClientPeerId+" Disconnected from ROV",1500,null)}handleLogMsgRecived(e,n){if(URL_PARAMS.SHOW_REMOTE_LOGS){let a=JSON.parse(e.Message);if(Array.isArray(a)||(a=[a]),a.length===0)return;typeof a[0]=="string"?a[0]="REMOTE LOG: "+a[0]:a.unshift("REMOTE LOG: "),e.Level==rov_actions_proto.LogLevel.Debug?console.debug(...a):e.Level==rov_actions_proto.LogLevel.Info?console.info(...a):e.Level==rov_actions_proto.LogLevel.Warning?console.warn(...a):e.Level==rov_actions_proto.LogLevel.Error?console.error(...a):e.Level==rov_actions_proto.LogLevel.Critical&&console.error(...a)}}sendRovMessage(e,n=null){frontendConnMngr.currentLivekitIdentity.get()!==null&&(e.ExchangeId||(e.ExchangeId=this.replyContinuityCallbacks.length+1),this.replyContinuityCallbacks[e.ExchangeId]||(this.replyContinuityCallbacks[e.ExchangeId]={callback:n,originalMsgData:e}),frontendConnMngr.sendMessageToRov(e,!1))}resendMessage(e){const n=this.replyContinuityCallbacks[e];n&&n.originalMsgData?(console.info("Resending message: ",n.originalMsgData),this.sendRovMessage(n.originalMsgData,n.callback)):console.warn("resendMessage(): No message to resend for ExchangeId: ",e)}runExchangeCallback(e,n){const a=this.replyContinuityCallbacks[n];a&&(a.callback&&a.callback(e),(e.Done||e.Error)&&delete this.replyContinuityCallbacks[n])}}const frontendRovMsgHandler=new FrontendRovMsgHandlerClass;var VideoStreamMethod=(t=>(t.none="none",t.livekit="livekit",t.simplepeer="simplepeer",t))(VideoStreamMethod||{});class FrontendConnectionManager{constructor(){de(this,"connectionState",nStore(ConnectionStates.init));de(this,"livekitConnection",new LivekitViewerConnection);de(this,"mainVideoStream",nStore(void 0));de(this,"currentLivekitIdentity",nStore(null));de(this,"simplepeerConnection");de(this,"livekitRoomPollingInterval",-1);de(this,"openLivekitRoomInfo",nStore([]));de(this,"_cleanupFuncs",{});de(this,"currentVideoStreamMethod",nStore("none"));this.simplepeerConnection=new SimplePeerConnection,changesSubscribe(this.livekitConnection.latestRecivedDataMessage,e=>{const{senderId:n,msg:a}=e;n==this.livekitConnection.getRoomName()&&frontendRovMsgHandler.handleRecivedMessage(a)}),changesSubscribe(this.simplepeerConnection.latestRecivedDataMessage,e=>{frontendRovMsgHandler.handleRecivedMessage(e)}),changesSubscribe(this.simplepeerConnection.outgoingSignalingMessages,e=>{this.sendMessageToRov({SimplepeerSignal:{Message:e}},!0)}),changesSubscribe(this.simplepeerConnection.currentVideoStream,()=>this.updateVideoStream()),changesSubscribe(this.livekitConnection.remoteVideoTrack,()=>this.updateVideoStream())}updateVideoStream(){const e=this.livekitConnection.remoteVideoTrack.get(),n=this.simplepeerConnection.currentVideoStream.get();setTimeout(()=>{n&&n.getVideoTracks().length>0&&!n.getVideoTracks()[0].muted?(this.currentVideoStreamMethod.set("simplepeer"),showToastMessage("Using Direct Video",1e3,!1),e&&e.stop(),this.mainVideoStream.set(n)):e?(this.currentVideoStreamMethod.set("livekit"),showToastMessage("Using Livekit Video",1e3,!1),e.start(),this.mainVideoStream.set(e.mediaStream)):(this.currentVideoStreamMethod.set("none"),showToastMessage("No Camera Stream",1e3,!1,ToastSeverity.error))},100)}async pollForOpenLivekitRooms(e){this.livekitRoomPollingInterval!==-1&&clearInterval(this.livekitRoomPollingInterval);const n=async()=>{if(this.connectionState.get()===ConnectionStates.connected||this.connectionState.get()===ConnectionStates.reconnecting)return;let a;try{a=await listLivekitRoomsWithoutSDK(e,LIVEKIT_LIST_ONLY_TOKEN)}catch(u){return console.warn("LK Error: Could not retrive list of livekit rooms",u),this.openLivekitRoomInfo.set([])}const c=a.filter(u=>u.num_participants>0&&u.metadata.length>0).map(u=>({name:u.name,token:getAuthTokenFromLivekitRoomMetadata(u.metadata)})).sort((u,d)=>u.name>d.name?1:d.name>u.name?-1:0);this.openLivekitRoomInfo.set(c)};await n(),this.livekitRoomPollingInterval=Number(setInterval(n,5e3))}async _keepTrackOfConnectionState(){this._cleanupFuncs.livekitConnState&&this._cleanupFuncs.livekitConnState();const e=changesSubscribe(this.livekitConnection.connectionState,a=>{this.simplepeerConnection&&this.simplepeerConnection.connectionState.get()===ConnectionStates.connected?this.connectionState.set(ConnectionStates.connected):this.connectionState.set(a)}),n=changesSubscribe(this.simplepeerConnection.connectionState,a=>{this.livekitConnection&&this.livekitConnection.connectionState.get()===ConnectionStates.connected?this.connectionState.set(ConnectionStates.connected):this.connectionState.set(a)});this._cleanupFuncs.livekitConnState=()=>{e(),n()}}async initUsingCloudLivekitConnection(){this.livekitConnection.close(),this.pollForOpenLivekitRooms(URL_PARAMS.LIVEKIT_CLOUD_ENDPOINT),await this.livekitConnection.init({hostUrl:URL_PARAMS.LIVEKIT_CLOUD_ENDPOINT,publishVideo:!1,reconnectAttempts:3,roomConnectionConfig:LIVEKIT_FRONTEND_ROOM_CONNECTION_CONFIG,roomConfig:LIVEKIT_FRONTEND_ROOM_CONFIG})}async initUsingLocalLivekitConnection(){this.livekitConnection.close(),this.pollForOpenLivekitRooms(URL_PARAMS.LIVEKIT_LOCAL_ENDPOINT),await this.livekitConnection.init({hostUrl:URL_PARAMS.LIVEKIT_LOCAL_ENDPOINT,publishVideo:!1,reconnectAttempts:3,roomConnectionConfig:LIVEKIT_FRONTEND_ROOM_CONNECTION_CONFIG,roomConfig:LIVEKIT_FRONTEND_ROOM_CONFIG})}async connectToLivekitRoom(e,n){if(!this.livekitConnection||!this.livekitConnection.config)throw new Error("connectToLivekitRoom() called before livekitConnection was initilized");this._keepTrackOfConnectionState(),await this.livekitConnection.start(e,n),this.currentLivekitIdentity.set(this.livekitConnection.getLivekitIdentitiy())}async startSimplePeerConnection(){if(!this.livekitConnection||this.livekitConnection.connectionState.get()!=ConnectionStates.connected)throw new Error("startSimplePeerConnection() called when livekitConnection was not fully connected!");if(!this.simplepeerConnection)throw new Error("startSimplePeerConnection() called without simplepeerConnection in class!");this.simplepeerConnection.start(Object.assign({},SIMPLEPEER_BASE_CONFIG,{initiator:!0,offerOptions:{offerToReceiveVideo:!0}}))}async ingestSimplePeerSignallingMsg(e){const n=this.simplepeerConnection;if(n)n.ingestSignalingMsg(e);else throw new Error("ingestSimplePeerSignallingMsg() called when simplepeerConnection was not initilized!")}async toggleSimplePeerConnection(){if(!this.simplepeerConnection)throw new Error("toggleSimplePeerConnection() called without simplepeerConnection in class!");const e=this.simplepeerConnection.connectionState.get();console.log("toggleSimplePeerConnection(): state",e),[ConnectionStates.disconnectedOk,ConnectionStates.failed,ConnectionStates.init].includes(e)?this.startSimplePeerConnection():this.simplepeerConnection.stop()}async sendMessageToRov(e,n=!1){if(!this.livekitConnection)throw new Error("sendMessageToRov() called before livekitConnection was initilized");n=!1;const a=rov_actions_proto.RovAction.encode(e).finish(),s=this.livekitConnection._rovRoomName;URL_PARAMS.DEBUG_MODE&&console.debug("Sending Message to ",s,n?"reliably":"unreliably",":",e),n&&this.livekitConnection.connectionState.get()===ConnectionStates.connected?await this.livekitConnection.sendMessage(a,n,[s]):this.simplepeerConnection&&this.simplepeerConnection.connectionState.get()===ConnectionStates.connected?await this.simplepeerConnection.sendMessage(a):await this.livekitConnection.sendMessage(a,!1,[s])}async disconnect(){this.simplepeerConnection&&await this.simplepeerConnection.stop(),this.livekitConnection&&await this.livekitConnection.close();for(const e in this._cleanupFuncs)this._cleanupFuncs[e]()}}const frontendConnMngr=new FrontendConnectionManager;var l$2=(t=>(t.up="up",t.down="down",t.left="left",t.right="right",t))(l$2||{}),v=(t=>(t.onOff="onOff",t.variable="variable",t))(v||{}),f$2=(t=>(t.real="real",t.emulated="emulated",t.overlay="overlay",t))(f$2||{});function i(t,e,n){const a=Math.sqrt(t*t+e*e);return a>n?{x:t/a,y:e/a}:{x:t/n,y:e/n}}function o$1(t){if(t instanceof SVGGraphicsElement){t.getAttribute("transform")&&console.warn("Setting Transform origin on an element that already has a transform attribute. This may break the transform!",t);const e=t.getBBox();t.style.transformOrigin=`${e.x+e.width/2}px ${e.y+e.height/2}px`}else if(t instanceof HTMLElement){console.warn("Setting Transform origin on an element that is not an SVG element. This may break the transform!",t);const e=t.getBoundingClientRect();t.style.transformOrigin=`${e.width/2}px ${e.height/2}px`}}var L=Object.defineProperty,M=(t,e,n)=>e in t?L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,h=(t,e,n)=>(M(t,typeof e!="symbol"?e+"":e,n),n);const T=18,A=4,E=class{constructor(t){if(h(this,"getNativeGamepads",()=>[]),h(this,"buttonPressThreshold",.1),h(this,"realGpadToPatchedIndexMap",[]),h(this,"patchedGpadToRealIndexMap",[]),h(this,"emulatedGamepads",[]),h(this,"emulatedGamepadsMetadata",[]),h(this,"undoEventPatch",()=>{}),this.buttonPressThreshold=t||this.buttonPressThreshold,E.instanceRunning)throw new Error("Only one GamepadEmulator instance may exist at a time!");E.instanceRunning=!0,this.undoEventPatch=this.monkeyPatchGamepadEvents(),this.monkeyPatchGetGamepads()}AddEmulatedGamepad(t,e,n=T,a=A){if((t===-1||!t&&t!==0)&&(t=this.nextEmptyEGpadIndex(e)),this.emulatedGamepads[t])return!1;const s={emulation:f$2.emulated,connected:!0,timestamp:Math.floor(Date.now()/1e3),displayId:"Emulated Gamepad "+t,id:"Emulated Gamepad "+t+" (Xinput STANDARD GAMEPAD)",mapping:"standard",index:t,buttons:new Array(n).fill({pressed:!1,value:0,touched:!1},0,n),axes:new Array(a).fill(0,0,a),hapticActuators:[]};this.emulatedGamepads[t]=s,this.emulatedGamepadsMetadata[t]={overlayMode:e};const c=new Event("gamepadconnected");return c.gamepad=s,window.dispatchEvent(c),s}RemoveEmulatedGamepad(t){this.ClearDisplayButtonEventListeners(t),this.ClearDisplayJoystickEventListeners(t);var e=this.emulatedGamepads[t];if(e){delete this.emulatedGamepads[t],delete this.emulatedGamepadsMetadata[t];const n={...e,connected:!1,timestamp:Math.floor(Date.now()/1e3)},a=new Event("gamepaddisconnected");a.gamepad=n,window.dispatchEvent(a)}else console.warn("Error: removing emulated gamepad. No emulated gamepad exists at index "+t)}PressButton(t,e,n,a){if(this.emulatedGamepads[t]===void 0)throw new Error("Error: PressButton() - no emulated gamepad at index "+t+", pass a valid index, or call AddEmulatedGamepad() first to create an emulated gamepad at that index");var s=n>this.buttonPressThreshold;this.emulatedGamepads[t].buttons[e]={pressed:s,value:n||0,touched:s||a||!1}}MoveAxis(t,e,n){if(!this.emulatedGamepads[t])throw new Error("Error: MoveAxis() - no emulated gamepad at index "+t+", pass a valid index, or call AddEmulatedGamepad() first to create an emulated gamepad at that index");this.emulatedGamepads[t].axes[e]=n}AddDisplayButtonEventListeners(t,e){if(!this.emulatedGamepads[t])throw new Error("Error: AddDisplayJoystickEventListeners() - no emulated gamepad at index "+t+", pass a valid index, or call AddEmulatedGamepad() first to create an emulated gamepad at that index");let n=[];for(var a=0;a<e.length;a++){const s=e[a],c=s.buttonIndex,u=s.tapTarget;if(!u){console.warn("AddDisplayButtonEventListeners() - no tap target in button config "+c+", skipping...");continue}const d=S=>{S.changedTouches[0].target==u&&S.preventDefault()};window.addEventListener("touchstart",d,{passive:!1});const m=S=>{const k=S.buttons==1?1:0;(!s.lockTargetWhilePressed||k==0)&&this.PressButton(t,c,k,!0)};u.addEventListener("pointerenter",m);const _=S=>{const k=S.buttons==1?1:0;(!s.lockTargetWhilePressed||k==0)&&this.PressButton(t,c,0,!1)};u.addEventListener("pointerleave",_);const b=S=>{};if(u.addEventListener("pointercancel",b),s.type==v.onOff){const S=w=>{w.preventDefault(),this.PressButton(t,c,1,!0),s.lockTargetWhilePressed?u.setPointerCapture(w.pointerId):u.releasePointerCapture(w.pointerId),console.log("on/off pointer down",u.hasPointerCapture(w.pointerId))};u.addEventListener("pointerdown",S);const k=()=>{this.PressButton(t,c,0,!0)};u.addEventListener("pointerup",k),n.push(function(){window.removeEventListener("touchstart",d),u.removeEventListener("pointerenter",m),u.removeEventListener("pointerleave",_),u.removeEventListener("pointerdown",S),u.removeEventListener("pointerup",k),u.removeEventListener("pointercancel",b)})}else if(s.type==v.variable){const S={...s},k=this.AddDragControlListener(S,(w,O,P)=>{let N=w?this.buttonPressThreshold+1e-5:0;N+=s.directions[l$2.left]||s.directions[l$2.right]?Math.abs(O):0,N+=s.directions[l$2.up]||s.directions[l$2.down]?Math.abs(P):0,this.PressButton(t,s.buttonIndex,Math.min(N,1),w)});n.push(function(){window.removeEventListener("touchstart",d),u.removeEventListener("pointerenter",m),u.removeEventListener("pointerleave",_),u.removeEventListener("pointercancel",b),k()})}}this.emulatedGamepadsMetadata[t].removeButtonListenersFunc=()=>{n.forEach(s=>s())}}AddDisplayJoystickEventListeners(t,e){if(!this.emulatedGamepads[t])throw new Error("Error: AddDisplayJoystickEventListeners() - no emulated gamepad at index "+t+", pass a valid index, or call AddEmulatedGamepad() first to create an emulated gamepad at that index");let n=[];for(let a=0;a<e.length;a++){const s=e[a];if(s.tapTarget==null){console.warn(`AddDisplayJoystickEventListeners() - no tap target in joystick config ${a}, skipping...`);continue}const c=this.AddDragControlListener(s,(u,d,m)=>{s.xAxisIndex!==void 0&&this.MoveAxis(t,s.xAxisIndex,d),s.yAxisIndex!==void 0&&this.MoveAxis(t,s.yAxisIndex,m)});n.push(c)}this.emulatedGamepadsMetadata[t].removeJoystickListenersFunc=()=>{n.forEach(a=>a())}}ClearDisplayButtonEventListeners(t){var e;this.emulatedGamepadsMetadata[t]&&((e=this.emulatedGamepadsMetadata[t])!=null&&e.removeButtonListenersFunc)&&this.emulatedGamepadsMetadata[t].removeButtonListenersFunc()}ClearDisplayJoystickEventListeners(t){var e;this.emulatedGamepadsMetadata[t]&&((e=this.emulatedGamepadsMetadata[t])!=null&&e.removeJoystickListenersFunc)&&this.emulatedGamepadsMetadata[t].removeJoystickListenersFunc()}AddDragControlListener(t,e){let n={startX:0,startY:0},a=-1;const s=d=>{var m=d.pointerId;if(a===m){const _=t.directions[l$2.left]?-1:0,b=t.directions[l$2.right]?1:0,S=t.directions[l$2.up]?-1:0,k=t.directions[l$2.down]?1:0,w=d.clientX-n.startX,O=d.clientY-n.startY;let{x:P,y:N}=i(w,O,t.dragDistance);P=Math.max(Math.min(P,b),_),N=Math.max(Math.min(N,k),S),e(!0,P,N)}},c=d=>{a==d.pointerId&&(document.removeEventListener("pointermove",s,!1),document.removeEventListener("pointerup",c,!1),a=-1,e(!1,0,0))};t.tapTarget.addEventListener("pointerdown",d=>{d.preventDefault(),n.startX=d.clientX,n.startY=d.clientY,a=d.pointerId,t.lockTargetWhilePressed?t.tapTarget.setPointerCapture(d.pointerId):t.tapTarget.releasePointerCapture(d.pointerId),console.log("stick pointer down",t.tapTarget.hasPointerCapture(d.pointerId)),e(!0,0,0),document.addEventListener("pointermove",s,!1),document.addEventListener("pointerup",c,!1)});const u=d=>{d.changedTouches[0].target==t.tapTarget&&d.preventDefault()};return window.addEventListener("touchstart",u,{passive:!1}),function(){window.removeEventListener("touchstart",u),t.tapTarget.removeEventListener("pointerdown",s)}}cloneGamepad(t){if(!t)return t;const e=t.axes?t.axes.length:0,n=t.buttons?t.buttons.length:0,a={};for(let s in t)if(s==="axes"){const c=new Array(e);for(let u=0;u<e;u++)c[u]=Number(t.axes[u]);Object.defineProperty(a,"axes",{value:c,enumerable:!0})}else if(s==="buttons"){const c=new Array(n);for(let u=0;u<n;u++){const d=t.buttons[u];if(d==null)c[u]=d;else{const m=d.pressed,_=d.value,b=d.touched||!1;c[u]={pressed:m,value:_,touched:b}}}Object.defineProperty(a,"buttons",{value:c,enumerable:!0})}else Object.defineProperty(a,s,{get:()=>t[s],configurable:!0,enumerable:!0});return a.emulation||(a.emulation=f$2.real),a}nextEmptyEGpadIndex(t){let e=0;if(t)do{if(!this.emulatedGamepads[e])break;e++}while(e<this.emulatedGamepads.length);else{const n=Math.max(this.emulatedGamepads.length,this.patchedGpadToRealIndexMap.length);do{if(!this.emulatedGamepads[e]&&this.patchedGpadToRealIndexMap[e]==null)break;console.log("nextEmptyEGpadIndex",e,!this.emulatedGamepads[e],this.patchedGpadToRealIndexMap[e]==null),e++}while(e<n)}return e}nextEmptyRealGpadIndex(t){let e=t;const n=Math.max(this.emulatedGamepads.length,this.patchedGpadToRealIndexMap.length);do{const a=this.emulatedGamepadsMetadata[e],s=this.realGpadToPatchedIndexMap[e]==null&&this.patchedGpadToRealIndexMap[e]==null;if(a&&a.overlayMode||!a&&s)break;e++}while(e<n);return e}monkeyPatchGamepadEvents(){let t,e,n,a;window.hasOwnProperty("ongamepadconnected")&&(t=Object.getOwnPropertyDescriptor(window,"ongamepadconnected"),n=window.ongamepadconnected,window.ongamepadconnected=null,Object.defineProperty(window,"ongamepadconnected",{get:()=>function(u){},set:u=>{n=u},configurable:!0})),window.hasOwnProperty("ongamepaddisconnected")&&(e=Object.getOwnPropertyDescriptor(window,"ongamepaddisconnected"),a=window.ongamepaddisconnected,window.ongamepaddisconnected=null,Object.defineProperty(window,"ongamepaddisconnected",{get:()=>function(u){},set:u=>{n=u},configurable:!0}));const s=u=>{const d=u.gamepad;if(d&&d.emulation===void 0){u.stopImmediatePropagation();const m=this.cloneGamepad(u.gamepad),_=m.index,b=this.nextEmptyRealGpadIndex(_);this.realGpadToPatchedIndexMap[_]=b,this.patchedGpadToRealIndexMap[b]=_,Object.defineProperty(m,"index",{get:()=>b}),Object.defineProperty(m,"emulation",{get:()=>f$2.real}),console.log(`real gamepad connected ${m.id} (${_}>${b})`,this.realGpadToPatchedIndexMap,this.emulatedGamepads,this.emulatedGamepadsMetadata),u=new Event("gamepadconnected"),u.gamepad=m,window.dispatchEvent(u)}console.log("windowOngamepadconnected",n),n&&n.call(window,u)};window.addEventListener("gamepadconnected",s);const c=u=>{const d=u.gamepad;if(d&&d.emulation===void 0){u.stopImmediatePropagation();const m=this.cloneGamepad(u.gamepad),_=this.realGpadToPatchedIndexMap[m.index]||m.index;Object.defineProperty(m,"index",{get:()=>_}),delete this.realGpadToPatchedIndexMap[m.index],delete this.patchedGpadToRealIndexMap[_],u=new Event("gamepaddisconnected"),u.gamepad=m,window.dispatchEvent(u)}a&&a.call(window,u)};return window.addEventListener("gamepaddisconnected",c),function(){window.removeEventListener("gamepadconnected",s),window.hasOwnProperty("ongamepadconnected")&&(Object.defineProperty(window,"ongamepadconnected",t),window.ongamepadconnected=n),window.removeEventListener("gamepaddisconnected",c),window.hasOwnProperty("ongamepaddisconnected")&&(Object.defineProperty(window,"ongamepaddisconnected",e),window.ongamepaddisconnected=a)}}monkeyPatchGetGamepads(){const t=this;let e=navigator.getGamepads||navigator.webkitGetGamepads||navigator.mozGetGamepads||navigator.msGetGamepads;e&&(this.getNativeGamepads=e),navigator.getGamepads=function(){let n=[],a=e!=null?t.getNativeGamepads.apply(navigator):[];for(let c=0;c<a.length;c++){const u=a[c];if(!u)continue;let d=t.cloneGamepad(u),m=t.realGpadToPatchedIndexMap[d.index]||d.index;Object.defineProperty(d,"index",{get:()=>m}),n[m]=d}let s=t.emulatedGamepads;for(let c=0;c<s.length;c++){let u=n[c],d=s[c];if(d&&u){u.emulation=f$2.overlay;let m=Math.max(u.buttons.length,d.buttons.length);for(let b=0;b<m;b++){const S=d.buttons[b]||{touched:!1,pressed:!1,value:0},k=u.buttons[b]||{touched:!1,pressed:!1,value:0};n[c].buttons[b]={touched:S.touched||k.touched||!1,pressed:S.pressed||k.pressed||!1,value:Math.max(S.value,k.value)||0}}let _=Math.max(d.axes.length,u.axes.length);for(let b=0;b<_;b++){const S=d.axes[b]||0,k=u.axes[b]||0;n[c].axes[b]=Math.abs(S||0)>Math.abs(k||0)?S||0:k||0}}else d&&(d.emulation=f$2.emulated,d.timestamp=Math.floor(Date.now()/1e3),n[c]=t.cloneGamepad(d))}return n}}cleanup(){for(let t=0;t<this.emulatedGamepads.length;t++)this.ClearDisplayButtonEventListeners(t),this.ClearDisplayJoystickEventListeners(t);this.emulatedGamepads=[],this.undoEventPatch(),navigator.getGamepads=this.getNativeGamepads,E.instanceRunning=!1}};let y=E;h(y,"instanceRunning",!1);var f$1=Object.defineProperty,l$1=(t,e,n)=>e in t?f$1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,o=(t,e,n)=>(l$1(t,typeof e!="symbol"?e+"":e,n),n);class G{constructor(e){o(this,"updateDelay"),o(this,"axisDeadZone"),o(this,"buttonConfigs"),o(this,"currentStateOfGamepads"),o(this,"gamepadConnectListeners"),o(this,"gamepadDisconnectListeners"),o(this,"gamepadButtonChangeListeners"),o(this,"gamepadAxisChangeListeners"),this.updateDelay=e.updateDelay||0,this.axisDeadZone=e.axisDeadZone||0,this.buttonConfigs=e.buttonConfigs||[],this.currentStateOfGamepads=[],this.gamepadConnectListeners=[],this.gamepadDisconnectListeners=[],this.gamepadButtonChangeListeners=[],this.gamepadAxisChangeListeners=[],navigator.gamepadInputEmulation="gamepad",window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,navigator.getGamepads=navigator.getGamepads||navigator.webkitGetGamepads||navigator.mozGetGamepads||navigator.msGetGamepads,this.gamepadApiSupported()&&this.tickLoop()}setButtonsConfig(e){this.buttonConfigs=e}onGamepadConnect(e){return this.gamepadConnectListeners.push(e),window.addEventListener("gamepadconnected",e,!0),e}offGamepadConnect(e){this.gamepadConnectListeners=this.gamepadConnectListeners.filter(n=>n!==e),window.removeEventListener("gamepadconnected",e,!0)}onGamepadDisconnect(e){return this.gamepadDisconnectListeners.push(e),window.addEventListener("gamepaddisconnected",e,!0),e}offGamepadDisconnect(e){this.gamepadDisconnectListeners=this.gamepadDisconnectListeners.filter(n=>n!==e),window.removeEventListener("gamepaddisconnected",e,!0)}onGamepadAxisChange(e){return this.gamepadAxisChangeListeners.push(e),e}offGamepadAxisChange(e){this.gamepadAxisChangeListeners=this.gamepadAxisChangeListeners.filter(n=>n!==e)}onGamepadButtonChange(e){return this.gamepadButtonChangeListeners.push(e),e}offGamepadButtonChange(e){this.gamepadButtonChangeListeners=this.gamepadButtonChangeListeners.filter(n=>n!==e)}gamepadApiSupported(){return!!navigator.getGamepads&&!!navigator.getGamepads()}getCurrentGamepadStates(e=!1){return e&&this.checkForGamepadChanges(),this.currentStateOfGamepads}tickLoop(){this.checkForGamepadChanges(),this.updateDelay==0?requestAnimationFrame(this.tickLoop.bind(this)):setTimeout(()=>{requestAnimationFrame(this.tickLoop.bind(this))},this.updateDelay)}checkForGamepadChanges(){let e=navigator.getGamepads();for(var n=0;n<e.length;n++){let a=e[n];!a||(this.currentStateOfGamepads[n]||(this.currentStateOfGamepads[n]=a),this.checkForAxisChanges(n,a),this.checkForButtonChanges(n,a),this.currentStateOfGamepads[n]=a)}}checkForAxisChanges(e,n){let a=n.axes;if(a.length==0)return;let s=this.currentStateOfGamepads[e].axes||[],c=[],u,d=!1;for(u=0;u<a.length;u++){let m=a[u]||0,_=s[u]||0;if(m!=_){if(Math.abs(m)<this.axisDeadZone&&Math.abs(_)<this.axisDeadZone)continue;c[u]=!0,d=!0}else c[u]=!1}d&&this.gamepadAxisChangeListeners.forEach(m=>m(e,n,c))}checkForButtonChanges(e,n){let a=n.buttons;if(a.length==0)return;const s=this.currentStateOfGamepads[e].buttons||a;let c=[],u,d=!1;for(u=0;u<a.length;u++){let m=!1;const _=a[u]||{pressed:!1,value:0,touched:!1},b=s[u]||{pressed:!1,value:0,touched:!1},S=this.buttonConfigs[u]||{},k={};_.touched&&!b.touched?(k.touchDown=!0,m=!0):!_.touched&&b.touched&&(k.touchUp=!0,m=!0),_.pressed&&!b.pressed?(k.pressed=!0,m=!0):!_.pressed&&b.pressed&&(k.released=!0,m=!0),S.fireWhileHolding&&_.pressed&&b.pressed&&(k.heldDown=!0,m=!0),_.value!=b.value&&(k.valueChanged=!0,m=!0),m?(d=!0,c[u]=k):c[u]=!1}d&&this.gamepadButtonChangeListeners.forEach(m=>m(e,n,c))}}var p=Object.defineProperty,f=(t,e,n)=>e in t?p(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,l=(t,e,n)=>(f(t,typeof e!="symbol"?e+"":e,n),n);class D{constructor(e,n){l(this,"config"),l(this,"apiWrapper"),l(this,"btnChangeListener"),l(this,"axisChangeListener"),l(this,"DefaultJoystickDisplayFunction",(a,s,c)=>{const u=a.movementRange;if(a.joystickElement.style.transform=`translate(${s*u}px,${c*u}px)`,a.highlights&&this.config.moveDirectionHighlightClass){const d=a.highlights[l$2.up],m=a.highlights[l$2.down],_=a.highlights[l$2.left],b=a.highlights[l$2.right];d&&c<-.1?d.classList.add(this.config.moveDirectionHighlightClass||""):d&&d.classList.remove(this.config.moveDirectionHighlightClass||""),m&&c>.1?m.classList.add(this.config.moveDirectionHighlightClass||""):m&&m.classList.remove(this.config.moveDirectionHighlightClass||""),_&&s<-.1?_.classList.add(this.config.moveDirectionHighlightClass||""):_&&_.classList.remove(this.config.moveDirectionHighlightClass||""),b&&s>.1?b.classList.add(this.config.moveDirectionHighlightClass||""):b&&b.classList.remove(this.config.moveDirectionHighlightClass||"")}}),l(this,"DefaultButtonDisplayFunction",(a,s,c,u,d,m)=>{const _=a.highlight;if(this.config.touchedHighlightClass&&_&&(d.touchDown?_.classList.add(this.config.touchedHighlightClass):d.touchUp&&_.classList.remove(this.config.touchedHighlightClass)),this.config.pressedHighlightClass&&_&&(d.pressed?_.classList.add(this.config.pressedHighlightClass):d.released&&_.classList.remove(this.config.pressedHighlightClass)),a.type==v.variable){const b=a.directionHighlight;if(this.config.moveDirectionHighlightClass&&b&&(d.pressed?b.classList.add(this.config.moveDirectionHighlightClass):d.released&&b.classList.remove(this.config.moveDirectionHighlightClass)),a.buttonElement){const S=a.direction==l$2.left||a.direction==l$2.right,k=a.direction==l$2.right||a.direction==l$2.down;a.buttonElement.style.transform=`translate${S?"X":"Y"}(${k?"":"-"}${s*a.movementRange}px)`}}}),l(this,"displayButtonChanges",(a,s,c)=>{if(a!=this.config.gamepadIndex)return;const u=this.config.buttons;for(let d=0;d<u.length;d++){const m=c[d];if(!m||Object.keys(m).length==0)continue;const _=u[d],b=s.buttons[d].value,S=s.buttons[d].touched,k=s.buttons[d].pressed;this.config.buttonDisplayFunction?this.config.buttonDisplayFunction(_,b,S,k,m,d):this.DefaultButtonDisplayFunction(_,b,S,k,m,d)}}),this.config=e,this.apiWrapper=n||new G({buttonConfigs:[],updateDelay:0}),this.btnChangeListener=this.apiWrapper.onGamepadButtonChange(this.displayButtonChanges.bind(this)),this.axisChangeListener=this.apiWrapper.onGamepadAxisChange(this.displayJoystickChanges.bind(this))}displayJoystickChanges(e,n,a){if(e!=this.config.gamepadIndex)return;const s=this.config.sticks;for(let c=0;c<s.length;c++){const u=s[c];if(u.xAxisIndex!==void 0&&a[u.xAxisIndex]||u.yAxisIndex!==void 0&&a[u.yAxisIndex]){const d=n.axes,m=u.xAxisIndex!==void 0&&d[u.xAxisIndex]||0,_=u.yAxisIndex!==void 0&&d[u.yAxisIndex]||0;this.config.joystickDisplayFunction?this.config.joystickDisplayFunction(u,m,_):this.DefaultJoystickDisplayFunction(u,m,_)}}}Cleanup(){this.apiWrapper.offGamepadButtonChange(this.btnChangeListener),this.apiWrapper.offGamepadAxisChange(this.axisChangeListener)}}class GamepadUi{constructor(){de(this,"gpadButtonHighlightElements");de(this,"gamepadContainer");de(this,"gamepadHelpTooltip");de(this,"gamepadHelpTooltipText");de(this,"defaultTooltipTarget");de(this,"tooManyGamepadsNotice");de(this,"currentPopperTarget");de(this,"touchingButtonsCount",0);de(this,"someAxiesNotCentered",!1);de(this,"someButtonsPressed",!1);de(this,"gamepadHelpVisible",!1);de(this,"cleanupTooltip")}start(){this.gamepadContainer=document.getElementById("gamepad-container"),this.gpadButtonHighlightElements=ONSCREEN_GPAD_BUTTON_LABELS.map(e=>document.getElementById(e+"_highlight")),this.gamepadHelpTooltip=document.querySelector("#gamepad-help-tooltip"),this.gamepadHelpTooltipText=document.querySelector("#gamepad-help-text"),this.defaultTooltipTarget=document.querySelector("#select_button"),this.tooManyGamepadsNotice=document.getElementById("too-many-gamepads-notice"),this.currentPopperTarget=this.defaultTooltipTarget}toggleGamepadHelpScreen(){this.gamepadHelpVisible=!this.gamepadHelpVisible,this.gamepadHelpVisible?(document.body.classList.add("gamepad-help-open"),document.body.classList.remove("driving-now")):document.body.classList.remove("gamepad-help-open")}showNotSupported(){alert("Game controllers are not supported in your browser! Use keyboard or mouse/touch controls or switch to a more modern browser.")}handleGamepadVisualFeedbackAxisEvents(e,n){e.forEach(s=>{let c=s.thumbStickElement,u=s.axisRange,d=s.xValue||0,m=s.yValue||0;c.style.transform=`rotateY(${-d*30}deg) rotateX(${m*30}deg) translate(${d*u}px,${m*u}px)`,this.gamepadHelpVisible&&(s.upIndicatorElement&&s.downIndicatorElement&&(Math.abs(d)<n?m<-n?(s.upIndicatorElement.style.opacity=Math.max(-m,0),s.downIndicatorElement.style.opacity=0):m>n?(s.upIndicatorElement.style.opacity=0,s.downIndicatorElement.style.opacity=Math.max(m,0)):(s.upIndicatorElement.style.opacity=0,s.downIndicatorElement.style.opacity=0):(s.upIndicatorElement.style.opacity=0,s.downIndicatorElement.style.opacity=0)),s.leftIndicatorElement&&s.rightIndicatorElement&&(Math.abs(m)<n?d<-n?(s.leftIndicatorElement.style.opacity=Math.max(-d,0),s.rightIndicatorElement.style.opacity=0):d>n?(s.leftIndicatorElement.style.opacity=0,s.rightIndicatorElement.style.opacity=Math.max(d,0)):(s.leftIndicatorElement.style.opacity=0,s.rightIndicatorElement.style.opacity=0):(s.leftIndicatorElement.style.opacity=0,s.rightIndicatorElement.style.opacity=0)))});let a=e.reduce((s,c)=>s+Math.abs(c.xValue)+Math.abs(c.yValue)>.05?1:0,0);!this.gamepadHelpVisible&&a>0&&this.someAxiesNotCentered==!1?(this.someAxiesNotCentered=!0,this.setGamepadVisability()):this.someAxiesNotCentered==!0&&a==0&&(this.someAxiesNotCentered=!1,this.setGamepadVisability())}setGamepadVisability(){!this.gamepadHelpVisible&&(this.someAxiesNotCentered||this.someButtonsPressed)?document.body.classList.add("driving-now"):document.body.classList.remove("driving-now")}setGamepadButtonClass(e,n){let a=n[e],s=this.gpadButtonHighlightElements[e];!a||!s||(a.touched?s.classList.add(ONSCREEN_GPAD_BUTTON_TOUCHED_CLASS):s.classList.remove(ONSCREEN_GPAD_BUTTON_TOUCHED_CLASS),a.pressed?s.classList.add(ONSCREEN_GPAD_BUTTON_PRESSED_CLASS):s.classList.remove(ONSCREEN_GPAD_BUTTON_PRESSED_CLASS))}handleGamepadVisualFeedbackButtonEvents(e){let n=0;for(let a=0;a<e.length;a++)this.setGamepadButtonClass(a,e),n+=e[a].pressed?1:0;!this.gamepadHelpVisible&&n>0&&this.someButtonsPressed==!1?(this.someButtonsPressed=!0,this.setGamepadVisability()):this.someButtonsPressed==!0&&(this.someButtonsPressed=!1,this.setGamepadVisability())}handleGamepadVisualFeedbackVariableTriggerButtonEvents(e,n){for(let a=0;a<n.length;a++){const s=n[a],c=s.buttonIndex;this.setGamepadButtonClass(c,e);let u=e[c]?e[c].value:0;s.buttonElement.style.transform=`rotateX(${u*30}deg) translateY(${u*s.axisRange}px)`}}getButtonHighlightElements(){return console.log("getButtonHighlightElements",this.gpadButtonHighlightElements),this.gpadButtonHighlightElements}}function bindStringSvelteStoreToLocalStorage(t,e,n){e.set(localStorage.getItem(t)||e.get()||n),changesSubscribe(e,a=>localStorage.setItem(t,String(a)))}function bindNumberSvelteStoreToLocalStorage(t,e,n){e.set(parseFloat(localStorage.getItem(t))||e.get()||n),changesSubscribe(e,a=>localStorage.setItem(t,String(a)))}function getURLQueryStringVariable(t){let n=window.location.search.substring(1).split("&");for(let a=0;a<n.length;a++){let s=n[a].split("=");if(decodeURIComponent(s[0])==t)return decodeURIComponent(s[1])}}function toggleFullscreen(t,e){e=e||document.documentElement;let n=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;!n||e!==n?(e.requestFullscreen||e.webkitEnterFullscreen||e.webkitRequestFullscreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullscreen).apply(e):(document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen).apply(document)}function calculateDesiredMotion(t){let e=Number(t[0].toFixed(3)),n=-1*Number(t[1].toFixed(3)),a=Number(t[2].toFixed(3)),s=-1*Number(t[3].toFixed(3));return{VelocityX:n,VelocityY:a,VelocityZ:s,AngularVelocityYaw:e}}class RovActionsClass{constructor(){de(this,"requiredMsgsLoopIntervalId",null);de(this,"lastMove",{VelocityX:0,VelocityY:0,VelocityZ:0,AngularVelocityYaw:0,ButtonBitmask:0});de(this,"lastMovementTime",0);de(this,"lastPingTime",0);de(this,"sensitivity",1);de(this,"shutdownRov",()=>{modalConfirm("Shutdown the ROV?","",()=>{showToastMessage("Sending Shutdown Request...",2e3,!1,ToastSeverity.info),this.sendActionAndWaitForDone({ShutdownRov:{}},e=>{e.Error?showToastMessage("ROV Shutdown Error: "+e.Error.Message,5e3,!1,ToastSeverity.error):e.Done&&(showToastMessage("Please wait 20 seconds before unplugging. ROV: "+e.Done.Message,8e3,!1,ToastSeverity.success),frontendConnMngr.disconnect())})})});de(this,"rebootRov",()=>{modalConfirm("Reboot the ROV?","The ROV will stop responding for about two minutes and then you can re-connect.",()=>{showToastMessage("Sending Reboot Request...",2e3,!1,ToastSeverity.info),this.sendActionAndWaitForDone({RebootRov:{}},e=>{e.Error?showToastMessage("ROV Reboot Error: "+e.Error.Message,5e3,!1,ToastSeverity.error):e.Done&&(showToastMessage("Press Connect again in about 30 seconds ROV: "+e.Done.Message,8e3,!1,ToastSeverity.success),showToastMessage("ROV: "+e.Done.Message),frontendConnMngr.disconnect())})})});de(this,"restartRovServices",()=>{modalConfirm("Restart ROV services?","The ROV will stop responding for about a minute and then you can re-connect.",()=>{let e=this.showCommandOutputPopup("Restarting ROV Services",`Sending Service Restart Request (Please Wait)...
`,`

Done.`);frontendRovMsgHandler.sendRovMessage({RestartRovServices:{}},e)})});de(this,"getRovStatusReport",()=>{let e=this.showCommandOutputPopup("ROV Status Report",`Sending Status Request (Please Wait)...
`,`

Done.`);frontendRovMsgHandler.sendRovMessage({RovStatusReport:{}},e)});de(this,"getRovLogs",()=>{let e=this.showCommandOutputPopup("ROV Logs",`Sending Request (Please Wait)...
`,`

Done.`);frontendRovMsgHandler.sendRovMessage({RovLogs:{}},e)});de(this,"enableRovWifi",()=>{showToastMessage("Sending Enable Wifi Command...",2e3,!1,ToastSeverity.info),this.sendActionAndWaitForDone({EnableWifi:{}},e=>{e.Error?showToastMessage("Enable Wifi Error: "+e.Error.Message,8e3,!1,ToastSeverity.error):e.Done&&showToastMessage("Wifi Enable: "+e.Done.Message,2e3,!1,ToastSeverity.success)})});de(this,"disableRovWifi",()=>{modalConfirm("Are you sure you want to disable rov wifi?","If the ROV is connected via wifi, <em>don't do this!</em>",()=>{showToastMessage("Sending Disable Wifi Command...",2e3,!1,ToastSeverity.info),this.sendActionAndWaitForDone({DisableWifi:{}},e=>{e.Error?showToastMessage("Disable Wifi Error: "+e.Error.Message,8e3,!1,ToastSeverity.error):e.Done&&showToastMessage("Wifi Disable: "+e.Done.Message,2e3,!1,ToastSeverity.success)})})})}gamepadButtonTriggers(e,n){const a=GPAD_STANDARD_BUTTON_INDEX.A,s=GPAD_STANDARD_BUTTON_INDEX.B;GPAD_STANDARD_BUTTON_INDEX.X,GPAD_STANDARD_BUTTON_INDEX.Y;const c=GPAD_STANDARD_BUTTON_INDEX.LT,u=GPAD_STANDARD_BUTTON_INDEX.RT,d=GPAD_STANDARD_BUTTON_INDEX.RB,m=GPAD_STANDARD_BUTTON_INDEX.LB;if(n[a]&&n[a].released?this.takeControl():n[s]&&n[s].released&&this.disarm(),n[c]||n[u]){const S=n[c]?e.buttons[c].value:0,k=n[u]?e.buttons[u].value:0;this.sensitivity=1-Math.max(S,k)*.8}const _=[a,s,c,u,m,d],b=n.map((S,k)=>S===!1||_.includes(k)?!1:S.pressed||S.heldDown);this.sendButtonsToRov(b)}gamepadAxisTriggers(e){const n=this.sensitivity,{VelocityX:a,VelocityY:s,VelocityZ:c,AngularVelocityYaw:u}=calculateDesiredMotion(e.axes);a==0&&s==0&&c==0&&u==0&&console.info("GAMEPAD MOTION: STOPed"),this.moveRov(a*n,s*n,c*n,u*n)}sendActionAndWaitForDone(e,n){frontendRovMsgHandler.sendRovMessage(e,a=>{n&&(a.Done||a.Error||a.ContinuedOutput)&&n(a)})}startRequiredMsgLoop(){this.requiredMsgsLoopIntervalId||(this.requiredMsgsLoopIntervalId=Number(setInterval(()=>{if(frontendConnMngr.connectionState.get()!=ConnectionStates.connected)return;const e=Date.now();e-this.lastPingTime>PING_INTERVAL&&(frontendRovMsgHandler.sendRovMessage({Ping:{Time:Date.now()}},null),this.lastPingTime=e),e-this.lastMovementTime>MOVE_MSG_TIMEOUT&&(frontendRovMsgHandler.sendRovMessage({Move:this.lastMove},null),this.lastMovementTime=e)},10)))}stopRequiredMsgLoop(){clearInterval(this.requiredMsgsLoopIntervalId),this.requiredMsgsLoopIntervalId=null}showCommandOutputPopup(e,n,a){let s=modalScrollingText(e,"",null);return s(n),c=>{c.ContinuedOutput?s(c.ContinuedOutput.Message+`
`):c.Done?s(c.Done.Message+`
`+a):c.Error&&s(c.Error.Message+`
`)}}takeControl(){frontendRovMsgHandler.sendRovMessage({TakeControl:{}},null)}disarm(){frontendRovMsgHandler.sendRovMessage({Disarm:{}},null)}setFlightMode(e){frontendRovMsgHandler.sendRovMessage({SetAutopilotMode:{mode:e}},null)}moveRov(e,n,a,s,c=-1){const u=c===-1?this.lastMove.ButtonBitmask:c;e-this.lastMove.VelocityX+(n-this.lastMove.VelocityY)+(a-this.lastMove.VelocityZ)+(s-this.lastMove.AngularVelocityYaw);const d={VelocityX:e,VelocityY:n,VelocityZ:a,AngularVelocityYaw:s,ButtonBitmask:u};console.log("MOVE:",d.VelocityX,d.VelocityY,d.VelocityZ,d.AngularVelocityYaw,d.ButtonBitmask),frontendRovMsgHandler.sendRovMessage({Move:d},null),this.lastMove=d,this.lastMovementTime=Date.now()}sendButtonsToRov(e){const n=this.lastMove.VelocityX,a=this.lastMove.VelocityY,s=this.lastMove.VelocityZ,c=this.lastMove.AngularVelocityYaw,u=e.reduce((m,_,b)=>(_&&(m|=1<<GPAD_STANDARD_BUTTON_INDEX_TO_MAVLINK_INDEX[b]),m),0),d=Date.now()-this.lastMovementTime;this.lastMove.ButtonBitmask===u&&d<700||(frontendRovMsgHandler.sendRovMessage({Move:{VelocityX:n,VelocityY:a,VelocityZ:s,AngularVelocityYaw:c,ButtonBitmask:u}},null),this.lastMove.ButtonBitmask=u,this.lastMovementTime=Date.now())}refreshAllSensorData(){frontendRovMsgHandler.sendRovMessage({RefreshAllSensors:{}},null)}toggleLights(){frontendRovMsgHandler.sendRovMessage({ToogleLights:{}},null)}takePhoto(){frontendRovMsgHandler.sendRovMessage({TakePhoto:{}},null)}startVideoRecording(){frontendRovMsgHandler.sendRovMessage({StartVideoRec:{}},null)}stopVideoRecording(){frontendRovMsgHandler.sendRovMessage({StopVideoRec:{}},null)}}const RovActions=new RovActionsClass;function popup(t,e){const{computePosition:n,autoUpdate:a,offset:s,shift:c,flip:u,arrow:d,size:m,autoPlacement:_,hide:b,inline:S}=get_store_value(storePopup),k={open:!1,autoUpdateCleanup:()=>{}},w=':is(a[href], button, input, textarea, select, details, [tabindex]):not([tabindex="-1"])';let O;const P="https://www.skeleton.dev/utilities/popups";let N,I,U=!1;function $(){N=document.querySelector(`[data-popup="${e.target}"]`)??document.createElement("div"),I=N.querySelector(".arrow")??document.createElement("div")}$();function x(){var ee,ie,se,ce,fe,pe,ue,ge;if(!N)throw new Error(`The data-popup="${e.target}" element was not found. ${P}`);if(!n)throw new Error(`Floating UI 'computePosition' not found for data-popup="${e.target}". ${P}`);if(!s)throw new Error(`Floating UI 'offset' not found for data-popup="${e.target}". ${P}`);if(!c)throw new Error(`Floating UI 'shift' not found for data-popup="${e.target}". ${P}`);if(!u)throw new Error(`Floating UI 'flip' not found for data-popup="${e.target}". ${P}`);if(!d)throw new Error(`Floating UI 'arrow' not found for data-popup="${e.target}". ${P}`);const Z=[];m&&Z.push(m((ee=e.middleware)==null?void 0:ee.size)),_&&Z.push(_((ie=e.middleware)==null?void 0:ie.autoPlacement)),b&&Z.push(b((se=e.middleware)==null?void 0:se.hide)),S&&Z.push(S((ce=e.middleware)==null?void 0:ce.inline)),n(t,N,{placement:e.placement??"bottom",middleware:[s(((fe=e.middleware)==null?void 0:fe.offset)??8),c(((pe=e.middleware)==null?void 0:pe.shift)??{padding:8}),u((ue=e.middleware)==null?void 0:ue.flip),d(((ge=e.middleware)==null?void 0:ge.arrow)??{element:I||null}),...Z]}).then(({x:he,y:_e,placement:re,middlewareData:V})=>{if(Object.assign(N.style,{left:`${he}px`,top:`${_e}px`}),I){const{x:Q,y:j}=V.arrow,le={top:"bottom",right:"left",bottom:"top",left:"right"}[re.split("-")[0]];Object.assign(I.style,{left:Q!=null?`${Q}px`:"",top:j!=null?`${j}px`:"",right:"",bottom:"",[le]:"-4px"})}})}function C(){N&&(U=!0,setTimeout(()=>{U&&(k.open=!0,e.state&&e.state({state:k.open}),x(),N.style.display="block",N.style.opacity="1",N.style.pointerEvents="auto",N.removeAttribute("inert"),k.autoUpdateCleanup=a(t,N,x),O=Array.from(N==null?void 0:N.querySelectorAll(w)))},e.delay??0))}function H(Z){if(!N)return;U=!1;const ee=parseFloat(window.getComputedStyle(N).transitionDuration.replace("s",""))*1e3;setTimeout(()=>{k.open=!1,e.state&&e.state({state:k.open}),N.style.opacity="0",N.setAttribute("inert",""),k.autoUpdateCleanup&&k.autoUpdateCleanup(),Z&&Z()},ee)}function q(){k.open===!1?C():H()}function K(Z){if(k.open===!1||t.contains(Z.target))return;if(N&&N.contains(Z.target)===!1){H();return}const ee=e.closeQuery===void 0?"a[href], button":e.closeQuery,ie=N==null?void 0:N.querySelectorAll(ee);ie==null||ie.forEach(se=>{se.contains(Z.target)&&H()})}const W=Z=>{if(k.open===!1)return;const ee=Z.key;if(ee==="Escape"){Z.preventDefault(),t.focus(),H();return}O=Array.from(N==null?void 0:N.querySelectorAll(w)),k.open&&document.activeElement===t&&(ee==="ArrowDown"||ee==="Tab")&&w.length>0&&O.length>0&&(Z.preventDefault(),O[0].focus())};switch(e.event){case"click":t.addEventListener("click",q,!0),window.addEventListener("click",K,!0);break;case"hover":t.addEventListener("mouseover",()=>C(),!0),t.addEventListener("mouseleave",()=>H(),!0);break;case"focus-blur":t.addEventListener("focus",q,!0),t.addEventListener("blur",()=>H(),!0);break;case"focus-click":t.addEventListener("focus",C,!0),window.addEventListener("click",K,!0);break;default:throw new Error(`Event value of '${e.event}' is not supported. ${P}`)}return window.addEventListener("keydown",W,!0),x(),{update(Z){H(()=>{e=Z,x(),$()})},toggle:q,open:C,close:H,destroy(){t.removeEventListener("click",q,!0),t.removeEventListener("mouseover",C,!0),t.removeEventListener("mouseleave",()=>H(),!0),t.removeEventListener("focus",q,!0),t.removeEventListener("focus",C,!0),t.removeEventListener("blur",()=>H(),!0),window.removeEventListener("click",K,!0),window.removeEventListener("keydown",W,!0)}}}function get_each_context$4(t,e,n){const a=t.slice();return a[1]=e[n],a}function create_each_block$4(t){let e,n=t[1].label+"",a,s,c,u,d,m,_;return{c(){e=element("div"),a=text(n),s=space(),c=element("div"),u=space(),this.h()},l(b){e=claim_element(b,"DIV",{class:!0,"data-popup":!0});var S=children(e);a=claim_text(S,n),s=claim_space(S),c=claim_element(S,"DIV",{class:!0}),children(c).forEach(detach),u=claim_space(S),S.forEach(detach),this.h()},h(){attr(c,"class","arrow variant-filled-primary popper-tooltip-arrow"),attr(e,"class","card px-4 py-2 opacity-95 font-bold max-w[40px] variant-filled-primary z-40 pointer-events-none select-none"),attr(e,"data-popup",d=t[1].id)},m(b,S){insert_hydration(b,e,S),append_hydration(e,a),append_hydration(e,s),append_hydration(e,c),append_hydration(e,u),_=!0},p(b,S){(!_||S&1)&&n!==(n=b[1].label+"")&&set_data(a,n),(!_||S&1&&d!==(d=b[1].id))&&attr(e,"data-popup",d)},i(b){_||(b&&add_render_callback(()=>{_&&(m||(m=create_bidirectional_transition(e,fade,{duration:1e3},!0)),m.run(1))}),_=!0)},o(b){b&&(m||(m=create_bidirectional_transition(e,fade,{duration:1e3},!1)),m.run(0)),_=!1},d(b){b&&detach(e),b&&m&&m.end()}}}function create_fragment$s(t){let e,n,a=ensure_array_like(t[0]),s=[];for(let u=0;u<a.length;u+=1)s[u]=create_each_block$4(get_each_context$4(t,a,u));const c=u=>transition_out(s[u],1,1,()=>{s[u]=null});return{c(){for(let u=0;u<s.length;u+=1)s[u].c();e=empty()},l(u){for(let d=0;d<s.length;d+=1)s[d].l(u);e=empty()},m(u,d){for(let m=0;m<s.length;m+=1)s[m]&&s[m].m(u,d);insert_hydration(u,e,d),n=!0},p(u,[d]){if(d&1){a=ensure_array_like(u[0]);let m;for(m=0;m<a.length;m+=1){const _=get_each_context$4(u,a,m);s[m]?(s[m].p(_,d),transition_in(s[m],1)):(s[m]=create_each_block$4(_),s[m].c(),transition_in(s[m],1),s[m].m(e.parentNode,e))}for(group_outros(),m=a.length;m<s.length;m+=1)c(m);check_outros()}},i(u){if(!n){for(let d=0;d<a.length;d+=1)transition_in(s[d]);n=!0}},o(u){s=s.filter(Boolean);for(let d=0;d<s.length;d+=1)transition_out(s[d]);n=!1},d(u){u&&detach(e),destroy_each(s,u)}}}let savedTooltips=nStore([]);const addTooltip=async(t,e,n)=>{let a,s,c;return savedTooltips.update(u=>(s="TT-"+String(u.length),n=Object.assign({event:"hover",target:s,delay:1500,placement:"left",middleware:{autoPlacement:{autoAlignment:!1,crossAxis:!0,allowedPlacements:["left","right"]}}},n),c=u.length,u.push({id:s,label:e,config:n}),u)),await waitfor(1),a=popup(t,n),savedTooltips.get()[c].actions=a,a};function instance$s(t,e,n){let a;return component_subscribe(t,savedTooltips,s=>n(0,a=s)),[a]}class HelpTooltips extends SvelteComponent{constructor(e){super(),init(this,e,instance$s,create_fragment$s,safe_not_equal,{})}}const LEFT_X_AXIS_INDEX=0,LEFT_Y_AXIS_INDEX=1,RIGHT_X_AXIS_INDEX=2,RIGHT_Y_AXIS_INDEX=3,X_BUTTON_INDEX=0,gpadHelpTooltips=[];class GamepadController{constructor(){de(this,"gpadUi");de(this,"gpadEmulator");de(this,"gpadApiWrapper");de(this,"touchedGpadButtonCount",0);de(this,"onAxisChange");de(this,"onButtonChange");this.gpadUi=new GamepadUi,this.touchedGpadButtonCount=0}start(e,n){this.gpadUi.start(),this.gpadEmulator=new y(.1),new G({}).gamepadApiSupported()||this.gpadUi.showNotSupported(),this.gpadApiWrapper=new G({axisDeadZone:.05,updateDelay:28,buttonConfigs:GAME_CONTROLLER_BUTTON_CONFIG}),this.onAxisChange=e,this.onButtonChange=n,this.gpadApiWrapper.onGamepadConnect(this.gamepadConnectDisconnectHandler.bind(this)),this.gpadApiWrapper.onGamepadDisconnect(this.gamepadConnectDisconnectHandler.bind(this)),this.gpadApiWrapper.onGamepadAxisChange(this.handleAxisChange.bind(this)),this.gpadApiWrapper.onGamepadButtonChange(this.handleButtonChange.bind(this))}setupOnscreenGamepad(e){this.gpadEmulator.AddEmulatedGamepad(0,!0,T,A),this.setupGamepadDisplay(0,e),this.setupEmulatedGamepadInput(0,e),this.addEmulatedGamepadKeyboardBindings(0),this.addHelpTooltips()}gamepadConnectDisconnectHandler(){const e=navigator.getGamepads();let n=e.reduce((a,s)=>s?a+1:a,0);n!=0&&e[0].emulated&&(n-=1),n>1&&console.log("WARNING: More than one gamepad connected!",e)}handleButtonChange(e,n,a){if(!(e!=0||!n||!n.buttons)){this.onButtonChange&&this.onButtonChange(n,a);for(let s=0;s<a.length;s++)a[s]&&a[s].touchDown?gpadHelpTooltips[s]&&gpadHelpTooltips[s].open():a[s]&&a[s].touchUp&&gpadHelpTooltips[s]&&gpadHelpTooltips[s].close()}}handleAxisChange(e,n){if(e!=0||!n||!n.axes)return;this.onAxisChange&&this.onAxisChange(n);const a=[{axisRange:14,xValue:n.axes[0]||0,yValue:n.axes[1]||0,thumbStickElement:document.getElementById("stick_left"),upIndicatorElement:document.getElementById("l_stick_up_direction_highlight"),downIndicatorElement:document.getElementById("l_stick_down_direction_highlight"),leftIndicatorElement:document.getElementById("l_stick_left_direction_highlight"),rightIndicatorElement:document.getElementById("l_stick_right_direction_highlight"),upHelpText:"Forward",downHelpText:"Back",leftHelpText:"Turn Left",rightHelpText:"Turn Right"},{axisRange:14,xValue:n.axes[2]||0,yValue:n.axes[3]||0,thumbStickElement:document.getElementById("stick_right"),upIndicatorElement:document.getElementById("r_stick_up_direction_highlight"),downIndicatorElement:document.getElementById("r_stick_down_direction_highlight"),leftIndicatorElement:document.getElementById("r_stick_left_direction_highlight"),rightIndicatorElement:document.getElementById("r_stick_right_direction_highlight"),upHelpText:"Up",downHelpText:"Down",leftHelpText:"Strafe Left",rightHelpText:"Strafe Right"}];this.gpadUi.handleGamepadVisualFeedbackAxisEvents(a,.4)}setupGamepadDisplay(e,n){n.querySelectorAll("#stick_right, #stick_left").forEach(c=>{o$1(c)});const a=ONSCREEN_GPAD_BUTTON_LABELS.map((c,u)=>c.includes("trigger")?{type:v.variable,highlight:n.querySelector("#"+c+"_highlight"),buttonElement:n.querySelector("#"+c),direction:l$2.down,directionHighlight:n.querySelector("#"+c+"_direction_highlight"),movementRange:10}:{type:v.onOff,highlight:n.querySelector("#"+c+"_highlight")}),s=[{joystickElement:n.querySelector("#stick_left"),xAxisIndex:0,yAxisIndex:1,movementRange:10,highlights:{[l$2.up]:n.querySelector("#l_stick_up_direction_highlight"),[l$2.down]:n.querySelector("#l_stick_down_direction_highlight"),[l$2.left]:n.querySelector("#l_stick_left_direction_highlight"),[l$2.right]:n.querySelector("#l_stick_right_direction_highlight")}},{joystickElement:n.querySelector("#stick_right"),xAxisIndex:2,yAxisIndex:3,movementRange:10,highlights:{[l$2.up]:n.querySelector("#r_stick_up_direction_highlight"),[l$2.down]:n.querySelector("#r_stick_down_direction_highlight"),[l$2.left]:n.querySelector("#r_stick_left_direction_highlight"),[l$2.right]:n.querySelector("#r_stick_right_direction_highlight")}}];new D({gamepadIndex:e,pressedHighlightClass:"pressed",touchedHighlightClass:"touched",moveDirectionHighlightClass:"moved",buttons:a,sticks:s},this.gpadApiWrapper)}setupEmulatedGamepadInput(e,n){const a=ONSCREEN_GPAD_BUTTON_LABELS.map((c,u)=>c.includes("trigger")?{type:v.variable,buttonIndex:u,tapTarget:n.querySelector("#"+c+"_touch_target"),dragDistance:50,lockTargetWhilePressed:!0,directions:{[l$2.up]:!1,[l$2.down]:!0,[l$2.left]:!1,[l$2.right]:!1}}:{type:v.onOff,buttonIndex:u,lockTargetWhilePressed:c.includes("stick"),tapTarget:n.querySelector("#"+c+"_touch_target")});this.gpadEmulator.AddDisplayButtonEventListeners(e,a);const s=[{tapTarget:n.querySelector("#gamepad-joystick-touch-area-left"),dragDistance:30,xAxisIndex:0,yAxisIndex:1,lockTargetWhilePressed:!0,directions:{[l$2.up]:!0,[l$2.down]:!0,[l$2.left]:!0,[l$2.right]:!0}},{tapTarget:n.querySelector("#gamepad-joystick-touch-area-right"),dragDistance:30,xAxisIndex:2,yAxisIndex:3,lockTargetWhilePressed:!0,directions:{[l$2.up]:!0,[l$2.down]:!0,[l$2.left]:!0,[l$2.right]:!0}},{tapTarget:n.querySelector("#stick_button_left_touch_target"),dragDistance:30,xAxisIndex:0,yAxisIndex:1,lockTargetWhilePressed:!0,directions:{[l$2.up]:!0,[l$2.down]:!0,[l$2.left]:!0,[l$2.right]:!0}},{tapTarget:n.querySelector("#stick_button_right_touch_target"),dragDistance:30,xAxisIndex:2,yAxisIndex:3,lockTargetWhilePressed:!0,directions:{[l$2.up]:!0,[l$2.down]:!0,[l$2.left]:!0,[l$2.right]:!0}}];this.gpadEmulator.AddDisplayJoystickEventListeners(e,s)}addEmulatedGamepadKeyboardBindings(e){const n=(a,s)=>{const c=["INPUT","TEXTAREA","SELECT","OPTION"];if(s=s||window.event,c.includes(s.target.tagName))return;const u=parseInt(s.key);s.key==="Space"&&a&&this.gpadEmulator.PressButton(e,X_BUTTON_INDEX,1,!0),s.key==="a"?this.gpadEmulator.MoveAxis(e,LEFT_X_AXIS_INDEX,a?-1:0):s.key==="d"?this.gpadEmulator.MoveAxis(e,LEFT_X_AXIS_INDEX,a?1:0):s.key==="w"?this.gpadEmulator.MoveAxis(e,LEFT_Y_AXIS_INDEX,a?-1:0):s.key==="s"?this.gpadEmulator.MoveAxis(e,LEFT_Y_AXIS_INDEX,a?1:0):s.key==="ArrowLeft"?(this.gpadEmulator.MoveAxis(e,RIGHT_X_AXIS_INDEX,a?-1:0),s.preventDefault()):s.key==="ArrowRight"?(this.gpadEmulator.MoveAxis(e,RIGHT_X_AXIS_INDEX,a?1:0),s.preventDefault()):s.key==="ArrowUp"?(this.gpadEmulator.MoveAxis(e,RIGHT_Y_AXIS_INDEX,a?-1:0),s.preventDefault()):s.key==="ArrowDown"?(this.gpadEmulator.MoveAxis(e,RIGHT_Y_AXIS_INDEX,a?1:0),s.preventDefault()):isNaN(u)?s.keyCode&&this.gpadEmulator.PressButton(e,s.keyCode-66+9,a?1:0,a):this.gpadEmulator.PressButton(e,Math.max(u-1,0),a?1:0,a)};window.onkeydown=a=>n(!0,a),window.onkeyup=a=>n(!1,a)}testGamepadJoysticks(){setInterval(()=>{this.gpadEmulator.MoveAxis(0,0,Math.random()*2-1),this.gpadEmulator.MoveAxis(0,1,Math.random()*2-1),this.gpadEmulator.MoveAxis(0,2,Math.random()*2-1),this.gpadEmulator.MoveAxis(0,3,Math.random()*2-1)},10)}addHelpTooltips(){ONSCREEN_GPAD_BUTTON_LABELS.forEach(async(e,n)=>{const a=document.getElementById(e+"_touch_target");a&&(gpadHelpTooltips[n]=await addTooltip(a,GAME_CONTROLLER_BUTTON_CONFIG[n].helpLabel,{placement:GAME_CONTROLLER_BUTTON_CONFIG[n].tooltipPlacement}))})}}const gpadCtrl=new GamepadController;class FrontendStartupFlowClass{async start(){await this.checkIfInIframe()}async checkIfInIframe(){if(window.parent===window){console.log("We are not in an iframe, trying to connect to Livekit Cloud...");try{await frontendConnMngr.initUsingCloudLivekitConnection()}catch(e){await this.failedToConnectToLivekitCloud(e)}}else console.log("We are in an iframe, alerting user"),modalConfirm("Uh oh, rov control won't work here","Click ok to open this page outside BlueOS",()=>{window.open(window.location.toString())})}async failedToConnectToLivekitCloud(e){throw console.error("Livekit Cloud Not Accessable",e),new Error("Byeeeee!")}async failedToConnectToLocalLivekit(e){console.error("Local Livekit Server Not Accessable: ",e)}async navigateToROVLocalIframePage(){window.location.href=URL_PARAMS.LIVEKIT_LOCAL_ENDPOINT+"/offlineframe"}}const frontendStartupFlow=new FrontendStartupFlowClass,initPage=()=>{debugPageModeActive.set(getURLQueryStringVariable("debug")!=null),document.addEventListener("fullscreenchange",t=>{fullscreenOpen.set(document.fullscreenElement!==null)}),window.onbeforeunload=()=>{frontendConnMngr.disconnect()},bindNumberSvelteStoreToLocalStorage("rovPeerIdEndNumber",rovPeerIdEndNumber,0),bindStringSvelteStoreToLocalStorage("ourPeerId",ourPeerId),frontendStartupFlow.start(),gpadCtrl.start(RovActions.gamepadAxisTriggers.bind(RovActions),RovActions.gamepadButtonTriggers.bind(RovActions),10),RovActions.startRequiredMsgLoop()},LoadingIndicator_svelte_svelte_type_style_lang="";function create_if_block$4(t){let e,n,a,s,c;return{c(){e=element("div"),n=element("div"),a=space(),s=element("span"),c=text(t[0]),this.h()},l(u){e=claim_element(u,"DIV",{id:!0,class:!0});var d=children(e);n=claim_element(d,"DIV",{class:!0}),children(n).forEach(detach),a=claim_space(d),s=claim_element(d,"SPAN",{id:!0,class:!0});var m=children(s);c=claim_text(m,t[0]),m.forEach(detach),d.forEach(detach),this.h()},h(){attr(n,"class","svelte-112od4m"),attr(s,"id","site_loading_text"),attr(s,"class","svelte-112od4m"),attr(e,"id","site_loading_indicator"),attr(e,"class","lds-circle bg-surface-900 border-4 border-surface-700 shadow-2xl svelte-112od4m")},m(u,d){insert_hydration(u,e,d),append_hydration(e,n),append_hydration(e,a),append_hydration(e,s),append_hydration(s,c)},p(u,d){d&1&&set_data(c,u[0])},d(u){u&&detach(e)}}}function create_fragment$r(t){let e,n=t[0]!=null&&create_if_block$4(t);return{c(){n&&n.c(),e=empty()},l(a){n&&n.l(a),e=empty()},m(a,s){n&&n.m(a,s),insert_hydration(a,e,s)},p(a,[s]){a[0]!=null?n?n.p(a,s):(n=create_if_block$4(a),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:noop$4,o:noop$4,d(a){a&&detach(e),n&&n.d(a)}}}let currentMsg=nStore(null);function instance$r(t,e,n){let a;return component_subscribe(t,currentMsg,s=>n(0,a=s)),[a]}class LoadingIndicator extends SvelteComponent{constructor(e){super(),init(this,e,instance$r,create_fragment$r,safe_not_equal,{})}}const GamepadLeftSvg=`<svg width="100%" height="100%" viewBox="0 0 123 232" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd">
  <g id="left_side_of_controller">
    <path d="M112.977 140.769c-6 29.375-13.537 33.424-35.28 43.583-35.355 16.519-33.138 57.105-56.59 45.51-14.36-7.1-21.13-19.23-21.13-38.4 0-24.92 11.42-65.99 32.4-119.1 10.625-22.199 25.844-16.641 42.794-16.641 7.93 0 15.744-1.226 22.454 2.224 14.564 7.511 21.031 55.022 15.352 82.824Z"/>
    <g id="stick_button_left">
      <g id="stick_bg_left">
        <circle id="shadow10" cx="81.987" cy="176.33" r="26.46" style="fill-opacity:.5"/>
        <circle id="Oval5" cx="80.737" cy="175.09" r="25.21" style="fill:#6180b0;stroke:#000;stroke-width:2.49px"/>
      </g>
      <path d="M80.737 179.329v-8.477h25.442v-7.872l12.11 12.11-12.11 12.11v-7.871H80.737Z" style="fill:#ff00bf" class="direction_highlight" id="l_stick_right_direction_highlight"/>
      <path d="M76.499 175.09h8.477v25.442h7.872l-12.11 12.11-12.11-12.11h7.871V175.09Z" style="fill:#ff00bf" class="direction_highlight" id="l_stick_down_direction_highlight"/>
      <path d="M80.737 170.852v8.477H55.295v7.871l-12.11-12.11 12.11-12.11v7.872h25.442Z" style="fill:#ff00bf" class="direction_highlight" id="l_stick_left_direction_highlight"/>
      <path d="M84.976 175.09h-8.477v-25.442h-7.872l12.11-12.11 12.11 12.11h-7.871v25.442Z" style="fill:#ff00bf" class="direction_highlight" id="l_stick_up_direction_highlight"/>
      <g id="stick_left">
        <circle id="shadow11" cx="82.597" cy="176.96" r="17.12" style="fill-opacity:.5"/>
        <use xlink:href="#2a" x="48" y="143" width="65" height="65" class="gpad-highlight" id="stick_button_left_highlight"/>
        <g id="Group-6">
          <circle id="Oval-Copy" cx="80.737" cy="175.09" r="15.88" style="fill:#fff;stroke:#000;stroke-width:2.49px"/>
          <circle id="Oval-Copy-2" cx="80.737" cy="175.09" r="12.14" style="fill:#fff;stroke:#000;stroke-width:1.25px"/>
          <path d="M79.737 170.127a.402.402 0 0 0-.4-.4h-.725a.4.4 0 0 1-.32-.64l2.125-2.833a.4.4 0 0 1 .64 0l2.125 2.833a.4.4 0 0 1-.32.64h-.725a.402.402 0 0 0-.4.4v2.088a.402.402 0 0 0 .354.397c1.712.21 3.36.845 4.718 1.903a.4.4 0 0 0 .481.011l.619-.445a.399.399 0 0 1 .634.332l-.058 3.054a.4.4 0 0 1-.519.374l-2.916-.91a.402.402 0 0 1-.114-.707l.125-.091a.398.398 0 0 0-.018-.662 7.939 7.939 0 0 0-2.845-1.046.4.4 0 0 0-.459.394c-.002 1.15-.002 4.148-.002 5.234a.4.4 0 0 0 .4.4h.725a.4.4 0 0 1 .32.64l-2.125 2.833a.398.398 0 0 1-.64 0l-2.125-2.833a.4.4 0 0 1 .32-.64h.725a.4.4 0 0 0 .4-.4v-5.21a.4.4 0 0 0-.467-.395 8.156 8.156 0 0 0-2.818 1.075.398.398 0 0 0-.024.654c.045.036.093.072.141.108a.4.4 0 0 1-.127.704l-2.93.861a.399.399 0 0 1-.513-.383l-.006-3.054a.4.4 0 0 1 .639-.322l.604.451a.4.4 0 0 0 .486-.005c1.357-1.045 2.985-1.681 4.666-1.909a.4.4 0 0 0 .348-.396l.001-2.105Z"/>
        </g>
      </g>
    </g>
    <g id="select_button">
      <use xlink:href="#2b" x="78" y="118" width="43" height="39" class="gpad-highlight" id="select_button_highlight"/>
      <path id="select" d="M105.267 133.325a7.506 7.506 0 0 1 2.496 5.595 7.507 7.507 0 0 1-2.496 5.596H95.213a7.507 7.507 0 0 1-2.496-5.596c0-2.22.964-4.217 2.496-5.595h10.054Z" style="fill:#9a9a9a;fill-opacity:.5"/>
      <path id="select1" d="M104.162 132.138a7.506 7.506 0 0 1 2.496 5.595 7.507 7.507 0 0 1-2.496 5.596H94.108a7.507 7.507 0 0 1-2.496-5.596c0-2.22.964-4.217 2.496-5.595h10.054Z" style="fill:#fff;stroke:#000;stroke-width:1.35px"/>
      <text x="96.295" y="141.267" style="font-family:'ArialRoundedMTBold','Arial Rounded MT Bold',sans-serif;font-size:9.858px">?</text>
    </g>
    <g id="d_pad">
      <path d="M86.434 71.626c.913 0 1.659.746 1.659 1.659v18.212h18.212c.913 0 1.66.747 1.66 1.659v14.893c0 .913-.747 1.66-1.66 1.66H88.093v18.211c0 .913-.746 1.66-1.659 1.66H71.541c-.911 0-1.66-.749-1.66-1.66v-18.211H51.67c-.911 0-1.66-.749-1.66-1.66V93.156c0-.902.747-1.659 1.66-1.659h18.211V73.285c0-.902.747-1.659 1.66-1.659h14.893Z" style="fill:#9a9a9a;fill-opacity:.5" id="shadow14"/>
      <use xlink:href="#2c" x="53" y="54" width="48" height="53" class="gpad-highlight" id="d_pad_up_highlight"/>
      <use xlink:href="#2d" x="53" y="91" width="48" height="52" class="gpad-highlight" id="d_pad_down_highlight"/>
      <use xlink:href="#2e" x="70" y="75" width="52" height="48" class="gpad-highlight" id="d_pad_right_highlight"/>
      <use xlink:href="#2f" x="33" y="75" width="52" height="48" class="gpad-highlight" id="d_pad_left_highlight"/>
      <path d="M84.774 69.966c.913 0 1.66.747 1.66 1.66v18.211h18.222c.902 0 1.659.747 1.659 1.66V106.4c0 .903-.757 1.66-1.659 1.66H86.434v18.211c0 .903-.747 1.66-1.66 1.66H69.892c-.911 0-1.66-.749-1.66-1.66v-18.222H50.01c-.91 0-1.659-.749-1.659-1.659V91.497c0-.913.747-1.66 1.659-1.66h18.212V71.626c0-.913.747-1.66 1.659-1.66h14.893Z" style="fill:#fff;stroke:#000;stroke-width:1.66px;stroke-linejoin:round"/>
      <path d="m91.827 94.401 9.095 4.542-9.105 4.564V94.39l.01.011Z" style="fill:none;stroke:#000;stroke-width:1.66px;stroke-linejoin:round" id="d_pad_right"/>
      <path d="m62.839 103.496-9.106-4.553 9.106-4.553v9.106Z" style="fill:none;stroke:#000;stroke-width:1.66px;stroke-linejoin:round" id="d_pad_left"/>
      <path d="m81.881 113.432-4.553 9.106-4.553-9.106h9.106Z" style="fill:none;stroke:#000;stroke-width:1.66px;stroke-linejoin:round" id="d_pad_down"/>
      <path d="m72.775 84.455 4.563-9.106 4.543 9.106h-9.106Z" style="fill:none;stroke:#000;stroke-width:1.66px;stroke-linejoin:round" id="d_pad_up"/>
      <path id="center_icon" d="M71.374 99.114c0-.817.672-1.49 1.49-1.49h8.939c.817 0 1.49.673 1.49 1.49v3.642c0 .817-.673 1.49-1.49 1.49h-8.939c-.818 0-1.49-.673-1.49-1.49v-3.642Zm1.071 1.382v2.389c0 .268.219.485.49.485h8.83a.49.49 0 0 0 .491-.485v-1.742l-1.452-1.437a.497.497 0 0 0-.694 0l-1.249 1.236.308.305c.099.091.156.22.156.355a.491.491 0 0 1-.85.331l-3.394-3.36a.497.497 0 0 0-.694 0l-1.942 1.923Zm5.55-2.209a.662.662 0 1 1 .001 1.323.662.662 0 0 1-.001-1.323Zm-5.131-1.656-.082.001c.21-.594.775-.995 1.406-.994h6.29c.649 0 1.202.415 1.406.994l-.081-.001h-8.939Zm1.242-1.985.082-.002h6.29c.028 0 .055 0 .082.002a1.493 1.493 0 0 0-1.406-.995h-3.642c-.63 0-1.196.4-1.406.995Z"/>
    </g>
    <g id="shoulder_trigger_back_left">
      <g class="direction_highlight" id="shoulder_trigger_back_left_direction_highlight">
        <path d="M110.415 51.254 98.146 34.763h24.538l-12.269 16.491Z" style="fill:#ff00bf"/>
        <path d="M97.161 17.167c2.534 0 13.254.512 13.218 21" style="fill:none;stroke:#ff00bf;stroke-width:8.5px;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5"/>
      </g>
      <path id="shadow4" d="M54.417 40.591h37.84c1.52 0 2.77-.618 2.77-1.36a.695.695 0 0 0-.07-.309l-10.9-23.604c-.7-1.545-3.53-2.648-6.75-2.648h-11.8c-7.66 0-13.86 3.05-13.86 6.811v19.761c0 .741 1.25 1.36 2.77 1.36v-.011Z" style="fill-opacity:.5"/>
      <use xlink:href="#2g" x="32" y="3" width="76" height="56" transform="translate(0 -4.346)" class="gpad-highlight" id="shoulder_trigger_back_left_highlight"/>
      <path id="bg" d="M51.957 38.16c-.38 0-.73-.072-.98-.196-.25-.124-.4-.288-.4-.484V17.719c0-1.69 1.4-3.225 3.65-4.327a20.546 20.546 0 0 1 8.83-1.803h11.79c1.26 0 2.48.206 3.46.597.98.392 1.67.928 1.95 1.525l10.9 23.625c.03.34-.13.515-.38.628-.26.134-.6.206-.98.206h-37.84v-.01Z" style="fill:#fff;stroke:#000;stroke-width:2.2px"/>
      <path d="m74.228 32.999-.217-.942a.766.766 0 0 0-1.493.343l.9 3.914 3.914-.9a.766.766 0 0 0-.343-1.493l-1.606.369c.66-1.61.965-3.317.85-5.04a.766.766 0 0 0-1.529.101 9.59 9.59 0 0 1-.476 3.648Zm-9.227-13.535a2.177 2.177 0 1 1 4.168-.327.93.93 0 0 1 .191.118l2.594 2.023a.986.986 0 0 1-1.213 1.555l-2.594-2.023a1.04 1.04 0 0 1-.16-.158 2.16 2.16 0 0 1-1.678.093l-3.292 3.361.048.141.046.179c.021.101.036.205.043.312v.269c-.006.101-.019.2-.038.297l-.055.216a1.959 1.959 0 0 1-.044.129l3.292 3.361a2.16 2.16 0 0 1 1.678.093.957.957 0 0 1 .16-.158l2.594-2.023a.986.986 0 0 1 1.213 1.555L69.36 30.5a.97.97 0 0 1-.191.117 2.179 2.179 0 1 1-4.308.516 2.184 2.184 0 0 1 .14-.842l-3.291-3.362-.006.002a2.14 2.14 0 0 1-.356.093l-.131.018-.236.013-.171-.007-.188-.023a2.142 2.142 0 0 1-.447-.125l-.232-.108-.19-.117-.204-.158-.153-.147-.147-.173-.081-.113-.129-.221-.084-.186a2.661 2.661 0 0 1-.035-.095h-2.107v1.616a.704.704 0 1 1-1.408 0v-4.641a.704.704 0 1 1 1.408 0v1.616h2.107l.084-.209.08-.155.124-.195.144-.181.089-.095.125-.115.144-.113.065-.045.274-.156a2.182 2.182 0 0 1 .737-.2l.313-.006.24.027c.128.021.251.053.371.095l3.291-3.361Zm1.228 10.811.04-.038a1.127 1.127 0 1 1-.04.038Zm-4.929-6.48a1.13 1.13 0 0 0-1.401.76l-.032.141-.014.181.016.195.03.128a1.13 1.13 0 0 0 1.396.761l.113-.04c.411-.168.7-.572.7-1.044l-.002-.072a1.13 1.13 0 0 0-.698-.972l-.108-.038Zm12.928-7.039a9.59 9.59 0 0 1 .476 3.648.766.766 0 0 0 1.529.101c.115-1.723-.19-3.43-.85-5.04l1.606.369a.766.766 0 0 0 .343-1.493l-3.914-.901-.9 3.915a.765.765 0 1 0 1.493.343l.217-.942Zm-7.959 2.762a1.128 1.128 0 1 0-.04-.039l.04.039Z"/>
    </g>
    <g id="shoulder_button_front_left">
      <path id="shadow5" d="M94.279 44.584H54.287c-2.643 0-4.818 2.591-4.818 5.74v6.9c.004 1.258.875 2.29 1.931 2.29h45.767c1.059 0 1.93-1.038 1.93-2.3v-6.88c0-3.149-2.175-5.74-4.818-5.74v-.01Z" style="fill-opacity:.5"/>
      <use xlink:href="#2h" x="30" y="31" width="86" height="41" class="gpad-highlight" id="shoulder_button_front_left_highlight"/>
      <path id="bg1" d="M92.769 44.934h.017c2.109 0 3.844 2.067 3.844 4.58v6.92c0 .625-.433 1.14-.957 1.14H49.897c-.529 0-.965-.519-.965-1.15v-6.9c0-2.513 1.735-4.58 3.844-4.58h39.993v-.01Z" style="fill:#fff;stroke:#000;stroke-width:2.12px"/>
      <text x="70.61" y="54.634" style="font-family:'ArialRoundedMTBold','Arial Rounded MT Bold',sans-serif;font-size:15px">-</text>
    </g>
    <g id="l_touch_targets" opacity="0">
      <path id="stick_button_left_touch_target" d="M103.497 149.101c7.227 6.337 11.792 15.634 11.792 25.989 0 19.069-15.482 34.551-34.552 34.551-19.069 0-34.551-15.482-34.551-34.551 0-19.07 15.482-34.552 34.551-34.552 2.258 0 4.466.217 6.601.631 1.548 5.051 6.247 8.728 11.797 8.728 1.535 0 3.005-.281 4.362-.796Z" style="fill:#419bf3"/>
      <path id="select_button_touch_target" d="M93.558 126.53a12.266 12.266 0 0 1 5.577-1.333c6.809 0 12.336 5.534 12.336 12.35s-5.527 12.35-12.336 12.35-12.337-5.534-12.337-12.35c0-1.681.336-3.284.945-4.744a18.743 18.743 0 0 0 5.815-6.273Z" style="fill:#419bf3"/>
      <path id="d_pad_left_touch_target" d="M57.9 116.925c-10.093-.218-18.219-8.48-18.219-18.625 0-10.281 8.346-18.628 18.628-18.628.14 0 .279.002.419.005l18.205 18.204v.01L57.9 116.925Z" style="fill:#419bf3"/>
      <path id="d_pad_down_touch_target" d="m57.9 116.925 19.042-19.043 19.033 19.042c.004.14.006.279.006.419 0 10.282-8.348 18.629-18.629 18.629-10.282 0-19.452-8.765-19.452-19.047Z" style="fill:#419bf3"/>
      <path id="d_pad_up_touch_target" d="M67.141 63.678h20.421c4.962 3.261 8.277 8.827 8.413 15.17L76.942 97.882l-.009-.001-18.205-18.204c-.004-.14-.005-.279-.005-.419 0-6.512 3.349-12.249 8.418-15.58Z" style="fill:#419bf3"/>
      <path id="d_pad_right_touch_target" d="m76.942 97.882 19.033-19.034c10.281 0 19.048 9.171 19.048 19.452 0 10.282-8.348 18.629-18.629 18.629-.14 0-.279-.002-.419-.005L76.942 97.882Z" style="fill:#419bf3"/>
      <path id="shoulder_button_front_left_touch_target" d="M99.096 41.101H47.503c-2.766 0-5.009 2.197-5.009 4.908v15.706c0 1.077.905 1.963 2.004 1.963h57.603c1.099 0 2.004-.886 2.004-1.963V46.009c0-2.711-2.243-4.908-5.009-4.908Z" style="fill:#419bf3"/>
      <path id="shoulder_trigger_back_left_touch_target" d="M47.697 41.101h52.635c1.521 0 2.816-1.579 2.065-2.955-2.77-5.082-14.508-29.61-14.508-29.61-.743-1.517-3.545-2.595-6.742-2.595H58.788c-7.657 0-13.864 3.027-13.864 6.761v27.047c0 .741 1.252 1.352 2.773 1.352Z" style="fill:#419bf3"/>
    </g>
  </g>
  <defs>
    <image id="2a" width="65" height="65" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAABBCAYAAACO98lFAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAHVUlEQVR4nO1b2XLjOAyEnawzmUxm9mF+Ll84P5eXzX1rX9R2q9UAacXeo2pQhaJsyyLRBEAQoCJ+U6yO3cHVcF31wb8N1XN+rX6Wv3+GDg6CEXqVXLvPQ8f1wQE5GAgi/Iralfmu6nugdjDfcXsQQD4NAgmfCb6m79w9TApAxXz/p8BYDIKZeeU1teuoAcmE/2i0/J/FQCwCQWY/E/wkdgDoZwUCpIJ+RMR7cs33TjRjXzD2AiFRfSf4CfEpXfM9CgTPPgRWfpPfGJCJqewDRDcIjdlXoStWDQE5AN4a/B5TDVkERBcICQCs5izkHyNvpMVvuJ+1gUFgAF6JX+RawXCa0QVEE4QEAFZtFXwTEWcjb6hlMAACgGBTUABeRn4e+YVaAMNAvIc4zxYQJQgFAGAV/ovhM2LcD7NQTWAteCF+MsygODC6gTitQCgAwGzyrH+JiPOI+Dq2zApECwTWAAj9SLwZ28zJxvic7bOvhutVBkQKgokD1AfwzEP4rxFxMTI+n9N9bBIsAIMAO4faMwD3MQdyLc9R+qDnW7J/FDNQ4aH+EP58FPrbyBfUAoweEODUMhDuie9G5u8eY2cmMA82jSEiBqcNlTm4ZRAgQP0x85ej4N/HFp9bILR8AoPAPkafEfQMx1vf4MxiBkLDDDIAvgs7ELBKYJlsgfAaO+f3GFOfwv93ALggivuZUKYJLhaAZz+LnQ/ArH+PiB8jA4hvsfML0IJNzE0hixPgHJ9juszy/0P+68LrWRCl2tBjDuuYrwbsBy5H4f8kEKAJcIwQgqNGFzazENAGaE/lUF2kmQZQIdowAWE0hSwiZFNgENgMGISL2K0MmUME8+BUG3oAYNBcJAkwuC8PApFziKwF8AfQBJgErlULsiUt20WC3X6DVxNeUl2IrXuMLRBsEg6EbEUACOwUsSxexnSJhC9QZ1htpVUbPuh+5z8yJ1pFkuvYOcm5TyBTyIBgTWBtUGYNYC1o5RIYiHUCAoPk4gkXVmeOeEtLNUEjRF4FeL9Q+QFHmCHdrkN4sGoAYomHmC/HzpdMNIGXGR4IO0V1jNAGjhg1NNaVwM2oCuoY/9Gdqu5XdBwZCJP+EROpJlQD0G2y2yXqdtl2boDXMTBhojAZ78k4dOfauyKVq4NLmigQbneone4DgI6BgRhkLFn+QnMXThMn4ziNmMUHVe7glDrQIIYB4I6dUPuQbubURJndmHg81h9lPsFtnnQWeBDaoVtplpBqg45HweCxuQnRcW0fnHXOJqEdaxY5iwGWCu/G4sbVGlO2Kk3GpSC4DhWMjDPhDwGEjqd3TOqXus1BB5517B5+aC1okY7N9d8cRwbC/5UWgZ+BoGXxfQqkQ5id2pFor6JtRgqCCuCyNRW7zg8FiEuZVXXLtESnVGmCE94lLcoszgFIn9Ma01vUEzQbmwMhE5737e46A8MJsi9l2tiqV2ZF28mY1hHb6oyzbdeRqw06MPa2zUL4bFJeC66AmFCPJrjSWFUT1PzeUiBckoXzCK5OWY1HD3ZsyW2gVAu0LMZJDG6fY7qF5nUbYHO+oEf4TCN1LDoOl1VKtUFBcB5YkXe1Qc0ouw0Lg9EiTaCw+nONksfwFL4K5Uw0InbVqGwrrabANQDuHJkczihzzM5CnYwt5/laAGAM7IdU+AdigPBkQHBARPBAxTmqCjotuDeMgWAwmLXsMIXz9u6QhuYRIXTWP7Sh0oQttXwCA4GBcElMK0PsC0Ke00q5u5WAfYCCfyfMILBfqFasFAQFwiU1HyKvDPEzGEg1lSyR6lYBgP8wCnwbETfEt+Gr06lTTMtwv1Y/h6vhWoVgTeAMkzuMxQKxWmsZTvOOFfCqBbcCAj7fxdQc1Cfg2TOqapGo1mBASGI8xTTL5CpDqsqupL5PQRbaB9W/iYi/Rr6h7wFCtjyiny4QcKMCAdWsKkPOo6OyzOajOcjM/GAKUHc1BTaHh5g7xdIULAijSTihNHHhhMhmkeOIpYc02CECCDUFtypMTqqovBYEEUqBeI25QwOp/2BbZhCqMwZVXIIl0a0KrAXOF2yF7z6uQ9rAzgpm8TrexiDoHkM9egWC9pNFhi420CAJS2PXxglUpqI6zitofZKLtb2lscqhsk+Ac3yMeVDmAjPd1qdnGXvOMbKTzH6vljWtUbp4gUFwTtUd5tQNE+8auwGIaGhChD3VmhVruQSmJTp3rLfn4BYD8WyuOafhEjsR4Y/t7QVCAwitVbqS2Ea+1/AZ5OIE1iz2E5o44VcAOChqAtANQgJEVglypTqefY4RqjDbpfSyM0k2rXfQo/6gxjsPzkyyFz9aYbPbUb4bThO8R3npA1S8+8RVKYDBbVa2Y9JUGgPCbZZB3hsACLGIirfgtETXKtsxue20u7bCRyx7GexT9cLGu5A97MgJyMLrPRHxL70SyFSAgTa7VhpMm11HxH/k5VClBJDq2tFMWLk+6KvCRy2fFy+L94IwoWO9NP5PnCGYUfUm/THfjv9NBf0N6UGHaHzqzbQAAAAASUVORK5CYII="/>
    <image id="2b" width="43" height="39" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAnCAYAAACWn7G7AAAACXBIWXMAAA7EAAAOxAGVKw4bAAADoklEQVRYhdWZ3XbaMBCExxQSCm2v8nJ5wrxc7hrCT0joBRo8HkayKTetztkjY2T0abzeXQvgP2rdPRc/n15vuv6lezrdM9/kySpgty72CvaWBYxOZpCd9a3jBHeq9ADGwauwDUg1hOMxODXYcRM4wgpogpxVjn1xNcCvyufLomrAV7AG6pDJHFqbQyVLC4jA87SCBuQ3s5n0Duygn8X0mIZy/rLI59Nr58AD2KCqQs5LvyjHcznnwAqrcMdgXQ04KZhAOSlBCLgA8GD9QhbjsAr6IXawzx8YKn/xY1XX3cBvPyEI9wDg0YzQhJ0JrIPui81LX/NxXfClJZ8lrKq6KGBLAN+LLYspMN1BYY84K7kHsCtG9/G7cBXa1HdryrqvPhSwVbF16QlOYMJ26F2Aiu4AvNuiUqTQ8wN156SXVSosXUBV/SFG6GWBpWIoEx8L7A7AVsbMZIxHB57TWN3DBmXpBuqvVHYN4KfYWtRdmLJ8mLblewflYmjHApxi9k1u8FigVjir+kuAV+hdwWH3shCqRfc4iGk00bsco0GKsUldAqvCa/SuoG5AWILwlh/QP2yMJBqvo7IzP9FQV4Edeo3eh92naXwgGUGoNkFTFgSAjjkguYEDc8WatTTuauylssxKFOOIs8KaSGrZr1bBVWsDH5ySRaoVaLz2qzI2FUC1krSawbTV6koP3MmmjPM5Rt8YWrA6ocdCFiEaduboowBKzyedY3ldqgPSIppxNtWfDsfUyaxEPz2VMeqzmhD49O9lERpbFXoAnNKtDkqgmt81G2lMZSrt5Fqm2TcAm3K8FWgHdujJynohQkiFIugSOYPxug2A3w1gugbnVgGbsKosb70GcIYkfs906rBc6LYAbnBW+A29a4y5Q4RlHcmB6gJ7DMMOTDktZLRE1EKG7rARo7qEHXeDl+7pVLJETVl9DyMoVeND5qqrG/GB3Iq9o3/gkrLAiBtwACdK+wRepzKLadrk7xBWo8gO15HBX2viW27y2Rqwnqeq/h6Wqn8HTqZuEF0AsPwrRbgXMlobaG6vVUyE1fcwTySeKLiwC3DzVVwmAa5fi9WXGfy9YvIqTtXldQrvbwieyQZtyo6MFh1exPjOTGuTQ+0znBvE17QjM2WvK+1z1Xr9TS9ofKuounUE5O2jCBuAE3iKFGkfQIHHKrQqaBPWgB261aeWqqmrWPrX+7Pawq732OfUqrXr1N3vSbDabv0fodbu/X/hn29/AAo2VaYa5XYBAAAAAElFTkSuQmCC"/>
    <image id="2c" width="48" height="53" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAA1CAYAAAAHz2g0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEw0lEQVRoge1ay3LbMAxc2c6zSU/5uX5hfq7HJo7t2OqhXGu1Akgp8UybmXIGI1mWCCxeBCEBX3x0l5zsR/9z9nzP3VN/CZ6zGTaE+4wiUiBzQFYZB0J3M86XDBewz/7LwISMTfAuOEbXqnPOELSvnAOIQawajCjsqtBaaFPoSug6+H2dXL+S5znXWnithH8HxG48uSA36cMrjIH4uVNtuJZ7ACc5nux3bzSyxIhZRXhqPzq6xhAcM8Ep5LFxTEFsAg258O426j68Hpm9BYCaPhZ6lyPPO/lf5ziPCAAZq+YjfydFQDIAmfCHIvSh0L781mdPMt/UhYr7uNtQcAbdTaFrOXoQasyQBxmqb1PbFJi0kyMB0SLqUnjunvqaC6n2KfwtgLtyvDVAbgkH4D5PzVPYt0Jre0YDW90zjQFg6j4EcAfgXohgbjB2J89OketQuxScSlglwiuIswttgGb2oQsRwLdCD+VIEHQnWiED4K6zBfBa+FAOve8d09g6j6UuRAs8APhuIOhKfCYCoBlnXzRP63FR7TEOaMbAezDnBIBaIosBAngUusdgBQY05+Bw36ffq/CnIuiuEC0apWg4ABde44DLf2SFR4ytQADKUC1A7e/wx31UeALTmPK5VN5qFuowXsAiEIyFBwyxQMYRALoCAWwEGAPa03O2SALIs5ACURAszDSlalYiALpFBmBX5gTGWteU7MWdr/DNGMhKCq0oyVTXBwVAxsxAmlW6co3C+6JY1TxH5kIKwuNBXcpLZi2dIwDUKMrvPaZliS6IUYU7y4VaVakXeFrb1yygeV6fy4pCz/2z1gG9ObJGVGJHwByAW2Jtz9VcZpELZUBq8VEjXfqz/1s80jEHQAZmCS19dvZo7Yn/+fEfwN8eXx7A0iDm8C5BjT5y/0UBLGGuOyeOLvhvCdgPA/AJsibUEeMNN6/xfgVwrDwTAYzkmAXABc+E9l7OAUMez4o53WFpD8gBZZZpAshMqUyU+R7D/la3hVp6qAVYPvO5rHUSWQN23rRApHFtPnHr9ybC877WfoDdCAejVoksMRoOQG/yJpRvB7UdssZgJVajmQV0Q78t5GAia7g7hQCAMeJoI07ht0V4ap7WWbInfgXwUohA2KE7CO80MymAKHDVb1Xzrxh3E44YNunaScgAaE/oVyGC2GJoK6ornVuKKm/kQpp1nCGFp4ZVeG8xZgBcIS8BCI0LtYIruupC3kVjn0aF57Zwi6EVottB7wtFc7IzF7kSreAL5DgGnrunvrQXI/+nz2r3mf97K6TVG82sQBAkBrRaIEqp1TQaaUv3tEcM2ve+aK297n1PTwzMSG6BZhC78J0wUoGYz9WtXPiwEYtxbEXvB3ZCTKe+JgDuQia8g2BTlde1Nc7umm7mo62kr+6e4XyB1BU6WwvOk59H8pbGXzMp8frSd2RuCa+rDnZtEsS1l3zqr35d/Td7SxkJXwORValRTaRzxEwaLzuixpNnnEz4CERU6Wal9dl99D1xaz/AoUy0xsnaIXMBKBAFk9Hkc4OQUeVbicg6Ps+cvo6XBBEY+DH6VqLKLAGi5/783KaUCxLV+6N7Fn2t4qPyrdCiLlpjhAK2vhn6lABLvtBqjUt9wfXlxm/KDCtMj03mWAAAAABJRU5ErkJggg=="/>
    <image id="2d" width="48" height="52" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAA0CAYAAADMk7uRAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEkklEQVRoge1ay3LbMAxcp3bzcnvqz+UL+3O5tY3t2I57CDdergBISjLT8Uw5g6EsiyQWDxKABFx4W7x34MPp8d1js/Zz8eM0d8wkJhJmPx0AgAGAMVAlE8b4wvrqemo7BdfRvRRIuGjBuBKC62yNaHFn+CSE4DoEMVg0YF7pqvjt80WAXLoRvRT/DUAsg0V0cWXyqqBIM1lzCb8kpP+9jX04PS4URLeQSF8lTPpipPci7VQAnPmj9E4KaKCJSAPOPJlcJqSAFIjOF9m5Mn8IiHwc29hOEzo5gIH0lXkyugLw1fqVAXGT8qY2TgkfAOyFnu33Hr02Oi24BtxBKd0VgGujr9JnIDhnJXkyvWvEOYDEkaVPTcg1QKnfALi1niBWGJqTamGM+Y3MsQjGqPbezHKKDyxxlvYtgDsA962/MxDqExkAmgOZ3zZS5v3ZI3rr6DVg9s+eGqCtE8A9gHUjAiGISAsKwO2ekn9CL/nIuY9tztFzINqBqIGbxvAawLdG6wbMtaBmRPuNpH/dxizkmUP7n+QCSU0ocmL6gAK4b8x/b71qgQ6dAXDpr0SyCi4TRre7KYAohJgK4h5nLXBr1TNBbZoAto1JMk+pq0/4zubCHmyjzny0ExGEOvS6XRMApaoaUADPOPvLS7tHjegcszQADLUwBQSB0IwyAJTyHmcTO+FsTrodZwfjqA8o81VIQSYJhoBucLZdXZwaOMh/aL/1QIxO9jJQzEwoA6LB3Ao9EPYVADJFh3WmXfJVWJICUMZ57SG1AllKr3FTBEC3yiwgrCQ/AJIByIAoiAyQMqMAXBORpCczPhWAA4kmnkJznw93nI8AGAP0WQBmNz8cLq79B/Cv28UDmOvEWb2moo+M+xQAY8xkdR22xchzUSErWnc2gGgyLzhl9Rw/8DQWiuo+Xv/pqg8VkAzAWB1H0709+iiTDGcAtIyi6aKCc804XyWAqvRX1XI0RGb+mgHYoU8Znw3MmGmlACo7V+lx0R1esyeV/AF1PnCQcVsD41rRYlbYKhPyLMrrOFvEOe2UlJKp41OjjYEhkMycysKWS96LUGScqd9Ve46ZlQNg87l2jfnfAP60a2qFIMZ8ogOQ2b5LbYM+adG0UMuMEQCaIoWxacw7iB36umjq0JUPZNL3ChptmmkhkxuNMr0uFJnRrwaC5kTHTkvsEQAgNh/aPbMnzawoSa+PRgAioWzQa8K1QBDhwbYEXsvUrbyYmQ/rOOqUR7mv9aCpxd29jKdpqkNHzjz5HIg04DUelaAXdmn7DkDn1SocS+tb9Nur+sCoE3MRj130bQmfoenorqPmVQGITMnPFj8X3JHfQHRpXDMjjWO8qLWy65X87wl6BSA6Y/x090Ot00L1joyLvST3OCnDh6yCFuW4WRSrsVAWG+VOHCzC5i/WdCusXrVWCXoWjntkmtp++poVCF+1qllFdaG51YUs0o3Cdb33NrYEEICIwIyVRTIQUWjsGokoZL5aaOx7Cb9XzlU0D86igC00HWcsbMFnNnN/Zy0KjyPtAKg/uZkstZkfOI058Wh7z8dPF9n+Akw5M9cvVTL/AAAAAElFTkSuQmCC"/>
    <image id="2e" width="52" height="48" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAwCAYAAABe6Vn9AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEqUlEQVRogd2a3VLjMAyFT0qh/C1XvBxPyMtxudAW0nYv8GmOFclWYHd2Bs9o8m/7i2RbUgL8sDIsufnp9LLo/r9VnofHU/bebgcdiN7xd4vtfHXcgws7Y0CG5DbTRqtDp+Q2BJt1pAESCcx+rw2vI9phu2/lfL8HtQ464UGsgq0HGMF4QB7AMdhWUE+nl8FCVQ2KdiyIyoVzboWctrIgh7JP0eOZxhTK05CFIcC67FPWmMNFmuoB2c5bGWSrYLNyBnLGDmHY+TWAS7OlEExNMQOkmlGAEcBHkRHTSzrIs4Psz4EExJoaAS4BXAHYlC2PLZRqqgekJqYg70a0vuZYikxOYdYCsgFwXYTHERTrimDU1AhDgH2RHWqNe+NtELiuhi5Qa+YGwG3ZUiyUN0lYGKAeNwqzK7KVeuw4O5ZrqqmpsTJ+KBwzBLkuELcA7ozcYtIWoXQ8tTSk2qGZEeQNwKsjO3xq7r08o7MfnofH01c0dAfgF4D7IoTiuOJE0gLSscNxsy8wfDGD3KMTxEfrhbWmbR1Dl6XTBLoH8FDA7sr5a0yznzU7D8iOnR0+XxqfP2E+tqwFzIqnIUiHaH5XmMxPtfSASUs3mGZD1ZA3hjxz25ZnCUOQPWLtq8xmObvSe1A6MaimCKQNR2bhAe1Qa8ZqTde9pvZ7JqdAOpaoKU4W95hmvCVAHBM6Zgi4kfq0zqZHEpmcB8UJwgMjHE1zCRAXTh7vUS/e6nJ5MFX9GW/bQlnPgbKRfZpGC+ggnaSZ7aVugnhLQRiHRSbXg7L+nQXMaEg9ilHqinxE6yemx5CCWCjrgVvPW497QDzv1WE9eDsJhH5iy+QUJhMnRTFS5Pqcks96bYelBxTBWclcz9aVrcMtq/4t3ZJOMSXq+XZdWQ1FCYue/Ou6FgNFWRjrynsC9NchK/Za1P5ioAyIjftHTDMUkFuHxiJah02Q2KwP0IDygDIg7MiHEcJwnekBqXPK8MBCehmfEKqlIW1cQTQu0ZD5Qu4fE0Dq+uxFCMd2ohSWC2WB9IaWVjTmp2cAuSfjKaiGGKky/FYw1pmCUqDI1Gw2hiCMLglzwDx8QACkmR6+IIbdb6Vu1ZiaoQflAtkG7VvUN6lhAmHekQ/wbOqK4fcrgN8CRm2p+SnUrEQm540b1Yx2+lCuaQieySl4ITi1RCjVFKHClLAHBMw1pKa2xeR4ApNmliRJ7MxpkyRvqLW0RZ3lsWZXFU9D3szGN6hjQ+1f46BeGssbozaNRfOLzC5cYM8NltxcKzmiYTejVM3JeWFy1UYAZLVE06Z2KJwB3UkiSgV7Da0whcm8R7VmTe07qWA7k+qWIHZdqkp2DOm1I2oT0YlgyScVbzZV70OT9TznwYTrEMxN6mDqubFAaOIv+vLQ0lALSsVziapJwf3g9Tw8nuQbkQKNpmH1BqIPXi0YDyjyF72PX19aWFmO5rw25n3kysC0oDwwL8QIve1Zw8F3Vi9R0gJZAuRBachwdM6dn29+NA6gIjh7rVlno9jB7XkArlfgfdYPG1/440WzrmTxZi0PFsCCHy9sSfwak6onWWwnZ53+8q8xXvkfPy8t+XHpR5Y/ZaguuvoNjWEAAAAASUVORK5CYII="/>
    <image id="2f" width="52" height="48" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAwCAYAAABe6Vn9AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEqElEQVRogd2ay3LbMAxFIT/qxE26ys/lC/Nz2bV1/IisLsprXV0BJNRkughnMPRDgngEkAQgmX2x1i05+Hl4XXT8Z7WX7mnIHtscoAPR+v7RpoOffG/BhYMRkC7ZZ/VHgxqSfQjmXpBguI/E5HPrGt5AvIFHcjvOg5oNQmBYVkHvAYb6HSgP4hr0MziFmlwwgFmJrJ3fGK4G4oGpXIv0wecq1Ma5iMKsqd+UHp8VMLJUBIMeA8XAezN7L31fdPc2BVM9UyBnEcBgMXjItgj/5kGxrgjEs8p7kYv0nehwFwW1kOdqDPHNkQyU1xgGdx8AFzM7F1mXXm+ClXOH5+G1g9tFLsfzBUA7M7srsqOeLcZQ0FWDgZsxzNnMTmZ2JH16DgQ3LpxD3vzZ2F9L3JnZfZF96QG1s9FSGSupdRjmWAQ3qLO5a+o8mgBg/kB4zsASgPhuZg+l3xPYzkb3w13NAME6bJk3MzuY2W8z+1X6Q5G3Anu2ca7d4F66p6FmIV4QYCGGeiSw+3LMls5rAfHcYTfDjenkOMyt6g2rLdvqcrDWvsA8mtmPAuVZKQvE1jnY6Lb6v87TFBAOiBYFdr1Hkn2BZStFexLPB7gNXG1brjvYOK9ONl8kvAhltspFUQIv2zynGApWAtDG8kCXMljcCMAAYmdT6zDUrLVcji3lQQHswUa3w8Ait2AgzAu42UCAvC3oXhdGJJHL6Txi18MGy/sS4DCPMkB90XW20WVgGejJwEz0exZiOLWWBwYBIAaRAbrYaJm+wOhGnbJMDUjjMAXS+G4rkrUQz4N30uXFiOkcLLKQdyLnQRyBaxTOkXgNCG7m6dC0JJ2e1FyOYTJ5UitHUqAhea537bC1gCK4mgtE/y/Rl9Uxa6v2Ic2WLjEl9HxYV9ZCtaJFq6DxWbpSsC0grbREYbwnZu2NtSUK0gSLgDIgvQjiMrhxZh/COapLiyIKl07BcbBe3APhdBnhy7qcd10AhGgatQMPsGaxJhBftFbA4Lz/ZKNlEHRmgXA+BDoBGJWw3KZASu/B8AA4IeNBZmM5jraRjR4JTK3mWWoCx0DqnzUYDABhTkeD42jbKkCcPiAfQrrtgcH9qitfNIc0RdZqzIFgrBx7so8leEeb1hFgsZNN3Q+WSi0K3iKgd5HTbLOxJsApOIcv3g3DTVDLHwrQT4Fi9wtLwh4QX5Tdja2DAWNQKD1p0TEKJBmI5xFbCZaC+8H1eC6lXE4txCsacnoMEP/DBZE+aIpcA/IKJVzGgpXU7XhvmrTbxUptrlUxvRfRQqOX87eA+MZxofGN4PBdV7+btaJSsLfCIatE49+RYWKByGaW0UrKloIL4vMMwlOcWeW4TKQbIldrPqtYD92wRGajDYF4L9LasQfkZZmZzFKvA70aVnEfwrgPvF66p4GeEUVA7O/6wItT5RoM62sFvhrX4b/FGyuaPimDwpWNc0v3nGyG6UXzHlgrpZi02YUrD421UKK/qb6MhfizB6apw1WOrz80DqAiOP09C6JNg0wvAvC+5x7roy188aKqK9m8PCfql714wS3xakxKT7LpIGeD/udXY6L2v19gWvLi0pdsfwDrTzKXc+jmowAAAABJRU5ErkJggg=="/>
    <image id="2g" width="76" height="56" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAAA4CAYAAABXJB78AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAGn0lEQVR4nO2c21LjSBBE0zYwHhhmX/bn+ML9OV6XGTCL5wGllU5ltSSDL0RsRXRIsmypdZRVXX2BBQ6wh+3jwj5ajGx9Px23bFsc63YbzuOfxd/+2w/ZnEo7KIXi++kzv98hwBxQOvbPPxXapEoHUA5jiX1QfpygHQpMy1uxTfA+BdxopQVWAkA4Xha2z2O9zqT7YwhL4Wj5z44dIICPQ7uqThSqqgCtuuL7DjEpDsjgPCZVkFheZZ/ngH1wH7b4hk1VwFA1KytXXVnJVov+vnLRylxZDollY8cKT1X3IZWVChPjQ/LBFcy1bK/lWIsqz6EhbIFaXQSgkDYAXqRsunts7Bq8/vZh+7g4FNoAmKnL3Y4QrgHcyPabHSu8ltKAoWsmWAqMyiKoZym/u62rltd8s+PZtnfhEODV/RQUIa1ty0JoqjKNa61YVgFTV1RYvwH8ksJjQqQK1UUPds3kkim4ExaBrAF8t7KWQqhJZZXCKlUkddH9COeb3Gtp10jphl5/llUxTKFRJVTVdwC3XbmTrYKjym7QBtZqKStgqq5fAJ7sPgv7nacZy+46OCSW7YCNuCNdkcq6A/DDikKjEt0tk0vS5gKjutbdfRSW52baWu41AFMgqbnCUsBXd1zjXVE/ANwD+NkVQrtFrzIN/p6XTUktHBhbRwWm6lrK9z030zRjKd+ZrbJWDGMqkYDd4R3UX9iHRpW5wsYC/lRgrjDeY2nf9bSDOZoq7SCVJYW5S2rryPhFl7xHD+0e+8CosKkpRWXeSjLoV8ry/EyBEdoS0lrOUdlYK+nAGPTvunIv5Sd6lySwsdg1BxgV9ophkFdlpfzM0wsG/9kt5hUQx7c8YVVgDPzaUtId79C3ktrMt3IvhGN/CI9jvK7D0txMy3N37hq9yhby+8k2xSWTyqi0VBjw2ToqMGAfzhyFEYymJ8AwtikwTWYJ7Qq9e+/ysoft46REVoGltz4GbW0l5V9V33GOKTRVlsYtz/yf0L9EBcZ4tkIf/CerbBk+S+Nd2o/0znYq3vn2/mQaGkolfcf7s/riCOhWiifTnubsXmYITQNr5WGpi6TDNz4qkTraKaP3e7VM377ur9C7qCbVz6i7bApMYxmD/ySlJYVpZVvgWspJY1+toN8yd2etCxukqlFyaBouYsgYU1nLJb2CDi1l7mMjqx+xKV235J4JWiuhbtqYwvx4rACfC6mql6usFdNSHKsapVGVtYBp5Vpx6BhqatVH7+sNkrvlVJWt7NqljQFLFT4VnCn1GFOZw9JeiELT8AKgVtlcYJdgVQMwBiy1mD4aPCqGrwhMjQ9XJdeem6UWM+VlALLKviqwlO60eiNJaaqyyS3mVwWmlhoATWbHgLW6cQP76sAODf4p+48qc7f86sDUpuZlSWUpxfg0l0yrY85R1LTldGg+slL1L8s4piqbslQgVXTsYXTM/BT5mgKs4lk18awd8pfudzrAuNcpbwHzN+mTotUqGr0ZcDxg1Qy5jm5U4HTrs/Qb+e0bzCpgaXjYZ2/SCppX9G+E4+anUpgOKOrypgpcGsOr5h+aCqvcLkHSaSzKWYeSTwHM66v1TODSgKivbxukF5xZcmB+c1eUT2FxRobZMrrvpbH8Y1uaXdKZIp73vM231UjMFpgWw1rLjDh+zhu9dee9f3Zsq1TGenIsfzD5gZmDnJVLJlgbDCcZqCxW8kU+a+YzR7KkMs6ScyLEZ8G9cVsU+wD2gSV3rFTFNQ3qhi/o5yMndTOOZD6HyRfNl8xpN50NT8uhorViWLWe4Ql9oFRl6XzkuYHpC2cco2f8i/25ypbiBvAql1RY+pZ80RorpAtD0mz3KSylQmnFD5X21B3rXKUuiYpKuwLely526X+KXwqMyoFU5hm9i5ZjSye2VlhRaFzaOdk9W4kr3Y2BU4dwWRG6Ykr+zjmMnV68p0O6lKByTcCgtVpJfTv68FqBm+6GVaYMnAcaH9LX9qvSfIXPC4ZryAbQdsA6t9QbsgP9ahXRuDBnSeYprZWAew9F15Gl4D+qMN5o0PHEEJguHUiB/pwzS1N6Lakkhe1W9rT6ktz3v9nhzVLf69yu6OZpUjWAUC0ebivMWktguBaUAKulApeiLprHoGp4qvoruIHFh5r4J39V38uvec6g758lcNvieHcdXWhXPkz4izaHkiBdgqoq81CThrH83GBVYvMBiz9Z1v1LUNMcc2i+vwcnLeGc9ICN1SyXDmjMBkDG1rke/MBTljdeun32fxz434L9AZ7ptX/DaxeNAAAAAElFTkSuQmCC"/>
    <image id="2h" width="86" height="41" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFYAAAApCAYAAACvIt7jAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEmklEQVRoge2bzVLbQBCEW8YGgiG58HI8IS/HMeBfrBy0Y/W2ZlaKqyivEqZqSrKx1t6Pdmt2JAPf8SXRXHLQS/t20XFzjNfmub3kuMmAHJhjj+caCjJ7PBX0KAwB2jhb7++Tx79yRBDHtqOAw4k7QBliE6SOOSewLXKAUWbHRYDdiRNU3i7QA1wEW++4mqME8hRsFbILd6lPCFTORcob2rfHCnfMIq4dnlIV4mfanuSx/V3HySKbcACVAXIuaZ+Bl6yhplC1KsBj2rc8Ygj8rFxV7UCxKRgqw1ylY2xr+/waDy6Pe83wTlYK1SAeARxou0j7HGflvrRvDcM9g3XUyko1gCsAt04aZA8uR01g1QIM6oFyn/Imbb3P79qCKlY9kqHeArgDcJ/yjvIWvYrHVFtLqFpZpTvKLfrzSCPHtum58ZMXhjawRAfOgD4A+EFpkFm5pvbawbIFGNQ9OqCblCaWRo4bwGU7iBTL3mpg79BBXVM+pDTlqmoXzvjXDLUCBstQt+jnY1C9E5xlA1HuEjj7q+exbAP36BS6BvAE4DHlOj3PluCBvTZUC64G2AbMArbolOpB5ZOb7S8wwQo8xTJYU+wTgJ/oAT+gtwS1Ax67hlCwbANmAe/o5wDndau0b3YHeIqV4IogUuwjOqi/0naNHizbQa21LPsjn7TYAkyJahO36CuFwYrzpX3Da/PcMlhvpcUe66nWlPuI3g4MLCu2JrCRYvfwobLvWkbVT6jYUg3L5ZZVBKZeO5HNWbF7dJ+7Qe+7O3Tz/IBfUnL1k0Vp5aVLWV4gcD1roLXs8qqCmkIVy35qfmvzUaiuDfDgpTrWg7uUXAVpYGutY1mx9jkNsjcXXVmO9kM8K9B9D3Qpoz5trTF1bl4HDwjmtyz90Qlt9p6C/PzLca8RuqTlDBvbEuH8Io8d+wBWIHOpwsU0e1CtYfOyQt8aLtyEsXkqdB1jEEt6AZcLpXaavak1KTbIyxNeec0BLK+8uKTaIYfNq62sF+uFp1gPKjcobMmnNd8BeSOmdn/VliEvad/RlVgb9JBLcCd1t7x2mgfV4BlUr4atHSyQfxttjh8AfqMHzAo+0DGhDzNYbfx6PcoNelWCXrNF3oCZE1hdfe3RwXxHDneDoXJDS1DFMlzuqO+Q13S8OuGloNZ6tYc3V1atwWXVRmBHr3mVbICLaf7q6OWZ2k9cFp7PavtQFbuH77UA0EaN7ugaEC9PuePD3SBdQ88NLFufNl7sasIWuc9OUqxXah0x7N5wg4IvJmpjAqgbrjdfrs3Nb3eSXn3re+xr89zSVVp7kyYdzHD4K8NrafZVbf7WGgrWvol60uZFg9a0JxnnHJ4V2PYkz9sbHzFsTER9gtpjbEHECuYcrWOzydO1L68xoXfC6O1Gk5oTFUYEVwGfZL94N0xUFVjof8UGv6jjU2noV9nmWWoy8WsGUAEHQHCnoQKMvvZzAqrhea6KynsewASwQHhvLO/r43CsmYWnXg84v8a9jTOEUbg13muGF8eaWWhbMHqueFf3JBjBjzn+FZBjMYA35XcIF8P5X345c+mvZr7ji+IPPk7IumiDX5AAAAAASUVORK5CYII="/>
  </defs>
</svg>
`,GamepadRightSvg=`<svg width="100%" height="100%" viewBox="0 0 123 232" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd">
  <g id="right_side_of_controller">
    <path d="M10.5 140.855c6 29.375 13.537 33.424 35.28 43.583 35.355 16.519 33.138 57.105 56.59 45.51 14.36-7.1 21.13-19.23 21.13-38.4 0-24.92-11.42-65.99-32.4-119.1-10.625-22.2-25.844-16.642-42.794-16.642-7.93 0-15.744-1.225-22.454 2.225-14.564 7.511-21.031 55.022-15.352 82.824Z"/>
    <g id="stick_button_right">
      <g id="stick_bg_right">
        <circle id="shadow12" cx="42.54" cy="176.272" r="26.46" style="fill-opacity:.5"/>
        <circle id="Oval6" cx="41.3" cy="175.022" r="25.21" style="fill:#6180b0;stroke:#000;stroke-width:2.49px"/>
      </g>
      <path d="M41.215 179.291v-8.477h25.442v-7.872l12.11 12.11-12.11 12.11v-7.871H41.215Z" style="fill:#ff00bf" class="direction_highlight" id="r_stick_right_direction_highlight"/>
      <path d="M36.977 175.052h8.477v25.442h7.871l-12.11 12.11-12.11-12.11h7.872v-25.442Z" style="fill:#ff00bf" class="direction_highlight" id="r_stick_down_direction_highlight"/>
      <path d="M41.216 170.814v8.477H15.774v7.871l-12.11-12.11 12.11-12.11v7.872h25.442Z" style="fill:#ff00bf" class="direction_highlight" id="r_stick_left_direction_highlight"/>
      <path d="M45.454 175.052h-8.477V149.61h-7.872l12.11-12.11 12.11 12.11h-7.871v25.442Z" style="fill:#ff00bf" class="direction_highlight" id="r_stick_up_direction_highlight"/>
      <g id="stick_right">
        <circle id="shadow13" cx="43.16" cy="176.892" r="17.12" style="fill-opacity:.5"/>
        <use xlink:href="#4a" x="161" y="142" width="65" height="66" transform="translate(-152)" class="gpad-highlight" id="stick_button_right_highlight"/>
        <g id="Group-61">
          <circle id="Oval-Copy1" cx="41.3" cy="175.022" r="15.88" style="fill:#fff;stroke:#000;stroke-width:2.49px"/>
          <circle id="Oval-Copy-21" cx="41.3" cy="175.022" r="12.14" style="fill:#fff;stroke:#000;stroke-width:1.25px"/>
          <path d="M39.689 175a.318.318 0 0 0 .317-.353l-.282-2.586a.318.318 0 0 0-.317-.284h-2.102a.32.32 0 0 1-.239-.53l3.995-4.543a.317.317 0 0 1 .478 0l3.995 4.543a.32.32 0 0 1-.239.53h-2.102c-.163 0-.3.122-.317.284l-.282 2.586a.318.318 0 0 0 .317.353h3.433a.32.32 0 0 0 .319-.319v-.968a.318.318 0 0 1 .51-.255l3.05 2.287a.32.32 0 0 1 0 .51l-3.05 2.287a.318.318 0 0 1-.51-.255v-.968a.32.32 0 0 0-.319-.319h-3.721a.32.32 0 0 0-.317.284l-.386 3.542a.318.318 0 0 0 .317.353h.029a.318.318 0 0 1 .233.537l-.966 1.034a.318.318 0 0 1-.466 0 972.66 972.66 0 0 1-.966-1.034.318.318 0 0 1 .233-.537h.029a.318.318 0 0 0 .317-.353l-.386-3.542a.32.32 0 0 0-.317-.284h-3.721a.32.32 0 0 0-.319.319v.968a.318.318 0 0 1-.51.255l-3.05-2.287a.32.32 0 0 1 0-.51l3.05-2.287a.318.318 0 0 1 .51.255v.968a.32.32 0 0 0 .319.319h3.433Z"/>
        </g>
      </g>
    </g>
    <g id="start_button">
      <path id="start" d="M30.051 132.744a8.497 8.497 0 0 1 2.825 6.334 8.495 8.495 0 0 1-2.825 6.333H18.67a8.495 8.495 0 0 1-2.825-6.333 8.497 8.497 0 0 1 2.825-6.334h11.381Z" style="fill:#9a9a9a;fill-opacity:.5"/>
      <use xlink:href="#4b" x="152" y="117" width="46" height="41" transform="translate(-152)" class="gpad-highlight" id="start_button_highlight"/>
      <path id="start1" d="M28.85 131.196a8.494 8.494 0 0 1 2.826 6.333 8.496 8.496 0 0 1-2.826 6.333H17.47a8.495 8.495 0 0 1-2.825-6.333 8.493 8.493 0 0 1 2.825-6.333h11.38Z" style="fill:#fff;stroke:#000;stroke-width:1.35px"/>
      <path id="Playstation_Btn_Icon" d="m20.832 134.571 5.982 2.961-5.975 2.955v-5.916h-.007Z" style="stroke:#000;stroke-width:1.1px;stroke-linejoin:round"/>
    </g>
    <g id="button_1">
      <g id="Group">
        <circle id="shadow" cx="45.85" cy="121.855" r="11.806" style="fill:#00ff04;fill-opacity:.5"/>
        <use xlink:href="#4c" x="171" y="95" width="52" height="52" transform="translate(-152)" class="gpad-highlight" id="button_1_highlight"/>
        <circle id="Oval" cx="44.99" cy="121.007" r="10.945" style="fill:#00ff04;stroke:#000;stroke-width:1.72px"/>
      </g>
      <g id="Playstation_Btn_Icon1">
        <path id="Line" d="m41.345 117.35 7.72 7.731" style="fill:none;stroke:#000;stroke-width:1.72px;stroke-linecap:round;stroke-linejoin:round"/>
        <path id="Line-Copy" d="m41.345 125.081 7.72-7.731" style="fill:none;stroke:#000;stroke-width:1.72px;stroke-linecap:round;stroke-linejoin:round"/>
      </g>
    </g>
    <g id="button_2">
      <g id="Group1">
        <circle id="shadow1" cx="66.7" cy="101.005" r="11.806" style="fill:#ff0009;fill-opacity:.5"/>
        <use xlink:href="#4d" x="192" y="74" width="52" height="52" transform="translate(-152)" class="gpad-highlight" id="button_2_highlight"/>
        <circle id="Oval1" cx="65.851" cy="100.145" r="10.945" style="fill:#ff0009;stroke:#000;stroke-width:1.72px"/>
      </g>
      <path d="M60.941 95.78c-.898 0-1.637.739-1.637 1.637v5.456c0 .898.739 1.637 1.637 1.637h5.456c.898 0 1.637-.739 1.637-1.637v-5.456c0-.898-.739-1.637-1.637-1.637h-5.456Zm11.457.546a.548.548 0 0 0-.931-.386l-2.182 2.183a.542.542 0 0 0-.16.385v3.274c0 .145.057.284.16.386l2.182 2.182c.103.102.241.16.386.16a.548.548 0 0 0 .545-.546v-7.638Zm-8.746.911a2.905 2.905 0 0 1 2.898 2.908 2.906 2.906 0 0 1-2.898 2.909 2.905 2.905 0 0 1-2.897-2.909 2.904 2.904 0 0 1 2.897-2.908Zm0 1.212c.933 0 1.69.76 1.69 1.696 0 .936-.757 1.696-1.69 1.696-.932 0-1.689-.76-1.689-1.696 0-.936.757-1.696 1.689-1.696Z"/>
    </g>
    <g id="button_3">
      <g id="Group2">
        <circle id="shadow2" cx="25" cy="101.005" r="11.806" style="fill:#48c0fb;fill-opacity:.5"/>
        <use xlink:href="#4e" x="151" y="74" width="51" height="52" transform="translate(-152)" class="gpad-highlight" id="button_3_highlight"/>
        <circle id="Oval3" cx="24.14" cy="100.145" r="10.945" style="fill:#48c0fb;stroke:#000;stroke-width:1.72px"/>
      </g>
      <path d="M17.592 98.69c0-.798.657-1.455 1.455-1.455h.677c.486 0 .941-.243 1.21-.647l.591-.888c.27-.404.725-.647 1.211-.647h2.808c.486 0 .941.243 1.21.647l.591.888c.27.404.725.647 1.211.647h.676c.798 0 1.455.657 1.455 1.455v5.093c0 .798-.657 1.455-1.455 1.455H19.047a1.462 1.462 0 0 1-1.455-1.455V98.69Zm9.821 2.183a3.288 3.288 0 0 1-3.273 3.273 3.289 3.289 0 0 1-3.274-3.273 3.29 3.29 0 0 1 3.274-3.274 3.289 3.289 0 0 1 3.273 3.274Zm-3.273 2.182a2.192 2.192 0 0 0 2.182-2.182 2.193 2.193 0 0 0-2.182-2.183 2.193 2.193 0 0 0-2.183 2.183c0 1.197.985 2.182 2.183 2.182Z"/>
    </g>
    <g id="button_4">
      <g id="Group3">
        <circle id="shadow3" cx="45.85" cy="80.155" r="11.806" style="fill:#fff000;fill-opacity:.5"/>
        <use xlink:href="#4f" x="173" y="56" width="48" height="47" transform="translate(-152)" class="gpad-highlight" id="button_4_highlight"/>
        <circle id="Oval4" cx="44.99" cy="79.295" r="10.945" style="fill:#fff000;stroke:#000;stroke-width:1.72px"/>
      </g>
      <path id="Light_Icon" d="M44.99 72.753c.336 0 .613.277.613.613v1.227a.616.616 0 0 1-.613.613.616.616 0 0 1-.614-.613v-1.227c0-.336.277-.613.614-.613Zm0 10.631c.336 0 .613.277.613.613v1.227a.616.616 0 0 1-.613.613.617.617 0 0 1-.614-.613v-1.227c0-.336.277-.613.614-.613Zm0-6.542a2.465 2.465 0 0 0-2.454 2.453 2.465 2.465 0 0 0 2.454 2.453 2.464 2.464 0 0 0 2.453-2.453 2.464 2.464 0 0 0-2.453-2.453Zm4.626-1.305a.616.616 0 0 0 .195-.449.616.616 0 0 0-.613-.613.616.616 0 0 0-.449.195l-.868.867a.615.615 0 0 0-.164.418c0 .336.277.613.613.613a.615.615 0 0 0 .418-.164l.867-.867h.001Zm-7.518 7.517a.612.612 0 0 0-.418-1.062c-.17 0-.333.07-.449.195l-.866.867a.612.612 0 0 0 .866.866l.867-.866Zm9.434-3.759a.617.617 0 0 1-.614.614h-1.226a.616.616 0 0 1-.613-.614c0-.336.276-.613.613-.613h1.226c.337 0 .614.277.614.613Zm-10.631 0a.617.617 0 0 1-.613.614h-1.227a.617.617 0 0 1-.613-.614c0-.336.277-.613.613-.613h1.227c.336 0 .613.277.613.613Zm7.847 4.626a.614.614 0 0 0 .867-.867l-.867-.867a.616.616 0 1 0-.867.867l.867.866v.001Zm-7.517-7.517a.617.617 0 0 0 1.032-.449.612.612 0 0 0-.165-.418l-.867-.867a.611.611 0 0 0-.441-.187.613.613 0 0 0-.426 1.054l.867.867Z" style="fill-rule:nonzero"/>
    </g>
    <g id="shoulder_trigger_back_right">
      <g class="direction_highlight" id="shoulder_trigger_back_right_direction_highlight">
        <path d="m12.269 51.254 12.27-16.491H0l12.269 16.491Z" style="fill:#ff00bf"/>
        <path d="M25.523 17.167c-2.534 0-13.254.512-13.218 21" style="fill:none;stroke:#ff00bf;stroke-width:8.5px;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5"/>
      </g>
      <path id="shadow6" d="M70.5 39.658H32.67c-1.52 0-2.78-.6-2.78-1.32 0-.1.03-.2.07-.3l10.9-22.92c.71-1.5 3.53-2.57 6.76-2.57h11.8c7.65 0 13.86 2.96 13.86 6.61v19.18c0 .72-1.25 1.32-2.78 1.32Z" style="fill-opacity:.5"/>
      <use xlink:href="#4g" x="165" y="3" width="76" height="55" transform="translate(-152 -4.306)" class="gpad-highlight" id="shoulder_trigger_back_right_highlight"/>
      <path id="bg" d="M31.21 37.298c-.37 0-.72-.06-.98-.19-.25-.12-.4-.28-.4-.47l10.92-23.07c.28-.58.97-1.1 1.95-1.48.99-.37 2.2-.58 3.46-.58h11.8c3.44 0 6.56.67 8.82 1.75 2.34 1.11 3.66 2.63 3.65 4.2v19.18c0 .19-.15.35-.4.47-.26.13-.62.2-.98.2H31.2l.01-.01Z" style="fill:#fff;stroke:#000;stroke-width:2.17px"/>
      <path d="M60.102 31.312a10.054 10.054 0 0 1-1.374 2.86.681.681 0 0 0 1.122.769c.892-1.302 1.505-2.722 1.785-4.195l1.075 1.05a.68.68 0 1 0 .95-.974l-2.551-2.49-2.489 2.551a.68.68 0 1 0 .973.95l.509-.521Zm-8.281-11.708a1.932 1.932 0 1 1 3.698-.289.862.862 0 0 1 .17.104l2.302 1.795a.876.876 0 0 1-1.077 1.38l-2.301-1.796a.82.82 0 0 1-.143-.139 1.924 1.924 0 0 1-1.489.082l-2.921 2.983a1.183 1.183 0 0 1 .043.125c.011.038.022.076.031.115l.01.043c.019.09.031.183.037.277l.002.022.001.037a.508.508 0 0 1 .001.039v.026l-.001.071v.006l-.002.038a1.91 1.91 0 0 1-.034.263l-.014.066-.025.096-.004.012a1.515 1.515 0 0 1-.045.132l2.921 2.983a1.939 1.939 0 0 1 1.489.082.898.898 0 0 1 .143-.139l2.301-1.796a.875.875 0 0 1 1.077 1.38l-2.302 1.795a.862.862 0 0 1-.17.104 1.933 1.933 0 0 1-1.828 2.326 1.932 1.932 0 0 1-1.87-2.615L48.9 26.229l-.005.002a1.954 1.954 0 0 1-.339.085c-.026.005-.053.008-.079.011l-.014.002c-.035.004-.07.006-.105.008l-.018.001-.012.001-.048.001h-.027l-.074-.001-.013-.001-.015-.001a13.143 13.143 0 0 1-.119-.01l-.013-.001-.063-.009-.021-.003a1.881 1.881 0 0 1-.54-.175l-.011-.005-.02-.011-.011-.005-.01-.006-.01-.005-.046-.026-.018-.01-.007-.005c-.03-.018-.06-.036-.089-.056l-.009-.007a1.622 1.622 0 0 1-.141-.106l-.013-.01-.027-.024a1.461 1.461 0 0 1-.128-.122l-.008-.009-.039-.042-.005-.006-.028-.033-.027-.032-.007-.009-.012-.015-.012-.016-.029-.038-.005-.008-.032-.045-.006-.01a1.934 1.934 0 0 1-.076-.123l-.024-.044a.773.773 0 0 1-.015-.029l-.038-.079-.005-.011-.004-.011-.004-.008-.015-.035-.004-.011-.004-.009c-.011-.028-.022-.056-.031-.085h-1.87v1.434a.625.625 0 0 1-1.25 0v-4.118a.625.625 0 0 1 1.25 0v1.434h1.87a1.351 1.351 0 0 1 .05-.132l.005-.011.019-.043.034-.069.005-.01.006-.01.003-.007.023-.041a1.82 1.82 0 0 1 .095-.151l.006-.01.009-.012.023-.032.009-.012.007-.009a.106.106 0 0 0 .009-.011l.006-.008.009-.012.028-.034.036-.042.001-.001.063-.067.008-.009.008-.008.076-.072.026-.023.009-.007c.041-.035.083-.068.126-.099l.002-.002.047-.033.01-.006a2.03 2.03 0 0 1 .201-.118l.011-.005.021-.01.011-.005a1.924 1.924 0 0 1 .654-.178l.012-.001.058-.004.015-.001.015-.001h.022l.038-.001h.05l.012.001h.025l.012.001.018.001.032.002.012.001.024.002c.045.004.09.009.133.016l.012.002c.113.019.223.048.329.085l2.921-2.983Zm1.089 9.594.036-.034a1.002 1.002 0 1 1-.036.034Zm-4.373-5.75a1.002 1.002 0 0 0-1.269.783l-.003.016c-.006.04-.01.081-.012.122v.013l-.001.026c0 .054.005.107.013.158l.001.007.001.008c.007.037.015.073.026.109l.001.004a1.002 1.002 0 0 0 1.238.675l.007-.001.012-.004.011-.004a.142.142 0 0 0 .022-.007l.013-.005.009-.003a1.001 1.001 0 0 0 .648-.937l-.002-.064a1.002 1.002 0 0 0-.619-.862l-.027-.011-.009-.003-.013-.005-.01-.003-.012-.004-.009-.003-.016-.005Zm11.565-5.943-.509-.522a.681.681 0 0 0-.962-.012.681.681 0 0 0-.011.962l2.489 2.551 2.551-2.49a.68.68 0 0 0-.95-.974l-1.075 1.05c-.28-1.472-.893-2.893-1.785-4.195a.68.68 0 0 0-1.122.769 10.047 10.047 0 0 1 1.374 2.861Zm-7.156 2.147a1.002 1.002 0 1 0-.036-.034l.036.034Z"/>
    </g>
    <g id="shoulder_button_front_right">
      <path id="shadow7" d="M32.192 43.878h39.986c2.643 0 4.817 2.645 4.817 5.859v7.033c0 1.288-.871 2.347-1.93 2.347h-45.76c-1.059 0-1.93-1.059-1.93-2.347v-7.033c0-3.214 2.175-5.859 4.817-5.859Z" style="fill-opacity:.5"/>
      <use xlink:href="#4h" x="159" y="30" width="87" height="41" transform="translate(-152)" class="gpad-highlight" id="shoulder_button_front_right_highlight"/>
      <path id="bg1" d="M30.673 44.236h40.011c2.109 0 3.844 2.109 3.844 4.674v7.053c0 .638-.432 1.164-.957 1.164H27.795c-.53 0-.965-.53-.965-1.174V48.91c0-2.565 1.735-4.674 3.843-4.674Z" style="fill:#fff;stroke:#000;stroke-width:2.15px"/>
      <text x="48.396" y="55.277" style="font-family:'ArialRoundedMTBold','Arial Rounded MT Bold',sans-serif;font-size:13px">+</text>
    </g>
    <g id="r_touch_targets" opacity="0">
      <path id="stick_button_right_touch_target" d="M34.841 141.791a34.686 34.686 0 0 1 6.374-.588c19.07 0 34.552 15.482 34.552 34.552s-15.482 34.552-34.552 34.552c-19.069 0-34.551-15.482-34.551-34.552 0-10.648 4.827-20.178 12.411-26.518 1.298.465 2.697.718 4.155.718 5.345 0 9.9-3.406 11.611-8.164Z" style="fill:#419bf3"/>
      <path id="start_button_touch_target" d="M35.167 134.497c.26.997.399 2.043.399 3.122 0 6.809-5.528 12.336-12.336 12.336-6.808 0-12.336-5.527-12.336-12.336s5.528-12.337 12.336-12.337c2.48 0 4.789.734 6.723 1.995a16.16 16.16 0 0 0 5.214 7.22Z" style="fill:#419bf3"/>
      <path id="button_1_touch_target" d="M39.627 106.677a16.066 16.066 0 0 1 5.496-.963c1.93 0 3.781.34 5.496.963l9.655 9.656c.623 1.715.963 3.566.963 5.496 0 8.894-7.22 16.114-16.114 16.114-8.894 0-16.115-7.22-16.115-16.114 0-1.93.34-3.781.963-5.496l9.656-9.656Z" style="fill:#419bf3"/>
      <path id="button_2_touch_target" d="M60.481 85.823a16.066 16.066 0 0 1 5.496-.963c8.894 0 16.114 7.221 16.114 16.115 0 8.894-7.22 16.114-16.114 16.114-2.186 0-4.271-.436-6.173-1.226l-8.715-8.715a16.056 16.056 0 0 1-1.227-6.173c0-1.93.34-3.781.963-5.496l9.656-9.656Z" style="fill:#419bf3"/>
      <path id="button_3_touch_target" d="M30.442 115.863a16.056 16.056 0 0 1-6.173 1.226c-8.894 0-16.115-7.22-16.115-16.114 0-8.894 7.221-16.115 16.115-16.115 1.93 0 3.781.34 5.495.963l9.656 9.656c.623 1.715.963 3.566.963 5.496 0 2.186-.436 4.271-1.226 6.173l-8.715 8.715Z" style="fill:#419bf3"/>
      <path id="button_4_touch_target" d="M30.235 86.294a16.056 16.056 0 0 1-1.227-6.173c0-8.894 7.221-16.115 16.115-16.115 8.894 0 16.114 7.221 16.114 16.115 0 2.186-.436 4.271-1.226 6.173l-8.715 8.715a16.056 16.056 0 0 1-6.173 1.226c-2.186 0-4.271-.436-6.173-1.226l-8.715-8.715Z" style="fill:#419bf3"/>
      <path id="shoulder_trigger_back_right_touch_target" d="M76.155 41.187H23.519c-1.52 0-2.586-2.458-1.769-4.167.046-.096 14.212-28.399 14.212-28.399.743-1.517 3.546-2.595 6.744-2.595h22.358c7.656 0 13.863 3.027 13.863 6.762v27.046c0 .742-1.252 1.353-2.772 1.353Z" style="fill:#419bf3"/>
      <path id="shoulder_button_front_right_touch_target" d="M25.477 41.187h48.72c2.613 0 4.73 2.007 4.73 4.483v14.346c0 .983-.854 1.793-1.892 1.793H22.639c-1.038 0-1.892-.81-1.892-1.793V45.67c0-2.476 2.117-4.483 4.73-4.483Z" style="fill:#419bf3"/>
    </g>
  </g>
  <defs>
    <image id="4a" width="65" height="66" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAABCCAYAAAAIY7vrAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAHcElEQVR4nO1c23YbNwyEZEduLm7ykJ/LF+bn8lK7kZVa1vahHO3s7IDk6hK3J+U5OEtJ3iUwBEAQ4Dri/xar1xr4y/BtMvbX1efhtXi5KggqaMe4KRDXBOmiIBihVx19bkNH/+KAXAQEEX5lru67rA10zfrHdglAzgKhInwP6fgqcIv4nrPAOAkEIzw+r+nzmq5r+Y7vQYMQhxgFPdBnvc7AOBWIxSAQADrz64RuzHcOCBZ8iIiXGEHgPpPTjsVgLAJBANAZh7A3QrfUx+98X4ggLPRLROzLVckBgmctAqIbBAOACg9hb4neyGcGg0EA8xCchX8u/T31+fdMM7qB6AJBAGD75tmG0KCNXAEIA8Hjs+qz0M8R8ZdcQaolJwHRBCEBgNVdBb8j2tBVgYA2BDENYVh40A8ifMdg7MNrRROIKggNADDzGxL2t4TwO5sHO0g1BQbgR0TsEsLvAEP9RRcQt50AgHT2N0XIu4h4W+gd9UHQDNaGDASYgQLwFBHbGLXqtnzH/uWZREgjzm4QBAC2fwiCmWfh3xdCH78BKAiAZ9VAgOrvivBb8wznYFnwA/pfhm+rTBusORQtUA2AGrPqvyOBPxC9J2qBgJaBAA3YRsT3iPhTCL89FcBgHrp6pGYx0wQTDXLQwyaA2f8QEfeGMhB4haiBAHN4kme0nKsjjkdmLTMHDYZ4CYQWYPZ/NwSNgKawT+hdHQCCA5F9igKQRZNDxD+TrNowASHRAvYF0AKYwH0R+iORgsArBAdNDLRGi/sYV4ddTE1J74+YCp9Fk3YXOgOBhFczUC14G1NN+BgRn8qVzQGziGXUaYGCcCgg3BUQWHi+n4XngCkLoDi0boKgQDhfAAAgsDMHaIFTY14e0RgEAMFLKmuA/r1GmfuYB1DrGE1i4iCPICR7Aw2KEA+oOYDuYzQF1gKdxWwrzRrR2ms4R+oiSWgEm96kqSb0moJbFnl5ZC3g4Eh9gYIA4QbhgUFgJ6oriQut+f6DA2IdvmWaoCAoIVrUuEB3kS7HoFtx3pNgddHYRMfG+M6RTvIYvAhkmuBAACMcITJBeHWENT/gwNckSbaCaEAFcoEZg40o8tgYBN0sZT6BgdCw2M2+A6C1e4XQDMCbmJoBtHKX8OFWFF2WRxAqGaNsv6DEAOjAtbxiCwB8vinfuQnJ+ADPuk+Z8aA+weULNWGyScghvxQA5gNXTeIwP7yN56vzB6k5OsfoNMFljXiwLGu0VHjlA1d1oK1MVpbO4wDt6BwZBBcnuBSaI/b6TvhzgUC/pqGtnGbqj5w54FozjWzJY/U9VxOUL8ePTpJbgpu81MyhNrAjB8AlmptBHq+XtxSMLFhiBmpUVbMrNF1me6jJWwuEX6K1QDipOHrFpsnTi/DmQHAPcnVATWBkDJzbVBDODdR4q/FV3UDxQG4Q3rfzNrWrUHpmY35cMqVWq6zywiAoACy4Cu8If+cGPBWIGk86vuYQdJJS06iZgwNAa4NaBktrgie0TCuVH02kKBiqpcdnI7ukW2lnBln2xtUFwZwGT2i9y6jaf2tCwA/zxxNTTbiuGZFOAFxNEAyoVpziMJ0GMACuROd4USDS8VkTsH11qqcpLNQGOZFRK4+57HILBD6xUivSMh9cqOUibdVBZuaQaQIXRjmRwQlVBWCIMR/Qyi6pxrhSPQu+jWkZjktxrJkMxKxlKXenCaoB25gmMlxNgQUDENneQjUAaXcUYjiNhrokE9cjoQ0100xBaGkCGPke8wSG7ibVrLKUO5tHNjZXp7ko+0h9BoI1oXle4QjC19XnoSQZFAg1B06quNMnTpieVFfLF0HtHws9UJ9BYHNwWjBrNXOATa6JGZfI0KSFizFq6S4ez/kBqDe04MEQl+mz8vxxjGpBlhiKGAsVXCDVBIbu2bOZdGcTHAjZGQVoAUzgISL+KARtYJ/Q7RRnIJBJgDEwBW2oJSxqqpwVZdkc2PzYGaovAAggNgf2B7VAKQeBmjoq1PIcACyEW1K1JKexBMYZzP18UgWrwGNM/QIDAFNwq0JEdJ5UMdoA5laFOXVqzpZ1SatVp/UZz+YZteM6uipokNSMVGsHt9g3RHlohPfoDAKH1xpPuIMaaO6AhsYGrBEcKGmkuOgYX7qhaZTqtT7Jp9j0GJ/WJ3tPr7FP4NBYo8NWhGhXBG6pJkjcEDHOdsTcZ2THbJ5iWhrrPbjFjpH3K3jmjr7v3TWmrbm17TjVqiUxPdp7F9MKkYscNTjTnSsLzH13GKPbDLpBqADhqlPZ4W72BVmAxfsFPt2uh7tZ7fko7ws9oxuAbhAMELpc6vsNXBJzhzSyiDFLn+k5JKf6s5Xgokf9K0DUymKuNFarEDMImkR1L36o8DZ11tMWV42S13+ystiN6bvKleYRXEq/O6t91dd/0JIXwbL6pfZdiUxTagdz1e8Gue/nvQjGrfJWXFaz1N+5KRAt4nt+/iuB2ha+HOr+NmIumBP2osI7Js5uF3hNOGIa3MyEjviXviactRNeGI9IIrz/zAvjS5oD6DX/fcAv3/4G1s+EbdFAgYoAAAAASUVORK5CYII="/>
    <image id="4b" width="46" height="41" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAApCAYAAABKvBuPAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAD00lEQVRYhdWZzXKjQAyEm8R2kv075eX8hHk533Ydm9gJe8g0NI0EYzuXTJVqKBjgk9BImgH4pq255eZtt7vp/pfmubv23otenIDWnMsAJ+drlakCN+BmoV9q3UIPYFmB2ZcFwI0dN8H56LkRpAqC41n4FFygHfYuONZz2XMd9sP6SFL4ENygVe4WhGP02W7RjwpZhJ+AJ9AEuy/9qhzfyzn27j6Edrj3Imc5zhSYwK8cPIFWyFWRtRyrIu42EAiFdTnJdb2Pik8A+2bWVisTeF1kU2QtfQTPlzr0qcib9ZR3EX6tkdUji0cuQuiHRAi/FnD6Ol+s0G9FjgBauUebzokGZvU5V3HoTYF8EnksPeE3GFtdwRW6LdCqbDQnCN8A6LbdrqHVe/BkUqqLPBTQHwB+lp6i8Gp1YJhoZ4M+YHAxdSudvGrxkdXd4lEUuRfwpwL6S4RKPJYxDk7/JvgRwGsZuwrGqXyU65ykfatxFX5OB/8N4I/BE5xAjVjvhE9rH2RcpBxd6oxpeF20uIdB+q+6CsEJT6tvAksSpsWntTkXgKn/U05ivN6Nt90OL81zNxdVCM44zQgyZ3W6C0Mjwd4xuMlarumX4NfQ0Fplca811M89HDKq0PoE5yTNwNU9VJkDhq+q0FEyG8CTKtBDIhXgCxhlGBIpDk5XYcija7SY5oG5DDyCr035DI1RFvVsqlYDhsjACcjxXjZEwGm1mYHPKXJJxcjWJdfnnhsVaxeDZ/Wy19cqnlR8TM0z04VEBp4V/FpzeLFEF2lkPDDOmicTrQ416WQro77dAWGh7laMqjqGsCOGyKDyGpw7yHiKKhTV5uGaVC2efXqv6hSUEYRWPmOcyjWKnDCk+70ppgoQfrISysAjBTRdK/Qe46qO0C3qMucewF8A/0QBlrhV8A4eQetLaTGGL1qU1xmTGdqAuFZ5LdAO3xYDRT4PAN2krA0UUPA3jOMu3aCT61o80X2a4DnqLrT83sC5Cqq2uEJHFteCX6GPyOtxL2u1HqevE5y+rq4yKWlH4C/Nc7ftdg7PF3pSIQx932uNaOkWrYA84lzt4w7eCKAnFPXba9acLcYhVd0kAl9cLGvc5Av1WrSiUehLV/nRSt/jePWGULagWJloRRfV0AoeZV5d7UQZtAev3RDSQbopE312tXJUQ2dJLZNwJ8vbLXuHDpttv2XwX7t3mMCzX9qpjWpoL5ayAi6sDC/arQ3gOTb7ErNF/4ICfq4fe9X+eAKv92R99NwuOI6qvv74pj8S3maUqHlmBDI596X/gLJ261834LY/b9+y/QdJLrfuY2EtwQAAAABJRU5ErkJggg=="/>
    <image id="4c" width="52" height="52" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAYAAADFeBvrAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE3ElEQVRogd2a3XbaMBCEF0ISaJr2Ji+XJ8zL5aZJgAQK7kU0ZjyelQ1JTlt0zh7xI2R9Hmm1WhNxZmXymZ3dN48n9fcwuWs+awwfAkoA9DN9r4PvwXwE8CQgAZkM1FlpBuqTwI4CqoA40zY8WK6dcZujwEYDEYyCTM1r/ox/oyB7qfV1+5uxUINARhU3eNgFveY2XBRkHxE7eu0gR0NVgRJVptGHcMZtuPDAd4ntow+Im1EFS4EMDO42BnsREbOKqVoYEMP8rtiO2uF3g1CzDEiKKoJBXxa7ktpBRQKziYgt1dvSHt/jd1ynxSok6jAMg1yRXZPhs8s4TD9WSGE2EfFGhveAQ9veFHQq9YAEBkCsCkPMiy3o9ZyAAKVAGCwgXiNiXWoY4DbRn4apo8imnMIASEG+kS1KPY+DUgDiKQcgKLEuhhs1i9w7ouzNZ+3A22KmGmAwxa7LwBcRcUP2vdQAA1QGhDsPZZZiLxGxKsZqbaPrCXsqOYVYHZ5urA4gbqVmKNzxDAhTbRUHRVUd3mx5/diIIgNSKHYCmGYA+kEGqGOBoCa8Yg2GbaIwHaAy3TJ1LuOgDoBuC8jPYj8EqDbl4BCwdrQdQNze1HMM981jO+2GphxPt6s4LHxMMwd0E/01xHcdg3uL7r7FMHDtW6rZhQOqp5ICqUpOITgEhoJBIXbdbmPdJjBQBV6Q9yk4BSjJYx10CjV3DTcNKDV4OQzW7UPuO4XBGmPT6KMXOUwjeusnUwhOASrxHsTejTfZ68Tm1Fb70b54TwMQbkRr2HJqCjkgVmoRfYDapopyEe8qsTK82a6ju5c5IA162+LW0FgoNQ53eG0oEB/82AFoXwrCMO7waIH4gm4tcYTtjKcEfpslTbRfvWncpyqjUBbI5Qj0VJod5rLDnb1oHBa0zoIxh0XXZ+vpdDq44pyFmiZHsj7cZ3pkz8wlYHrXGwP0X5UxJ1ZNMbm4SgNG10fWryZGMnPXyGO56EavLs1US2qo8T7hQI7tdzSYU0iB0CkHidvE4JV4n6klSXamT4Q7WfymYJ2iQKySJjQ4JHHGmym7Zr0ob6QM4PIKAEuP4Np/ppDeRb0wTprrqEfW7sDGfXJOgfMKqBkQYKxUT6FpRHuEdYtf1eELr8iWpQakJjvUXD/LpK8MqDPe2nlIFdLodxXdOCs7xA0dHzbU30ux5+jmFlgpBurkFLi4NQTjRYvpwUkNl6bim5BNQz2xAuipAD2X9wqEdJZTKAViKJ5ymzK4dfgwXgd7zBEcWZ7niPhFYDz1VKFhL/cwuWvum0e8xfFWFdKYS4/NrOQxQMsC8WSAXqPuFJqhNBYGyIkKflTCIbwOks8zY4HgCKASphxyc7qGUnUyIDRUlTZxCCC5rbrhMYlGtyaxljjR6BxCdWPNctvuPMTZU5cK1qwp59rGpIJ1K8DaqWVNm7G5bY0YFJ5dO68xbLScp86ePnB0oBurS9bbnJyWv/U4xUUfX/M4RaBq2dQxD7xqoQ8Hpe6hVy0oPfkJngaAteB1Fu93lnMAeoxwm/axjySrJVUo4sweGhsotM8SKPpYP0toZAc8BeiFNx9+rJ+AaZJial7XEifZiVg/G63KSUACxb91aWQH3w5Oamfc5mv+GsPlbP68pOVs/l6WlX/hD4BnV/4AcperLpSp2XYAAAAASUVORK5CYII="/>
    <image id="4d" width="52" height="52" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAYAAADFeBvrAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFUElEQVRogd2a0XbaSBBEC+LY2E68L/k5f2F+zi+7iQO2A+yDp6BUqh4JzO5D5pw+EiCGuaqenp5GwB/WFpfu8HH/dFKf3xff9pf8/Q8DBYBT+hzBfBTwLKAORHXUtg/nfgRwHtxJQAaig15MvNamg1dDOD8ZajaQwKSBL4tzBTsMUga+K84ddDbYJFBQxUEqUzgFUoBkFdwsqC5QAeMD/2S2lKOqxcE4wDaYA86GKoGCiyWQKzm68Rp1O1VmC+B3YT2wLtRVjxbZvRTgc8dUMQfSwb81e5Vz/Zxtxz4e90+LCioqZOq4aynINYCbZtdyVCh+n3dYlXlt9tKM5wRMinWVGgEVMEscVbmWwa+CKRRdkn2qqxFm0yDW7ZyvCaiKTbpf5XLualTGQW4B3DW7bcbPVCUHepNBbwD8Km5CFfL9vQwUopqqQxdTkHsAX9rx3qBuZHBLAeK8IcwaR1VdUQ7ajSqNWlLIg4C6GmEI8gXAVzm/b6AESgop0Brv6lRADqDutgCAx/3TwO0OQBOBwNW5byAPzb42I9CtATEoJKCVwPB3HWZrxx2Ga9uhuUIOlebOHY7KPAD4qxmVIhDnhANtcYxmq3DdAsMFV6OcAlGlQRifcjmq87kB6dxxoAcBSgNVICpEFakOMF503zBcnxTMs5CoUFpEk0KqEk3nEIF0YdXBOrB//mqmUBwfF9tDuwIO88ez6ASkYToFBgJxknMO8i7qwprWKCqii+2m9feCYdTUpWWWQp4VMCNQt6PdYbgeeUDQQXPgHs3oilxsGTBW7VzXKAUatKW9rnI3T3N0YVXTTEFTIE2V1FYn9KVJr2fyC0bpKihUiahD3WCYyymEh2HgXQlPVqnMTWEK4wnvSCEFqnaivQzbVah+WIE0hdlZn1V/qk7aCUegHpRv4vyHFGDkDtY/oaoN4ty+dZyH5nPI4c7dcleFE++711/v5pQK9YD0x/+vNue3utf0gKpyU8p6q3JUKk8hXHNKFSj1NQlUVWY0v6pyrAqy6jcVSXr5WxfOg0J11zy38hyLlhbTuUWS1J/uVuM23JsCpSJgShKZlngtgJ9rblZVfbahT+9Pc7gKaHL74C6hLuDbZq0BpM0c+/GFNeVsGzGvLejNqqD2ve1DUkjv3lpMawEpCdXFEBjmcszZfhVGMC+W+JwaNHe5pBDvjiqj22bfz/D7ugtV1ejCWiB5BvCz2XMzh3KgVDR5B/q++LZvyZ1CqbtRoTWO+dxUVceV88/ZH2H+AfCj2c+ZQJNziM0jkQJpnqUBQBNN3Y1OFUkU6G8BokobHAOE1uYiVC9s6938hOMGyxNFYHznvepT1RQU6EeDolJUaVKhWPUJbscfXwqUJonAsKDBqLVGLpIQ3BXXOaQu94yjy1GdbkAYAElzlX4jJ568lnON6nBz1gNSl6NKhPKg4OpsbYyDVtW2aZrW6zbcy8BeDtYImOaQRrkUugmawvZg/sytbfMiraq4MmmR5OC0PNUr1qdFdS3vazBIOd2oxVTcVPKiif4DoVvytBWvgofOuZdgnvak6Bb/Tun94aUX7+z9lJNRIa8BpBpClcvpH1+alM6CATqbJat1u1Is4mupS498PxVJNP2hUp7JE9i3L0CYN9pKhSyMsx06xVClbYN4Ra4BoPO9yvxfcX6/2ya3vMXzCVpD0GLHVC2gyhf1XD8bheez/wUvoPidFDTSMRUzfIud/vtxT7jcgxcFWJpfwDCDKCszGN75tJ0+SRVtZ1V0Jp758fe8edpfHf/7h5e8TTxa1uvbBzp4/ZFHzC5Wczv1wT9tl34I8I9q/wJ8hc/eTcdQhAAAAABJRU5ErkJggg=="/>
    <image id="4e" width="51" height="52" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAA0CAYAAAAnpACSAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFSElEQVRogd2a3VIbOxCE28TYQIDc5OV4wrwcNyfhP8CeC9S41duzP4FTpyqqmtLaXmv1aUajmbGBv6htPnOwq+F61Xg/Nt+Hz3z+h2CKya8Zs4P5KNxqmACwKfpq/GGmB/BnYKtgBER7v/b3tOnEh5nXANZBLYKZgKAcFdf+jMHktbjuoJYCzcIYSAI4KsS1xMm9Sl+JQ2MJ1CRMAaIT/hKE7/Nefl818ArgRXqVCmwWqIQJIAliW8gX9BqCTEon/hxEoV5kAThGCbRdCeIAx012cn0s9zmMauJ3kCcDg4NIP2ojzRQgrglOft9kJ/0OvYY4jpqXTv6xyZP0/JxQbnZROx3MhEZUE5z4HsAJgNPWnwQgmhtwMLFnA3kQuTc41dQsUDIz3+zUiGriVOSsiUJRcwnGQe6b8H7VJuS77Df23iQMgVwr1AgBvgI4b/1XA9q3yXHfAAcTew4gt+g1SRh30Z27vhquN6qdd5hmYnNaOZXJXzQY9gqUYAYcTIYwdw2E9yoMFyAdqNEZVGbm3su1cgHgssmFARFmZ5PTzf+IN42oFtW81PNpP4oYVDtb0QrQa8a1ws1+3uQSwLcmBFJT42qrN1MY3kdn4Rrxw9QPVM53bGaYNrEd+r3CyRPmMmhGHYDDPOHNzBQEsuL0eCp6oKoG31sys8rETtBvfALR3AiTTIcTpQN4Qu3t+LnLb/SRxasDLdWMmpkDnYucoTcd3wdcWXUO+pkfpDx/+Nq9HQBsroZr/Nh8H1wzafPrQelA7Hl9hrEncxN6KTSiIHQOqmU9h9x9v2kmuGQ/YxyGQCr64D0OZ1OKzdz0uEe4jzSqoFesQLqWNFPFYx7KEE7js2O5N53k6okUZB9Eg1eP9SLQ2nBmSqoUII09tPtebAzGdT6ujpcy2cM5EyCmkrCUu6gJaAaa8qWp3Cj1R6jNqxvfV64CS4C+UmnVgPEqrkm9Uwoe98sUzP/VNtavalXUDExHrFVFpcvXZZylY84VNapnABhrZu4BPKFTzOSxkz90auwUh6V4LI353rbhg1QG0gzR4ya+3rX7qlKTAmgxI9UCPG1WsDINcDPzVfM0lxGv5+16sKn7raozzzbuUxhXYzICVRoCABy1XCCpX0E00tWY6R7j+EknkTToabPXAXQ8h5kESppx02KooanuHfpwI4XxanL6PqF0LGact+2a6bQukGonOoKpPaPhuINoyOEg/F5KATwOuwNwI3IrokDUqGtG513uGX6Bq6gwt+jjsKqUNFedUZifAH41IdQdenNTU+s006XNBYhv/gfkeClNtCpoaNr8gIMWfgL4R6DU3HzvaLDatS3JWirgDkAfrvGY7wVf8SUFDYX51UAIc4NeM+7RZvcMm5uZBoR+hvg+eETtGBIMN/4NDmammnnAQSvRk8W6mYCwZ+FAgVKy5ftqrgioGuQepKgToNt391yGNKnWnBK0lDpr+sxrVmY829QF8vRY3TOFIHTN0cyW1Jp5g24yr/u6+3atLCmcc6KcuB7A1Mii8yVNEsCoIKjm5emzp9ApfU6OQrXjYYxqQn8BGMGknzRGmik8G9qgujI+sUeMXXc6ND1MUrCq6DerFWAiCSoK6SmF1vzffzXz1Fm9ZIrE9f3kvUYeTNtUcgb03o19ynGqH2qr6kzKYRxgFQgwk57avzGW1ALSWeQpQJUvOcAo/vrQT+cBSienE/aKTFWoc6DUu2AJyGIYA3KoqpJTjZ0m7GbM68//u4m2ALWk11btQ33vv/8jkLaJfzctGXsorj/0N60/hvG29o9z2j77T3R/RfsXSO/jtpPsGBMAAAAASUVORK5CYII="/>
    <image id="4f" width="48" height="47" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAvCAYAAAClgknJAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE80lEQVRogd1a21bbMBCchJAGSri0/BxfyM/RQkm4E9wHdvBovLKdwEurc/bY2Eaa2V2tdqUA/3ibfEUnF83VTv1cTs6bz469MwEDPalcvTWV685ktiYgwCcjRFuTyJu925rIaAIV4FO57tnfSkIB87qxv5XYaCKjCBj4qcieyEzu+V4JvAnwDYBXud/Ie5IZRWKQQIBXjRP4LGQ/ZC7PZhUCryEvJnyuRBoAzRCJXgIJeAIn4G8mcyFCSwCt5l8BPIc8AXiMK5+RjLpXL4kqAQOvbkKwCwAHIYdxXcS7fbRWIAFqnsAfANzH9UHIPKG1yCCJlID4PF2GWifwQwDfARzZlSRoBSfwHEDvQ9YhdyH3QoTWoEulc2KWEegBfxBAlwCORZZBgpaYx/8ogZcgQM2vAdwmhFWpul6Ms4C4joM/DJBLAKchZwBOQpZBjm6UWYDucwdgBeAPgBuTW7TW4Pz4mBNuhZoFdNLuo3Ubgv8B4GdcSUIJDLnQHVqXc7LUdiciIbFCQSCZuLMAs4gBjwPweQhJnKB1IUajLAox+ih4utpEgNfWiclFc1XMhcwCrn26zzKAngVoEqAFCErDqK4DGkZppf34Tr/J1ogirCrYDwKVmK/uc2QEKKdBLtO+L2S0AsMsSfIdw6wK14cpEivULODuQwscBwlO4pN4ptrnmpHlQhuUKzXfcY3QEEuZBwlaomhOQNMFEqALefj00Kn+7OGQQGlZdy2d3Gu8RyiuKfdCmFaozoEshHLFJQmKrr7qzxl47TvLjzixuSDqJHeXLPpWAppx0g005zkwUeCa+2S1gLZpgNecStMS9q3h2INC0Zk2zeU1ccuSNmah2vkQeA8SrqRaYlirMzoE9HktbXbg2umY+qKWJPoYWX2RAh0qE7MCRifqNuBrRLw48nE6SiLmmgV0AL/3wT/bvI9ss6DanIBnf16A630RzlDJFgfa0DgunXGmQCfPdpCal2h+0qlhR5JwJWV1so/TSeaIOXMh7Vhr2GeUpV+WpwyR0G9UOcyRXpD3v3ECbErAzVirYSlZDav7PDXwrnHNf7R/zYOqlvCVWF1HNc8qisI6doF2BZ5If9nkc+Wwb62PWchojUwCbumUAAdS7XMAzVO0cNG8H8gXNdWcal2Br1HWyKzItDYerInd/zVDVPBMnVX7/L8soVPLUvPa5y3ey8vbkDVaKzAT7a8HLifnzUVzpYNpBcXB/qDcOvF8ni7Vt7FFpdwF2BsA1yhrYlrhEeU862yx1Fwos8BcRCsp/VbT6ixtVtehQq4B/Aq5jmcrlC5UjUJ9BHxA5irMURz8I9q5we+UgGufuxIZAbqQEhieA4kbcdAHdHeg1c0e0e5KaF2c7UowICiBawC/47pC6z4d/x+7reJW0KSO7zOX2JYAJ+8N2km8Qqv9bKEsWt/Wohf3Wh+zvFRheTm0L6Shc2Xi24sFgW23FmmF2vNso8orqdrGli9cCtwjT1X7wPDuNL/JttYXJlrD9u1OkwRFV93aFnv1sGPM+YCTcCIuXmYC5equiaGC1oOO0Sc1Y09olERWCnqI7dvYUiKvIln6PHjMtMsZWXbctJfcZ7mQkvD7nQ76tioJR5xU+s5Blsz5yeTOJ5RbE6gQcUL+jq1Wrn682+Ww+1NFeeW0vq/ftIb+zE8OvmJX4aON/c3EV/xG4r9pfwEs4yD3oK/mAAAAAABJRU5ErkJggg=="/>
    <image id="4g" width="76" height="55" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAAA3CAYAAACmcqwpAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAGiUlEQVR4nO2b3XbaSBCES9ixN7G9e5OXyxPm5XK3scHGMnuByiqVumckgQHnbJ8zRwKEfj6qe3p6hgZHth+7X4289P3G3tfPo9cl2xVe7ypbAMDP5rufo2pzbrBqAku3UfPPltxPBsj3S68BzAN3FGCBqrStgv1VcNzc+4nUE7W3wmcKcBK4g4ElqlIwKwBXsu9tCbQM1luw9VaCCKAM7nrCzU0xPqSCuqo0HuOK83OquRtGatLWyra19xzg+3l/7H41GbSDFGbqUtUQynXXvtg+P6tBy6wES8G8BlvuO8CR2iJoixUWwFJlEcwXADeyvZH3CVDdtaSyTF2qklYa4Wxlu5XXbA2Gqouu926HuqTGH6pKQd0mjeAITdXJ8+o26xE9VikoQnqR7XO35XurbqvGcyJyzUUuKeqiKhQWlfRX175K43sO7QrlDiACFgV2AlM1PUvb2Fbhqbuqiw5c8xCFKbQVhjGKoL517U72Ce4Wscqy3jJySXdHPjAV9YIezlqa/kh+Tv1B/LrzgSWBXhV2iz2QbwDurREclXYjN68qA5YDU1ekmjYAntCr2q+l52RrEMSxpQrzxFTd8Ra9uu4BPAD4u9sSGlWmD7AEmMcvdUl1wycMw4BeJ0pHVhBoGstmATN1Rb0i1fW1A3MP4B/sgSk0qowKm+KSfDhuHZoDozuuMQwBTGN4njZo2mMOlLZEYZG6CIzBXtX1gD00glO3dBc5BJgHfbrkGmNYmRtvu2NaecZlMaygLnVHDfZ36N1RGxXmLnIl565ZNCRiIwAC086FAFo5hsfxGKYbKozFCvOAn7kjgTHYP0ijwgjM49cSYO6aVIt2Ko19TpfddPeysWNXkESWcWwSMKtGRD0jgz3d8U6a95IM+uom7o5A2SX1tbe2O+8r+thIWKo8j21RTjiyOQqrxa5IYWyag2kPWUpaS1bK/N+683LYw89aDDuCaNQRDdMG91MFFtS6VGERLE1YtXmWr+44B5ZbFM90mEVYW8TDsxIsfe5ZaYUqa4q6tPmQKJP/lMprqcCnGTrP9ybXiwoAURGgWJtb4pI+DNJkVVukKt6kFxSnwPLPHB5VoMMdLzN50w4nKmqO7qcIrHPHSF2RO7rC+FpdIBoGzam0qtXAaqytVX2ze1mssFIJx2OXqoywSvWv2sPPMc8VFZz+6BGoST/gKnoTKKqLD671rgiaDrCzLvtYoCKL4mKpZd8bWAosOIHGg6xn9LqXBtnJgfXIVgOVgQstBJYMgzyViIqEWaBfmm9dnJUU5rC8Tu+B3iurHuirPdBnsBGwyiDb3dFL0A7rj1IXkCtsbqIauWMtQf2U0AbAJhQIS+qKhj61Icens0hhcwbZJXf842ABkrhWBtlTgHmSGtXpgcIEw5GstvAkXE8x1TzTj9QVAdOEVV/rWNFr56wkfCQsXsvXTpRgzQIYDY1qAd+hZfUkvRmdUPBrHduiyV2f3MhW8QAVcCVgUQzztRJRT+g33WKoro82vbavo4gWo7gS9TwjuwbC3tFdMiqTRDHKZ2PQ7Z9q/Kj3QGC6HMABOrhIbQNThWUDVS/r+MIRYDzFxQmEVzv21ApjDZ+THZzcdYAltRWn2bIBaZSl88Z0WovnY109KhCewhTYFv3s9xN6eL4QZbQIJbKsHpaN4N3ldLqK0+uv2P+KOmNzSmDa0eiygTWAx65xUYqqLYI2a21FNufnN8EJUk40cH7vXAmrA+MPuMEe1r8AfqNX2zMqy51kmwLzqatIUTr13qIH6DV74HzAdIab02u/u/aIMTTvAIBKDMsu7LCoIKD/BT0fO2dlgg/MXpDxao09pEeMVfaCcQcwySWjX0hnjHVBB2+GytJ041xVidLSAV0rRnCMZcU4li13ihZ38IIEweN0JnnKZOiprBZOdJGdB38CS3tKBcZBcXQxTQ34/gvyucYI1qng6cNmy6AITtuk9CJTmALz3EsDqWf9mrPRzuGS3PoQTZeh6+pqTWJHWf9oUfDP5vtOhkc6WG7lRtxFFdSlwKK5W/KHZgem8LI/PFRdEnaQgvPhhs8mR4nuOYuFWelGqxdRJaMNvjOwwUMlJWodT/qM8SXCopWgedshcEVg/PeZWh6mBT8uIypNgF4CKLcMXFQPK8ICggdM/lEbgfGe8BJh0TxrLxUNU1hA8pAGTY/LAF0yLGAci6Jhz/t+6f+S1QcN4E363oVbCOTD/pGbQPw0tuTP8f/bQvsPPoCzn/bfs3UAAAAASUVORK5CYII="/>
    <image id="4h" width="87" height="41" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFcAAAApCAYAAABA4LXdAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEk0lEQVRoge2bzVLbQBCE24kxhJ+ceDmekJfjCBhwsHKw2ttqzeyakFStUkzV1Aphy9qP9uzMrAC+7J/Z6rMXuBsePn2Nnu1+dTv86Xs/BCYBeeq53i2CODv3EdgnQTCoKxuzcydfvwNzYENjPAlydfIVqOp+rnbdXmDXVKqjO+y4CjmdrICNAH5Ljk+F3JNlUPfJ8Qx4BjicvIF1qDVfImBVIiHq+D6O++D3VcDryodmUL8nnkEG+gTsilVwhJo5X3+81t3wsHLAM7hBnHWo69HP5HiNOWQHDPQDebDjCOqvxFdIAPuHZMp11RLq2egbG+mq5ChE9GSq3AjsbvQ3GVU0NCoert4JXIu1qliC3QA4F7+Qcw44U29Ppqp1sG8AXsU5J3/vgDK/elhArlpC/CF+MY6EraHCw0NvpnAIV8G+iHM+sPfMMgdVbw2uxlmqljCvAFzK6IAj9fZmCkVVq2C3AJ5Qwpy+j6Hkm5yDjAVusJApYIVLqDcArjEHvEFZ4HqGCxT1uWq3o29Q5hGFD03TVmiEhdpCxhh7iQPUGwA/x+NrlDDBRS6C2wtkX8wUripWw4G/bocCOBRQLVtgzGQM9bBwjQNcAqZ6CZc3thTlaqy9QBEIMA0Z6pp6EnKcLYym6vWYywWN6iXgGxyAMzRo3O0VbrSYveIAd4OiWAf/giKe8Nt5NzzgfnU7tMJCFhoI+ApFxQwNmjUsRbksEHjvjLHvKFC3mK4phOv5/FS5QZ+2BpgKvsAUNMelwNVsgXDXKIAYBhRqlGqmc/xIhaalr4Kmn9vPS8oWtEBgGPDqU8FmRdJkngq31WJsNW68iaM30Kvp13iP+Ty8Z6Jzagqn1hXTG+AY/YWyi0+ayp1a1Ah3q805YnO0U+BGN6L9Te8iaV6oyu1NwV6haedL24tpDxcN8bTgttpx2uDQxeAdywgLXv5qs4bdMLrCznYmJhbB9TcoWE2ktf5mSrJHWXV7znFpOkev0OgvKHOmqBxwaArXW2cOVVXKG2BWgPF1ryh5oKYpvZrDZSHB8vcJwPP4s6pZ+wqpejPlcnTFEuwzpnU3b0qrs6XB9SrtGQe4jyiAqWIHvPcLA3O4mpaocrX80wIBKLGKSs6aNj2ahz4V0RYHqI8ogB1uFH+PtgYOO5dSpbUayNqCI/gXzCuzpcAFpnA1/D2jKPgJ0/AQhYaJtRY0hcutDsLay/lom6fHVqObw/X5qoI1NFC5rl4AGLKdCC5qvqDtUJSoC4B2kWo7EEuAG+1I6DpDz5Sr1wNQVy7BKiRVNP+63iWKFrLe4UYblZrjEihhZzF3Yke4jbjrKZp+dTKwvQKNzEOhhwjdfdCQEKVjR6ulYp5e+Kq6w7xZ0/uzCjVrlfY6eml8hJo+tyDq9VxXj9kzYB9B1cr0rPdY6xaFB193oufGUtUC7d4CdzX9gxWutt8QjEuwwY6j8t+hzyozf1YsBJBss9ccwbhUcxXX/Pj66CnHFETjafKsj7l0sMBcxRw93QrjrFoTRrK/1nr/EiFn3a0INoD2o/sfgvC//+fOKfaZ/+75sr9ovwE6VuMXJQtz3QAAAABJRU5ErkJggg=="/>
  </defs>
</svg>
`,OnscreenGamepads_svelte_svelte_type_style_lang="";function create_fragment$q(t){let e,n,a,s,c,u,d,m,_,b,S,k;return{c(){e=element("div"),n=element("div"),a=space(),s=element("div"),c=space(),u=element("div"),d=new HtmlTagHydration(!1),m=space(),_=element("div"),b=new HtmlTagHydration(!1),this.h()},l(w){e=claim_element(w,"DIV",{id:!0,class:!0});var O=children(e);n=claim_element(O,"DIV",{id:!0,class:!0}),children(n).forEach(detach),a=claim_space(O),s=claim_element(O,"DIV",{id:!0,class:!0}),children(s).forEach(detach),c=claim_space(O),u=claim_element(O,"DIV",{class:!0});var P=children(u);d=claim_html_tag(P,!1),P.forEach(detach),m=claim_space(O),_=claim_element(O,"DIV",{class:!0});var N=children(_);b=claim_html_tag(N,!1),N.forEach(detach),O.forEach(detach),this.h()},h(){attr(n,"id","gamepad-joystick-touch-area-left"),attr(n,"class","gamepad-joystick-touch-area svelte-vynov5"),attr(s,"id","gamepad-joystick-touch-area-right"),attr(s,"class","gamepad-joystick-touch-area svelte-vynov5"),d.a=null,attr(u,"class","gpad-display gpad-display-left"),toggle_class(u,"hidden",!t[0]),b.a=null,attr(_,"class","gpad-display gpad-display-right"),toggle_class(_,"hidden",!t[0]),attr(e,"id","gamepad-container"),attr(e,"class","inset-0 opacity-30 absolute pointer-events-none"),toggle_class(e,"hidden",collapsedMode)},m(w,O){insert_hydration(w,e,O),append_hydration(e,n),append_hydration(e,a),append_hydration(e,s),append_hydration(e,c),append_hydration(e,u),d.m(GamepadLeftSvg,u),append_hydration(e,m),append_hydration(e,_),b.m(GamepadRightSvg,_),t[2](e),k=!0},p(w,[O]){(!k||O&1)&&toggle_class(u,"hidden",!w[0]),(!k||O&1)&&toggle_class(_,"hidden",!w[0])},i(w){k||(w&&add_render_callback(()=>{k&&(S||(S=create_bidirectional_transition(e,fade,{duration:100},!0)),S.run(1))}),k=!0)},o(w){w&&(S||(S=create_bidirectional_transition(e,fade,{duration:100},!1)),S.run(0)),k=!1},d(w){w&&detach(e),t[2](null),w&&S&&S.end()}}}let collapsedMode=!1;function instance$q(t,e,n){let a,{visible:s=!1}=e;onMount(()=>{gpadCtrl.setupOnscreenGamepad(a)});function c(u){binding_callbacks[u?"unshift":"push"](()=>{a=u,n(1,a)})}return t.$$set=u=>{"visible"in u&&n(0,s=u.visible)},[s,a,c]}class OnscreenGamepads extends SvelteComponent{constructor(e){super(),init(this,e,instance$q,create_fragment$q,safe_not_equal,{visible:0})}}const videoPlaceholderUrl=""+new URL("../assets/video-placeholder.81b2ca09.jpg",import.meta.url).href,VideoPlayer_svelte_svelte_type_style_lang="";function create_fragment$p(t){let e,n="";return{c(){e=element("div"),e.innerHTML=n,this.h()},l(a){e=claim_element(a,"DIV",{id:!0,class:!0,"data-svelte-h":!0}),get_svelte_dataset(e)!=="svelte-6r09sx"&&(e.innerHTML=n),this.h()},h(){attr(e,"id","livestream_container"),attr(e,"class","pointer-events-none svelte-1suf0q2"),toggle_class(e,"full",t[1])},m(a,s){insert_hydration(a,e,s),t[2](e)},p(a,[s]){s&2&&toggle_class(e,"full",a[1])},i:noop$4,o:noop$4,d(a){a&&detach(e),t[2](null)}}}function instance$p(t,e,n){let a;component_subscribe(t,fullscreenOpen,b=>n(1,a=b));let s=null,c=null,u=null;const d=b=>{!b||b==s||u&&(s=b,c=document.createElement("video"),c.id="video_livestream",c.poster=videoPlaceholderUrl,c.muted=!0,c.autoplay=!0,c.controls=!1,c.srcObject=b,c.setAttribute("tabindex","-1"),n(0,u.innerHTML="",u),u.appendChild(c),c.onclick=()=>{c&&c.play()},setTimeout(()=>{c&&c.play().catch(S=>{showToastMessage("Video cannot start: Click video to play or try reloading page",5e3,!1,ToastSeverity.warning,()=>{c&&c.play()})})},150))},m=changesSubscribe(frontendConnMngr.mainVideoStream,b=>{d(b||null)});onDestroy(()=>{c&&(c.pause(),c.srcObject=null),m()});function _(b){binding_callbacks[b?"unshift":"push"](()=>{u=b,n(0,u)})}return[u,a,_]}class VideoPlayer extends SvelteComponent{constructor(e){super(),init(this,e,instance$p,create_fragment$p,safe_not_equal,{})}}const bgvariants=["bg-green-900","bg-yellow-900","bg-red-900","bg-blue-900","bg-purple-900","bg-indigo-900","bg-gray-900","bg-orange-900"],bordervariants=["border-green-700","border-yellow-700","border-red-700","border-blue-700","border-purple-700","border-indigo-700","border-gray-700","border-orange-700"];let instanceCounter=0;const getColors=()=>{const t=bgvariants[instanceCounter],e=bordervariants[instanceCounter];return instanceCounter=(instanceCounter+1)%bgvariants.length,{bg:t,border:e}};function get_each_context$3(t,e,n){const a=t.slice();return a[10]=e[n],a}function create_default_slot$2(t){let e,n=t[5](t[0])+"",a,s,c,u;return{c(){e=svg_element("tspan"),a=text(n),s=space(),c=svg_element("tspan"),u=text(t[1]),this.h()},l(d){e=claim_svg_element(d,"tspan",{x:!0,dy:!0});var m=children(e);a=claim_text(m,n),m.forEach(detach),s=claim_space(d),c=claim_svg_element(d,"tspan",{x:!0,dy:!0,"font-weight":!0});var _=children(c);u=claim_text(_,t[1]),_.forEach(detach),this.h()},h(){attr(e,"x","50%"),attr(e,"dy","-0.5em"),attr(c,"x","50%"),attr(c,"dy","1em"),attr(c,"font-weight","normal")},m(d,m){insert_hydration(d,e,m),append_hydration(e,a),insert_hydration(d,s,m),insert_hydration(d,c,m),append_hydration(c,u)},p(d,m){m&1&&n!==(n=d[5](d[0])+"")&&set_data(a,n),m&2&&set_data(u,d[1])},d(d){d&&(detach(e),detach(s),detach(c))}}}function create_each_block$3(t){let e,n,a=t[10]+"",s;return{c(){e=svg_element("svg"),n=svg_element("text"),s=text(a),this.h()},l(c){e=claim_svg_element(c,"svg",{class:!0,viewBox:!0});var u=children(e);n=claim_svg_element(u,"text",{x:!0,y:!0,"text-anchor":!0,"font-weight":!0,"dominant-baseline":!0,"font-size":!0,class:!0});var d=children(n);s=claim_text(d,a),d.forEach(detach),u.forEach(detach),this.h()},h(){attr(n,"x","50%"),attr(n,"y","50%"),attr(n,"text-anchor","middle"),attr(n,"font-weight","bold"),attr(n,"dominant-baseline","middle"),attr(n,"font-size","32"),attr(n,"class","fill-token"),attr(e,"class","w-full max-h-10 mt-2"),attr(e,"viewBox","0 0 175 30")},m(c,u){insert_hydration(c,e,u),append_hydration(e,n),append_hydration(n,s)},p(c,u){u&8&&a!==(a=c[10]+"")&&set_data(s,a)},d(c){c&&detach(e)}}}function create_fragment$o(t){let e,n,a,s;n=new ProgressRadial({props:{value:t[2],strokeLinecap:"round",font:126,width:"w-full",class:"mb-4",$$slots:{default:[create_default_slot$2]},$$scope:{ctx:t}}});let c=ensure_array_like(t[3]),u=[];for(let d=0;d<c.length;d+=1)u[d]=create_each_block$3(get_each_context$3(t,c,d));return{c(){e=element("div"),create_component(n.$$.fragment),a=space();for(let d=0;d<u.length;d+=1)u[d].c();this.h()},l(d){e=claim_element(d,"DIV",{class:!0});var m=children(e);claim_component(n.$$.fragment,m),a=claim_space(m);for(let _=0;_<u.length;_+=1)u[_].l(m);m.forEach(detach),this.h()},h(){attr(e,"class","border-2 shadow-md rounded-md p-4 "+t[4].bg+" "+t[4].border)},m(d,m){insert_hydration(d,e,m),mount_component(n,e,null),append_hydration(e,a);for(let _=0;_<u.length;_+=1)u[_]&&u[_].m(e,null);s=!0},p(d,[m]){const _={};if(m&4&&(_.value=d[2]),m&8195&&(_.$$scope={dirty:m,ctx:d}),n.$set(_),m&8){c=ensure_array_like(d[3]);let b;for(b=0;b<c.length;b+=1){const S=get_each_context$3(d,c,b);u[b]?u[b].p(S,m):(u[b]=create_each_block$3(S),u[b].c(),u[b].m(e,null))}for(;b<u.length;b+=1)u[b].d(1);u.length=c.length}},i(d){s||(transition_in(n.$$.fragment,d),s=!0)},o(d){transition_out(n.$$.fragment,d),s=!1},d(d){d&&detach(e),destroy_component(n),destroy_each(u,d)}}}function instance$o(t,e,n){let a,s,c,{value:u=2.02302}=e,{min:d=0}=e,{max:m=100}=e,{unit:_="%"}=e,{name:b=""}=e;const S=getColors(),k=w=>Number.isNaN(w)||w==1/0?"∞":w==-1/0?"-∞":w<9999?String(w).substring(0,4):w.toExponential(0);return t.$$set=w=>{"value"in w&&n(0,u=w.value),"min"in w&&n(6,d=w.min),"max"in w&&n(7,m=w.max),"unit"in w&&n(1,_=w.unit),"name"in w&&n(8,b=w.name)},t.$$.update=()=>{t.$$.dirty&256&&n(3,a=b.split(" ")),t.$$.dirty&1&&n(9,s=!u&&u!==0||Number.isNaN(u)?0:u),t.$$.dirty&704&&n(2,c=Math.max(Math.round((s-d)/(m-d)*100),0))},[u,_,c,a,S,k,d,m,b,s]}class CircleStatIndicator extends SvelteComponent{constructor(e){super(),init(this,e,instance$o,create_fragment$o,safe_not_equal,{value:0,min:6,max:7,unit:1,name:8})}}function create_fragment$n(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$g='<path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>',svgoutlined$g='<path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/>',svground$g='<path d="M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59 7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12 5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"/>',svgsharp$g='<path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/>',svgtwotone$g='<path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/>';function instance$n(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$g;break;case"outlined":b=svgoutlined$g;break;case"round":b=svground$g;break;case"sharp":b=svgsharp$g;break;case"two-tone":b=svgtwotone$g;break;default:b=svgoutlined$g}let{ariaLabel:S="close"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Close extends SvelteComponent{constructor(e){super(),init(this,e,instance$n,create_fragment$n,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$m(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$f='<path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>',svgoutlined$f='<path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"/>',svground$f='<path d="M14.71 6.71a.996.996 0 0 0-1.41 0L8.71 11.3a.996.996 0 0 0 0 1.41l4.59 4.59a.996.996 0 1 0 1.41-1.41L10.83 12l3.88-3.88c.39-.39.38-1.03 0-1.41z"/>',svgsharp$f='<path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"/>',svgtwotone$f='<path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"/>';function instance$m(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$f;break;case"outlined":b=svgoutlined$f;break;case"round":b=svground$f;break;case"sharp":b=svgsharp$f;break;case"two-tone":b=svgtwotone$f;break;default:b=svgoutlined$f}let{ariaLabel:S="chevron left"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Chevron_left extends SvelteComponent{constructor(e){super(),init(this,e,instance$m,create_fragment$m,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$l(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$e='<path d="M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>',svgoutlined$e='<path d="M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6-6-6z"/>',svground$e='<path d="M9.29 6.71a.996.996 0 0 0 0 1.41L13.17 12l-3.88 3.88a.996.996 0 1 0 1.41 1.41l4.59-4.59a.996.996 0 0 0 0-1.41L10.7 6.7c-.38-.38-1.02-.38-1.41.01z"/>',svgsharp$e='<path d="M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6-6-6z"/>',svgtwotone$e='<path d="M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6-6-6z"/>';function instance$l(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$e;break;case"outlined":b=svgoutlined$e;break;case"round":b=svground$e;break;case"sharp":b=svgsharp$e;break;case"two-tone":b=svgtwotone$e;break;default:b=svgoutlined$e}let{ariaLabel:S="chevron right"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Chevron_right extends SvelteComponent{constructor(e){super(),init(this,e,instance$l,create_fragment$l,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$k(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$d='<path d="m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"/>',svgoutlined$d='<path d="m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14l-6-6z"/>',svground$d='<path d="M11.29 8.71 6.7 13.3a.996.996 0 1 0 1.41 1.41L12 10.83l3.88 3.88a.996.996 0 1 0 1.41-1.41L12.7 8.71a.996.996 0 0 0-1.41 0z"/>',svgsharp$d='<path d="m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14l-6-6z"/>',svgtwotone$d='<path d="m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14l-6-6z"/>';function instance$k(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$d;break;case"outlined":b=svgoutlined$d;break;case"round":b=svground$d;break;case"sharp":b=svgsharp$d;break;case"two-tone":b=svgtwotone$d;break;default:b=svgoutlined$d}let{ariaLabel:S="expand less"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Expand_less extends SvelteComponent{constructor(e){super(),init(this,e,instance$k,create_fragment$k,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$j(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$c='<path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"/>',svgoutlined$c='<path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"/>',svground$c='<path d="M15.88 9.29 12 13.17 8.12 9.29a.996.996 0 1 0-1.41 1.41l4.59 4.59c.39.39 1.02.39 1.41 0l4.59-4.59a.996.996 0 0 0 0-1.41c-.39-.38-1.03-.39-1.42 0z"/>',svgsharp$c='<path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"/>',svgtwotone$c='<path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"/>';function instance$j(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$c;break;case"outlined":b=svgoutlined$c;break;case"round":b=svground$c;break;case"sharp":b=svgsharp$c;break;case"two-tone":b=svgtwotone$c;break;default:b=svgoutlined$c}let{ariaLabel:S="expand more"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Expand_more extends SvelteComponent{constructor(e){super(),init(this,e,instance$j,create_fragment$j,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}const fragmentShader=`precision mediump float;

uniform vec2 resolution;
uniform float yaw;
uniform float roll;
uniform float pitch;

const float pi = 3.1415927;
const float deg = pi / 180.0;

// Uncomment to see the lat-long grid for context
#define SHOW_LARGE_GRID
#define SHOW_SPHERE
#define SHOW_SPHERE_GRID

mat3 rotationAll(float yaw, float pitch, float roll) {
        /// yaw
    return mat3(

    cos(yaw), 0, -sin(yaw),
       0,     1,    0,
    sin(yaw), 0, cos(yaw))
/// pitch
     * mat3(
    1,     0,          0,
    0, cos(pitch), sin(pitch),
    0, -sin(pitch), cos(pitch))

 /// roll
     * mat3(
    cos(roll), sin(roll),  0,
    -sin(roll), cos(roll), 0,
    0,            0,       1);
}

void main() {
    vec2 uv = gl_FragCoord.xy / resolution;
    float scale = 1.0 / resolution.x; // min(resolution.x, resolution.y);
    vec4 color = vec4(0.0, 0.0, 0.0, 0.0);

	const float verticalFieldOfView = 50.0 * deg;
	const float insetSphereRadius = 0.5;


    // Inset sphere
    vec2 spherePoint = (uv - insetSphereRadius) / insetSphereRadius; //(uv - insetSphereRadius) / insetSphereRadius;
    if (length(spherePoint) <= 1.0) {
        vec3 c = vec3(0);
        vec2 s = clamp(spherePoint, vec2(-1.0), vec2(1.0));

        // Show convex sphere grid lines
        // vec3 dir = rotationAll(yaw, pitch,roll) * vec3(s.xy, sqrt(max(0.0, 1.0 - dot(s.xy, s.xy))));
        //             float latLongLine = (1.0 - pow(smoothstep(0.0, 0.09, min(abs(fract(atan(dir.y, length(dir.xz)) / (15.0 * deg)) - 0.5), abs(fract(atan(dir.x, dir.z) / (15.0 * deg)) - 0.5)) * 2.0), 10.0));
        //             c += latLongLine * vec3(-dir.y, dir.y, 1);

        // show concave sphere grid lines:
        vec3 dir = rotationAll(yaw, pitch,roll) * normalize(vec3(s.xy, 1.0));
        // vec3 dir = rotationAll(yaw, pitch,roll) * vec3(s.xy, sqrt(max(0.0, 1.0 - dot(s.xy, s.xy))));
        // float latLongLine = (1.0 - pow(smoothstep(0.0, 0.09, min(abs(fract(atan(dir.y, length(dir.xz)) / (15.0 * deg)) - 0.5), abs(fract(atan(dir.x, dir.z) / (15.0 * deg)) - 0.5)) * 2.0), 10.0));
        // float latLongLine = (1.0 - pow(smoothstep(0.0, 0.04, min(abs(fract(atan(dir.y, length(dir.xz)) / (15.0 * deg)) - 0.5), abs(fract(atan(dir.x, dir.z) / (15.0 * deg)) - 0.5)) * 2.0), 10.0));


        float latLine = (1.0 - pow(smoothstep(0.0, 0.4,abs(fract(atan(dir.y, length(dir.xz)) / (15.0 * deg)) - 0.5) * 2.0), 1.0));

        float longLine = (1.0 - pow(smoothstep(0.0, 0.4, abs(fract(atan(dir.x, dir.z) / (15.0 * deg)) - 0.5) * 2.0), 10.0));


        c += (max(latLine,longLine) * 0.8) * vec3(dir.y / 2.0,  dir.y / 2.0 + 0.5, dir.y / 2.0 + 1.0) *(dir.y / 2.0 + 0.7);
                // c += latLine * vec3(1.0 - abs(dir.y),  dir.y - 0.5, -dir.y + 0.5) *(dir.y / 2.0 + 0.5);
                // c += longLine *  vec3(dir.y / 2.0 + 0.5,  dir.y / 2.0 + 0.5, dir.y / 2.0 + 0.5) / 2.0;

        // Fade the inset sphere to antialias its border transition
        float fade = clamp((1.0 - length(spherePoint)) * 2.0, 0.0, 1.0);
        color.rgb = mix(vec3(0), c, fade);
        float fade2 = clamp((1.0 - length(spherePoint)) * 5.0, 0.0, 0.4);
        color.a = fade2;
    }

  gl_FragColor = color;
}
`;/* @license twgl.js 5.5.3 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
Available via the MIT license.
see: http://github.com/greggman/twgl.js for details */const BYTE$2=5120,UNSIGNED_BYTE$3=5121,SHORT$2=5122,UNSIGNED_SHORT$3=5123,INT$3=5124,UNSIGNED_INT$3=5125,FLOAT$3=5126,UNSIGNED_SHORT_4_4_4_4$1=32819,UNSIGNED_SHORT_5_5_5_1$1=32820,UNSIGNED_SHORT_5_6_5$1=33635,HALF_FLOAT$1=5131,UNSIGNED_INT_2_10_10_10_REV$1=33640,UNSIGNED_INT_10F_11F_11F_REV$1=35899,UNSIGNED_INT_5_9_9_9_REV$1=35902,FLOAT_32_UNSIGNED_INT_24_8_REV$1=36269,UNSIGNED_INT_24_8$1=34042,glTypeToTypedArray={};{const t=glTypeToTypedArray;t[BYTE$2]=Int8Array,t[UNSIGNED_BYTE$3]=Uint8Array,t[SHORT$2]=Int16Array,t[UNSIGNED_SHORT$3]=Uint16Array,t[INT$3]=Int32Array,t[UNSIGNED_INT$3]=Uint32Array,t[FLOAT$3]=Float32Array,t[UNSIGNED_SHORT_4_4_4_4$1]=Uint16Array,t[UNSIGNED_SHORT_5_5_5_1$1]=Uint16Array,t[UNSIGNED_SHORT_5_6_5$1]=Uint16Array,t[HALF_FLOAT$1]=Uint16Array,t[UNSIGNED_INT_2_10_10_10_REV$1]=Uint32Array,t[UNSIGNED_INT_10F_11F_11F_REV$1]=Uint32Array,t[UNSIGNED_INT_5_9_9_9_REV$1]=Uint32Array,t[FLOAT_32_UNSIGNED_INT_24_8_REV$1]=Uint32Array,t[UNSIGNED_INT_24_8$1]=Uint32Array}function getGLTypeForTypedArray(t){if(t instanceof Int8Array)return BYTE$2;if(t instanceof Uint8Array||t instanceof Uint8ClampedArray)return UNSIGNED_BYTE$3;if(t instanceof Int16Array)return SHORT$2;if(t instanceof Uint16Array)return UNSIGNED_SHORT$3;if(t instanceof Int32Array)return INT$3;if(t instanceof Uint32Array)return UNSIGNED_INT$3;if(t instanceof Float32Array)return FLOAT$3;throw new Error("unsupported typed array type")}function getGLTypeForTypedArrayType(t){if(t===Int8Array)return BYTE$2;if(t===Uint8Array||t===Uint8ClampedArray)return UNSIGNED_BYTE$3;if(t===Int16Array)return SHORT$2;if(t===Uint16Array)return UNSIGNED_SHORT$3;if(t===Int32Array)return INT$3;if(t===Uint32Array)return UNSIGNED_INT$3;if(t===Float32Array)return FLOAT$3;throw new Error("unsupported typed array type")}function getTypedArrayTypeForGLType(t){const e=glTypeToTypedArray[t];if(!e)throw new Error("unknown gl type");return e}const isArrayBuffer$1=typeof SharedArrayBuffer<"u"?function t(e){return e&&e.buffer&&(e.buffer instanceof ArrayBuffer||e.buffer instanceof SharedArrayBuffer)}:function t(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer};function error$1(...t){console.error(...t)}const isTypeWeakMaps=new Map;function isType(t,e){if(!t||typeof t!="object")return!1;let n=isTypeWeakMaps.get(e);n||(n=new WeakMap,isTypeWeakMaps.set(e,n));let a=n.get(t);if(a===void 0){const s=Object.prototype.toString.call(t);a=s.substring(8,s.length-1)===e,n.set(t,a)}return a}function isBuffer(t,e){return typeof WebGLBuffer<"u"&&isType(e,"WebGLBuffer")}function isTexture(t,e){return typeof WebGLTexture<"u"&&isType(e,"WebGLTexture")}const STATIC_DRAW=35044,ARRAY_BUFFER$1=34962,ELEMENT_ARRAY_BUFFER$2=34963,BUFFER_SIZE=34660,BYTE$1=5120,UNSIGNED_BYTE$2=5121,SHORT$1=5122,UNSIGNED_SHORT$2=5123,INT$2=5124,UNSIGNED_INT$2=5125,FLOAT$2=5126,defaults$2={attribPrefix:""};function setBufferFromTypedArray(t,e,n,a,s){t.bindBuffer(e,n),t.bufferData(e,a,s||STATIC_DRAW)}function createBufferFromTypedArray(t,e,n,a){if(isBuffer(t,e))return e;n=n||ARRAY_BUFFER$1;const s=t.createBuffer();return setBufferFromTypedArray(t,n,s,e,a),s}function isIndices(t){return t==="indices"}function getNormalizationForTypedArrayType(t){return t===Int8Array||t===Uint8Array}function getArray$1(t){return t.length?t:t.data}const texcoordRE=/coord|texture/i,colorRE=/color|colour/i;function guessNumComponentsFromName(t,e){let n;if(texcoordRE.test(t)?n=2:colorRE.test(t)?n=4:n=3,e%n>0)throw new Error(`Can not guess numComponents for attribute '${t}'. Tried ${n} but ${e} values is not evenly divisible by ${n}. You should specify it.`);return n}function getNumComponents$1(t,e,n){return t.numComponents||t.size||guessNumComponentsFromName(e,n||getArray$1(t).length)}function makeTypedArray(t,e){if(isArrayBuffer$1(t))return t;if(isArrayBuffer$1(t.data))return t.data;Array.isArray(t)&&(t={data:t});let n=t.type?typedArrayTypeFromGLTypeOrTypedArrayCtor(t.type):void 0;return n||(isIndices(e)?n=Uint16Array:n=Float32Array),new n(t.data)}function glTypeFromGLTypeOrTypedArrayType(t){return typeof t=="number"?t:t?getGLTypeForTypedArrayType(t):FLOAT$2}function typedArrayTypeFromGLTypeOrTypedArrayCtor(t){return typeof t=="number"?getTypedArrayTypeForGLType(t):t||Float32Array}function attribBufferFromBuffer(t,e){return{buffer:e.buffer,numValues:2*3*4,type:glTypeFromGLTypeOrTypedArrayType(e.type),arrayType:typedArrayTypeFromGLTypeOrTypedArrayCtor(e.type)}}function attribBufferFromSize(t,e){const n=e.data||e,a=typedArrayTypeFromGLTypeOrTypedArrayCtor(e.type),s=n*a.BYTES_PER_ELEMENT,c=t.createBuffer();return t.bindBuffer(ARRAY_BUFFER$1,c),t.bufferData(ARRAY_BUFFER$1,s,e.drawType||STATIC_DRAW),{buffer:c,numValues:n,type:getGLTypeForTypedArrayType(a),arrayType:a}}function attribBufferFromArrayLike(t,e,n){const a=makeTypedArray(e,n);return{arrayType:a.constructor,buffer:createBufferFromTypedArray(t,a,void 0,e.drawType),type:getGLTypeForTypedArray(a),numValues:0}}function createAttribsFromArrays(t,e){const n={};return Object.keys(e).forEach(function(a){if(!isIndices(a)){const s=e[a],c=s.attrib||s.name||s.attribName||defaults$2.attribPrefix+a;if(s.value){if(!Array.isArray(s.value)&&!isArrayBuffer$1(s.value))throw new Error("array.value is not array or typedarray");n[c]={value:s.value}}else{let u;s.buffer&&s.buffer instanceof WebGLBuffer?u=attribBufferFromBuffer:typeof s=="number"||typeof s.data=="number"?u=attribBufferFromSize:u=attribBufferFromArrayLike;const{buffer:d,type:m,numValues:_,arrayType:b}=u(t,s,a),S=s.normalize!==void 0?s.normalize:getNormalizationForTypedArrayType(b),k=getNumComponents$1(s,a,_);n[c]={buffer:d,numComponents:k,type:m,normalize:S,stride:s.stride||0,offset:s.offset||0,divisor:s.divisor===void 0?void 0:s.divisor,drawType:s.drawType}}}}),t.bindBuffer(ARRAY_BUFFER$1,null),n}function getBytesPerValueForGLType(t,e){return e===BYTE$1||e===UNSIGNED_BYTE$2?1:e===SHORT$1||e===UNSIGNED_SHORT$2?2:e===INT$2||e===UNSIGNED_INT$2||e===FLOAT$2?4:0}const positionKeys=["position","positions","a_position"];function getNumElementsFromAttributes(t,e){let n,a;for(a=0;a<positionKeys.length&&(n=positionKeys[a],!(n in e||(n=defaults$2.attribPrefix+n,n in e)));++a);a===positionKeys.length&&(n=Object.keys(e)[0]);const s=e[n];if(!s.buffer)return 1;t.bindBuffer(ARRAY_BUFFER$1,s.buffer);const c=t.getBufferParameter(ARRAY_BUFFER$1,BUFFER_SIZE);t.bindBuffer(ARRAY_BUFFER$1,null);const u=getBytesPerValueForGLType(t,s.type),d=c/u,m=s.numComponents||s.size,_=d/m;if(_%1!==0)throw new Error(`numComponents ${m} not correct for length ${length}`);return _}function createBufferInfoFromArrays(t,e,n){const a=createAttribsFromArrays(t,e),s=Object.assign({},n||{});s.attribs=Object.assign({},n?n.attribs:{},a);const c=e.indices;if(c){const u=makeTypedArray(c,"indices");s.indices=createBufferFromTypedArray(t,u,ELEMENT_ARRAY_BUFFER$2),s.numElements=u.length,s.elementType=getGLTypeForTypedArray(u)}else s.numElements||(s.numElements=getNumElementsFromAttributes(t,s.attribs));return s}function isWebGL2(t){return!!t.texStorage2D}const glEnumToString=function(){const t={},e={};function n(a){const s=a.constructor.name;if(!t[s]){for(const c in a)if(typeof a[c]=="number"){const u=e[a[c]];e[a[c]]=u?`${u} | ${c}`:c}t[s]=!0}}return function(s,c){return n(s),e[c]||(typeof c=="number"?`0x${c.toString(16)}`:c)}}(),error=error$1;function getElementById(t){return typeof document<"u"&&document.getElementById?document.getElementById(t):null}const TEXTURE0=33984,ARRAY_BUFFER=34962,ELEMENT_ARRAY_BUFFER$1=34963,COMPILE_STATUS=35713,LINK_STATUS=35714,FRAGMENT_SHADER=35632,VERTEX_SHADER=35633,SEPARATE_ATTRIBS=35981,ACTIVE_UNIFORMS=35718,ACTIVE_ATTRIBUTES=35721,TRANSFORM_FEEDBACK_VARYINGS=35971,ACTIVE_UNIFORM_BLOCKS=35382,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398,UNIFORM_BLOCK_DATA_SIZE=35392,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395,FLOAT=5126,FLOAT_VEC2=35664,FLOAT_VEC3=35665,FLOAT_VEC4=35666,INT=5124,INT_VEC2=35667,INT_VEC3=35668,INT_VEC4=35669,BOOL=35670,BOOL_VEC2=35671,BOOL_VEC3=35672,BOOL_VEC4=35673,FLOAT_MAT2=35674,FLOAT_MAT3=35675,FLOAT_MAT4=35676,SAMPLER_2D=35678,SAMPLER_CUBE=35680,SAMPLER_3D=35679,SAMPLER_2D_SHADOW=35682,FLOAT_MAT2x3=35685,FLOAT_MAT2x4=35686,FLOAT_MAT3x2=35687,FLOAT_MAT3x4=35688,FLOAT_MAT4x2=35689,FLOAT_MAT4x3=35690,SAMPLER_2D_ARRAY=36289,SAMPLER_2D_ARRAY_SHADOW=36292,SAMPLER_CUBE_SHADOW=36293,UNSIGNED_INT=5125,UNSIGNED_INT_VEC2=36294,UNSIGNED_INT_VEC3=36295,UNSIGNED_INT_VEC4=36296,INT_SAMPLER_2D=36298,INT_SAMPLER_3D=36299,INT_SAMPLER_CUBE=36300,INT_SAMPLER_2D_ARRAY=36303,UNSIGNED_INT_SAMPLER_2D=36306,UNSIGNED_INT_SAMPLER_3D=36307,UNSIGNED_INT_SAMPLER_CUBE=36308,UNSIGNED_INT_SAMPLER_2D_ARRAY=36311,TEXTURE_2D$1=3553,TEXTURE_CUBE_MAP=34067,TEXTURE_3D=32879,TEXTURE_2D_ARRAY=35866,typeMap={};function getBindPointForSamplerType(t,e){return typeMap[e].bindPoint}function floatSetter(t,e){return function(n){t.uniform1f(e,n)}}function floatArraySetter(t,e){return function(n){t.uniform1fv(e,n)}}function floatVec2Setter(t,e){return function(n){t.uniform2fv(e,n)}}function floatVec3Setter(t,e){return function(n){t.uniform3fv(e,n)}}function floatVec4Setter(t,e){return function(n){t.uniform4fv(e,n)}}function intSetter(t,e){return function(n){t.uniform1i(e,n)}}function intArraySetter(t,e){return function(n){t.uniform1iv(e,n)}}function intVec2Setter(t,e){return function(n){t.uniform2iv(e,n)}}function intVec3Setter(t,e){return function(n){t.uniform3iv(e,n)}}function intVec4Setter(t,e){return function(n){t.uniform4iv(e,n)}}function uintSetter(t,e){return function(n){t.uniform1ui(e,n)}}function uintArraySetter(t,e){return function(n){t.uniform1uiv(e,n)}}function uintVec2Setter(t,e){return function(n){t.uniform2uiv(e,n)}}function uintVec3Setter(t,e){return function(n){t.uniform3uiv(e,n)}}function uintVec4Setter(t,e){return function(n){t.uniform4uiv(e,n)}}function floatMat2Setter(t,e){return function(n){t.uniformMatrix2fv(e,!1,n)}}function floatMat3Setter(t,e){return function(n){t.uniformMatrix3fv(e,!1,n)}}function floatMat4Setter(t,e){return function(n){t.uniformMatrix4fv(e,!1,n)}}function floatMat23Setter(t,e){return function(n){t.uniformMatrix2x3fv(e,!1,n)}}function floatMat32Setter(t,e){return function(n){t.uniformMatrix3x2fv(e,!1,n)}}function floatMat24Setter(t,e){return function(n){t.uniformMatrix2x4fv(e,!1,n)}}function floatMat42Setter(t,e){return function(n){t.uniformMatrix4x2fv(e,!1,n)}}function floatMat34Setter(t,e){return function(n){t.uniformMatrix3x4fv(e,!1,n)}}function floatMat43Setter(t,e){return function(n){t.uniformMatrix4x3fv(e,!1,n)}}function samplerSetter(t,e,n,a){const s=getBindPointForSamplerType(t,e);return isWebGL2(t)?function(c){let u,d;!c||isTexture(t,c)?(u=c,d=null):(u=c.texture,d=c.sampler),t.uniform1i(a,n),t.activeTexture(TEXTURE0+n),t.bindTexture(s,u),t.bindSampler(n,d)}:function(c){t.uniform1i(a,n),t.activeTexture(TEXTURE0+n),t.bindTexture(s,c)}}function samplerArraySetter(t,e,n,a,s){const c=getBindPointForSamplerType(t,e),u=new Int32Array(s);for(let d=0;d<s;++d)u[d]=n+d;return isWebGL2(t)?function(d){t.uniform1iv(a,u),d.forEach(function(m,_){t.activeTexture(TEXTURE0+u[_]);let b,S;!m||isTexture(t,m)?(b=m,S=null):(b=m.texture,S=m.sampler),t.bindSampler(n,S),t.bindTexture(c,b)})}:function(d){t.uniform1iv(a,u),d.forEach(function(m,_){t.activeTexture(TEXTURE0+u[_]),t.bindTexture(c,m)})}}typeMap[FLOAT]={Type:Float32Array,size:4,setter:floatSetter,arraySetter:floatArraySetter};typeMap[FLOAT_VEC2]={Type:Float32Array,size:8,setter:floatVec2Setter,cols:2};typeMap[FLOAT_VEC3]={Type:Float32Array,size:12,setter:floatVec3Setter,cols:3};typeMap[FLOAT_VEC4]={Type:Float32Array,size:16,setter:floatVec4Setter,cols:4};typeMap[INT]={Type:Int32Array,size:4,setter:intSetter,arraySetter:intArraySetter};typeMap[INT_VEC2]={Type:Int32Array,size:8,setter:intVec2Setter,cols:2};typeMap[INT_VEC3]={Type:Int32Array,size:12,setter:intVec3Setter,cols:3};typeMap[INT_VEC4]={Type:Int32Array,size:16,setter:intVec4Setter,cols:4};typeMap[UNSIGNED_INT]={Type:Uint32Array,size:4,setter:uintSetter,arraySetter:uintArraySetter};typeMap[UNSIGNED_INT_VEC2]={Type:Uint32Array,size:8,setter:uintVec2Setter,cols:2};typeMap[UNSIGNED_INT_VEC3]={Type:Uint32Array,size:12,setter:uintVec3Setter,cols:3};typeMap[UNSIGNED_INT_VEC4]={Type:Uint32Array,size:16,setter:uintVec4Setter,cols:4};typeMap[BOOL]={Type:Uint32Array,size:4,setter:intSetter,arraySetter:intArraySetter};typeMap[BOOL_VEC2]={Type:Uint32Array,size:8,setter:intVec2Setter,cols:2};typeMap[BOOL_VEC3]={Type:Uint32Array,size:12,setter:intVec3Setter,cols:3};typeMap[BOOL_VEC4]={Type:Uint32Array,size:16,setter:intVec4Setter,cols:4};typeMap[FLOAT_MAT2]={Type:Float32Array,size:32,setter:floatMat2Setter,rows:2,cols:2};typeMap[FLOAT_MAT3]={Type:Float32Array,size:48,setter:floatMat3Setter,rows:3,cols:3};typeMap[FLOAT_MAT4]={Type:Float32Array,size:64,setter:floatMat4Setter,rows:4,cols:4};typeMap[FLOAT_MAT2x3]={Type:Float32Array,size:32,setter:floatMat23Setter,rows:2,cols:3};typeMap[FLOAT_MAT2x4]={Type:Float32Array,size:32,setter:floatMat24Setter,rows:2,cols:4};typeMap[FLOAT_MAT3x2]={Type:Float32Array,size:48,setter:floatMat32Setter,rows:3,cols:2};typeMap[FLOAT_MAT3x4]={Type:Float32Array,size:48,setter:floatMat34Setter,rows:3,cols:4};typeMap[FLOAT_MAT4x2]={Type:Float32Array,size:64,setter:floatMat42Setter,rows:4,cols:2};typeMap[FLOAT_MAT4x3]={Type:Float32Array,size:64,setter:floatMat43Setter,rows:4,cols:3};typeMap[SAMPLER_2D]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D$1};typeMap[SAMPLER_CUBE]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_CUBE_MAP};typeMap[SAMPLER_3D]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_3D};typeMap[SAMPLER_2D_SHADOW]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D$1};typeMap[SAMPLER_2D_ARRAY]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D_ARRAY};typeMap[SAMPLER_2D_ARRAY_SHADOW]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D_ARRAY};typeMap[SAMPLER_CUBE_SHADOW]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_CUBE_MAP};typeMap[INT_SAMPLER_2D]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D$1};typeMap[INT_SAMPLER_3D]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_3D};typeMap[INT_SAMPLER_CUBE]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_CUBE_MAP};typeMap[INT_SAMPLER_2D_ARRAY]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D_ARRAY};typeMap[UNSIGNED_INT_SAMPLER_2D]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D$1};typeMap[UNSIGNED_INT_SAMPLER_3D]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_3D};typeMap[UNSIGNED_INT_SAMPLER_CUBE]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_CUBE_MAP};typeMap[UNSIGNED_INT_SAMPLER_2D_ARRAY]={Type:null,size:0,setter:samplerSetter,arraySetter:samplerArraySetter,bindPoint:TEXTURE_2D_ARRAY};function floatAttribSetter(t,e){return function(n){if(n.value)switch(t.disableVertexAttribArray(e),n.value.length){case 4:t.vertexAttrib4fv(e,n.value);break;case 3:t.vertexAttrib3fv(e,n.value);break;case 2:t.vertexAttrib2fv(e,n.value);break;case 1:t.vertexAttrib1fv(e,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else t.bindBuffer(ARRAY_BUFFER,n.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,n.numComponents||n.size,n.type||FLOAT,n.normalize||!1,n.stride||0,n.offset||0),t.vertexAttribDivisor&&t.vertexAttribDivisor(e,n.divisor||0)}}function intAttribSetter(t,e){return function(n){if(n.value)if(t.disableVertexAttribArray(e),n.value.length===4)t.vertexAttrib4iv(e,n.value);else throw new Error("The length of an integer constant value must be 4!");else t.bindBuffer(ARRAY_BUFFER,n.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,n.numComponents||n.size,n.type||INT,n.stride||0,n.offset||0),t.vertexAttribDivisor&&t.vertexAttribDivisor(e,n.divisor||0)}}function uintAttribSetter(t,e){return function(n){if(n.value)if(t.disableVertexAttribArray(e),n.value.length===4)t.vertexAttrib4uiv(e,n.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else t.bindBuffer(ARRAY_BUFFER,n.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,n.numComponents||n.size,n.type||UNSIGNED_INT,n.stride||0,n.offset||0),t.vertexAttribDivisor&&t.vertexAttribDivisor(e,n.divisor||0)}}function matAttribSetter(t,e,n){const a=n.size,s=n.count;return function(c){t.bindBuffer(ARRAY_BUFFER,c.buffer);const u=c.size||c.numComponents||a,d=u/s,m=c.type||FLOAT,b=typeMap[m].size*u,S=c.normalize||!1,k=c.offset||0,w=b/s;for(let O=0;O<s;++O)t.enableVertexAttribArray(e+O),t.vertexAttribPointer(e+O,d,m,S,b,k+w*O),t.vertexAttribDivisor&&t.vertexAttribDivisor(e+O,c.divisor||0)}}const attrTypeMap={};attrTypeMap[FLOAT]={size:4,setter:floatAttribSetter};attrTypeMap[FLOAT_VEC2]={size:8,setter:floatAttribSetter};attrTypeMap[FLOAT_VEC3]={size:12,setter:floatAttribSetter};attrTypeMap[FLOAT_VEC4]={size:16,setter:floatAttribSetter};attrTypeMap[INT]={size:4,setter:intAttribSetter};attrTypeMap[INT_VEC2]={size:8,setter:intAttribSetter};attrTypeMap[INT_VEC3]={size:12,setter:intAttribSetter};attrTypeMap[INT_VEC4]={size:16,setter:intAttribSetter};attrTypeMap[UNSIGNED_INT]={size:4,setter:uintAttribSetter};attrTypeMap[UNSIGNED_INT_VEC2]={size:8,setter:uintAttribSetter};attrTypeMap[UNSIGNED_INT_VEC3]={size:12,setter:uintAttribSetter};attrTypeMap[UNSIGNED_INT_VEC4]={size:16,setter:uintAttribSetter};attrTypeMap[BOOL]={size:4,setter:intAttribSetter};attrTypeMap[BOOL_VEC2]={size:8,setter:intAttribSetter};attrTypeMap[BOOL_VEC3]={size:12,setter:intAttribSetter};attrTypeMap[BOOL_VEC4]={size:16,setter:intAttribSetter};attrTypeMap[FLOAT_MAT2]={size:4,setter:matAttribSetter,count:2};attrTypeMap[FLOAT_MAT3]={size:9,setter:matAttribSetter,count:3};attrTypeMap[FLOAT_MAT4]={size:16,setter:matAttribSetter,count:4};const errorRE=/ERROR:\s*\d+:(\d+)/gi;function addLineNumbersWithError(t,e="",n=0){const a=[...e.matchAll(errorRE)],s=new Map(a.map((c,u)=>{const d=parseInt(c[1]),m=a[u+1],_=m?m.index:e.length,b=e.substring(c.index,_);return[d-1,b]}));return t.split(`
`).map((c,u)=>{const d=s.get(u);return`${u+1+n}: ${c}${d?`

^^^ ${d}`:""}`}).join(`
`)}const spaceRE=/^[ \t]*\n/;function prepShaderSource(t){let e=0;return spaceRE.test(t)&&(e=1,t=t.replace(spaceRE,"")),{lineOffset:e,shaderSource:t}}function reportError(t,e){return t.errorCallback(e),t.callback&&setTimeout(()=>{t.callback(`${e}
${t.errors.join(`
`)}`)}),null}function checkShaderStatus(t,e,n,a){if(a=a||error,!t.getShaderParameter(n,COMPILE_STATUS)){const c=t.getShaderInfoLog(n),{lineOffset:u,shaderSource:d}=prepShaderSource(t.getShaderSource(n)),m=`${addLineNumbersWithError(d,c,u)}
Error compiling ${glEnumToString(t,e)}: ${c}`;return a(m),m}return""}function getProgramOptions(t,e,n){let a,s,c;if(typeof e=="function"&&(n=e,e=void 0),typeof t=="function")n=t,t=void 0;else if(t&&!Array.isArray(t)){const _=t;n=_.errorCallback,t=_.attribLocations,a=_.transformFeedbackVaryings,s=_.transformFeedbackMode,c=_.callback}const u=n||error,d=[],m={errorCallback(_,...b){d.push(_),u(_,...b)},transformFeedbackVaryings:a,transformFeedbackMode:s,callback:c,errors:d};{let _={};Array.isArray(t)?t.forEach(function(b,S){_[b]=e?e[S]:S}):_=t||{},m.attribLocations=_}return m}const defaultShaderType=["VERTEX_SHADER","FRAGMENT_SHADER"];function getShaderTypeFromScriptType(t,e){if(e.indexOf("frag")>=0)return FRAGMENT_SHADER;if(e.indexOf("vert")>=0)return VERTEX_SHADER}function deleteProgramAndShaders(t,e,n){const a=t.getAttachedShaders(e);for(const s of a)n.has(s)&&t.deleteShader(s);t.deleteProgram(e)}const wait=(t=0)=>new Promise(e=>setTimeout(e,t));function createProgramNoCheck(t,e,n){const a=t.createProgram(),{attribLocations:s,transformFeedbackVaryings:c,transformFeedbackMode:u}=getProgramOptions(n);for(let d=0;d<e.length;++d){let m=e[d];if(typeof m=="string"){const _=getElementById(m),b=_?_.text:m;let S=t[defaultShaderType[d]];_&&_.type&&(S=getShaderTypeFromScriptType(t,_.type)||S),m=t.createShader(S),t.shaderSource(m,prepShaderSource(b).shaderSource),t.compileShader(m),t.attachShader(a,m)}}Object.entries(s).forEach(([d,m])=>t.bindAttribLocation(a,m,d));{let d=c;d&&(d.attribs&&(d=d.attribs),Array.isArray(d)||(d=Object.keys(d)),t.transformFeedbackVaryings(a,d,u||SEPARATE_ATTRIBS))}return t.linkProgram(a),a}function createProgram(t,e,n,a,s){const c=getProgramOptions(n,a,s),u=new Set(e),d=createProgramNoCheck(t,e,c);function m(_,b){const S=getProgramErrors(_,b,c.errorCallback);return S&&deleteProgramAndShaders(_,b,u),S}if(c.callback){waitForProgramLinkCompletionAsync(t,d).then(()=>{const _=m(t,d);c.callback(_,_?void 0:d)});return}return m(t,d)?void 0:d}async function waitForProgramLinkCompletionAsync(t,e){const n=t.getExtension("KHR_parallel_shader_compile"),a=n?(c,u)=>c.getProgramParameter(u,n.COMPLETION_STATUS_KHR):()=>!0;let s=0;do await wait(s),s=1e3/60;while(!a(t,e))}function getProgramErrors(t,e,n){if(n=n||error,!t.getProgramParameter(e,LINK_STATUS)){const s=t.getProgramInfoLog(e);n(`Error in program linking: ${s}`);const u=t.getAttachedShaders(e).map(d=>checkShaderStatus(t,t.getShaderParameter(d,t.SHADER_TYPE),d,n));return`${s}
${u.filter(d=>d).join(`
`)}`}}function createProgramFromSources(t,e,n,a,s){return createProgram(t,e,n,a,s)}function isBuiltIn(t){const e=t.name;return e.startsWith("gl_")||e.startsWith("webgl_")}const tokenRE=/(\.|\[|]|\w+)/g,isDigit=t=>t>="0"&&t<="9";function addSetterToUniformTree(t,e,n,a){const s=t.split(tokenRE).filter(d=>d!=="");let c=0,u="";for(;;){const d=s[c++];u+=d;const m=isDigit(d[0]),_=m?parseInt(d):d;if(m&&(u+=s[c++]),c===s.length){n[_]=e;break}else{const S=s[c++],k=S==="[",w=n[_]||(k?[]:{});n[_]=w,n=w,a[u]=a[u]||function(O){return function(P){setUniformTree(O,P)}}(w),u+=S}}}function createUniformSetters(t,e){let n=0;function a(d,m,_){const b=m.name.endsWith("[0]"),S=m.type,k=typeMap[S];if(!k)throw new Error(`unknown type: 0x${S.toString(16)}`);let w;if(k.bindPoint){const O=n;n+=m.size,b?w=k.arraySetter(t,S,O,_,m.size):w=k.setter(t,S,O,_,m.size)}else k.arraySetter&&b?w=k.arraySetter(t,_):w=k.setter(t,_);return w.location=_,w}const s={},c={},u=t.getProgramParameter(e,ACTIVE_UNIFORMS);for(let d=0;d<u;++d){const m=t.getActiveUniform(e,d);if(isBuiltIn(m))continue;let _=m.name;_.endsWith("[0]")&&(_=_.substr(0,_.length-3));const b=t.getUniformLocation(e,m.name);if(b){const S=a(e,m,b);s[_]=S,addSetterToUniformTree(_,S,c,s)}}return s}function createTransformFeedbackInfo(t,e){const n={},a=t.getProgramParameter(e,TRANSFORM_FEEDBACK_VARYINGS);for(let s=0;s<a;++s){const c=t.getTransformFeedbackVarying(e,s);n[c.name]={index:s,type:c.type,size:c.size}}return n}function createUniformBlockSpecFromProgram(t,e){const n=t.getProgramParameter(e,ACTIVE_UNIFORMS),a=[],s=[];for(let d=0;d<n;++d){s.push(d),a.push({});const m=t.getActiveUniform(e,d);a[d].name=m.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(d){const m=d[0],_=d[1];t.getActiveUniforms(e,s,t[m]).forEach(function(b,S){a[S][_]=b})});const c={},u=t.getProgramParameter(e,ACTIVE_UNIFORM_BLOCKS);for(let d=0;d<u;++d){const m=t.getActiveUniformBlockName(e,d),_={index:t.getUniformBlockIndex(e,m),usedByVertexShader:t.getActiveUniformBlockParameter(e,d,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),usedByFragmentShader:t.getActiveUniformBlockParameter(e,d,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),size:t.getActiveUniformBlockParameter(e,d,UNIFORM_BLOCK_DATA_SIZE),uniformIndices:t.getActiveUniformBlockParameter(e,d,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES)};_.used=_.usedByVertexShader||_.usedByFragmentShader,c[m]=_}return{blockSpecs:c,uniformData:a}}function setUniformTree(t,e){for(const n in e){const a=t[n];typeof a=="function"?a(e[n]):setUniformTree(t[n],e[n])}}function setUniforms(t,...e){const n=t.uniformSetters||t,a=e.length;for(let s=0;s<a;++s){const c=e[s];if(Array.isArray(c)){const u=c.length;for(let d=0;d<u;++d)setUniforms(n,c[d])}else for(const u in c){const d=n[u];d&&d(c[u])}}}function createAttributeSetters(t,e){const n={},a=t.getProgramParameter(e,ACTIVE_ATTRIBUTES);for(let s=0;s<a;++s){const c=t.getActiveAttrib(e,s);if(isBuiltIn(c))continue;const u=t.getAttribLocation(e,c.name),d=attrTypeMap[c.type],m=d.setter(t,u,d);m.location=u,n[c.name]=m}return n}function setAttributes(t,e){for(const n in e){const a=t[n];a&&a(e[n])}}function setBuffersAndAttributes(t,e,n){n.vertexArrayObject?t.bindVertexArray(n.vertexArrayObject):(setAttributes(e.attribSetters||e,n.attribs),n.indices&&t.bindBuffer(ELEMENT_ARRAY_BUFFER$1,n.indices))}function createProgramInfoFromProgram(t,e){const n=createUniformSetters(t,e),a=createAttributeSetters(t,e),s={program:e,uniformSetters:n,attribSetters:a};return isWebGL2(t)&&(s.uniformBlockSpec=createUniformBlockSpecFromProgram(t,e),s.transformFeedbackInfo=createTransformFeedbackInfo(t,e)),s}const notIdRE=/\s|{|}|;/;function createProgramInfo(t,e,n,a,s){const c=getProgramOptions(n,a,s),u=[];if(e=e.map(function(_){if(!notIdRE.test(_)){const b=getElementById(_);if(b)_=b.text;else{const S=`no element with id: ${_}`;c.errorCallback(S),u.push(S)}}return _}),u.length)return reportError(c,"");const d=c.callback;d&&(c.callback=(_,b)=>{d(_,_?void 0:createProgramInfoFromProgram(t,b))});const m=createProgramFromSources(t,e,c);return m?createProgramInfoFromProgram(t,m):null}const TRIANGLES=4,UNSIGNED_SHORT=5123;function drawBufferInfo(t,e,n,a,s,c){n=n===void 0?TRIANGLES:n;const u=e.indices,d=e.elementType,m=a===void 0?e.numElements:a;s=s===void 0?0:s,d||u?c!==void 0?t.drawElementsInstanced(n,m,d===void 0?UNSIGNED_SHORT:e.elementType,s,c):t.drawElements(n,m,d===void 0?UNSIGNED_SHORT:e.elementType,s):c!==void 0?t.drawArraysInstanced(n,s,m,c):t.drawArrays(n,s,m)}function create_fragment$i(t){let e,n,a;return{c(){e=element("div"),n=element("canvas"),this.h()},l(s){e=claim_element(s,"DIV",{class:!0});var c=children(e);n=claim_element(c,"CANVAS",{id:!0,width:!0,height:!0,class:!0}),children(n).forEach(detach),c.forEach(detach),this.h()},h(){attr(n,"id","AHRS-display"),attr(n,"width","100"),attr(n,"height","100"),attr(n,"class","w-full aspect-square"),attr(e,"class",a="border-2 shadow-md rounded-md p-2 "+t[2].bg+" "+t[2].border+" "+t[1])},m(s,c){insert_hydration(s,e,c),append_hydration(e,n),t[9](n)},p(s,[c]){c&2&&a!==(a="border-2 shadow-md rounded-md p-2 "+s[2].bg+" "+s[2].border+" "+s[1])&&attr(e,"class",a)},i:noop$4,o:noop$4,d(s){s&&detach(e),t[9](null)}}}function instance$i(t,e,n){let a,s,c,u;component_subscribe(t,rovRoll,O=>n(6,s=O)),component_subscribe(t,rovPitch,O=>n(7,c=O)),component_subscribe(t,rovHeading,O=>n(8,u=O));let d;const m=getColors(),_=`
attribute vec4 position;
void main() {
  gl_Position = position;
}
`;let b,S,k;onMount(()=>{if(n(3,b=d.getContext("webgl")),!b){console.warn("Unable to initialize WebGL. Your browser or machine may not support it.");return}n(4,S=createProgramInfo(b,[_,fragmentShader])),n(5,k=createBufferInfoFromArrays(b,{position:[-1,-1,0,1,-1,0,-1,1,0,-1,1,0,1,-1,0,1,1,0]}))});function w(O){binding_callbacks[O?"unshift":"push"](()=>{d=O,n(0,d)})}return t.$$set=O=>{n(11,e=assign$1(assign$1({},e),exclude_internal_props(O)))},t.$$.update=()=>{if(n(1,a=`${e.class??""}`),t.$$.dirty&504&&S&&b){b.viewport(0,0,b.canvas.width,b.canvas.height);const O={yaw:u*(3.14/180)*-1,pitch:c*(3.14/180)*-1,roll:s*(3.14/180),resolution:[b.canvas.width,b.canvas.height]};b.useProgram(S.program),setBuffersAndAttributes(b,S,k),setUniforms(S,O),drawBufferInfo(b,k)}},e=exclude_internal_props(e),[d,a,m,b,S,k,s,c,u,w]}class YawRollViz extends SvelteComponent{constructor(e){super(),init(this,e,instance$i,create_fragment$i,safe_not_equal,{})}}function get_each_context$2(t,e,n){const a=t.slice();return a[20]=e[n],a[22]=n,a}function create_if_block_1$2(t){let e,n,a=[],s=new Map,c,u,d,m=ensure_array_like(t[3]);const _=S=>S[20].toastId;for(let S=0;S<m.length;S+=1){let k=get_each_context$2(t,m,S),w=_(k);s.set(w,a[S]=create_each_block$2(w,k))}let b=t[1]&&create_if_block_2$1(t);return{c(){e=element("section"),n=element("div");for(let S=0;S<a.length;S+=1)a[S].c();c=space(),b&&b.c(),u=empty(),this.h()},l(S){e=claim_element(S,"SECTION",{class:!0});var k=children(e);n=claim_element(k,"DIV",{class:!0});var w=children(n);for(let O=0;O<a.length;O+=1)a[O].l(w);w.forEach(detach),k.forEach(detach),c=claim_space(S),b&&b.l(S),u=empty(),this.h()},h(){attr(n,"class","p-2 max-h-80 relative z-0 pb-4"),toggle_class(n,"h-24",!t[1]),toggle_class(n,"overflow-y-clip",!t[1]),toggle_class(n,"overflow-y-auto",t[1]),attr(e,"class","overflow-clip rounded-b-xl bg-black relative shadow-md pt-2")},m(S,k){insert_hydration(S,e,k),append_hydration(e,n);for(let w=0;w<a.length;w+=1)a[w]&&a[w].m(n,null);insert_hydration(S,c,k),b&&b.m(S,k),insert_hydration(S,u,k),d=!0},p(S,k){k&16399&&(m=ensure_array_like(S[3]),group_outros(),a=update_keyed_each(a,k,_,1,S,m,s,n,outro_and_destroy_block,create_each_block$2,null,get_each_context$2),check_outros()),(!d||k&2)&&toggle_class(n,"h-24",!S[1]),(!d||k&2)&&toggle_class(n,"overflow-y-clip",!S[1]),(!d||k&2)&&toggle_class(n,"overflow-y-auto",S[1]),S[1]?b?(b.p(S,k),k&2&&transition_in(b,1)):(b=create_if_block_2$1(S),b.c(),transition_in(b,1),b.m(u.parentNode,u)):b&&(group_outros(),transition_out(b,1,1,()=>{b=null}),check_outros())},i(S){if(!d){for(let k=0;k<m.length;k+=1)transition_in(a[k]);transition_in(b),d=!0}},o(S){for(let k=0;k<a.length;k+=1)transition_out(a[k]);transition_out(b),d=!1},d(S){S&&(detach(e),detach(c),detach(u));for(let k=0;k<a.length;k+=1)a[k].d();b&&b.d(S)}}}function create_if_block_3$1(t){let e,n,a,s,c,u,d,m=t[2]&&create_if_block_4(t);function _(){return t[16](t[22])}return{c(){e=element("button"),m&&m.c(),n=space(),this.h()},l(b){e=claim_element(b,"BUTTON",{class:!0,role:!0});var S=children(e);m&&m.l(S),n=claim_space(S),S.forEach(detach),this.h()},h(){attr(e,"class",a=`btn relative shadow-2xl variant-filled-${t[20].severity} btn-md toast flex justify-between items-center pointer-events-auto  p-4 space-x-4 rounded-container-token shadow-lg w-full cursor-pointer`),attr(e,"role","banner"),toggle_class(e,"mb-2",t[1]),toggle_class(e,"h-16",t[22]!=t[0]),toggle_class(e,"border-2",t[22]==t[0]),set_style(e,"top",(t[1]?0:-t[14](t[22]))+"em"),set_style(e,"z-index",10-t[22])},m(b,S){insert_hydration(b,e,S),m&&m.m(e,null),append_hydration(e,n),c=!0,u||(d=listen(e,"click",_),u=!0)},p(b,S){t=b,t[2]?m?m.p(t,S):(m=create_if_block_4(t),m.c(),m.m(e,n)):m&&(m.d(1),m=null),(!c||S&8&&a!==(a=`btn relative shadow-2xl variant-filled-${t[20].severity} btn-md toast flex justify-between items-center pointer-events-auto  p-4 space-x-4 rounded-container-token shadow-lg w-full cursor-pointer`))&&attr(e,"class",a),(!c||S&10)&&toggle_class(e,"mb-2",t[1]),(!c||S&9)&&toggle_class(e,"h-16",t[22]!=t[0]),(!c||S&9)&&toggle_class(e,"border-2",t[22]==t[0]),S&10&&set_style(e,"top",(t[1]?0:-t[14](t[22]))+"em"),S&8&&set_style(e,"z-index",10-t[22])},i(b){c||(add_render_callback(()=>{c&&(s||(s=create_bidirectional_transition(e,scale,{duration:200,delay:0},!0)),s.run(1))}),c=!0)},o(b){s||(s=create_bidirectional_transition(e,scale,{duration:200,delay:0},!1)),s.run(0),c=!1},d(b){b&&detach(e),m&&m.d(),b&&s&&s.end(),u=!1,d()}}}function create_if_block_4(t){let e,n,a=t[20].messageRepeatCount>1?`[x${t[20].messageRepeatCount}] `:"",s,c=t[20].msg+"",u,d;return{c(){e=element("div"),n=element("p"),s=text(a),u=text(c),this.h()},l(m){e=claim_element(m,"DIV",{class:!0,style:!0});var _=children(e);n=claim_element(_,"P",{});var b=children(n);s=claim_text(b,a),u=claim_text(b,c),b.forEach(detach),_.forEach(detach),this.h()},h(){attr(e,"class","alert-message overflow-hidden text-left text-ellipsis whitespace-normal"),attr(e,"style",d=t[0]==t[22]?"":"max-height:3em")},m(m,_){insert_hydration(m,e,_),append_hydration(e,n),append_hydration(n,s),append_hydration(n,u)},p(m,_){_&8&&a!==(a=m[20].messageRepeatCount>1?`[x${m[20].messageRepeatCount}] `:"")&&set_data(s,a),_&8&&c!==(c=m[20].msg+"")&&set_data(u,c),_&9&&d!==(d=m[0]==m[22]?"":"max-height:3em")&&attr(e,"style",d)},d(m){m&&detach(e)}}}function create_each_block$2(t,e){let n,a,s,c=e[20].closed&&create_if_block_3$1(e);return{key:t,first:null,c(){n=empty(),c&&c.c(),a=empty(),this.h()},l(u){n=empty(),c&&c.l(u),a=empty(),this.h()},h(){this.first=n},m(u,d){insert_hydration(u,n,d),c&&c.m(u,d),insert_hydration(u,a,d),s=!0},p(u,d){e=u,e[20].closed?c?(c.p(e,d),d&8&&transition_in(c,1)):(c=create_if_block_3$1(e),c.c(),transition_in(c,1),c.m(a.parentNode,a)):c&&(group_outros(),transition_out(c,1,1,()=>{c=null}),check_outros())},i(u){s||(transition_in(c),s=!0)},o(u){transition_out(c),s=!1},d(u){u&&(detach(n),detach(a)),c&&c.d(u)}}}function create_if_block_2$1(t){let e,n,a,s,c;return n=new Expand_less({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),{c(){e=element("button"),create_component(n.$$.fragment),this.h()},l(u){e=claim_element(u,"BUTTON",{class:!0});var d=children(e);claim_component(n.$$.fragment,d),d.forEach(detach),this.h()},h(){attr(e,"class","btn variant-filled-primary relative max-w-28 mx-auto mr-4 z-10 shadow-xl -mt-5 -mb-5 z-1")},m(u,d){insert_hydration(u,e,d),mount_component(n,e,null),a=!0,s||(c=listen(e,"click",t[17]),s=!0)},p:noop$4,i(u){a||(transition_in(n.$$.fragment,u),a=!0)},o(u){transition_out(n.$$.fragment,u),a=!1},d(u){u&&detach(e),destroy_component(n),s=!1,c()}}}function create_else_block$3(t){let e,n;return e=new Chevron_right({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),{c(){create_component(e.$$.fragment)},l(a){claim_component(e.$$.fragment,a)},m(a,s){mount_component(e,a,s),n=!0},i(a){n||(transition_in(e.$$.fragment,a),n=!0)},o(a){transition_out(e.$$.fragment,a),n=!1},d(a){destroy_component(e,a)}}}function create_if_block$3(t){let e,n;return e=new Chevron_left({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),{c(){create_component(e.$$.fragment)},l(a){claim_component(e.$$.fragment,a)},m(a,s){mount_component(e,a,s),n=!0},i(a){n||(transition_in(e.$$.fragment,a),n=!0)},o(a){transition_out(e.$$.fragment,a),n=!1},d(a){destroy_component(e,a)}}}function create_fragment$h(t){let e,n,a,s,c,u,d,m,_,b,S,k,w,O,P,N,I,U,$,x,C,H,q,K,W,Z,ee,ie,se,ce,fe,pe,ue=t[3].length>0&&t[2]&&create_if_block_1$2(t);s=new YawRollViz({props:{class:"m-2 mb-0"}}),d=new CircleStatIndicator({props:{value:t[4],min:0,max:50,unit:"M",name:"Depth"}}),_=new CircleStatIndicator({props:{value:t[5],min:6,max:27,unit:"*C",name:"Water Temp"}}),S=new CircleStatIndicator({props:{value:t[6],min:11,max:17.6,unit:"Volts",name:"Batt Volts"}}),w=new CircleStatIndicator({props:{value:t[7],min:0,max:60,unit:"Amps",name:"Batt Amps"}}),P=new CircleStatIndicator({props:{value:t[8],min:20,max:600,unit:"ms",name:"Net Latency"}}),I=new CircleStatIndicator({props:{value:t[9],min:0,max:120,unit:"%",name:"Autopilot Load"}}),$=new CircleStatIndicator({props:{value:t[10],min:0,max:100,unit:"%",name:"Memory Usage"}}),C=new CircleStatIndicator({props:{value:t[11],min:0,max:100,unit:"%",name:"Disk Usage"}}),q=new CircleStatIndicator({props:{value:t[12],min:20,max:120,unit:"*C",name:"CPU Temp"}}),W=new CircleStatIndicator({props:{value:t[13],min:0,max:100,unit:"%",name:"CPU Usage"}});const ge=[create_if_block$3,create_else_block$3],he=[];function _e(re,V){return re[2]?0:1}return ie=_e(t),se=he[ie]=ge[ie](t),{c(){e=element("div"),ue&&ue.c(),n=space(),a=element("section"),create_component(s.$$.fragment),c=space(),u=element("div"),create_component(d.$$.fragment),m=space(),create_component(_.$$.fragment),b=space(),create_component(S.$$.fragment),k=space(),create_component(w.$$.fragment),O=space(),create_component(P.$$.fragment),N=space(),create_component(I.$$.fragment),U=space(),create_component($.$$.fragment),x=space(),create_component(C.$$.fragment),H=space(),create_component(q.$$.fragment),K=space(),create_component(W.$$.fragment),Z=space(),ee=element("button"),se.c(),this.h()},l(re){e=claim_element(re,"DIV",{class:!0});var V=children(e);ue&&ue.l(V),n=claim_space(V),a=claim_element(V,"SECTION",{class:!0});var Q=children(a);claim_component(s.$$.fragment,Q),c=claim_space(Q),u=claim_element(Q,"DIV",{class:!0});var j=children(u);claim_component(d.$$.fragment,j),m=claim_space(j),claim_component(_.$$.fragment,j),b=claim_space(j),claim_component(S.$$.fragment,j),k=claim_space(j),claim_component(w.$$.fragment,j),O=claim_space(j),claim_component(P.$$.fragment,j),N=claim_space(j),claim_component(I.$$.fragment,j),U=claim_space(j),claim_component($.$$.fragment,j),x=claim_space(j),claim_component(C.$$.fragment,j),H=claim_space(j),claim_component(q.$$.fragment,j),K=claim_space(j),claim_component(W.$$.fragment,j),j.forEach(detach),Q.forEach(detach),Z=claim_space(V),ee=claim_element(V,"BUTTON",{class:!0});var le=children(ee);se.l(le),le.forEach(detach),V.forEach(detach),this.h()},h(){attr(u,"class","grid gap-2 p-2"),toggle_class(u,"grid-cols-1",!t[2]),toggle_class(u,"grid-cols-2",t[2]),attr(a,"class","flex-auto basis-0 overflow-auto"),attr(ee,"class","btn w-full variant-filled-surface relative rounded-b-none rounded-t-xl z-10"),attr(e,"class","flex flex-col h-full overflow-hidden relative"),toggle_class(e,"w-72",t[2]),toggle_class(e,"w-28",!t[2])},m(re,V){insert_hydration(re,e,V),ue&&ue.m(e,null),append_hydration(e,n),append_hydration(e,a),mount_component(s,a,null),append_hydration(a,c),append_hydration(a,u),mount_component(d,u,null),append_hydration(u,m),mount_component(_,u,null),append_hydration(u,b),mount_component(S,u,null),append_hydration(u,k),mount_component(w,u,null),append_hydration(u,O),mount_component(P,u,null),append_hydration(u,N),mount_component(I,u,null),append_hydration(u,U),mount_component($,u,null),append_hydration(u,x),mount_component(C,u,null),append_hydration(u,H),mount_component(q,u,null),append_hydration(u,K),mount_component(W,u,null),append_hydration(e,Z),append_hydration(e,ee),he[ie].m(ee,null),ce=!0,fe||(pe=listen(ee,"click",t[15]),fe=!0)},p(re,[V]){re[3].length>0&&re[2]?ue?(ue.p(re,V),V&12&&transition_in(ue,1)):(ue=create_if_block_1$2(re),ue.c(),transition_in(ue,1),ue.m(e,n)):ue&&(group_outros(),transition_out(ue,1,1,()=>{ue=null}),check_outros());const Q={};V&16&&(Q.value=re[4]),d.$set(Q);const j={};V&32&&(j.value=re[5]),_.$set(j);const le={};V&64&&(le.value=re[6]),S.$set(le);const J={};V&128&&(J.value=re[7]),w.$set(J);const z={};V&256&&(z.value=re[8]),P.$set(z);const X={};V&512&&(X.value=re[9]),I.$set(X);const te={};V&1024&&(te.value=re[10]),$.$set(te);const oe={};V&2048&&(oe.value=re[11]),C.$set(oe);const B={};V&4096&&(B.value=re[12]),q.$set(B);const F={};V&8192&&(F.value=re[13]),W.$set(F),(!ce||V&4)&&toggle_class(u,"grid-cols-1",!re[2]),(!ce||V&4)&&toggle_class(u,"grid-cols-2",re[2]);let Y=ie;ie=_e(re),ie!==Y&&(group_outros(),transition_out(he[Y],1,1,()=>{he[Y]=null}),check_outros(),se=he[ie],se||(se=he[ie]=ge[ie](re),se.c()),transition_in(se,1),se.m(ee,null)),(!ce||V&4)&&toggle_class(e,"w-72",re[2]),(!ce||V&4)&&toggle_class(e,"w-28",!re[2])},i(re){ce||(transition_in(ue),transition_in(s.$$.fragment,re),transition_in(d.$$.fragment,re),transition_in(_.$$.fragment,re),transition_in(S.$$.fragment,re),transition_in(w.$$.fragment,re),transition_in(P.$$.fragment,re),transition_in(I.$$.fragment,re),transition_in($.$$.fragment,re),transition_in(C.$$.fragment,re),transition_in(q.$$.fragment,re),transition_in(W.$$.fragment,re),transition_in(se),ce=!0)},o(re){transition_out(ue),transition_out(s.$$.fragment,re),transition_out(d.$$.fragment,re),transition_out(_.$$.fragment,re),transition_out(S.$$.fragment,re),transition_out(w.$$.fragment,re),transition_out(P.$$.fragment,re),transition_out(I.$$.fragment,re),transition_out($.$$.fragment,re),transition_out(C.$$.fragment,re),transition_out(q.$$.fragment,re),transition_out(W.$$.fragment,re),transition_out(se),ce=!1},d(re){re&&detach(e),ue&&ue.d(),destroy_component(s),destroy_component(d),destroy_component(_),destroy_component(S),destroy_component(w),destroy_component(P),destroy_component(I),destroy_component($),destroy_component(C),destroy_component(q),destroy_component(W),he[ie].d(),fe=!1,pe()}}}function instance$h(t,e,n){let a,s,c,u,d,m,_,b,S,k,w,O;component_subscribe(t,sidebarExpanded,q=>n(2,a=q)),component_subscribe(t,toastHistoryStore,q=>n(3,s=q)),component_subscribe(t,depthM,q=>n(4,c=q)),component_subscribe(t,waterTempC,q=>n(5,u=q)),component_subscribe(t,batteryVoltage,q=>n(6,d=q)),component_subscribe(t,batteryCurrent,q=>n(7,m=q)),component_subscribe(t,networkLatencyMs,q=>n(8,_=q)),component_subscribe(t,autopilotLoad,q=>n(9,b=q)),component_subscribe(t,memUsagePercent,q=>n(10,S=q)),component_subscribe(t,diskUsagePercent,q=>n(11,k=q)),component_subscribe(t,cpuTempC,q=>n(12,w=q)),component_subscribe(t,cpuUsagePercent,q=>n(13,O=q));let P=-1,N=!1;const I=q=>q==0?0:(3.5+Math.min(q,6)/60*5)*q,U=getDrawerStore();U.subscribe(q=>{sidebarExpanded.set(q.open)});const $=()=>U.close();return[P,N,a,s,c,u,d,m,_,b,S,k,w,O,I,()=>{get_store_value(U).open?$():sidebarExpanded.set(!sidebarExpanded.get())},q=>{N?P==q?n(0,P=-1):n(0,P=q):(sidebarExpanded.set(!0),n(0,P=q),n(1,N=!0))},()=>{n(0,P=-1),n(1,N=!1)}]}class Sidebar extends SvelteComponent{constructor(e){super(),init(this,e,instance$h,create_fragment$h,safe_not_equal,{})}}const CompassDial_svelte_svelte_type_style_lang="";function create_fragment$g(t){let e,n,a,s,c;return{c(){e=element("div"),n=element("div"),a=space(),s=element("div"),this.h()},l(u){e=claim_element(u,"DIV",{class:!0,style:!0});var d=children(e);n=claim_element(d,"DIV",{class:!0}),children(n).forEach(detach),a=claim_space(d),s=claim_element(d,"DIV",{class:!0,id:!0}),children(s).forEach(detach),d.forEach(detach),this.h()},h(){attr(n,"class","line svelte-1epa793"),attr(s,"class","bg svelte-1epa793"),attr(s,"id","compassDiscImg"),set_style(s,"transform",`translateX(${t[0]}px)`),attr(e,"class",c=null_to_empty("compass  bg-surface-900 rounded-full overflow-clip border-surface-900 border-x-4 "+t[1].class||"")+" svelte-1epa793"),set_style(e,"height","34px"),set_style(e,"min-width","200px")},m(u,d){insert_hydration(u,e,d),append_hydration(e,n),append_hydration(e,a),append_hydration(e,s)},p(u,[d]){d&1&&set_style(s,"transform",`translateX(${u[0]}px)`),d&2&&c!==(c=null_to_empty("compass  bg-surface-900 rounded-full overflow-clip border-surface-900 border-x-4 "+u[1].class||"")+" svelte-1epa793")&&attr(e,"class",c)},i:noop$4,o:noop$4,d(u){u&&detach(e)}}}function instance$g(t,e,n){let a;return component_subscribe(t,rovHeading,s=>n(0,a=s)),t.$$set=s=>{n(1,e=assign$1(assign$1({},e),exclude_internal_props(s)))},e=exclude_internal_props(e),[a,e]}class CompassDial extends SvelteComponent{constructor(e){super(),init(this,e,instance$g,create_fragment$g,safe_not_equal,{})}}function create_fragment$f(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$b='<path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"/>',svgoutlined$b='<path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7.5 13h2v2H11V9H9.5v2.5h-2V9H6v6h1.5zM18 14v-4c0-.55-.45-1-1-1h-4v6h4c.55 0 1-.45 1-1zm-1.5-.5h-2v-3h2v3z"/>',svground$b='<path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8.75 12c-.41 0-.75-.34-.75-.75V13h-2v1.25c0 .41-.34.75-.75.75S6 14.66 6 14.25v-4.5c0-.41.34-.75.75-.75s.75.34.75.75v1.75h2V9.75c0-.41.34-.75.75-.75s.75.34.75.75v4.5c0 .41-.34.75-.75.75zm3.25-6H17c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-3.5c-.28 0-.5-.22-.5-.5v-5c0-.28.22-.5.5-.5zm1 4.5h2v-3h-2v3z"/>',svgsharp$b='<path d="M21 3H3v18h18V3zM11 15H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"/>',svgtwotone$b='<path d="M14.5 10.5h2v3h-2zM19 5H5v14h14V5zm-8 10H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm7-1c0 .55-.45 1-1 1h-4V9h4c.55 0 1 .45 1 1v4z" opacity=".3"/><path d="M5 21h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2zM5 5h14v14H5V5zm4.5 6.5h-2V9H6v6h1.5v-2h2v2H11V9H9.5zM17 9h-4v6h4c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1zm-.5 4.5h-2v-3h2v3z"/>';function instance$f(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$b;break;case"outlined":b=svgoutlined$b;break;case"round":b=svground$b;break;case"sharp":b=svgsharp$b;break;case"two-tone":b=svgtwotone$b;break;default:b=svgoutlined$b}let{ariaLabel:S="hd"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Hd extends SvelteComponent{constructor(e){super(),init(this,e,instance$f,create_fragment$f,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$e(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$a='<path d="M17.5 15v-2h1.1l.9 2H21l-.9-2.1c.5-.2.9-.8.9-1.4v-1c0-.8-.7-1.5-1.5-1.5H16v4.9l1.1 1.1h.4zm0-4.5h2v1h-2v-1zm-4.5 0v.4l1.5 1.5v-1.9c0-.8-.7-1.5-1.5-1.5h-1.9l1.5 1.5h.4zm-3.5-1-7-7-1.1 1L6.9 9h-.4v2h-2V9H3v6h1.5v-2.5h2V15H8v-4.9l1.5 1.5V15h3.4l7.6 7.6 1.1-1.1-12.1-12z"/>',svgoutlined$a='<path d="M17.5 15v-2h1.1l.9 2H21l-.9-2.1c.5-.3.9-.8.9-1.4v-1c0-.8-.7-1.5-1.5-1.5H16v4.86L17.14 15h.36zm0-4.5h2v1h-2v-1zm-4.5 0v.36l1.5 1.5V10.5c0-.8-.7-1.5-1.5-1.5h-1.86l1.5 1.5H13zM2.51 2.49 1.45 3.55 6.9 9h-.4v2h-2V9H3v6h1.5v-2.5h2V15H8v-4.9l1.5 1.5V15h3.4l7.6 7.6 1.06-1.06z"/>',svground$a='<path d="M17.5 14.25V13h1.1l.72 1.59a.693.693 0 0 0 1.27-.55l-.49-1.14c.5-.3.9-.8.9-1.4v-1c0-.83-.67-1.5-1.5-1.5H17c-.55 0-1 .45-1 1v3.9l1.04 1.04c.27-.11.46-.38.46-.69zm0-3.75h2v1h-2v-1zm-4.5 0v.4l1.5 1.5v-1.9c0-.82-.68-1.5-1.5-1.5h-1.9l1.5 1.5h.4zm8.03 10.53-18-18a.742.742 0 1 0-1.05 1.05l4.98 4.98c-.27.11-.46.38-.46.69V11h-2V9.75c0-.41-.34-.75-.75-.75S3 9.34 3 9.75v4.5c0 .41.34.75.75.75s.75-.34.75-.75V12.5h2v1.75c0 .41.34.75.75.75s.75-.34.75-.75V10.1l1.5 1.5v2.9c0 .28.22.5.5.5h2.5c.12 0 .24-.01.36-.04l7.11 7.11c.29.29.76.29 1.05 0a.74.74 0 0 0 .01-1.04z"/>',svgsharp$a='<path d="M17.5 15v-2h1.1l.9 2H21l-.9-2.1h.9V9h-5v4.86L17.14 15h.36zm0-4.5h2v1h-2v-1zm-4.5 0v.36l1.5 1.5V10.5c0-.8-.7-1.5-1.5-1.5h-1.86l1.5 1.5H13zM2.51 2.49 1.45 3.55 6.9 9h-.4v2h-2V9H3v6h1.5v-2.5h2V15H8v-4.9l1.5 1.5V15h3.4l7.6 7.6 1.06-1.06z"/>',svgtwotone$a='<path d="M17.5 15v-2h1.1l.9 2H21l-.9-2.1c.5-.3.9-.8.9-1.4v-1c0-.8-.7-1.5-1.5-1.5H16v4.86L17.14 15h.36zm0-4.5h2v1h-2v-1zm-4.5 0v.36l1.5 1.5V10.5c0-.8-.7-1.5-1.5-1.5h-1.86l1.5 1.5H13zM2.51 2.49 1.45 3.55 6.9 9h-.4v2h-2V9H3v6h1.5v-2.5h2V15H8v-4.9l1.5 1.5V15h3.4l7.6 7.6 1.06-1.06z"/>';function instance$e(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$a;break;case"outlined":b=svgoutlined$a;break;case"round":b=svground$a;break;case"sharp":b=svgsharp$a;break;case"two-tone":b=svgtwotone$a;break;default:b=svgoutlined$a}let{ariaLabel:S="hdr off"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Hdr_off extends SvelteComponent{constructor(e){super(),init(this,e,instance$e,create_fragment$e,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$d(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$9='<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>',svgoutlined$9='<path d="M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>',svground$9='<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1s1 .45 1 1v4c0 .55-.45 1-1 1zm1-8h-2V7h2v2z"/>',svgsharp$9='<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>',svgtwotone$9='<path d="M12 4c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8zm1 13h-2v-6h2v6zm0-8h-2V7h2v2z" opacity=".3"/><path d="M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>';function instance$d(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$9;break;case"outlined":b=svgoutlined$9;break;case"round":b=svground$9;break;case"sharp":b=svgsharp$9;break;case"two-tone":b=svgtwotone$9;break;default:b=svgoutlined$9}let{ariaLabel:S="info"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Info extends SvelteComponent{constructor(e){super(),init(this,e,instance$d,create_fragment$d,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$c(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$8='<path d="M13 3h-2v10h2V3zm4.83 2.17-1.42 1.42A6.92 6.92 0 0 1 19 12c0 3.87-3.13 7-7 7A6.995 6.995 0 0 1 7.58 6.58L6.17 5.17A8.932 8.932 0 0 0 3 12a9 9 0 0 0 18 0c0-2.74-1.23-5.18-3.17-6.83z"/>',svgoutlined$8='<path d="M13 3h-2v10h2V3zm4.83 2.17-1.42 1.42A6.92 6.92 0 0 1 19 12c0 3.87-3.13 7-7 7A6.995 6.995 0 0 1 7.58 6.58L6.17 5.17A8.932 8.932 0 0 0 3 12a9 9 0 0 0 18 0c0-2.74-1.23-5.18-3.17-6.83z"/>',svground$8='<path d="M12 3c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1s1-.45 1-1V4c0-.55-.45-1-1-1zm5.14 2.86a.99.99 0 0 0-.01 1.39c1.13 1.2 1.83 2.8 1.87 4.57.09 3.83-3.08 7.13-6.91 7.17A6.981 6.981 0 0 1 5 12c0-1.84.71-3.51 1.87-4.76.37-.39.37-1-.01-1.38a.993.993 0 0 0-1.43.02A8.92 8.92 0 0 0 3 11.74c-.14 4.88 3.83 9.1 8.71 9.25 5.1.16 9.29-3.93 9.29-9 0-2.37-.92-4.51-2.42-6.11-.38-.41-1.04-.42-1.44-.02z"/>',svgsharp$8='<path d="M13 3h-2v10h2V3zm4.83 2.17-1.42 1.42A6.92 6.92 0 0 1 19 12c0 3.87-3.13 7-7 7A6.995 6.995 0 0 1 7.58 6.58L6.17 5.17A8.932 8.932 0 0 0 3 12a9 9 0 0 0 18 0c0-2.74-1.23-5.18-3.17-6.83z"/>',svgtwotone$8='<path d="M13 3h-2v10h2V3zm4.83 2.17-1.42 1.42A6.92 6.92 0 0 1 19 12c0 3.87-3.13 7-7 7A6.995 6.995 0 0 1 7.58 6.58L6.17 5.17A8.932 8.932 0 0 0 3 12a9 9 0 0 0 18 0c0-2.74-1.23-5.18-3.17-6.83z"/>';function instance$c(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$8;break;case"outlined":b=svgoutlined$8;break;case"round":b=svground$8;break;case"sharp":b=svgsharp$8;break;case"two-tone":b=svgtwotone$8;break;default:b=svgoutlined$8}let{ariaLabel:S="power settings new"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Power_settings_new extends SvelteComponent{constructor(e){super(),init(this,e,instance$c,create_fragment$c,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$b(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$7='<path d="M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8zm-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34A8.014 8.014 0 0 0 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91z"/>',svgoutlined$7='<path d="M6 13c0-1.65.67-3.15 1.76-4.24L6.34 7.34A8.014 8.014 0 0 0 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91zm14 0c0-4.42-3.58-8-8-8-.06 0-.12.01-.18.01l1.09-1.09L11.5 2.5 8 6l3.5 3.5 1.41-1.41-1.08-1.08c.06 0 .12-.01.17-.01 3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93z"/>',svground$7='<path d="M12 5V3.21c0-.45-.54-.67-.85-.35l-2.8 2.79c-.2.2-.2.51 0 .71l2.79 2.79c.32.31.86.09.86-.36V7c3.31 0 6 2.69 6 6 0 2.72-1.83 5.02-4.31 5.75-.42.12-.69.52-.69.95 0 .65.62 1.16 1.25.97A7.991 7.991 0 0 0 20 13c0-4.42-3.58-8-8-8zm-6 8c0-1.34.44-2.58 1.19-3.59.3-.4.26-.95-.09-1.31-.42-.42-1.14-.38-1.5.1a7.991 7.991 0 0 0 4.15 12.47c.63.19 1.25-.32 1.25-.97 0-.43-.27-.83-.69-.95C7.83 18.02 6 15.72 6 13z"/>',svgsharp$7='<path d="M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8zm-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34A8.014 8.014 0 0 0 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91z"/>',svgtwotone$7='<path d="M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8zm-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34A8.014 8.014 0 0 0 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91z"/>';function instance$b(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$7;break;case"outlined":b=svgoutlined$7;break;case"round":b=svground$7;break;case"sharp":b=svgsharp$7;break;case"two-tone":b=svgtwotone$7;break;default:b=svgoutlined$7}let{ariaLabel:S="restart alt"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Restart_alt extends SvelteComponent{constructor(e){super(),init(this,e,instance$b,create_fragment$b,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$a(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$6='<path d="M17 1.01 7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14zm-1-6h-3V8h-2v5H8l4 4 4-4z"/>',svgoutlined$6='<path d="M17 1.01 7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14zm-1-6h-3V8h-2v5H8l4 4 4-4z"/>',svground$6='<path d="M17 1.01 7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14zm-2.21-6H13V9c0-.55-.45-1-1-1s-1 .45-1 1v4H9.21c-.45 0-.67.54-.35.85l2.79 2.79c.2.2.51.2.71 0l2.79-2.79a.5.5 0 0 0-.36-.85z"/>',svgsharp$6='<path d="M5 1v22h14V1H5zm12 18H7V5h10v14zm-1-6h-3V8h-2v5H8l4 4 4-4z"/>',svgtwotone$6='<path d="M7 19h10V5H7v14zm4-6V8h2v5h3l-4 4-4-4h3z" opacity=".3"/><path d="M16 13h-3V8h-2v5H8l4 4zm1-11.99L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14z"/>';function instance$a(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$6;break;case"outlined":b=svgoutlined$6;break;case"round":b=svground$6;break;case"sharp":b=svgsharp$6;break;case"two-tone":b=svgtwotone$6;break;default:b=svgoutlined$6}let{ariaLabel:S="system update"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class System_update extends SvelteComponent{constructor(e){super(),init(this,e,instance$a,create_fragment$a,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$9(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$5='<path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>',svgoutlined$5='<path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>',svground$5='<path d="M6 14c-.55 0-1 .45-1 1v3c0 .55.45 1 1 1h3c.55 0 1-.45 1-1s-.45-1-1-1H7v-2c0-.55-.45-1-1-1zm0-4c.55 0 1-.45 1-1V7h2c.55 0 1-.45 1-1s-.45-1-1-1H6c-.55 0-1 .45-1 1v3c0 .55.45 1 1 1zm11 7h-2c-.55 0-1 .45-1 1s.45 1 1 1h3c.55 0 1-.45 1-1v-3c0-.55-.45-1-1-1s-1 .45-1 1v2zM14 6c0 .55.45 1 1 1h2v2c0 .55.45 1 1 1s1-.45 1-1V6c0-.55-.45-1-1-1h-3c-.55 0-1 .45-1 1z"/>',svgsharp$5='<path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>',svgtwotone$5='<path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>';function instance$9(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$5;break;case"outlined":b=svgoutlined$5;break;case"round":b=svground$5;break;case"sharp":b=svgsharp$5;break;case"two-tone":b=svgtwotone$5;break;default:b=svgoutlined$5}let{ariaLabel:S="fullscreen"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Fullscreen extends SvelteComponent{constructor(e){super(),init(this,e,instance$9,create_fragment$9,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$8(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$4='<path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>',svgoutlined$4='<path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>',svground$4='<path d="M6 16h2v2c0 .55.45 1 1 1s1-.45 1-1v-3c0-.55-.45-1-1-1H6c-.55 0-1 .45-1 1s.45 1 1 1zm2-8H6c-.55 0-1 .45-1 1s.45 1 1 1h3c.55 0 1-.45 1-1V6c0-.55-.45-1-1-1s-1 .45-1 1v2zm7 11c.55 0 1-.45 1-1v-2h2c.55 0 1-.45 1-1s-.45-1-1-1h-3c-.55 0-1 .45-1 1v3c0 .55.45 1 1 1zm1-11V6c0-.55-.45-1-1-1s-1 .45-1 1v3c0 .55.45 1 1 1h3c.55 0 1-.45 1-1s-.45-1-1-1h-2z"/>',svgsharp$4='<path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>',svgtwotone$4='<path d="M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"/>';function instance$8(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$4;break;case"outlined":b=svgoutlined$4;break;case"round":b=svground$4;break;case"sharp":b=svgsharp$4;break;case"two-tone":b=svgtwotone$4;break;default:b=svgoutlined$4}let{ariaLabel:S="fullscreen exit"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Fullscreen_exit extends SvelteComponent{constructor(e){super(),init(this,e,instance$8,create_fragment$8,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$7(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$3='<path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>',svgoutlined$3='<path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>',svground$3='<path d="M4 18h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1zm0-5h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1zM3 7c0 .55.45 1 1 1h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1z"/>',svgsharp$3='<path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>',svgtwotone$3='<path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>';function instance$7(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$3;break;case"outlined":b=svgoutlined$3;break;case"round":b=svground$3;break;case"sharp":b=svgsharp$3;break;case"two-tone":b=svgtwotone$3;break;default:b=svgoutlined$3}let{ariaLabel:S="menu"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Menu extends SvelteComponent{constructor(e){super(),init(this,e,instance$7,create_fragment$7,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$6(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$2='<path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>',svgoutlined$2='<path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>',svground$2='<path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>',svgsharp$2='<path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>',svgtwotone$2='<path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>';function instance$6(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$2;break;case"outlined":b=svgoutlined$2;break;case"round":b=svground$2;break;case"sharp":b=svgsharp$2;break;case"two-tone":b=svgtwotone$2;break;default:b=svgoutlined$2}let{ariaLabel:S="more horiz"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class More_horiz extends SvelteComponent{constructor(e){super(),init(this,e,instance$6,create_fragment$6,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$5(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled$1='<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/>',svgoutlined$1='<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/>',svground$1='<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75-.9.92c-.5.51-.86.97-1.04 1.69-.08.32-.13.68-.13 1.14h-2v-.5a3.997 3.997 0 0 1 1.17-2.83l1.24-1.26c.46-.44.68-1.1.55-1.8a1.99 1.99 0 0 0-1.39-1.53c-1.11-.31-2.14.32-2.47 1.27-.12.37-.43.65-.82.65h-.3C8.4 9 8 8.44 8.16 7.88a4.008 4.008 0 0 1 3.23-2.83c1.52-.24 2.97.55 3.87 1.8 1.18 1.63.83 3.38-.19 4.4z"/>',svgsharp$1='<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/>',svgtwotone$1='<path d="M12 4c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8zm1 14h-2v-2h2v2zm0-3h-2c0-3.25 3-3 3-5 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 2.5-3 2.75-3 5z" opacity=".3"/><path d="M11 16h2v2h-2zm1-14C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/>';function instance$5(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled$1;break;case"outlined":b=svgoutlined$1;break;case"round":b=svground$1;break;case"sharp":b=svgsharp$1;break;case"two-tone":b=svgtwotone$1;break;default:b=svgoutlined$1}let{ariaLabel:S="help"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Help extends SvelteComponent{constructor(e){super(),init(this,e,instance$5,create_fragment$5,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function create_fragment$4(t){let e,n,a,s,c=[{xmlns:"http://www.w3.org/2000/svg"},t[5],{role:t[1]},{width:t[0]},{height:t[0]},{fill:t[2]},{"aria-label":t[3]},{viewBox:"0 0 24 24"}],u={};for(let d=0;d<c.length;d+=1)u=assign$1(u,c[d]);return{c(){e=svg_element("svg"),n=new HtmlTagHydration(!0),this.h()},l(d){e=claim_svg_element(d,"svg",{xmlns:!0,role:!0,width:!0,height:!0,fill:!0,"aria-label":!0,viewBox:!0});var m=children(e);n=claim_html_tag(m,!0),m.forEach(detach),this.h()},h(){n.a=null,set_svg_attributes(e,u)},m(d,m){insert_hydration(d,e,m),n.m(t[4],e),a||(s=[listen(e,"click",t[7]),listen(e,"keydown",t[8]),listen(e,"keyup",t[9]),listen(e,"focus",t[10]),listen(e,"blur",t[11]),listen(e,"mouseenter",t[12]),listen(e,"mouseleave",t[13]),listen(e,"mouseover",t[14]),listen(e,"mouseout",t[15])],a=!0)},p(d,[m]){m&16&&n.p(d[4]),set_svg_attributes(e,u=get_spread_update(c,[{xmlns:"http://www.w3.org/2000/svg"},m&32&&d[5],m&2&&{role:d[1]},m&1&&{width:d[0]},m&1&&{height:d[0]},m&4&&{fill:d[2]},m&8&&{"aria-label":d[3]},{viewBox:"0 0 24 24"}]))},i:noop$4,o:noop$4,d(d){d&&detach(e),a=!1,run_all(s)}}}let svgfilled='<path d="M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27L15.73 3zM17 15.74 15.74 17 12 13.26 8.26 17 7 15.74 10.74 12 7 8.26 8.26 7 12 10.74 15.74 7 17 8.26 13.26 12 17 15.74z"/>',svgoutlined='<path d="M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27L15.73 3zM19 14.9 14.9 19H9.1L5 14.9V9.1L9.1 5h5.8L19 9.1v5.8zm-4.17-7.14L12 10.59 9.17 7.76 7.76 9.17 10.59 12l-2.83 2.83 1.41 1.41L12 13.41l2.83 2.83 1.41-1.41L13.41 12l2.83-2.83-1.41-1.41z"/>',svground='<path d="M14.9 3H9.1c-.53 0-1.04.21-1.42.59l-4.1 4.1C3.21 8.06 3 8.57 3 9.1v5.8c0 .53.21 1.04.59 1.41l4.1 4.1c.37.38.88.59 1.41.59h5.8c.53 0 1.04-.21 1.41-.59l4.1-4.1c.38-.37.59-.88.59-1.41V9.1c0-.53-.21-1.04-.59-1.41l-4.1-4.1c-.37-.38-.88-.59-1.41-.59zm.64 12.54a.996.996 0 0 1-1.41 0L12 13.41l-2.12 2.12a.996.996 0 1 1-1.41-1.41L10.59 12 8.46 9.88a.996.996 0 1 1 1.41-1.41L12 10.59l2.12-2.12a.996.996 0 1 1 1.41 1.41L13.41 12l2.12 2.12c.4.39.4 1.03.01 1.42z"/>',svgsharp='<path d="M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27L15.73 3zm.51 11.83-1.41 1.41L12 13.41l-2.83 2.83-1.41-1.41L10.59 12 7.76 9.17l1.41-1.41L12 10.59l2.83-2.83 1.41 1.41L13.41 12l2.83 2.83z"/>',svgtwotone='<path d="M9.1 5 5 9.1v5.8L9.1 19h5.8l4.1-4.1V9.1L14.9 5H9.1zm7.14 9.83-1.41 1.41L12 13.41l-2.83 2.83-1.41-1.41L10.59 12 7.76 9.17l1.41-1.41L12 10.59l2.83-2.83 1.41 1.41L13.41 12l2.83 2.83z" opacity=".3"/><path d="M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27L15.73 3zM19 14.9 14.9 19H9.1L5 14.9V9.1L9.1 5h5.8L19 9.1v5.8zm-4.17-7.14L12 10.59 9.17 7.76 7.76 9.17 10.59 12l-2.83 2.83 1.41 1.41L12 13.41l2.83 2.83 1.41-1.41L13.41 12l2.83-2.83-1.41-1.41z"/>';function instance$4(t,e,n){const a=["size","role","color","variation","ariaLabel"];let s=compute_rest_props(e,a);const c=getContext("iconCtx")??{};let{size:u=c.size||"24"}=e,{role:d=c.role||"img"}=e,{color:m=c.color||"currentColor"}=e,{variation:_=c.variation||"outlined"}=e,b;switch(_){case"filled":b=svgfilled;break;case"outlined":b=svgoutlined;break;case"round":b=svground;break;case"sharp":b=svgsharp;break;case"two-tone":b=svgtwotone;break;default:b=svgoutlined}let{ariaLabel:S="dangerous"}=e;function k(C){bubble.call(this,t,C)}function w(C){bubble.call(this,t,C)}function O(C){bubble.call(this,t,C)}function P(C){bubble.call(this,t,C)}function N(C){bubble.call(this,t,C)}function I(C){bubble.call(this,t,C)}function U(C){bubble.call(this,t,C)}function $(C){bubble.call(this,t,C)}function x(C){bubble.call(this,t,C)}return t.$$set=C=>{e=assign$1(assign$1({},e),exclude_internal_props(C)),n(5,s=compute_rest_props(e,a)),"size"in C&&n(0,u=C.size),"role"in C&&n(1,d=C.role),"color"in C&&n(2,m=C.color),"variation"in C&&n(6,_=C.variation),"ariaLabel"in C&&n(3,S=C.ariaLabel)},[u,d,m,S,b,s,_,k,w,O,P,N,I,U,$,x]}class Dangerous extends SvelteComponent{constructor(e){super(),init(this,e,instance$4,create_fragment$4,safe_not_equal,{size:0,role:1,color:2,variation:6,ariaLabel:3})}}function get_each_context$1(t,e,n){const a=t.slice();return a[6]=e[n],a}function create_else_block$2(t){let e,n=FlightmodeNameMap[t[6]]+"",a;return{c(){e=element("option"),a=text(n),this.h()},l(s){e=claim_element(s,"OPTION",{});var c=children(e);a=claim_text(c,n),c.forEach(detach),this.h()},h(){e.__value=t[6],set_input_value(e,e.__value)},m(s,c){insert_hydration(s,e,c),append_hydration(e,a)},p:noop$4,d(s){s&&detach(e)}}}function create_if_block$2(t){let e,n;return{c(){e=element("option"),n=text("Flight Mode"),this.h()},l(a){e=claim_element(a,"OPTION",{});var s=children(e);n=claim_text(s,"Flight Mode"),s.forEach(detach),this.h()},h(){e.__value=t[6],set_input_value(e,e.__value),e.disabled=!0},m(a,s){insert_hydration(a,e,s),append_hydration(e,n)},p:noop$4,d(a){a&&detach(e)}}}function create_each_block$1(t){let e;function n(c,u){return c[6]==FlightMode.unknown?create_if_block$2:create_else_block$2}let s=n(t)(t);return{c(){s.c(),e=empty()},l(c){s.l(c),e=empty()},m(c,u){s.m(c,u),insert_hydration(c,e,u)},p(c,u){s.p(c,u)},d(c){c&&detach(e),s.d(c)}}}function create_fragment$3(t){let e,n,a,s,c,u,d,m=ensure_array_like(t[3]),_=[];for(let b=0;b<m.length;b+=1)_[b]=create_each_block$1(get_each_context$1(t,m,b));return s=new Expand_more({props:{class:"absolute right-2 top-1/2 -translate-y-1/2 text-2xl pointer-events-none",tabindex:"-1"}}),{c(){e=element("div"),n=element("select");for(let b=0;b<_.length;b+=1)_[b].c();a=space(),create_component(s.$$.fragment),this.h()},l(b){e=claim_element(b,"DIV",{class:!0});var S=children(e);n=claim_element(S,"SELECT",{class:!0});var k=children(n);for(let w=0;w<_.length;w+=1)_[w].l(k);k.forEach(detach),a=claim_space(S),claim_component(s.$$.fragment,S),S.forEach(detach),this.h()},h(){n.disabled=t[1],attr(n,"class","select variant-outline-primary appearance-none md:pl-4"),attr(e,"class","rounded-full bg-slate-50 relative mx-2 mr-4")},m(b,S){insert_hydration(b,e,S),append_hydration(e,n);for(let k=0;k<_.length;k+=1)_[k]&&_[k].m(n,null);select_option(n,t[0]),append_hydration(e,a),mount_component(s,e,null),c=!0,u||(d=listen(n,"change",t[5]),u=!0)},p(b,[S]){if(S&8){m=ensure_array_like(b[3]);let k;for(k=0;k<m.length;k+=1){const w=get_each_context$1(b,m,k);_[k]?_[k].p(w,S):(_[k]=create_each_block$1(w),_[k].c(),_[k].m(n,null))}for(;k<_.length;k+=1)_[k].d(1);_.length=m.length}(!c||S&2)&&(n.disabled=b[1]),(!c||S&9)&&select_option(n,b[0])},i(b){c||(transition_in(s.$$.fragment,b),c=!0)},o(b){transition_out(s.$$.fragment,b),c=!1},d(b){b&&detach(e),destroy_each(_,b),destroy_component(s),u=!1,d()}}}function instance$3(t,e,n){let a;component_subscribe(t,autopilotMode,_=>n(4,a=_));let{disabled:s=!1}=e,{selectedMode:c=FlightMode.unknown}=e,u=_=>{const b=parseInt(_);console.log("Flightmode change: ",b),autopilotMode.set(FlightMode.unknown),RovActions.setFlightMode(b)},d=Object.values(FlightMode).filter(_=>typeof _=="number");const m=_=>u(_.currentTarget.value);return t.$$set=_=>{"disabled"in _&&n(1,s=_.disabled),"selectedMode"in _&&n(0,c=_.selectedMode)},t.$$.update=()=>{t.$$.dirty&16&&n(0,c=a)},[c,s,u,d,a,m]}class FlightModeSelector extends SvelteComponent{constructor(e){super(),init(this,e,instance$3,create_fragment$3,safe_not_equal,{disabled:1,selectedMode:0})}}function create_else_block_3(t){let e,n,a="GO",s,c,u="Enable Thrusters",d,m,_;return{c(){e=element("button"),n=element("span"),n.textContent=a,s=space(),c=element("span"),c.textContent=u,this.h()},l(b){e=claim_element(b,"BUTTON",{class:!0});var S=children(e);n=claim_element(S,"SPAN",{class:!0,"data-svelte-h":!0}),get_svelte_dataset(n)!=="svelte-ywhe5a"&&(n.textContent=a),s=claim_space(S),c=claim_element(S,"SPAN",{class:!0,"data-svelte-h":!0}),get_svelte_dataset(c)!=="svelte-1ig7gwa"&&(c.textContent=u),S.forEach(detach),this.h()},h(){attr(n,"class","block text-2xl -my-2 pointer-events-none font-mono font-bold"),attr(c,"class","hidden lg:inline"),e.disabled=d=!t[1],attr(e,"class","variant-filled-success mr-4 max-lg:btn-icon lg:btn btn-base")},m(b,S){insert_hydration(b,e,S),append_hydration(e,n),append_hydration(e,s),append_hydration(e,c),m||(_=listen(e,"click",t[10]),m=!0)},p(b,S){S&2&&d!==(d=!b[1])&&(e.disabled=d)},i:noop$4,o:noop$4,d(b){b&&detach(e),m=!1,_()}}}function create_if_block_3(t){let e,n,a,s,c="Halt Thrusters",u,d,m,_;return n=new Dangerous({props:{class:"block text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),{c(){e=element("button"),create_component(n.$$.fragment),a=space(),s=element("span"),s.textContent=c,this.h()},l(b){e=claim_element(b,"BUTTON",{class:!0});var S=children(e);claim_component(n.$$.fragment,S),a=claim_space(S),s=claim_element(S,"SPAN",{class:!0,"data-svelte-h":!0}),get_svelte_dataset(s)!=="svelte-1al6m2m"&&(s.textContent=c),S.forEach(detach),this.h()},h(){attr(s,"class","hidden lg:inline"),e.disabled=u=!t[1],attr(e,"class","variant-filled-error mr-4 max-lg:btn-icon lg:btn btn-base")},m(b,S){insert_hydration(b,e,S),mount_component(n,e,null),append_hydration(e,a),append_hydration(e,s),d=!0,m||(_=listen(e,"click",t[9]),m=!0)},p(b,S){(!d||S&2&&u!==(u=!b[1]))&&(e.disabled=u)},i(b){d||(transition_in(n.$$.fragment,b),d=!0)},o(b){transition_out(n.$$.fragment,b),d=!1},d(b){b&&detach(e),destroy_component(n),m=!1,_()}}}function create_else_block_2(t){let e,n,a,s,c,u,d,m;return n=new Power_settings_new({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),s=new More_horiz({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),{c(){e=element("button"),create_component(n.$$.fragment),a=space(),create_component(s.$$.fragment),this.h()},l(_){e=claim_element(_,"BUTTON",{class:!0});var b=children(e);claim_component(n.$$.fragment,b),a=claim_space(b),claim_component(s.$$.fragment,b),b.forEach(detach),this.h()},h(){e.disabled=c=!t[1],attr(e,"class","btn variant-filled-primary")},m(_,b){insert_hydration(_,e,b),mount_component(n,e,null),append_hydration(e,a),mount_component(s,e,null),u=!0,d||(m=listen(e,"click",t[20]),d=!0)},p(_,b){(!u||b&2&&c!==(c=!_[1]))&&(e.disabled=c)},i(_){u||(transition_in(n.$$.fragment,_),transition_in(s.$$.fragment,_),u=!0)},o(_){transition_out(n.$$.fragment,_),transition_out(s.$$.fragment,_),u=!1},d(_){_&&detach(e),destroy_component(n),destroy_component(s),d=!1,m()}}}function create_if_block_2(t){let e,n,a,s,c,u,d,m,_,b,S,k,w,O,P,N,I,U;return a=new Close({props:{class:"text-2xl  pointer-events-none",tabindex:"-1",variation:"round"}}),u=new Power_settings_new({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),_=new Restart_alt({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),k=new Info({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),P=new System_update({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),{c(){e=element("div"),n=element("button"),create_component(a.$$.fragment),s=space(),c=element("button"),create_component(u.$$.fragment),d=space(),m=element("button"),create_component(_.$$.fragment),b=space(),S=element("button"),create_component(k.$$.fragment),w=space(),O=element("button"),create_component(P.$$.fragment),this.h()},l($){e=claim_element($,"DIV",{class:!0});var x=children(e);n=claim_element(x,"BUTTON",{});var C=children(n);claim_component(a.$$.fragment,C),C.forEach(detach),s=claim_space(x),c=claim_element(x,"BUTTON",{class:!0});var H=children(c);claim_component(u.$$.fragment,H),H.forEach(detach),d=claim_space(x),m=claim_element(x,"BUTTON",{class:!0});var q=children(m);claim_component(_.$$.fragment,q),q.forEach(detach),b=claim_space(x),S=claim_element(x,"BUTTON",{class:!0});var K=children(S);claim_component(k.$$.fragment,K),K.forEach(detach),w=claim_space(x),O=claim_element(x,"BUTTON",{class:!0});var W=children(O);claim_component(P.$$.fragment,W),W.forEach(detach),x.forEach(detach),this.h()},h(){attr(c,"class","variant-filled-secondary"),attr(m,"class","variant-filled-secondary"),attr(S,"class","variant-filled-secondary"),attr(O,"class","variant-filled-secondary"),attr(e,"class","btn-group variant-filled-primary justify-evenly relative")},m($,x){insert_hydration($,e,x),append_hydration(e,n),mount_component(a,n,null),append_hydration(e,s),append_hydration(e,c),mount_component(u,c,null),append_hydration(e,d),append_hydration(e,m),mount_component(_,m,null),append_hydration(e,b),append_hydration(e,S),mount_component(k,S,null),append_hydration(e,w),append_hydration(e,O),mount_component(P,O,null),N=!0,I||(U=[listen(n,"click",t[15]),listen(c,"click",t[16]),listen(m,"click",t[17]),listen(S,"click",t[18]),listen(O,"click",t[19])],I=!0)},p:noop$4,i($){N||(transition_in(a.$$.fragment,$),transition_in(u.$$.fragment,$),transition_in(_.$$.fragment,$),transition_in(k.$$.fragment,$),transition_in(P.$$.fragment,$),N=!0)},o($){transition_out(a.$$.fragment,$),transition_out(u.$$.fragment,$),transition_out(_.$$.fragment,$),transition_out(k.$$.fragment,$),transition_out(P.$$.fragment,$),N=!1},d($){$&&detach(e),destroy_component(a),destroy_component(u),destroy_component(_),destroy_component(k),destroy_component(P),I=!1,run_all(U)}}}function create_lead_slot(t){let e,n,a,s,c,u,d,m,_,b,S,k,w,O,P;n=new Menu({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),c=new FlightModeSelector({props:{disabled:!t[1]}});const N=[create_if_block_3,create_else_block_3],I=[];function U(H,q){return H[5]?0:1}d=U(t),m=I[d]=N[d](t);const $=[create_if_block_2,create_else_block_2],x=[];function C(H,q){return H[0]&&H[1]?0:1}return S=C(t),k=x[S]=$[S](t),{c(){e=element("button"),create_component(n.$$.fragment),s=space(),create_component(c.$$.fragment),u=space(),m.c(),_=space(),b=element("div"),k.c(),this.h()},l(H){e=claim_element(H,"BUTTON",{class:!0});var q=children(e);claim_component(n.$$.fragment,q),q.forEach(detach),s=claim_space(H),claim_component(c.$$.fragment,H),u=claim_space(H),m.l(H),_=claim_space(H),b=claim_element(H,"DIV",{class:!0,style:!0});var K=children(b);k.l(K),K.forEach(detach),this.h()},h(){e.disabled=a=!t[1],attr(e,"class","btn btn-lg btn-icon bg-initial lg:hidden"),attr(b,"class","overflow-visible"),set_style(b,"max-width","4em")},m(H,q){insert_hydration(H,e,q),mount_component(n,e,null),insert_hydration(H,s,q),mount_component(c,H,q),insert_hydration(H,u,q),I[d].m(H,q),insert_hydration(H,_,q),insert_hydration(H,b,q),x[S].m(b,null),w=!0,O||(P=listen(e,"click",t[8]),O=!0)},p(H,q){(!w||q&2&&a!==(a=!H[1]))&&(e.disabled=a);const K={};q&2&&(K.disabled=!H[1]),c.$set(K);let W=d;d=U(H),d===W?I[d].p(H,q):(group_outros(),transition_out(I[W],1,1,()=>{I[W]=null}),check_outros(),m=I[d],m?m.p(H,q):(m=I[d]=N[d](H),m.c()),transition_in(m,1),m.m(_.parentNode,_));let Z=S;S=C(H),S===Z?x[S].p(H,q):(group_outros(),transition_out(x[Z],1,1,()=>{x[Z]=null}),check_outros(),k=x[S],k?k.p(H,q):(k=x[S]=$[S](H),k.c()),transition_in(k,1),k.m(b,null))},i(H){w||(transition_in(n.$$.fragment,H),transition_in(c.$$.fragment,H),transition_in(m),transition_in(k),w=!0)},o(H){transition_out(n.$$.fragment,H),transition_out(c.$$.fragment,H),transition_out(m),transition_out(k),w=!1},d(H){H&&(detach(e),detach(s),detach(u),detach(_),detach(b)),destroy_component(n),destroy_component(c,H),I[d].d(H),x[S].d(),O=!1,P()}}}function create_default_slot$1(t){let e,n,a=MavStateNameMap[t[4]]+"",s,c,u,d;return u=new CompassDial({props:{class:"w-full flex-auto -z-10"}}),{c(){e=element("span"),n=text("MavState: "),s=text(a),c=space(),create_component(u.$$.fragment),this.h()},l(m){e=claim_element(m,"SPAN",{class:!0});var _=children(e);n=claim_text(_,"MavState: "),s=claim_text(_,a),_.forEach(detach),c=claim_space(m),claim_component(u.$$.fragment,m),this.h()},h(){attr(e,"class","px-2 fixed left-1/2 -top-1")},m(m,_){insert_hydration(m,e,_),append_hydration(e,n),append_hydration(e,s),insert_hydration(m,c,_),mount_component(u,m,_),d=!0},p(m,_){(!d||_&16)&&a!==(a=MavStateNameMap[m[4]]+"")&&set_data(s,a)},i(m){d||(transition_in(u.$$.fragment,m),d=!0)},o(m){transition_out(u.$$.fragment,m),d=!1},d(m){m&&(detach(e),detach(c)),destroy_component(u,m)}}}function create_else_block_1(t){let e,n;return e=new Hd({props:{class:"block text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),{c(){create_component(e.$$.fragment)},l(a){claim_component(e.$$.fragment,a)},m(a,s){mount_component(e,a,s),n=!0},i(a){n||(transition_in(e.$$.fragment,a),n=!0)},o(a){transition_out(e.$$.fragment,a),n=!1},d(a){destroy_component(e,a)}}}function create_if_block_1$1(t){let e,n;return e=new Hdr_off({props:{class:"block text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),{c(){create_component(e.$$.fragment)},l(a){claim_component(e.$$.fragment,a)},m(a,s){mount_component(e,a,s),n=!0},i(a){n||(transition_in(e.$$.fragment,a),n=!0)},o(a){transition_out(e.$$.fragment,a),n=!1},d(a){destroy_component(e,a)}}}function create_else_block$1(t){let e,n;return e=new Fullscreen({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),{c(){create_component(e.$$.fragment)},l(a){claim_component(e.$$.fragment,a)},m(a,s){mount_component(e,a,s),n=!0},i(a){n||(transition_in(e.$$.fragment,a),n=!0)},o(a){transition_out(e.$$.fragment,a),n=!1},d(a){destroy_component(e,a)}}}function create_if_block$1(t){let e,n;return e=new Fullscreen_exit({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}}),{c(){create_component(e.$$.fragment)},l(a){claim_component(e.$$.fragment,a)},m(a,s){mount_component(e,a,s),n=!0},i(a){n||(transition_in(e.$$.fragment,a),n=!0)},o(a){transition_out(e.$$.fragment,a),n=!1},d(a){destroy_component(e,a)}}}function create_trail_slot(t){let e,n,a,s,c,u=t[2]?"Use SD Video":"Use HD Video",d,m,_,b,S,k,w="Help",O,P,N,I,U,$,x;const C=[create_if_block_1$1,create_else_block_1],H=[];function q(ee,ie){return ee[2]?0:1}n=q(t),a=H[n]=C[n](t),S=new Help({props:{class:"text-2xl pointer-events-none",tabindex:"-1",variation:"round"}});const K=[create_if_block$1,create_else_block$1],W=[];function Z(ee,ie){return ee[3]?0:1}return N=Z(t),I=W[N]=K[N](t),{c(){e=element("button"),a.c(),s=space(),c=element("span"),d=text(u),_=space(),b=element("button"),create_component(S.$$.fragment),k=element("span"),k.textContent=w,O=space(),P=element("button"),I.c(),this.h()},l(ee){e=claim_element(ee,"BUTTON",{class:!0});var ie=children(e);a.l(ie),s=claim_space(ie),c=claim_element(ie,"SPAN",{class:!0});var se=children(c);d=claim_text(se,u),se.forEach(detach),ie.forEach(detach),_=claim_space(ee),b=claim_element(ee,"BUTTON",{class:!0});var ce=children(b);claim_component(S.$$.fragment,ce),k=claim_element(ce,"SPAN",{class:!0,"data-svelte-h":!0}),get_svelte_dataset(k)!=="svelte-drr3ws"&&(k.textContent=w),ce.forEach(detach),O=claim_space(ee),P=claim_element(ee,"BUTTON",{class:!0});var fe=children(P);I.l(fe),fe.forEach(detach),this.h()},h(){attr(c,"class","hidden lg:inline"),e.disabled=m=!t[1],attr(e,"class","max-lg:btn-icon lg:btn variant-filled-warning text-white btn-base"),attr(k,"class","hidden lg:inline"),attr(b,"class","max-lg:btn-icon lg:btn variant-filled-secondary text-white btn-base"),attr(P,"class","btn btn-lg btn-icon bg-initial")},m(ee,ie){insert_hydration(ee,e,ie),H[n].m(e,null),append_hydration(e,s),append_hydration(e,c),append_hydration(c,d),insert_hydration(ee,_,ie),insert_hydration(ee,b,ie),mount_component(S,b,null),append_hydration(b,k),insert_hydration(ee,O,ie),insert_hydration(ee,P,ie),W[N].m(P,null),U=!0,$||(x=[listen(e,"click",t[13]),listen(P,"click",t[14])],$=!0)},p(ee,ie){let se=n;n=q(ee),n!==se&&(group_outros(),transition_out(H[se],1,1,()=>{H[se]=null}),check_outros(),a=H[n],a||(a=H[n]=C[n](ee),a.c()),transition_in(a,1),a.m(e,s)),(!U||ie&4)&&u!==(u=ee[2]?"Use SD Video":"Use HD Video")&&set_data(d,u),(!U||ie&2&&m!==(m=!ee[1]))&&(e.disabled=m);let ce=N;N=Z(ee),N!==ce&&(group_outros(),transition_out(W[ce],1,1,()=>{W[ce]=null}),check_outros(),I=W[N],I||(I=W[N]=K[N](ee),I.c()),transition_in(I,1),I.m(P,null))},i(ee){U||(transition_in(a),transition_in(S.$$.fragment,ee),transition_in(I),U=!0)},o(ee){transition_out(a),transition_out(S.$$.fragment,ee),transition_out(I),U=!1},d(ee){ee&&(detach(e),detach(_),detach(b),detach(O),detach(P)),H[n].d(),destroy_component(S),W[N].d(),$=!1,run_all(x)}}}function create_fragment$2(t){let e,n;return e=new AppBar({props:{padding:"p-2",class:"overflow-visible",background:"bg-transparent",slotDefault:"flex justify-around overflow-visible min-w-0",$$slots:{trail:[create_trail_slot],default:[create_default_slot$1],lead:[create_lead_slot]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment)},l(a){claim_component(e.$$.fragment,a)},m(a,s){mount_component(e,a,s),n=!0},p(a,[s]){const c={};s&16777279&&(c.$$scope={dirty:s,ctx:a}),e.$set(c)},i(a){n||(transition_in(e.$$.fragment,a),n=!0)},o(a){transition_out(e.$$.fragment,a),n=!1},d(a){destroy_component(e,a)}}}function instance$2(t,e,n){let a,s,c,u,d,m,_;component_subscribe(t,fullscreenOpen,W=>n(3,d=W)),component_subscribe(t,autopilotMavState,W=>n(4,m=W)),component_subscribe(t,autopilotArmed,W=>n(5,_=W));const b=frontendConnMngr.currentVideoStreamMethod;component_subscribe(t,b,W=>n(12,u=W));const S=frontendConnMngr.connectionState;component_subscribe(t,S,W=>n(11,c=W));const k=getDrawerStore(),w=()=>k.open();let O=!1;const P=()=>{RovActions.disarm()},N=()=>{RovActions.takeControl()},I=()=>frontendConnMngr.toggleSimplePeerConnection(),U=W=>{toggleFullscreen(W,null)},$=()=>n(0,O=!1),x=()=>{RovActions.shutdownRov(),n(0,O=!1)},C=()=>{RovActions.rebootRov(),n(0,O=!1)},H=()=>{RovActions.getRovStatusReport(),n(0,O=!1)},q=()=>{RovActions.restartRovServices(),n(0,O=!1)},K=()=>n(0,O=!0);return t.$$.update=()=>{t.$$.dirty&4096&&n(2,a=u===VideoStreamMethod.simplepeer),t.$$.dirty&2048&&n(1,s=c===ConnectionStates.connected)},[O,s,a,d,m,_,b,S,w,P,N,c,u,I,U,$,x,C,H,q,K]}class Topbar extends SvelteComponent{constructor(e){super(),init(this,e,instance$2,create_fragment$2,safe_not_equal,{})}}const RovSelector_svelte_svelte_type_style_lang="";function get_each_context(t,e,n){const a=t.slice();return a[12]=e[n],a}function create_else_block(t){let e,n,a,s,c,u,d,m,_,b,S,k=t[1]?"Disconnect":"Connect",w,O,P,N;return{c(){e=element("span"),n=element("p"),a=text(t[0]),s=space(),c=element("p"),u=text("You Are: "),d=element("span"),m=text(t[3]),_=space(),b=element("button"),S=element("span"),w=text(k),this.h()},l(I){e=claim_element(I,"SPAN",{class:!0});var U=children(e);n=claim_element(U,"P",{class:!0});var $=children(n);a=claim_text($,t[0]),$.forEach(detach),s=claim_space(U),c=claim_element(U,"P",{class:!0});var x=children(c);u=claim_text(x,"You Are: "),d=claim_element(x,"SPAN",{class:!0});var C=children(d);m=claim_text(C,t[3]),C.forEach(detach),x.forEach(detach),U.forEach(detach),_=claim_space(I),b=claim_element(I,"BUTTON",{class:!0});var H=children(b);S=claim_element(H,"SPAN",{class:!0});var q=children(S);w=claim_text(q,k),q.forEach(detach),H.forEach(detach),this.h()},h(){attr(n,"class","m-0 p-0 font-bold"),attr(d,"class","font-bold"),attr(c,"class","m-0 p-0 text-primary-200"),attr(e,"class","px-3 align-middle text-right text-white"),attr(S,"class","whitespace-nowrap inline"),attr(b,"class","btn mr-3 btn-md variant-filled-error align-top")},m(I,U){insert_hydration(I,e,U),append_hydration(e,n),append_hydration(n,a),append_hydration(e,s),append_hydration(e,c),append_hydration(c,u),append_hydration(c,d),append_hydration(d,m),insert_hydration(I,_,U),insert_hydration(I,b,U),append_hydration(b,S),append_hydration(S,w),P||(N=listen(b,"click",t[11]),P=!0)},p(I,U){U&1&&set_data(a,I[0]),U&8&&set_data(m,I[3]),U&2&&k!==(k=I[1]?"Disconnect":"Connect")&&set_data(w,k)},i(I){I&&(O||add_render_callback(()=>{O=create_in_transition(b,fade,{}),O.start()}))},o:noop$4,d(I){I&&(detach(e),detach(_),detach(b)),P=!1,N()}}}function create_if_block_1(t){let e,n="Connect to a ROV:",a,s,c,u=ensure_array_like(t[2]),d=[];for(let _=0;_<u.length;_+=1)d[_]=create_each_block(get_each_context(t,u,_));const m=_=>transition_out(d[_],1,1,()=>{d[_]=null});return{c(){e=element("h2"),e.textContent=n,a=space(),s=element("div");for(let _=0;_<d.length;_+=1)d[_].c();this.h()},l(_){e=claim_element(_,"H2",{class:!0,"data-svelte-h":!0}),get_svelte_dataset(e)!=="svelte-1tnk2i1"&&(e.textContent=n),a=claim_space(_),s=claim_element(_,"DIV",{class:!0});var b=children(s);for(let S=0;S<d.length;S+=1)d[S].l(b);b.forEach(detach),this.h()},h(){attr(e,"class","text-center py-4 px-6 font-bold"),attr(s,"class","flex flex-col align-stretch overflow-y-auto w-full p-3 pt-0")},m(_,b){insert_hydration(_,e,b),insert_hydration(_,a,b),insert_hydration(_,s,b);for(let S=0;S<d.length;S+=1)d[S]&&d[S].m(s,null);c=!0},p(_,b){if(b&132){u=ensure_array_like(_[2]);let S;for(S=0;S<u.length;S+=1){const k=get_each_context(_,u,S);d[S]?(d[S].p(k,b),transition_in(d[S],1)):(d[S]=create_each_block(k),d[S].c(),transition_in(d[S],1),d[S].m(s,null))}for(group_outros(),S=u.length;S<d.length;S+=1)m(S);check_outros()}},i(_){if(!c){for(let b=0;b<u.length;b+=1)transition_in(d[b]);c=!0}},o(_){d=d.filter(Boolean);for(let b=0;b<d.length;b+=1)transition_out(d[b]);c=!1},d(_){_&&(detach(e),detach(a),detach(s)),destroy_each(d,_)}}}function create_if_block(t){let e,n="Searching for online ROVs...";return{c(){e=element("h2"),e.textContent=n,this.h()},l(a){e=claim_element(a,"H2",{class:!0,"data-svelte-h":!0}),get_svelte_dataset(e)!=="svelte-15o12co"&&(e.textContent=n),this.h()},h(){attr(e,"class","text-center py-4 px-6 font-bold")},m(a,s){insert_hydration(a,e,s)},p:noop$4,i:noop$4,o:noop$4,d(a){a&&detach(e)}}}function create_each_block(t){let e,n=t[12].name+"",a,s,c,u,d,m,_,b,S;c=new Chevron_right({props:{variant:"round",class:"text-2xl inline-block pointer-events-none",tabindex:"-1"}});function k(){return t[10](t[12])}return{c(){e=element("button"),a=text(n),s=space(),create_component(c.$$.fragment),u=space(),this.h()},l(w){e=claim_element(w,"BUTTON",{class:!0});var O=children(e);a=claim_text(O,n),s=claim_space(O),claim_component(c.$$.fragment,O),u=claim_space(O),O.forEach(detach),this.h()},h(){e.disabled=d=!t[12].token,attr(e,"class","btn ring-white variant-filled-primary align-top block m-1")},m(w,O){insert_hydration(w,e,O),append_hydration(e,a),append_hydration(e,s),mount_component(c,e,null),append_hydration(e,u),_=!0,b||(S=listen(e,"click",k),b=!0)},p(w,O){t=w,(!_||O&4)&&n!==(n=t[12].name+"")&&set_data(a,n),(!_||O&4&&d!==(d=!t[12].token))&&(e.disabled=d)},i(w){_||(transition_in(c.$$.fragment,w),w&&(m||add_render_callback(()=>{m=create_in_transition(e,fade,{}),m.start()})),_=!0)},o(w){transition_out(c.$$.fragment,w),_=!1},d(w){w&&detach(e),destroy_component(c),b=!1,S()}}}function create_fragment$1(t){let e,n,a,s,c,u,d;const m=[create_if_block,create_if_block_1,create_else_block],_=[];function b(S,k){return S[2].length==0?0:S[1]?2:1}return a=b(t),s=_[a]=m[a](t),{c(){e=element("div"),n=element("div"),s.c(),this.h()},l(S){e=claim_element(S,"DIV",{id:!0,class:!0});var k=children(e);n=claim_element(k,"DIV",{class:!0});var w=children(n);s.l(w),w.forEach(detach),k.forEach(detach),this.h()},h(){attr(n,"class",c=` bg-surface-700 border-2 border-surface-500 m-0 items-center flex whitespace-nowrap text-center rounded-xl max-h-full  ${t[1]?"rounded-b-none border-b-0":"flex-col shadow-2xl"}`),toggle_class(n,"p-1",t[1]),attr(e,"id","rov_chooser"),attr(e,"class",u=null_to_empty(`absolute left-1/2 bottom-0  -translate-x-1/2 transition-all overflow-visible z-50  ${t[1]?" ":"disconnected  top-0"} `)+" svelte-1simma4")},m(S,k){insert_hydration(S,e,k),append_hydration(e,n),_[a].m(n,null),d=!0},p(S,[k]){let w=a;a=b(S),a===w?_[a].p(S,k):(group_outros(),transition_out(_[w],1,1,()=>{_[w]=null}),check_outros(),s=_[a],s?s.p(S,k):(s=_[a]=m[a](S),s.c()),transition_in(s,1),s.m(n,null)),(!d||k&2&&c!==(c=` bg-surface-700 border-2 border-surface-500 m-0 items-center flex whitespace-nowrap text-center rounded-xl max-h-full  ${S[1]?"rounded-b-none border-b-0":"flex-col shadow-2xl"}`))&&attr(n,"class",c),(!d||k&2)&&toggle_class(n,"p-1",S[1]),(!d||k&2&&u!==(u=null_to_empty(`absolute left-1/2 bottom-0  -translate-x-1/2 transition-all overflow-visible z-50  ${S[1]?" ":"disconnected  top-0"} `)+" svelte-1simma4"))&&attr(e,"class",u)},i(S){d||(transition_in(s),d=!0)},o(S){transition_out(s),d=!1},d(S){S&&detach(e),_[a].d()}}}function instance$1(t,e,n){let a,s,c,u,{selectedRov:d=""}=e;const m=frontendConnMngr.connectionState;component_subscribe(t,m,P=>n(9,s=P));const _=frontendConnMngr.openLivekitRoomInfo;component_subscribe(t,_,P=>n(2,c=P));const b=frontendConnMngr.currentLivekitIdentity;component_subscribe(t,b,P=>n(3,u=P));async function S(P){if(!P.token)return showToastMessage("ROV is not available at the moment. Please wait & try again.",5e3,!1,ToastSeverity.error);let N="";if(P.token.encrypted){n(0,d=P.name);const I=P.token.salt,U=P.token.iv;for(;;){await waitfor(200);const $=await modalPasswordPrompt("Enter ROV Password");if(!$)return;try{const x=await decrypt(P.token.token,I,U,$);if(console.log('Decrypted Token:"'+x+'"',P.name),!x||!x.startsWith(ENCRYPTED_AUTH_TOKEN_PREFIX)){showToastMessage("Incorrect password. Please try again.",2e3,!1,ToastSeverity.warning);continue}showToastMessage("Password accepted. Connecting...",2e3,!1,ToastSeverity.success),N=x.substring(ENCRYPTED_AUTH_TOKEN_PREFIX.length);break}catch(x){console.error("Token Decryption Failure:",x),showToastMessage("Incorrect password. Please try again. (Token Decryption Failure)",2e3,!1,ToastSeverity.warning);continue}}}else N=P.token.token;n(0,d=P.name),frontendConnMngr.connectToLivekitRoom(P.name,N)}function k(){frontendConnMngr.disconnect()}const w=P=>S(P),O=()=>k();return t.$$set=P=>{"selectedRov"in P&&n(0,d=P.selectedRov)},t.$$.update=()=>{t.$$.dirty&512&&n(1,a=s===ConnectionStates.connected||s===ConnectionStates.connecting)},[d,a,c,u,m,_,b,S,k,s,w,O]}class RovSelector extends SvelteComponent{constructor(e){super(),init(this,e,instance$1,create_fragment$1,safe_not_equal,{selectedRov:0})}}const sides=["top","right","bottom","left"],alignments=["start","end"],placements=sides.reduce((t,e)=>t.concat(e,e+"-"+alignments[0],e+"-"+alignments[1]),[]),min=Math.min,max=Math.max,round=Math.round,floor=Math.floor,createCoords=t=>({x:t,y:t}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp(t,e,n){return max(t,min(e,n))}function evaluate(t,e){return typeof t=="function"?t(e):t}function getSide(t){return t.split("-")[0]}function getAlignment(t){return t.split("-")[1]}function getOppositeAxis(t){return t==="x"?"y":"x"}function getAxisLength(t){return t==="y"?"height":"width"}function getSideAxis(t){return["top","bottom"].includes(getSide(t))?"y":"x"}function getAlignmentAxis(t){return getOppositeAxis(getSideAxis(t))}function getAlignmentSides(t,e,n){n===void 0&&(n=!1);const a=getAlignment(t),s=getAlignmentAxis(t),c=getAxisLength(s);let u=s==="x"?a===(n?"end":"start")?"right":"left":a==="start"?"bottom":"top";return e.reference[c]>e.floating[c]&&(u=getOppositePlacement(u)),[u,getOppositePlacement(u)]}function getExpandedPlacements(t){const e=getOppositePlacement(t);return[getOppositeAlignmentPlacement(t),e,getOppositeAlignmentPlacement(e)]}function getOppositeAlignmentPlacement(t){return t.replace(/start|end/g,e=>oppositeAlignmentMap[e])}function getSideList(t,e,n){const a=["left","right"],s=["right","left"],c=["top","bottom"],u=["bottom","top"];switch(t){case"top":case"bottom":return n?e?s:a:e?a:s;case"left":case"right":return e?c:u;default:return[]}}function getOppositeAxisPlacements(t,e,n,a){const s=getAlignment(t);let c=getSideList(getSide(t),n==="start",a);return s&&(c=c.map(u=>u+"-"+s),e&&(c=c.concat(c.map(getOppositeAlignmentPlacement)))),c}function getOppositePlacement(t){return t.replace(/left|right|bottom|top/g,e=>oppositeSideMap[e])}function expandPaddingObject(t){return{top:0,right:0,bottom:0,left:0,...t}}function getPaddingObject(t){return typeof t!="number"?expandPaddingObject(t):{top:t,right:t,bottom:t,left:t}}function rectToClientRect(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function computeCoordsFromPlacement(t,e,n){let{reference:a,floating:s}=t;const c=getSideAxis(e),u=getAlignmentAxis(e),d=getAxisLength(u),m=getSide(e),_=c==="y",b=a.x+a.width/2-s.width/2,S=a.y+a.height/2-s.height/2,k=a[d]/2-s[d]/2;let w;switch(m){case"top":w={x:b,y:a.y-s.height};break;case"bottom":w={x:b,y:a.y+a.height};break;case"right":w={x:a.x+a.width,y:S};break;case"left":w={x:a.x-s.width,y:S};break;default:w={x:a.x,y:a.y}}switch(getAlignment(e)){case"start":w[u]-=k*(n&&_?-1:1);break;case"end":w[u]+=k*(n&&_?-1:1);break}return w}const computePosition$1=async(t,e,n)=>{const{placement:a="bottom",strategy:s="absolute",middleware:c=[],platform:u}=n,d=c.filter(Boolean),m=await(u.isRTL==null?void 0:u.isRTL(e));let _=await u.getElementRects({reference:t,floating:e,strategy:s}),{x:b,y:S}=computeCoordsFromPlacement(_,a,m),k=a,w={},O=0;for(let P=0;P<d.length;P++){const{name:N,fn:I}=d[P],{x:U,y:$,data:x,reset:C}=await I({x:b,y:S,initialPlacement:a,placement:k,strategy:s,middlewareData:w,rects:_,platform:u,elements:{reference:t,floating:e}});if(b=U??b,S=$??S,w={...w,[N]:{...w[N],...x}},C&&O<=50){O++,typeof C=="object"&&(C.placement&&(k=C.placement),C.rects&&(_=C.rects===!0?await u.getElementRects({reference:t,floating:e,strategy:s}):C.rects),{x:b,y:S}=computeCoordsFromPlacement(_,k,m)),P=-1;continue}}return{x:b,y:S,placement:k,strategy:s,middlewareData:w}};async function detectOverflow(t,e){var n;e===void 0&&(e={});const{x:a,y:s,platform:c,rects:u,elements:d,strategy:m}=t,{boundary:_="clippingAncestors",rootBoundary:b="viewport",elementContext:S="floating",altBoundary:k=!1,padding:w=0}=evaluate(e,t),O=getPaddingObject(w),N=d[k?S==="floating"?"reference":"floating":S],I=rectToClientRect(await c.getClippingRect({element:(n=await(c.isElement==null?void 0:c.isElement(N)))==null||n?N:N.contextElement||await(c.getDocumentElement==null?void 0:c.getDocumentElement(d.floating)),boundary:_,rootBoundary:b,strategy:m})),U=S==="floating"?{...u.floating,x:a,y:s}:u.reference,$=await(c.getOffsetParent==null?void 0:c.getOffsetParent(d.floating)),x=await(c.isElement==null?void 0:c.isElement($))?await(c.getScale==null?void 0:c.getScale($))||{x:1,y:1}:{x:1,y:1},C=rectToClientRect(c.convertOffsetParentRelativeRectToViewportRelativeRect?await c.convertOffsetParentRelativeRectToViewportRelativeRect({rect:U,offsetParent:$,strategy:m}):U);return{top:(I.top-C.top+O.top)/x.y,bottom:(C.bottom-I.bottom+O.bottom)/x.y,left:(I.left-C.left+O.left)/x.x,right:(C.right-I.right+O.right)/x.x}}const arrow=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:a,placement:s,rects:c,platform:u,elements:d,middlewareData:m}=e,{element:_,padding:b=0}=evaluate(t,e)||{};if(_==null)return{};const S=getPaddingObject(b),k={x:n,y:a},w=getAlignmentAxis(s),O=getAxisLength(w),P=await u.getDimensions(_),N=w==="y",I=N?"top":"left",U=N?"bottom":"right",$=N?"clientHeight":"clientWidth",x=c.reference[O]+c.reference[w]-k[w]-c.floating[O],C=k[w]-c.reference[w],H=await(u.getOffsetParent==null?void 0:u.getOffsetParent(_));let q=H?H[$]:0;(!q||!await(u.isElement==null?void 0:u.isElement(H)))&&(q=d.floating[$]||c.floating[O]);const K=x/2-C/2,W=q/2-P[O]/2-1,Z=min(S[I],W),ee=min(S[U],W),ie=Z,se=q-P[O]-ee,ce=q/2-P[O]/2+K,fe=clamp(ie,ce,se),pe=!m.arrow&&getAlignment(s)!=null&&ce!=fe&&c.reference[O]/2-(ce<ie?Z:ee)-P[O]/2<0,ue=pe?ce<ie?ce-ie:ce-se:0;return{[w]:k[w]+ue,data:{[w]:fe,centerOffset:ce-fe-ue,...pe&&{alignmentOffset:ue}},reset:pe}}});function getPlacementList(t,e,n){return(t?[...n.filter(s=>getAlignment(s)===t),...n.filter(s=>getAlignment(s)!==t)]:n.filter(s=>getSide(s)===s)).filter(s=>t?getAlignment(s)===t||(e?getOppositeAlignmentPlacement(s)!==s:!1):!0)}const autoPlacement=function(t){return t===void 0&&(t={}),{name:"autoPlacement",options:t,async fn(e){var n,a,s;const{rects:c,middlewareData:u,placement:d,platform:m,elements:_}=e,{crossAxis:b=!1,alignment:S,allowedPlacements:k=placements,autoAlignment:w=!0,...O}=evaluate(t,e),P=S!==void 0||k===placements?getPlacementList(S||null,w,k):k,N=await detectOverflow(e,O),I=((n=u.autoPlacement)==null?void 0:n.index)||0,U=P[I];if(U==null)return{};const $=getAlignmentSides(U,c,await(m.isRTL==null?void 0:m.isRTL(_.floating)));if(d!==U)return{reset:{placement:P[0]}};const x=[N[getSide(U)],N[$[0]],N[$[1]]],C=[...((a=u.autoPlacement)==null?void 0:a.overflows)||[],{placement:U,overflows:x}],H=P[I+1];if(H)return{data:{index:I+1,overflows:C},reset:{placement:H}};const q=C.map(Z=>{const ee=getAlignment(Z.placement);return[Z.placement,ee&&b?Z.overflows.slice(0,2).reduce((ie,se)=>ie+se,0):Z.overflows[0],Z.overflows]}).sort((Z,ee)=>Z[1]-ee[1]),W=((s=q.filter(Z=>Z[2].slice(0,getAlignment(Z[0])?2:3).every(ee=>ee<=0))[0])==null?void 0:s[0])||q[0][0];return W!==d?{data:{index:I+1,overflows:C},reset:{placement:W}}:{}}}},flip=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,a;const{placement:s,middlewareData:c,rects:u,initialPlacement:d,platform:m,elements:_}=e,{mainAxis:b=!0,crossAxis:S=!0,fallbackPlacements:k,fallbackStrategy:w="bestFit",fallbackAxisSideDirection:O="none",flipAlignment:P=!0,...N}=evaluate(t,e);if((n=c.arrow)!=null&&n.alignmentOffset)return{};const I=getSide(s),U=getSide(d)===d,$=await(m.isRTL==null?void 0:m.isRTL(_.floating)),x=k||(U||!P?[getOppositePlacement(d)]:getExpandedPlacements(d));!k&&O!=="none"&&x.push(...getOppositeAxisPlacements(d,P,O,$));const C=[d,...x],H=await detectOverflow(e,N),q=[];let K=((a=c.flip)==null?void 0:a.overflows)||[];if(b&&q.push(H[I]),S){const ie=getAlignmentSides(s,u,$);q.push(H[ie[0]],H[ie[1]])}if(K=[...K,{placement:s,overflows:q}],!q.every(ie=>ie<=0)){var W,Z;const ie=(((W=c.flip)==null?void 0:W.index)||0)+1,se=C[ie];if(se)return{data:{index:ie,overflows:K},reset:{placement:se}};let ce=(Z=K.filter(fe=>fe.overflows[0]<=0).sort((fe,pe)=>fe.overflows[1]-pe.overflows[1])[0])==null?void 0:Z.placement;if(!ce)switch(w){case"bestFit":{var ee;const fe=(ee=K.map(pe=>[pe.placement,pe.overflows.filter(ue=>ue>0).reduce((ue,ge)=>ue+ge,0)]).sort((pe,ue)=>pe[1]-ue[1])[0])==null?void 0:ee[0];fe&&(ce=fe);break}case"initialPlacement":ce=d;break}if(s!==ce)return{reset:{placement:ce}}}return{}}}};async function convertValueToCoords(t,e){const{placement:n,platform:a,elements:s}=t,c=await(a.isRTL==null?void 0:a.isRTL(s.floating)),u=getSide(n),d=getAlignment(n),m=getSideAxis(n)==="y",_=["left","top"].includes(u)?-1:1,b=c&&m?-1:1,S=evaluate(e,t);let{mainAxis:k,crossAxis:w,alignmentAxis:O}=typeof S=="number"?{mainAxis:S,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...S};return d&&typeof O=="number"&&(w=d==="end"?O*-1:O),m?{x:w*b,y:k*_}:{x:k*_,y:w*b}}const offset=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:n,y:a}=e,s=await convertValueToCoords(e,t);return{x:n+s.x,y:a+s.y,data:s}}}},shift=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:a,placement:s}=e,{mainAxis:c=!0,crossAxis:u=!1,limiter:d={fn:N=>{let{x:I,y:U}=N;return{x:I,y:U}}},...m}=evaluate(t,e),_={x:n,y:a},b=await detectOverflow(e,m),S=getSideAxis(getSide(s)),k=getOppositeAxis(S);let w=_[k],O=_[S];if(c){const N=k==="y"?"top":"left",I=k==="y"?"bottom":"right",U=w+b[N],$=w-b[I];w=clamp(U,w,$)}if(u){const N=S==="y"?"top":"left",I=S==="y"?"bottom":"right",U=O+b[N],$=O-b[I];O=clamp(U,O,$)}const P=d.fn({...e,[k]:w,[S]:O});return{...P,data:{x:P.x-n,y:P.y-a}}}}};function getNodeName(t){return isNode(t)?(t.nodeName||"").toLowerCase():"#document"}function getWindow(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function getDocumentElement(t){var e;return(e=(isNode(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function isNode(t){return t instanceof Node||t instanceof getWindow(t).Node}function isElement(t){return t instanceof Element||t instanceof getWindow(t).Element}function isHTMLElement(t){return t instanceof HTMLElement||t instanceof getWindow(t).HTMLElement}function isShadowRoot(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof getWindow(t).ShadowRoot}function isOverflowElement(t){const{overflow:e,overflowX:n,overflowY:a,display:s}=getComputedStyle$1(t);return/auto|scroll|overlay|hidden|clip/.test(e+a+n)&&!["inline","contents"].includes(s)}function isTableElement(t){return["table","td","th"].includes(getNodeName(t))}function isContainingBlock(t){const e=isWebKit(),n=getComputedStyle$1(t);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(a=>(n.willChange||"").includes(a))||["paint","layout","strict","content"].some(a=>(n.contain||"").includes(a))}function getContainingBlock(t){let e=getParentNode(t);for(;isHTMLElement(e)&&!isLastTraversableNode(e);){if(isContainingBlock(e))return e;e=getParentNode(e)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(t){return["html","body","#document"].includes(getNodeName(t))}function getComputedStyle$1(t){return getWindow(t).getComputedStyle(t)}function getNodeScroll(t){return isElement(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function getParentNode(t){if(getNodeName(t)==="html")return t;const e=t.assignedSlot||t.parentNode||isShadowRoot(t)&&t.host||getDocumentElement(t);return isShadowRoot(e)?e.host:e}function getNearestOverflowAncestor(t){const e=getParentNode(t);return isLastTraversableNode(e)?t.ownerDocument?t.ownerDocument.body:t.body:isHTMLElement(e)&&isOverflowElement(e)?e:getNearestOverflowAncestor(e)}function getOverflowAncestors(t,e,n){var a;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=getNearestOverflowAncestor(t),c=s===((a=t.ownerDocument)==null?void 0:a.body),u=getWindow(s);return c?e.concat(u,u.visualViewport||[],isOverflowElement(s)?s:[],u.frameElement&&n?getOverflowAncestors(u.frameElement):[]):e.concat(s,getOverflowAncestors(s,[],n))}function getCssDimensions(t){const e=getComputedStyle$1(t);let n=parseFloat(e.width)||0,a=parseFloat(e.height)||0;const s=isHTMLElement(t),c=s?t.offsetWidth:n,u=s?t.offsetHeight:a,d=round(n)!==c||round(a)!==u;return d&&(n=c,a=u),{width:n,height:a,$:d}}function unwrapElement(t){return isElement(t)?t:t.contextElement}function getScale(t){const e=unwrapElement(t);if(!isHTMLElement(e))return createCoords(1);const n=e.getBoundingClientRect(),{width:a,height:s,$:c}=getCssDimensions(e);let u=(c?round(n.width):n.width)/a,d=(c?round(n.height):n.height)/s;return(!u||!Number.isFinite(u))&&(u=1),(!d||!Number.isFinite(d))&&(d=1),{x:u,y:d}}const noOffsets=createCoords(0);function getVisualOffsets(t){const e=getWindow(t);return!isWebKit()||!e.visualViewport?noOffsets:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function shouldAddVisualOffsets(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==getWindow(t)?!1:e}function getBoundingClientRect(t,e,n,a){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),c=unwrapElement(t);let u=createCoords(1);e&&(a?isElement(a)&&(u=getScale(a)):u=getScale(t));const d=shouldAddVisualOffsets(c,n,a)?getVisualOffsets(c):createCoords(0);let m=(s.left+d.x)/u.x,_=(s.top+d.y)/u.y,b=s.width/u.x,S=s.height/u.y;if(c){const k=getWindow(c),w=a&&isElement(a)?getWindow(a):a;let O=k.frameElement;for(;O&&a&&w!==k;){const P=getScale(O),N=O.getBoundingClientRect(),I=getComputedStyle$1(O),U=N.left+(O.clientLeft+parseFloat(I.paddingLeft))*P.x,$=N.top+(O.clientTop+parseFloat(I.paddingTop))*P.y;m*=P.x,_*=P.y,b*=P.x,S*=P.y,m+=U,_+=$,O=getWindow(O).frameElement}}return rectToClientRect({width:b,height:S,x:m,y:_})}function convertOffsetParentRelativeRectToViewportRelativeRect(t){let{rect:e,offsetParent:n,strategy:a}=t;const s=isHTMLElement(n),c=getDocumentElement(n);if(n===c)return e;let u={scrollLeft:0,scrollTop:0},d=createCoords(1);const m=createCoords(0);if((s||!s&&a!=="fixed")&&((getNodeName(n)!=="body"||isOverflowElement(c))&&(u=getNodeScroll(n)),isHTMLElement(n))){const _=getBoundingClientRect(n);d=getScale(n),m.x=_.x+n.clientLeft,m.y=_.y+n.clientTop}return{width:e.width*d.x,height:e.height*d.y,x:e.x*d.x-u.scrollLeft*d.x+m.x,y:e.y*d.y-u.scrollTop*d.y+m.y}}function getClientRects(t){return Array.from(t.getClientRects())}function getWindowScrollBarX(t){return getBoundingClientRect(getDocumentElement(t)).left+getNodeScroll(t).scrollLeft}function getDocumentRect(t){const e=getDocumentElement(t),n=getNodeScroll(t),a=t.ownerDocument.body,s=max(e.scrollWidth,e.clientWidth,a.scrollWidth,a.clientWidth),c=max(e.scrollHeight,e.clientHeight,a.scrollHeight,a.clientHeight);let u=-n.scrollLeft+getWindowScrollBarX(t);const d=-n.scrollTop;return getComputedStyle$1(a).direction==="rtl"&&(u+=max(e.clientWidth,a.clientWidth)-s),{width:s,height:c,x:u,y:d}}function getViewportRect(t,e){const n=getWindow(t),a=getDocumentElement(t),s=n.visualViewport;let c=a.clientWidth,u=a.clientHeight,d=0,m=0;if(s){c=s.width,u=s.height;const _=isWebKit();(!_||_&&e==="fixed")&&(d=s.offsetLeft,m=s.offsetTop)}return{width:c,height:u,x:d,y:m}}function getInnerBoundingClientRect(t,e){const n=getBoundingClientRect(t,!0,e==="fixed"),a=n.top+t.clientTop,s=n.left+t.clientLeft,c=isHTMLElement(t)?getScale(t):createCoords(1),u=t.clientWidth*c.x,d=t.clientHeight*c.y,m=s*c.x,_=a*c.y;return{width:u,height:d,x:m,y:_}}function getClientRectFromClippingAncestor(t,e,n){let a;if(e==="viewport")a=getViewportRect(t,n);else if(e==="document")a=getDocumentRect(getDocumentElement(t));else if(isElement(e))a=getInnerBoundingClientRect(e,n);else{const s=getVisualOffsets(t);a={...e,x:e.x-s.x,y:e.y-s.y}}return rectToClientRect(a)}function hasFixedPositionAncestor(t,e){const n=getParentNode(t);return n===e||!isElement(n)||isLastTraversableNode(n)?!1:getComputedStyle$1(n).position==="fixed"||hasFixedPositionAncestor(n,e)}function getClippingElementAncestors(t,e){const n=e.get(t);if(n)return n;let a=getOverflowAncestors(t,[],!1).filter(d=>isElement(d)&&getNodeName(d)!=="body"),s=null;const c=getComputedStyle$1(t).position==="fixed";let u=c?getParentNode(t):t;for(;isElement(u)&&!isLastTraversableNode(u);){const d=getComputedStyle$1(u),m=isContainingBlock(u);!m&&d.position==="fixed"&&(s=null),(c?!m&&!s:!m&&d.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||isOverflowElement(u)&&!m&&hasFixedPositionAncestor(t,u))?a=a.filter(b=>b!==u):s=d,u=getParentNode(u)}return e.set(t,a),a}function getClippingRect(t){let{element:e,boundary:n,rootBoundary:a,strategy:s}=t;const u=[...n==="clippingAncestors"?getClippingElementAncestors(e,this._c):[].concat(n),a],d=u[0],m=u.reduce((_,b)=>{const S=getClientRectFromClippingAncestor(e,b,s);return _.top=max(S.top,_.top),_.right=min(S.right,_.right),_.bottom=min(S.bottom,_.bottom),_.left=max(S.left,_.left),_},getClientRectFromClippingAncestor(e,d,s));return{width:m.right-m.left,height:m.bottom-m.top,x:m.left,y:m.top}}function getDimensions(t){return getCssDimensions(t)}function getRectRelativeToOffsetParent(t,e,n){const a=isHTMLElement(e),s=getDocumentElement(e),c=n==="fixed",u=getBoundingClientRect(t,!0,c,e);let d={scrollLeft:0,scrollTop:0};const m=createCoords(0);if(a||!a&&!c)if((getNodeName(e)!=="body"||isOverflowElement(s))&&(d=getNodeScroll(e)),a){const _=getBoundingClientRect(e,!0,c,e);m.x=_.x+e.clientLeft,m.y=_.y+e.clientTop}else s&&(m.x=getWindowScrollBarX(s));return{x:u.left+d.scrollLeft-m.x,y:u.top+d.scrollTop-m.y,width:u.width,height:u.height}}function getTrueOffsetParent(t,e){return!isHTMLElement(t)||getComputedStyle$1(t).position==="fixed"?null:e?e(t):t.offsetParent}function getOffsetParent(t,e){const n=getWindow(t);if(!isHTMLElement(t))return n;let a=getTrueOffsetParent(t,e);for(;a&&isTableElement(a)&&getComputedStyle$1(a).position==="static";)a=getTrueOffsetParent(a,e);return a&&(getNodeName(a)==="html"||getNodeName(a)==="body"&&getComputedStyle$1(a).position==="static"&&!isContainingBlock(a))?n:a||getContainingBlock(t)||n}const getElementRects=async function(t){let{reference:e,floating:n,strategy:a}=t;const s=this.getOffsetParent||getOffsetParent,c=this.getDimensions;return{reference:getRectRelativeToOffsetParent(e,await s(n),a),floating:{x:0,y:0,...await c(n)}}};function isRTL(t){return getComputedStyle$1(t).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement,isRTL};function observeMove(t,e){let n=null,a;const s=getDocumentElement(t);function c(){clearTimeout(a),n&&n.disconnect(),n=null}function u(d,m){d===void 0&&(d=!1),m===void 0&&(m=1),c();const{left:_,top:b,width:S,height:k}=t.getBoundingClientRect();if(d||e(),!S||!k)return;const w=floor(b),O=floor(s.clientWidth-(_+S)),P=floor(s.clientHeight-(b+k)),N=floor(_),U={rootMargin:-w+"px "+-O+"px "+-P+"px "+-N+"px",threshold:max(0,min(1,m))||1};let $=!0;function x(C){const H=C[0].intersectionRatio;if(H!==m){if(!$)return u();H?u(!1,H):a=setTimeout(()=>{u(!1,1e-7)},100)}$=!1}try{n=new IntersectionObserver(x,{...U,root:s.ownerDocument})}catch{n=new IntersectionObserver(x,U)}n.observe(t)}return u(!0),c}function autoUpdate(t,e,n,a){a===void 0&&(a={});const{ancestorScroll:s=!0,ancestorResize:c=!0,elementResize:u=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:m=!1}=a,_=unwrapElement(t),b=s||c?[..._?getOverflowAncestors(_):[],...getOverflowAncestors(e)]:[];b.forEach(I=>{s&&I.addEventListener("scroll",n,{passive:!0}),c&&I.addEventListener("resize",n)});const S=_&&d?observeMove(_,n):null;let k=-1,w=null;u&&(w=new ResizeObserver(I=>{let[U]=I;U&&U.target===_&&w&&(w.unobserve(e),cancelAnimationFrame(k),k=requestAnimationFrame(()=>{w&&w.observe(e)})),n()}),_&&!m&&w.observe(_),w.observe(e));let O,P=m?getBoundingClientRect(t):null;m&&N();function N(){const I=getBoundingClientRect(t);P&&(I.x!==P.x||I.y!==P.y||I.width!==P.width||I.height!==P.height)&&n(),P=I,O=requestAnimationFrame(N)}return n(),()=>{b.forEach(I=>{s&&I.removeEventListener("scroll",n),c&&I.removeEventListener("resize",n)}),S&&S(),w&&w.disconnect(),w=null,m&&cancelAnimationFrame(O)}}const computePosition=(t,e,n)=>{const a=new Map,s={platform,...n},c={...s.platform,_c:a};return computePosition$1(t,e,{...s,platform:c})};function create_default_slot_1(t){let e,n;return e=new Sidebar({}),{c(){create_component(e.$$.fragment)},l(a){claim_component(e.$$.fragment,a)},m(a,s){mount_component(e,a,s),n=!0},i(a){n||(transition_in(e.$$.fragment,a),n=!0)},o(a){transition_out(e.$$.fragment,a),n=!1},d(a){destroy_component(e,a)}}}function create_default_slot(t){let e,n,a,s,c,u,d,m;return e=new RovSelector({}),a=new LoadingIndicator({}),c=new VideoPlayer({}),d=new OnscreenGamepads({}),{c(){create_component(e.$$.fragment),n=space(),create_component(a.$$.fragment),s=space(),create_component(c.$$.fragment),u=space(),create_component(d.$$.fragment)},l(_){claim_component(e.$$.fragment,_),n=claim_space(_),claim_component(a.$$.fragment,_),s=claim_space(_),claim_component(c.$$.fragment,_),u=claim_space(_),claim_component(d.$$.fragment,_)},m(_,b){mount_component(e,_,b),insert_hydration(_,n,b),mount_component(a,_,b),insert_hydration(_,s,b),mount_component(c,_,b),insert_hydration(_,u,b),mount_component(d,_,b),m=!0},i(_){m||(transition_in(e.$$.fragment,_),transition_in(a.$$.fragment,_),transition_in(c.$$.fragment,_),transition_in(d.$$.fragment,_),m=!0)},o(_){transition_out(e.$$.fragment,_),transition_out(a.$$.fragment,_),transition_out(c.$$.fragment,_),transition_out(d.$$.fragment,_),m=!1},d(_){_&&(detach(n),detach(s),detach(u)),destroy_component(e,_),destroy_component(a,_),destroy_component(c,_),destroy_component(d,_)}}}function create_pageHeader_slot(t){let e,n;return e=new Topbar({}),{c(){create_component(e.$$.fragment)},l(a){claim_component(e.$$.fragment,a)},m(a,s){mount_component(e,a,s),n=!0},i(a){n||(transition_in(e.$$.fragment,a),n=!0)},o(a){transition_out(e.$$.fragment,a),n=!1},d(a){destroy_component(e,a)}}}function create_sidebarLeft_slot(t){let e,n;return e=new Sidebar({}),{c(){create_component(e.$$.fragment)},l(a){claim_component(e.$$.fragment,a)},m(a,s){mount_component(e,a,s),n=!0},i(a){n||(transition_in(e.$$.fragment,a),n=!0)},o(a){transition_out(e.$$.fragment,a),n=!1},d(a){destroy_component(e,a)}}}function create_fragment(t){let e,n,a,s,c,u,d,m,_,b;return e=new HelpTooltips({}),a=new Modal({}),c=new Toast({props:{position:"tl"}}),d=new Drawer({props:{width:"w-72",$$slots:{default:[create_default_slot_1]},$$scope:{ctx:t}}}),_=new AppShell({props:{slotSidebarLeft:"bg-surface-500/5 hidden lg:block",regionPage:"[&>main]:relative",$$slots:{sidebarLeft:[create_sidebarLeft_slot],pageHeader:[create_pageHeader_slot],default:[create_default_slot]},$$scope:{ctx:t}}}),{c(){create_component(e.$$.fragment),n=space(),create_component(a.$$.fragment),s=space(),create_component(c.$$.fragment),u=space(),create_component(d.$$.fragment),m=space(),create_component(_.$$.fragment)},l(S){claim_component(e.$$.fragment,S),n=claim_space(S),claim_component(a.$$.fragment,S),s=claim_space(S),claim_component(c.$$.fragment,S),u=claim_space(S),claim_component(d.$$.fragment,S),m=claim_space(S),claim_component(_.$$.fragment,S)},m(S,k){mount_component(e,S,k),insert_hydration(S,n,k),mount_component(a,S,k),insert_hydration(S,s,k),mount_component(c,S,k),insert_hydration(S,u,k),mount_component(d,S,k),insert_hydration(S,m,k),mount_component(_,S,k),b=!0},p(S,[k]){const w={};k&1&&(w.$$scope={dirty:k,ctx:S}),d.$set(w);const O={};k&1&&(O.$$scope={dirty:k,ctx:S}),_.$set(O)},i(S){b||(transition_in(e.$$.fragment,S),transition_in(a.$$.fragment,S),transition_in(c.$$.fragment,S),transition_in(d.$$.fragment,S),transition_in(_.$$.fragment,S),b=!0)},o(S){transition_out(e.$$.fragment,S),transition_out(a.$$.fragment,S),transition_out(c.$$.fragment,S),transition_out(d.$$.fragment,S),transition_out(_.$$.fragment,S),b=!1},d(S){S&&(detach(n),detach(s),detach(u),detach(m)),destroy_component(e,S),destroy_component(a,S),destroy_component(c,S),destroy_component(d,S),destroy_component(_,S)}}}function instance(t){return initializeStores(),storePopup.set({computePosition,autoUpdate,autoPlacement,flip,shift,offset,arrow}),setupToasts(),setupModals(),initPage(),onMount(()=>{appReady.set(!0)}),onDestroy(()=>{RovActions.stopRequiredMsgLoop(),frontendConnMngr.disconnect(),gpadCtrl.gpadEmulator.cleanup()}),[]}class Layout extends SvelteComponent{constructor(e){super(),init(this,e,instance,create_fragment,safe_not_equal,{})}}export{Layout as component,_layout as universal};
//# sourceMappingURL=0.650cb3e7.js.map
